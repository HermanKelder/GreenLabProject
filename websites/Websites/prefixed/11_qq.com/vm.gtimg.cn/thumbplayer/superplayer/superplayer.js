/**
 * thumbplayer-h5
 * Update Date: 2022-09-22 12:10:49
 * Author: thumbplayer-h5 team
 * ---
 * Copyright (c) 2022 Tencent
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SuperPlayerExport={})}(this,(function(exports){"use strict";var extendStatics$2=function(e,t){return extendStatics$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},extendStatics$2(e,t)};function __extends$d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}extendStatics$2(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var __assign$a=function(){return __assign$a=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$a.apply(this,arguments)},SET_LEVEL_MODE,PLAY_MODE;function __decorate$9(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a}function __metadata$9(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter$7(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function __generator$7(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}function __spreadArray$4(e,t,o){if(o||2===arguments.length)for(var r,i=0,n=t.length;i<n;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||t)}Promise.prototype.finally||(Promise.prototype.finally=function(e){var t=this.constructor;return this.then((function(o){return t.resolve(e()).then((function(){return o}))}),(function(o){return t.resolve(e()).then((function(){return t.reject(o)}))}))}),function(e){e.SOFT="soft",e.HARD="hard",e.SMOOTH="smooth"}(SET_LEVEL_MODE||(SET_LEVEL_MODE={})),exports.PLAY_MODE=void 0,PLAY_MODE=exports.PLAY_MODE||(exports.PLAY_MODE={}),PLAY_MODE.VOD="vod",PLAY_MODE.LIVE="live";var CAN_PLAY_ALL=null,VIDEO_CONTAINER_CLASS="txp_videos_container",END_STATE,VIDEO_READY_STATE,VIDEO_EVTS,VIDEO_STATE,ERROR_CODE;exports.END_STATE=void 0,END_STATE=exports.END_STATE||(exports.END_STATE={}),END_STATE.NORMAL="normal",END_STATE.INTERRUPT="interrupt",END_STATE.ERROR="error",function(e){e[e.HAVE_NOTHING=0]="HAVE_NOTHING",e[e.HAVE_METADATA=1]="HAVE_METADATA",e[e.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",e[e.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",e[e.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(VIDEO_READY_STATE||(VIDEO_READY_STATE={})),function(e){e.loadstart="loadstart",e.timeupdate="timeupdate",e.durationchange="durationchange",e.volumechange="volumechange",e.canplay="canplay",e.playing="playing",e.pause="pause",e.waiting="waiting",e.seeking="seeking",e.seeked="seeked",e.loadeddata="loadeddata",e.loadedmetadata="loadedmetadata",e.ended="ended",e.error="error",e.progress="progress",e.ratechange="ratechange",e.resize="resize",e.frameRender="videoFrameRender"}(VIDEO_EVTS||(VIDEO_EVTS={})),exports.VIDEO_STATE=void 0,VIDEO_STATE=exports.VIDEO_STATE||(exports.VIDEO_STATE={}),VIDEO_STATE.IDLE="idle",VIDEO_STATE.LOAD_START="loadStart",VIDEO_STATE.CANPLAY="canplay",VIDEO_STATE.PLAYING="playing",VIDEO_STATE.PAUSE="pause",VIDEO_STATE.SEEKING="seeking",VIDEO_STATE.SEEKED="seeked",VIDEO_STATE.BUFFERING="buffering",VIDEO_STATE.END="end",function(e){e.UNKNOWN_ERR="70011000",e.MEDIA_ERR_ABORTED="70011100",e.MEDIA_ERR_NETWORK="70011101",e.MEDIA_ERR_DECODE="70011102",e.MEDIA_ERR_SRC_NOT_SUPPORTED="70011103",e.ORG_LOAD_TIMEOUT="70011104",e.STATE_STUCK="70011105",e.ORG_PLAY_STUCK_ERR="70011111",e.NULL_URL="70011112",e.MISSING_KERNEL="70011113",e.KERNEL_NOT_SPT="70011114"}(ERROR_CODE||(ERROR_CODE={}));var VIDEO_ELEMENT_ERROR={1:{code:ERROR_CODE.MEDIA_ERR_ABORTED,message:"视频获取被终止"},2:{code:ERROR_CODE.MEDIA_ERR_NETWORK,message:"下载视频发生错误"},3:{code:ERROR_CODE.MEDIA_ERR_DECODE,message:"尝试解码出错"},4:{code:ERROR_CODE.MEDIA_ERR_SRC_NOT_SUPPORTED,message:"浏览器不支持该音视频"}},ERROR_MSG,PLAY_EVENT,VIDEO_NODE_EVENT,MSE_EVENTS,PAUSE_TYPE,PLAYER_LOG_LEVEL,PRELOAD_TYPE,CODEC,VIDEO_CODEC,AUDIO_CODEC,CONTAINER_FORMAT,HDR_CAPABILITY,VIDEO_ELEMENT_STATE;!function(e){e.UNKNOWN="未知错误",e.XHR_NET="视频获取途中出现问题",e.PRELOAD_VIDEO_TIMEOUT="加载视频超时",e.PLAY_STUCK="视频无法继续播放",e.LOAD_STREAM_FAIL="视频流获取途中出现问题",e.INNER="内部错误",e.NULL_URL="传入的地址为空"}(ERROR_MSG||(ERROR_MSG={})),exports.PLAY_EVENT=void 0,PLAY_EVENT=exports.PLAY_EVENT||(exports.PLAY_EVENT={}),PLAY_EVENT.RESTART="restart",PLAY_EVENT.TIME_UPDATE="timeupdate",PLAY_EVENT.METADATA_CHANGE="metadataChange",PLAY_EVENT.RATE_CHANGE="rateChange",PLAY_EVENT.VOLUME_CHANGE="volumeChange",PLAY_EVENT.DURATION_CHANGE="durationChange",PLAY_EVENT.AUTOPLAY_BLOCKED="autoplayBlocked",PLAY_EVENT.LOAD_PROGRESS="loadProgress",PLAY_EVENT.STATE_CHANGE="stateChange",PLAY_EVENT.FIRST_PLAYING="firstPlaying",PLAY_EVENT.VIDEONODE_PLAY_OVER="videoNodePlayOver",PLAY_EVENT.VIDEONODE_START_PLAY="videoNodeStartPlay",PLAY_EVENT.VIDEONODE_FIRST_PLAYING="videoNodeFirstPlaying",PLAY_EVENT.VIDEONODE_CHANGE="videoNodeChange",PLAY_EVENT.LIST_CHANGE="listChange",PLAY_EVENT.SET_LOADING="setLoading",PLAY_EVENT.PRELOAD_START="preloadStart",PLAY_EVENT.PRELOAD_VIDEONODE_OVER="preloadVideonodeOver",PLAY_EVENT.PRELOAD_VIDEONODE_CLEAR="preloadVideonodeClear",PLAY_EVENT.PRELOAD_VIDEONODE_ERROR="preloadVideonodeError",PLAY_EVENT.VIDEO_BUFFER_CHANGE="videoBufferChange",PLAY_EVENT.SETLEVEL_START="setLevelStart",PLAY_EVENT.SETLEVEL_OVER="setLevelOver",PLAY_EVENT.SET_AUDIO_TRACK_START="setAudioTrackStart",PLAY_EVENT.SET_AUDIO_TRACK_OVER="setAudioTrackOver",PLAY_EVENT.RESIZE="resize",PLAY_EVENT.STOPED="stoped",PLAY_EVENT.ERROR="error",PLAY_EVENT.RETRY_BACKURL="retryBackUrl",PLAY_EVENT.VIDEO_FRAME_RENDER="videoFrameRender",PLAY_EVENT.ELEMENT_EVTS="elementEvts",PLAY_EVENT.VIDEO_RESIZE="videoResize",PLAY_EVENT.FULLSCREEN_CHANGE="fullscreenChange",function(e){e.TIME_UPDATE="vn_timeupdate",e.METADATA_CHANGE="vn_metadataChange",e.VOLUME_CHANGE="vn_volumeChange",e.DURATION_CHANGE="vn_durationChange",e.PLAY_PROMISE_CATCHED="vn_playPromiseCatched",e.LOAD_PROGRESS="vn_loadProgress",e.RATE_CHANGE="vn_rateChange",e.BUFFER_APPENDED="vn_bufferAppended",e.STATE_CHANGE="vn_stateChange",e.ERROR="vn_error",e.RETRY="vn_retry",e.SET_LOADING="vn_setLoading",e.VIDEO_BUFFER_CHANGE="vn_videoBufferChange",e.SETLEVEL_START="vn_setLevelStart",e.SETLEVEL_OVER="vn_setLevelOver",e.SET_AUDIO_TRACK_START="vn_setAudioTrackStart",e.SET_AUDIO_TRACK_OVER="vn_setAudioTrackOver",e.URL_CHANGE="vn_urlChange",e.FIRST_PLAYING="vn_firstPlaying",e.ELEMENT_EVTS="vn_elementEvts",e.PLAY_OVER="vn_playOver",e.VIDEO_RESIZE="vn_videoResize",e.VIDEO_FRAME_RENDER="vn_videoFrameRender"}(VIDEO_NODE_EVENT||(VIDEO_NODE_EVENT={})),function(e){e.OEPN="open",e.CLOSE="close",e.ERROR="error",e.REINIT="REINIT",e.UPDATE_END="updateend",e.REMOVE_END="removeend"}(MSE_EVENTS||(MSE_EVENTS={})),function(e){e.USER="user",e.INNER="inner",e.SYS="sys"}(PAUSE_TYPE||(PAUSE_TYPE={})),function(e){e[e.NONE=0]="NONE",e[e.CORE=1]="CORE",e[e.KERNEL=2]="KERNEL"}(PLAYER_LOG_LEVEL||(PLAYER_LOG_LEVEL={})),exports.PRELOAD_TYPE=void 0,PRELOAD_TYPE=exports.PRELOAD_TYPE||(exports.PRELOAD_TYPE={}),PRELOAD_TYPE.META_DATA="metadata",PRELOAD_TYPE.AUTO="auto",PRELOAD_TYPE.AUTO_LOAD="autoLoad",function(e){e[e.H264=0]="H264",e[e.H265=1]="H265",e[e.AV1=2]="AV1"}(CODEC||(CODEC={})),exports.VIDEO_CODEC=void 0,VIDEO_CODEC=exports.VIDEO_CODEC||(exports.VIDEO_CODEC={}),VIDEO_CODEC.UNKNOWN="unknown",VIDEO_CODEC.H264="h264",VIDEO_CODEC.H265="h265",VIDEO_CODEC.H266="h266",VIDEO_CODEC.VP8="vp8",VIDEO_CODEC.VP9="vp9",VIDEO_CODEC.AV1="av1",VIDEO_CODEC.DOLBY_VISION="dolbyVision",exports.AUDIO_CODEC=void 0,AUDIO_CODEC=exports.AUDIO_CODEC||(exports.AUDIO_CODEC={}),AUDIO_CODEC.AAC="aac",AUDIO_CODEC.OPUS="opus",exports.CONTAINER_FORMAT=void 0,CONTAINER_FORMAT=exports.CONTAINER_FORMAT||(exports.CONTAINER_FORMAT={}),CONTAINER_FORMAT.MPEG_TS="mpegts",CONTAINER_FORMAT.FMP4="fmp4",CONTAINER_FORMAT.MP4="mp4",function(e){e[e.NOT_SUPPORTED=0]="NOT_SUPPORTED",e[e.WCG_DISPLAY_BUT_NO_HDR=1]="WCG_DISPLAY_BUT_NO_HDR",e[e.SUPPORTED=2]="SUPPORTED"}(HDR_CAPABILITY||(HDR_CAPABILITY={})),function(e){e.FREE="0",e.USED="1"}(VIDEO_ELEMENT_STATE||(VIDEO_ELEMENT_STATE={}));var CDN_PATH_PREFIX="//vm.gtimg.cn/thumbplayer/",CACHE_SIZE_KEY,AUDIO_TRACK_ERROR_MSG;function getEnvVals$1(){var e="npm";try{e="npm"}catch(e){}var t="";try{t="1.6.2"}catch(e){}var o="";try{o=1663819814714}catch(e){}var r=!1;try{r=!1}catch(e){}return{CHANNEL:e,VERSION:t,BUILD_TIME:o,LOCAL_DEV:r}}!function(e){e.DEMUX="demux_cache_size"}(CACHE_SIZE_KEY||(CACHE_SIZE_KEY={})),function(e){e.KERNEL_NOT_EXISTS="kernel not exists",e.NOT_SUPPORT="not support",e.STATE_INVALID="state invalid"}(AUDIO_TRACK_ERROR_MSG||(AUDIO_TRACK_ERROR_MSG={}));var _a$8=getEnvVals$1(),CHANNEL$1=_a$8.CHANNEL,BUILD_TIME$2=_a$8.BUILD_TIME,VERSION$3=_a$8.VERSION,LOCAL_DEV=_a$8.LOCAL_DEV,r$2;function t$1(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function e$2(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}function n$2(e,t,o){if(o||2===arguments.length)for(var r,i=0,n=t.length;i<n;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}!function(e){e[e.sync=1]="sync",e[e.async=0]="async"}(r$2||(r$2={}));var i$2=function(){function e(){this._hasPriority=!1,this._array=[]}return e.prototype.insert=function(e,t){if(void 0===t&&(t=!1),0!==e.priority&&(this._hasPriority=!0),!this._hasPriority)return t?(this._array.unshift(e),0):(this._array.push(e),this._array.length-1);var o=this._array.findIndex((function(o){return o.priority===e.priority?t:o.priority<e.priority}));return-1===o?(this._array.push(e),this._array.length-1):(this._array.splice(o,0,e),o)},e.prototype.clone=function(){return n$2([],this._array,!0)},e.prototype.getListener=function(e){return this._array[e]},e.prototype.getListeners=function(){return this._array.map((function(e){return e.listener}))},e.prototype.remove=function(e){var t=this._array.findIndex((function(t){return t.listener===e}));-1!==t&&(this._array[t].isRemove=!0,this._array.splice(t,1))},e.prototype.findIdx=function(e){return this._array.findIndex((function(t){return t.listener===e}))},e.prototype.size=function(){return this._array.length},e}(),s$1=function(){function e(e){void 0===e&&(e={}),this._events=Object.create(null),this._cacheEvents=Object.create(null);var t=e.maxListeners,o=void 0===t?10:t,r=e.replayType,i=void 0===r?r$2.sync:r,n=e.isCache,a=void 0!==n&&n;this._isCache=a,this._replayType=i,this._maxListeners=o}return e.prototype.setCacheStatus=function(e){this._isCache=e},e.prototype.setReplayType=function(e){this._replayType=e},e.prototype.getCacheStatus=function(){return this._isCache},e.prototype.clearCache=function(){this._isCache=!1,this._cacheEvents=Object.create(null)},e.prototype.setMaxListeners=function(e){return this._maxListeners=e,this},e.prototype.getMaxListeners=function(){return this._maxListeners},e.prototype.emit=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return this._emit.apply(this,n$2([!1,e],t,!1))},e.prototype.asyncEmit=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return this._emit.apply(this,n$2([!0,e],t,!1))},e.prototype.addListener=function(e,t){return this._addListener(e,{listener:t,priority:0,isOnce:!1})},e.prototype.on=function(e,t,o){return void 0===o&&(o=0),this._addListener(e,{listener:t,priority:o,isOnce:!1})},e.prototype.listeners=function(e){var t=this._events[e];return t?t.getListeners():[]},e.prototype.prependListener=function(e,t){return this._addListener(e,{listener:t,priority:0,isOnce:!1},!0)},e.prototype.once=function(e,t,o){return void 0===o&&(o=0),this._addListener(e,{listener:t,priority:o,isOnce:!0})},e.prototype.removeListener=function(e,t){var o=this._events[e];return o?(o.remove(t),this):this},e.prototype.off=function(e,t){return this.removeListener(e,t)},e.prototype.removeAllListeners=function(e){return void 0===e?(this._events=Object.create(null),this):(this._events[e]&&delete this._events[e],this)},e.prototype.listenerCount=function(e){var t;return(null===(t=this._events[e])||void 0===t?void 0:t.size())||0},e.prototype.eventNames=function(){return Object.getOwnPropertyNames(this._events)},e.prototype._emit=function(t,o){var r=this;void 0===t&&(t=!1);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var a=[{type:o,target:this,data:1===i.length?i[0]:i}],s=this._events[o],l={stopIndex:-1,onceCount:0,emitData:a};if(this._addCacheEvent(o,l,t),!s)return!!t&&Promise.resolve(!1);var c=Promise.resolve();return s.clone().some((function(o,i){return(o.isOnce||o.isRemove)&&(l.onceCount+=1),!o.isRemove&&(t?(c=c.then((function(){return t$1(r,void 0,void 0,(function(){return e$2(this,(function(t){switch(t.label){case 0:return l.stopIndex>=0||o.isRemove?[2]:(o.isOnce&&s.remove(o.listener),[4,o.listener.apply(this,a)]);case 1:return t.sent()===e.STOP_IMMEDIATE_PROPAGATION&&(l.stopIndex=Math.max(i-l.onceCount,0)),[2]}}))}))})),!1):(o.isOnce&&s.remove(o.listener),o.listener.apply(r,a)===e.STOP_IMMEDIATE_PROPAGATION&&(l.stopIndex=Math.max(i-l.onceCount,0),!0)))})),!t||c.then((function(){return!0}))},e.prototype._addCacheEvent=function(e,t,o){if(this._isCache){var r=o?Promise.resolve(t):t;this._cacheEvents[e]?this._cacheEvents[e].push(r):this._cacheEvents[e]=[r]}},e.prototype._replayCacheEvent=function(t,o,r){var i=this,n=this._cacheEvents[t];if(this._isCache&&n){var a=o.isOnce?1:0;n.some((function(s,l){return s instanceof Promise?(n[l]=s.then((function(n){return t$1(i,void 0,void 0,(function(){var i;return e$2(this,(function(s){switch(s.label){case 0:return n.stopIndex>=0&&r>n.stopIndex?[2,n]:[4,o.listener.apply(this,n.emitData)];case 1:return i=s.sent(),o.isOnce&&this.off(t,o.listener),i===e.STOP_IMMEDIATE_PROPAGATION?n.stopIndex=Math.max(r-a,0):n.stopIndex>=0&&r<=n.stopIndex&&(n.stopIndex=n.stopIndex-a+1),[2,n]}}))}))})),o.isOnce):(s.stopIndex>=0&&r>s.stopIndex||(o.isOnce&&i.off(t,o.listener),o.listener.apply(i,s.emitData)===e.STOP_IMMEDIATE_PROPAGATION?s.stopIndex=Math.max(r-a,0):s.stopIndex>=0&&r<=s.stopIndex&&(s.stopIndex=s.stopIndex-a+1)),o.isOnce)}))}},e.prototype._addListener=function(e,t,o){var r=this;void 0===o&&(o=!1),this._events[e]||(this._events[e]=new i$2);var i=this._events[e].insert(t,o);return this._maxListeners>0&&this._events[e].size()===this._maxListeners&&console.warn("Possible EventEmitter memory leak detected. ".concat(this._events[e].size()," ").concat(String(e)," listeners ")+"added. Use emitter.setMaxListeners() to increase limit"),this._replayType===r$2.async?setTimeout((function(){var o=r._events[e].findIdx(t.listener);-1!==o&&r._replayCacheEvent(e,t,o)})):this._replayCacheEvent(e,t,i),this},e.STOP_IMMEDIATE_PROPAGATION="EventEmitter.STOP_IMMEDIATE_PROPAGATION",e}(),e$1=function(){return(e$1=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function t(e){if("undefined"!=typeof Image){var t=new Image(1,1),o=e$1({attaid:"0f400053130",token:"6552374442",comps:"@tencent/ovb-utils",version:"1.1.4",ua:navigator.userAgent,url:location.href,_dc:Math.random()},e),r=Object.keys(o).map((function(e){return e+"="+encodeURIComponent(o[e])})).join("&");t.src="https://h.trace.qq.com/kv?"+r}}var n$1=function(){function e(){}return e.setDefault=function(t){e.defaultOptions=e$1(e$1({},e.defaultOptions),t)},e.getCookie=function(t){var o=void 0,r=document.cookie?document.cookie.split("; "):[],i={};return r.some((function(r){var n=r.split("="),a=n[0],s=n.slice(1),l=e.decode(a),c=e.parseValue(s.join("="));return l===t?(o=c,!0):(i[l]=c,!1)})),void 0===t?i:o},e.setCookie=function(t,o,r){return void 0===r&&(r={}),e.set(t,o,r)},e.clearCookie=function(t,o,r){void 0===o&&(o=""),void 0===r&&(r=""),e.setCookie(t,"",{domain:o,path:r,expires:-1})},e.clearAllCookies=function(t,o){void 0===t&&(t=""),void 0===o&&(o="");var r=document.cookie?document.cookie.split("; "):[],i={domain:t,path:o,expires:-1};r.forEach((function(t){var o=t.split("=")[0];e.set(o,"",i,!0)}))},e.set=function(t,o,r,i){void 0===i&&(i=!1);var n=e$1(e$1({},e.defaultOptions),r),a=n.domain,s=n.path,l=n.secure,c=n.expires,p=n.sameSite,d=new Date(Date.now()+24*c*60*60*1e3),u=[(i?t:e.encode(t))+"="+e.stringifyValue(o),"; expires="+d.toUTCString(),s?"; path="+s:"",a?"; domain="+a:"",p?"; SameSite="+p:"",l?"; Secure":""].join("");return document.cookie=u,u},e.encode=function(t){return e.raw?t:encodeURIComponent(t)},e.decode=function(t){return e.raw?t:decodeURIComponent(t)},e.stringifyValue=function(t){return e.encode(e.json?JSON.stringify(t):String(t))},e.parseValue=function(t){if(e.raw)return t;var o=t;0===o.indexOf('"')&&(o=o.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return o=decodeURIComponent(o.replace(/\+/g," ")),e.json?JSON.parse(o):o}catch(t){}},e.raw=!1,e.json=!1,e.defaultOptions={domain:"",path:"/",expires:365,secure:!0,sameSite:""},e}(),i$1=function(e,t){var o=""+e;return!o||o.length>=t?o:""+Array(t+1-o.length).join("0")+e},r$1=/\[([^\]]+)]|(Y|y){1,4}|M{1,4}|D{1,2}|d{1,2}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,a$1;function o$2(e,t){void 0===t&&(t="yyyy-MM-DD HH:mm:ss");var o=new Date(e);if(isNaN(o.getTime()))return o.toString();var r=t,i=""+o.getFullYear(),n=i.slice(-2),a=o.getHours(),s=""+(a%12||12),l=""+(o.getMonth()+1),c=""+o.getDate(),p=""+o.getDay(),d=""+o.getMinutes(),u=""+o.getSeconds(),A=""+o.getMilliseconds(),_=15*Math.round(o.getTimezoneOffset()/15),E=Math.abs(_),g=i$1(Math.floor(E/60),2),f=i$1(E%60,2),h=_<=0?"+":"-",v=""+h+g+":"+f,m=""+h+g+f,y={YY:n,YYYY:i,yy:n,yyyy:i,M:l,MM:i$1(l,2),D:c,DD:i$1(c,2),d:p,dd:i$1(c,2),H:""+a,HH:i$1(a,2),h:i$1(s,1),hh:i$1(s,2),a:a<12?"am":"pm",A:a<12?"AM":"PM",m:d,mm:i$1(d,2),s:u,ss:i$1(u,2),SSS:i$1(A,3),Z:v,ZZ:m};return r.replace(r$1,(function(e,t){return t||y[e]||e}))}function g$1(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function m$2(e){var t=e.split("#"),o=t[0],r=t[1],i=void 0===r?"":r,n=o.split("?"),a=n[0],s=n[1],l=void 0===s?"":s,c=g$1(i),p=Object.create(null);return l.split("&").forEach((function(e){var t=e.split("="),o=t[0],r=t[1],i=void 0===r?"":r,n=g$1(o),a=g$1(i);null===n||null===a||""===n&&""===a||p[n]||(p[n]=a)})),{url:a,query:p,hash:c}}function x$1(e,t){var o;if(!t||!document.querySelectorAll("style[data-tag="+t+"]").length){var r=document.createElement("style");r.textContent=e.trim(),t&&(r.dataset.tag=t),null===(o=document.getElementsByTagName("head")[0])||void 0===o||o.appendChild(r)}}function b(e,t){return new Promise((function(o,r){if(t&&document.querySelectorAll("script[data-tag="+t+"]").length)return o();var i=document.createElement("script"),n=e$1({type:"text/javascript",charset:"utf-8"},e);Object.keys(n).forEach((function(e){return M(i,e,n[e])})),t&&(i.dataset.tag=t),i.onload=function(){return o()},i.onreadystatechange=function(){var e=i.readyState;["complete","loaded"].includes(e)&&(i.onreadystatechange=null,o())},i.onerror=r,document.body.appendChild(i)}))}function M(e,t,o){if(e)return void 0===o?e.getAttribute(t):e.setAttribute(t,o)}function q(e,t){return!!(null==e?void 0:e.className)&&-1!==e.getAttribute("class").split(" ").indexOf(t)}function _(e,t){if(e&&!q(e,t)){var o=(e.className+" "+t).trim();e.setAttribute("class",o)}}function E(e,t){if(e){var o=e.className.split(" "),r=o.indexOf(t);-1!==r&&(o.splice(r,1),e.className=o.join(" "))}}function k(e,t,o){if(e&&t)if("string"!=typeof t||void 0===o){if("string"==typeof t&&void 0===o)return(e.currentStyle?e.currentStyle:getComputedStyle(e,null))[t];"object"==typeof t&&Object.keys(t).forEach((function(o){return k(e,o,t[o])}))}else{var r=/width|height|left|right|top|bottom|padding|margin/i.test(t)&&"number"==typeof o;e.style[t]=r?o+"px":o}}function O(e){k(e,{display:"none"})}function j(e,t){void 0===t&&(t="block"),k(e,{display:t})}function C(e,t){if(e)return void 0===t?e.innerText:void(e.innerText=t)}function A(e,t){if(e)return void 0===t?e.innerHTML:void(e.innerHTML=t)}!function(e){e[e.equal=0]="equal",e[e.low=-1]="low",e[e.high=1]="high"}(a$1||(a$1={}));var P=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z-]+(?:\.[\da-z-]+)*)?(?:\+[\da-z-]+(?:\.[\da-z-]+)*)?)?)?$/i;function N(e){var t,o=e.replace(/^v/,"").replace(/\+.*$/,""),r=("-",-1===(t=o).indexOf("-")?t.length:t.indexOf("-")),i=o.substring(0,r).split(".");return i.push(o.substring(r+1)),i}function D(e){return isNaN(Number(e))?e:Number(e)}function I(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!P.test(e))throw new Error("Invalid argument not valid semver ('"+e+"' received)")}function T(e,t){[e,t].forEach(I);for(var o=N(e),r=N(t),i=0;i<Math.max(o.length-1,r.length-1);i++){var n=parseInt(o[i]||"0",10),a=parseInt(r[i]||"0",10);if(n>a)return a$1.high;if(a>n)return a$1.low}var s=o[o.length-1],l=r[r.length-1];if(s&&l){var c=s.split(".").map(D),p=l.split(".").map(D);for(i=0;i<Math.max(c.length,p.length);i++){if(void 0===c[i]||"string"==typeof p[i]&&"number"==typeof c[i])return-1;if(void 0===p[i]||"string"==typeof c[i]&&"number"==typeof p[i])return 1;if(c[i]>p[i])return a$1.high;if(p[i]>c[i])return a$1.low}}else if(s||l)return s?a$1.low:a$1.high;return a$1.equal}var B=/</g,H=/>/g,R=/"/g,Q=/'/g,U=/&/g;function V(e){return e?(""+e).replace(U,"&amp;").replace(B,"&lt;").replace(H,"&gt;").replace(R,"&quot;").replace(Q,"&#39;"):""}"undefined"!=typeof document&&"undefined"!=typeof window&&("complete"===document.readyState?t({func:"init",result:1}):window.addEventListener("load",(function(){return t({func:"init",result:1})})));var comTool={supportES6:function(){try{eval("var foo = (x)=>x+1")}catch(e){return!1}return!0},isObject:function(e){return"object"==typeof e&&e.constructor===Object},createGUID:function(e){void 0===e&&(e=32);for(var t=e||32,o="",r=1;r<=t;r++){o+=Math.floor(16*Math.random()).toString(16)}return o},xss:V,removeDiscontinuityTimeRangesFromPlayTime:function(e,t){var o=comTool.findDiscontinuityTimeRangeAtPlaytime(e,t);if(o)return o.start;var r=e;return t.forEach((function(t){t.end<e&&(r-=t.end-t.start)})),r},findDiscontinuityTimeRangeAtPlaytime:function(e,t){return comTool.mergeTimeRanges(t).find((function(t){return e>=t.start&&e<=t.end}))},mergeTimeRanges:function(e){var t=-1,o=-1,r=[];return e.forEach((function(e){var i=e.start,n=e.end;t<0&&(t=i),i!==o&&o>=0&&(r.push({start:t,end:o}),t=i),o=n})),t>=0&&o>=0&&r.push({start:t,end:o}),r},compareVersion:T,formatPlayTime:function(e){var t=e;if("string"==typeof t&&(t=parseInt(t,10)),"number"!=typeof t||Number.isNaN(t))return"00:00";var o=function(e){return e<10?"0".concat(e):e},r=Math.floor(t/3600),i=Math.floor((t-3600*r)/60),n=Math.floor(t-3600*r-60*i);return 0===r?[o(i),o(n)].join(":"):[r,o(i),o(n)].join(":")},dateFormat:function(e,t){return void 0===t&&(t=Date.now()),o$2(t,e||"yyyy-MM-dd hh:mm:ss")},base64ToArrayBuffer:function(e){for(var t=window.atob(e),o=t.length,r=new Uint8Array(o),i=0;i<o;i++)r[i]=t.charCodeAt(i);return r},setTimeoutByRAF:function(e,t){var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame,r=+new Date;!function i(){+new Date-r>t?e():o(i)}()}},mobileDevReg=/android|iPod|ipad|iPhone|mobile/i;function uaMatch(e){var t,o,r;e=(e=e||navigator.userAgent).toLowerCase(),this.browser={},this.os={},this.mobile=!1,this.spider=!1,mobileDevReg.test(e)&&(this.mobile=!0);/(googlebot|bingbot|yandex|twitterbot|facebookexternalhit|rogerbot|linkedinbot|embedly|quora link preview|showyoubot|outbrain|pinterest\/0\.|pinterestbot|slackbot|vkShare|W3C_Validator|whatsapp|petalbot|applebot|mpcrawler|spider)/i.test(e)&&(this.spider=!0);for(var i,n,a={android_1:/android[\s\/]([\d\.]+)/i,android_2:/android/i,android_3:/MIDP-/i,ipod_1:/iPod\stouch;\sCPU\siPhone\sos\s([\d_]+)/i,ipod_100:/iPod.*os\s?([\d_\.]+)/i,iphone:/iPhone;\sCPU\siPhone\sos\s([\d_]+)/i,iphone_100:/iPhone.*os\s?([\d_\.]+)/i,ipad_1:/ipad;\scpu\sos\s([\d_]+)/i,ipad_2:/ipad([\d]+)?/i,windows:/windows\snt\s([\d\.]+)/i,mac:/Macintosh.*mac\sos\sx\s([\d_\.]+)/i,linux:/Linux/i},s=Object.keys(a),l=0,c=s.length;l<c;l++){var p=s[l];if(i=a[p].exec(e)){n=p.replace(/_\d+/,""),this.os[n]=!0,this.os.osName=n,i[1]&&(this.os.version=i[1].replace(/_/g,"."));break}}(this.os.iphone||this.os.ipad||this.os.ipod)&&(this.os.ios=!0);var d,u,A={wechat:/MicroMessenger\/([\d\.]+)/i,ipadqq:/IPadQQ\/([\d\.]+)/i,mqq:/qq\/([\d\.]+)/i,qzone:/QZONEJSSDK\/([\d\.]+)/i,mqqbrowser:/mqqbrowser\/([\d\.]+)/i,qqbrowser:/[^m]QQBrowser\/([\d\.]+)/i,x5:/tbs\/(\d+)/i,uc:/UCBrowser\/([\d\.]+)/i,safari_1:/Version\/(([\d\.]+))\sSafari\/[\d\.]+/i,safari_2:/Safari\/([\d\.]+)/i,chrome_1:/CriOS\/([\d\.]+)/i,chrome_2:/Chrome\/([\d\.]+)/i,firefox:/Firefox\/([\d\.]+)/i,ie_1:/MSIE\s([\d\.]+)/i,ie_2:/(trident\/\d\.\d)/i,ie_3:/(Edge)\/\d+\.\d+/i,weibo:/weibo__([\d\.]+)/i,qqnews:/qqnews\/([\d\.]+)/i,qqlive_1:/QQLiveBrowser\/([\d\.]+)/i,qqlive_2:/QQLiveHDBrowser\/([\d\.]+)/i,kuaibao:/qnreading\/([\d\.]+)/i,liebao:/LieBaoFast\/([\d\.]+)/i,douban:/com\.douban\.frodo\/([\d\.]+)/i,miuibrowser:/MiuiBrowser/i,baidu:/baiduboxapp/i,browser360:/360browser/i,oppobrowser:/OppoBrowser/i,qqdownloader:/qqdownloader\/([\d\.]+)/i},_=Object.keys(A),E=0;for(c=_.length;E<c;E++){var g=_[E];if(d=A[g].exec(e)){if(u=g.replace(/_\d+/,""),this.browser[u])return this;this.browser[u]={version:d[1]},this.browser.browserName=u,this.browser.version=d[1]}}return this.os.android&&this.browser.safari&&(this.browser.safari=null),this.browser.chrome&&this.browser.safari&&(this.browser.safari=null),(null===(r=null===(o=null===(t=this.browser)||void 0===t?void 0:t.ie)||void 0===o?void 0:o.version)||void 0===r?void 0:r.indexOf("trident"))>-1&&(this.browser.ie.version.indexOf("6.0")>-1?this.browser.ie.version="10":this.browser.ie.version.indexOf("5.0")>-1?this.browser.ie.version="9":this.browser.ie.version.indexOf("4.0")>-1?this.browser.ie.version="8":this.browser.ie.version="11"),this}var uaTool=uaMatch.call({},navigator.userAgent),jsonTool={safelyStringify:function(e){try{return JSON.stringify(e)}catch(e){return"{}"}}},__assign$9=window&&window.__assign||function(){return __assign$9=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$9.apply(this,arguments)},__spreadArray$3=window&&window.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var r,i=0,n=t.length;i<n;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},LogCacheLimit=4e3,noop=function(){},dummyConsole={trace:noop,debug:noop,info:noop,log:noop,warn:noop,error:noop},PatchedConsole=Object.assign({},dummyConsole),LogMode;function patchConsole(e){(e||Object.keys(dummyConsole)).forEach((function(e){var t;PatchedConsole[e]=(null===(t=self.console)||void 0===t?void 0:t[e])||noop}))}function enableConsoleOutput(e){patchConsole(e);try{PatchedConsole.log()}catch(e){PatchedConsole=dummyConsole}}function logtool(e){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}}!function(e){e[e.console=1]="console",e[e.cache=2]="cache"}(LogMode||(LogMode={}));var Logger=function(){function e(t,o,r){if(this.playerId=t,this.scopeName=o,!this.playerId)throw new Error("Missing logger id");e.cache[t]||(e.cache[t]=[]),this.logModeConfig=__assign$9({trace:LogMode.console,debug:LogMode.console,info:LogMode.console,log:LogMode.cache|LogMode.console,warn:LogMode.cache|LogMode.console,error:LogMode.cache|LogMode.console},r)}return e.prototype.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["trace"],e,!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["debug"],e,!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["info"],e,!1))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["log"],e,!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["warn"],e,!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callApi.apply(this,__spreadArray$3(["error"],e,!1))},e.prototype.callApi=function(t){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];var i=this,n=i.playerId,a=i.scopeName,s="[".concat(n.slice(-8),"][").concat(getLogTime(),"]").concat(a?"[".concat(a,"]"):"");if(this.logModeConfig[t]&LogMode.cache){var l="[".concat(t,"]").concat(s," ").concat(o.join(","));l.length>=LogCacheLimit&&(PatchedConsole.warn("Logger cache limit exceeded: ".concat(l.length)),l="".concat(l.slice(0,LogCacheLimit),"...")),e.cache[n].push(l)}this.logModeConfig[t]&LogMode.console&&PatchedConsole[t].apply(PatchedConsole,__spreadArray$3([s],o,!1))},e.level=0,e.cache={},e}(),logMethodCallDecoratorCreator=function(e){void 0===e&&(e="");return function(t,o,r){var i=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this._logger||this.logger;return"function"==typeof(null==n?void 0:n.log)&&n.log("@".concat(e,".").concat(o,"()"),jsonTool.safelyStringify(t)),i.apply(this,t)}}};function dumpLog(e){var t=document.createElement("a"),o=e.join("\n\n");t.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(o))),t.setAttribute("download","tp-log-".concat(Date.now(),".txt")),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function getLogTime(){var e=new Date;return"".concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())+".".concat("0000".concat(e.getMilliseconds()).slice(-3))}var cookieTool={set:function(e,t,o,r,i){var n={domain:o,path:r};return i&&(n.expires=(new Date).getTime()+3600*i*1e3),n$1.setCookie(e,t,n),!0},get:function(e){return n$1.getCookie(e)||""},del:n$1.clearCookie},lsTool={getData:function(e){var t="";try{window.localStorage&&(t=window.localStorage[e])}catch(e){window.console.log(e)}return t},setData:function(e,t){if("undefined"!==e&&void 0!==e)try{window.localStorage&&(window.localStorage[e]=t)}catch(e){window.console.log(e)}},delData:function(e){try{window.localStorage&&window.localStorage.removeItem(e)}catch(e){window.console.log(e)}}},urlTool={object2string:function(e,t){return void 0===t&&(t="&"),this.convertUrlParam(e,t,!1)},convertUrlParam:function(e,t,o){if(void 0===t&&(t="&"),void 0===o&&(o=!0),!e)return"";var r=Object.keys(e);if(r.length<=0)return"";var i=[];return r.forEach((function(t){var r="";r=o?"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t])):"".concat(t,"=").concat(e[t]),i.push(r)})),i.join(t)},getRootDomain:function(){var e=window.location.hostname||window.location.host,t=window.location.host.split(".");return t.length>1&&(e=t.slice(t.length-2).join(".")),e},getTopFrameUrl:function(){var e="";if(window.top!==window)try{e=window.top.location.href}catch(t){e=document.referrer}else e=window.location.href;return e},getDomainOfURL:function(e){if(null==e||""===e)return"";try{return new URL(e).hostname}catch(e){return""}},getUrlParamByKey:function(e,t){return m$2(e||location.href).query[t]||""},getUrlParams:function(e){return m$2(e||location.href).query},updateUrlParam:function(e,t,o){var r=e,i=this.getUrlParamByKey(r,t),n="".concat(t,"=").concat(o);return r=i?r.replace("".concat(t,"=").concat(i),n):r+(-1!==r.indexOf("?")?"&":"?")+n},getFileName:function(e){if(!e)return null;var t=e,o=t.indexOf("?");o>0&&(t=t.slice(0,o));var r=t.lastIndexOf("/");r>0&&(t=t.slice(r+1,t.length));var i=t.lastIndexOf("#");return i>0&&(t=t.slice(0,i)),t},getFileExtension:function(e){if(!e)return null;if(this.isWebRTCLink(e))return"webrtc";var t=urlTool.getFileName(e);if(t){var o=t.split(".");if(o&&o.length>1)return o[o.length-1]}return null},isWebRTCLink:function(e){return/^webrtc:\/\//.test(e)}},__extends$c=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),SimpleDefer=function(){var e=this;this.state="pending",this.promise=new Promise((function(t,o){e.resolve=function(o){e.state="fulfilled",t(o)},e.reject=function(t){e.state="rejected",o(t)}}))},TimeoutDefer=function(e){function t(t){var o=e.call(this)||this;return t.timeoutMS>0&&setTimeout((function(){return o.reject()}),t.timeoutMS),o}return __extends$c(t,e),t}(SimpleDefer),__assign$8=window&&window.__assign||function(){return __assign$8=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$8.apply(this,arguments)},domTool={insertStyle:x$1,loadScript:function(e,t,o,r){var i=new TimeoutDefer({timeoutMS:o});return b(__assign$8(__assign$8({},r),{src:e}),t).then(i.resolve).catch(i.reject),i.promise},attr:M,removeAttr:function(e,t){e&&t&&("src"===t?delete e.src:e.removeAttribute(t))},css:k,append:function(e,t){e&&e.appendChild(t)},prepend:function(e,t){e.children[0]?e.insertBefore(t,e.children[0]):e.appendChild(t)},addClass:_,removeClass:E,hasClass:q,hide:O,show:j,text:C,html:A,creatDom:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild},getDomSize:function(e){if(!e)return{width:0,height:0};var t=e.currentStyle?e.currentStyle:window.getComputedStyle(e,null);return{width:parseFloat(t.width),height:parseFloat(t.height)}},createVideoDom:function(e){var t,o;void 0===e&&(e={});var r={playsinline:{playsinline:"isiPhoneShowPlaysinline","webkit-playsinline":"isiPhoneShowPlaysinline"},airplay:{airplay:"allow","x-webkit-airplay":"allow"},crossorigin:{crossOrigin:"anonymous"},"h5-page":{"x5-video-player-type":"h5-page"}},i=__assign$8({playsinline:!0,"h5-page":!0},e),n=Object.keys(i).reduce((function(e,t){return r[t]&&"boolean"==typeof i[t]?e=__assign$8(__assign$8({},e),i[t]?r[t]:{}):e[t]=i[t],e}),{}),a=document.createElement("video");return Object.keys(n).forEach((function(e){a.setAttribute(e,n[e])})),k(a,{position:"absolute",width:null!==(t=null==e?void 0:e.width)&&void 0!==t?t:"100%",height:null!==(o=null==e?void 0:e.height)&&void 0!==o?o:"100%",top:0,left:0}),a},getElementFromConfig:function(e){return"string"==typeof e?document.querySelector(e):e}},e=function(){return(e=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o$1;function v(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function g(e,t){var o=[null,void 0,"",NaN].includes(e);if(t.isSkipEmpty&&o)return null;var r=!t.isSkipEmpty&&o?"":e;try{return t.encode?encodeURIComponent(r):r}catch(e){return null}}function h$1(e){var t=e.split("#"),o=t[0],r=t[1],i=void 0===r?"":r,n=o.split("?"),a=n[0],s=n[1],l=void 0===s?"":s,c=v(i),p=Object.create(null);return l.split("&").forEach((function(e){var t=e.split("="),o=t[0],r=t[1],i=void 0===r?"":r,n=v(o),a=v(i);null===n||null===a||""===n&&""===a||p[n]||(p[n]=a)})),{url:a,query:p,hash:c}}function m$1(t,o){void 0===o&&(o={encode:!0,isSkipEmpty:!1});var r=t.url,i=t.query,n=void 0===i?{}:i,a=t.hash,s=r.split("#"),l=s[0],c=s[1],p=void 0===c?"":c,d=l.split("?")[0],u=[],A=g(a||p,o),_=e(e({},h$1(r).query),n);return Object.keys(_).forEach((function(e){var t=g(e,o),r=g(_[e],o);null!==t&&null!==r&&u.push(t+"="+r)})),d+(u.length?"?"+u.join("&"):"")+(A?"#"+A:"")}function x(t,o){return new Promise((function(r,i){if(o&&document.querySelectorAll("script[data-tag="+o+"]").length)return r();var n=document.createElement("script"),a=e({type:"text/javascript",charset:"utf-8"},t);Object.keys(a).forEach((function(e){return S(n,e,a[e])})),o&&(n.dataset.tag=o),n.onload=function(){return r()},n.onreadystatechange=function(){var e=n.readyState;["complete","loaded"].includes(e)&&(n.onreadystatechange=null,r())},n.onerror=i,document.body.appendChild(n)}))}function S(e,t,o){if(e)return void 0===o?e.getAttribute(t):e.setAttribute(t,o)}!function(e){e[e.equal=0]="equal",e[e.low=-1]="low",e[e.high=1]="high"}(o$1||(o$1={}));var r=function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function n(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function o(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}var i=function(){function e(){this.interceptors=[]}return e.prototype.use=function(e,t){return this.interceptors.push({resolved:e,rejected:t}),this.interceptors.length-1},e.prototype.traverse=function(e,t){void 0===t&&(t=!1);var o=Promise.resolve(e);return(t?Array.prototype.reduceRight:Array.prototype.reduce).call(this.interceptors,(function(e,t){if(t){var r=t.resolved,i=t.rejected;o=o.then(r,i)}return e}),""),o},e.prototype.eject=function(e){this.interceptors[e]&&(this.interceptors[e]=null)},e}(),c={defaults:{timeout:0,method:"GET",mode:"cors",redirect:"follow",credentials:"same-origin"},headers:{common:{Accept:"application/json, text/plain, */*"},POST:{"Content-Type":"application/x-www-form-urlencoded"},PUT:{"Content-Type":"application/x-www-form-urlencoded"},PATCH:{"Content-Type":"application/x-www-form-urlencoded"}},baseURL:"",polyfillUrl:"https://vm.gtimg.cn/comps/script/fetch.min.js",interceptors:{request:new i,response:new i}},a=/^([a-z][a-z\d+\-.]*:)?\/\//i,u=Object.prototype.toString;function s(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(o){switch(o.label){case 0:if(window.fetch)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,x({src:e})];case 2:return o.sent(),[3,4];case 3:throw t=o.sent(),function(e){if("undefined"!=typeof Image){var t=new Image(1,1),o=r({attaid:"0f400053130",token:"6552374442",comps:"@tencent/ovb-request",version:"1.1.19",ua:navigator.userAgent,url:location.href,_dc:Math.random()},e),i=Object.keys(o).map((function(e){return e+"="+encodeURIComponent(o[e])})).join("&");t.src="https://h.trace.qq.com/kv?"+i}}({func:"loadPolyfill",result:0,params:e,error_msg:t.message}),new Error("加载 polyfill "+e+" 失败: "+t.message);case 4:return[2]}}))}))}function l(e){return["Accept","Content-Type"].forEach((function(t){return o=t,void((r=e.headers)&&Object.keys(r).forEach((function(e){e!==o&&e.toUpperCase()===o.toUpperCase()&&(r[o]=r[e],delete r[e])})));var o,r})),function(e){if("[object Object]"!==u.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}(e.body)&&(e.body=JSON.stringify(e.body),e.headers&&(e.headers["Content-Type"]="application/json;charset=utf-8")),e}var f=function(){},d=1;function h(e,t){return void 0===t&&(t={}),new Promise((function(o,i){var n,a=t.name,s=t.query,l=void 0===s?{}:s,c=t.param,p=void 0===c?"callback":c,u=t.timeout,A=void 0===u?6e4:u,_=t.prefix,E=void 0===_?"jsonp_":_,g=t.controller,h=t.charset,v=a||""+E+d++,m=document.createElement("script"),y=A?setTimeout((function(){T(!0),i(new Error("jsonp timeout"))}),A):null,T=function(e){var t;void 0===e&&(e=!1),null===(t=m.parentNode)||void 0===t||t.removeChild(m),y&&clearTimeout(y),g&&(g.element=null),window[v]=e?f:null},C=m$1({url:e,query:r(r({},l),(n={},n[p]=v,n))});m.src=C,h&&(m.charset=h),g&&(g.element=m),m.onerror=function(e){T(),i(e)},window[v]=function(e){T(),o(e)},document.body.append(m)}))}function m(e){return n(this,void 0,void 0,(function(){var t,i,n,p,d,u,A,_,E,g,f,h,v,m,y,T,C;return o(this,(function(o){switch(o.label){case 0:return t=c.baseURL,i=c.defaults,n=c.interceptors,[4,s(c.polyfillUrl)];case 1:return o.sent(),(p=r(r({},i),e)).headers||(p.headers=function(e){void 0===e&&(e="GET");var t=c.headers[e]||{};return r(r({},c.headers.common),t)}(p.method)),l(p),[4,n.request.traverse(p,!0)];case 2:if((d=o.sent())instanceof Error)throw d;return d.url=function(e,t){return!e||a.test(t)?t:e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}(t,d.url),u=d.url,A=d.timeout,_=d.params,E=d.method,g=["GET","DELETE","OPTIONS","HEAD"].includes(void 0===E?"GET":E)&&!!_,f=g?m$1({url:u,query:_}):u,h=[],A&&!d.signal&&(y=new Promise((function(e){v=setTimeout((function(){e(new Error("timeout"))}),A)})),h.push(y),m=new AbortController,d.signal=m.signal),h.push(fetch(f,d).catch((function(e){return e}))),[4,Promise.race(h)];case 3:return T=o.sent(),v&&clearTimeout(v),[4,n.response.traverse(T)];case 4:if((C=o.sent())instanceof Error)throw null==m||m.abort(),C;return[2,C]}}))}))}var netTool={jsonp:h,img:function(e){return new window.Promise((function(t,o){(new Image).src=e,t()}))},fetch:function(e,t){return void 0===t&&(t={}),m({url:e,method:t.method,body:t.body}).then((function(e){return e.json()}))},xhr:function(e){var t=e.retryCount||0,o=+new Date,r=0,i=function(n,a){var s=function(e){void 0===e&&(e="xhrNetworkError"),r<t?(r++,i(n,a)):a({error:e,target:l})},l=new XMLHttpRequest;l.open(e.method||"get",e.url),e.timeout&&(l.timeout=e.timeout),e.responseType&&(l.responseType=e.responseType),l.withCredentials=!!e.withCredentials,l.ontimeout=e.ontimeout,e.range&&l.setRequestHeader("Range","bytes=".concat(e.range[0],"-").concat(e.range[1])),e.headers&&Object.keys(e.headers).forEach((function(t){l.setRequestHeader(t,e.headers[t])})),l.onload=function(){200!==l.status&&206!==l.status?s("xhrStatusCodeError"):n({data:l.response,target:l,startTimestamp:o})},l.onerror=function(e){s()},l.onabort=function(){},l.ontimeout=function(){s("xhrTimeoutError")},e.body?l.send(e.body):l.send()};return new Promise((function(e,t){i(e,t)}))}},__awaiter$6=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$6=window&&window.__generator||function(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},testVideoElement=document.createElement("video"),videoTool={getBuffered:function(e){for(var t=[],o=e.buffered.length,r=0;r<o;r++)t.push({start:e.buffered.start(r),end:e.buffered.end(r)});return t},checkTimeInBuffer:function(e,t){for(var o=!1,r=t.length,i=0;i<r;i++){var n=t[i].start,a=t[i].end;if(e>=n&&e<=a){o=!0;break}}return o},clear:function(e){e&&(e instanceof HTMLVideoElement?(e.removeAttribute("src"),e.srcObject=null):(e.srcConfig=null,e.src=null),e.load())},destroyElement:function(e){var t;e&&(null===(t=e.destroy)||void 0===t||t.call(e),videoTool.clear(e),videoTool.removeElement(e,null))},captureVideo:function(e,t){var o=t.dx,r=t.dy,i=t.dw,n=t.dh,a=e.videoWidth,s=e.videoHeight,l=document.createElement("canvas");l.width=a,l.height=s;var c=l.getContext("2d");return c.drawImage(e,0,0,a,s),{captureHeight:n,captureWidth:i,captureX:o,captureY:r,playtime:e.currentTime,data:c.getImageData(o,r,i,n)}},resizeElement:function(e,t){var o;if(t&&e)if(e instanceof HTMLElement)domTool.css(e,t);else{var r=t.width,i=t.height;"number"==typeof r&&"number"==typeof i&&(null===(o=e.resize)||void 0===o||o.call(e,r,i))}},appendElement:function(e,t){var o;e instanceof HTMLElement?domTool.append(t,e):null===(o=e.appendToParent)||void 0===o||o.call(e,t)},removeElement:function(e,t){var o;e instanceof HTMLElement?(null==e?void 0:e.parentNode)&&e.remove():null===(o=e.removeFromParent)||void 0===o||o.call(e,t)},setElementFitType:function(e,t){e&&e instanceof HTMLElement&&domTool.css(e,{"object-fit":t})},getDefaultMaxBufferTime:function(){var e=navigator.connection;return e&&"wifi"===e.type?180:e&&"4g"===e.type?120:180},isAutoPlayBlockedMessage:function(e){return e&&/interact|not allowed|user gesture/.test(e)},supportSameTimePlay:function(){return(!uaTool.browser.x5||-1===["45031","45032"].indexOf("".concat(uaTool.browser.x5.version)))&&(!(uaTool.browser.mqqbrowser&&!(uaTool.browser.qqlive||uaTool.browser.wechat||uaTool.browser.mqq))&&!(uaTool.os.ios&&uaTool.os.version&&comTool.compareVersion(uaTool.os.version,"11.0")<0))},cannotDetectAutoPlayBlock:function(){return uaTool.browser.chrome&&comTool.compareVersion(uaTool.browser.chrome.version,"66.0")<0},supportMediaFragmentsURISpec:function(e){return void 0!==e?!!e:-1===window.navigator.userAgent.indexOf("jsdom")&&(!uaTool.mobile||!!uaTool.os.ios)},getVideoPlaybackQuality:function(e){var t=0,o=0;if(null==e?void 0:e.getVideoPlaybackQuality){var r=e.getVideoPlaybackQuality();o=r.droppedVideoFrames||0,t=r.totalVideoFrames||0}else e&&e.webkitDecodedFrameCount&&(t=e.webkitDecodedFrameCount,o=e.webkitDroppedFrameCount);return{totalVideoFrames:t,droppedVideoFrames:o}},supportMSE:function(){var e=videoTool.getMediaSource();if(!e)return!1;var t=window.SourceBuffer||window.WebKitSourceBuffer,o=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!o&&!!r},supportVideoFormat:function(){var e={mp4:"video/mp4",mov:"video/mp4",hls:"application/x-mpegURL",avi:"video/x-msvideo",mpeg:"video/mpeg",webm:"video/webm",ogg:"video/ogg"},t=[];return Object.keys(e).forEach((function(o){var r=e[o],i=testVideoElement.canPlayType(r);-1!==["maybe","probably"].indexOf(i)&&t.push(o)})),t},supportAV1:function(){return videoTool.isMediaSourceTypeSupported("video/mp4;codecs=av01.0.12M.08")},supportHevc:function(){return videoTool.isMediaSourceTypeSupported("video/mp4;codecs=hev1.1.6.L120.90")},isVideoCanPlayType:function(e){return testVideoElement.canPlayType(e)},isMediaSourceTypeSupported:function(e){var t;try{return null===(t=videoTool.getMediaSource())||void 0===t?void 0:t.isTypeSupported(e)}catch(e){return!1}},isMediaCapabilitiesTypeSupported:function(e){return __awaiter$6(this,void 0,void 0,(function(){var t,o,r,i,n,a,s,l,c,p,d,u;return __generator$6(this,(function(A){switch(A.label){case 0:t=e.type,o=e.mimeType,r=e.resolution,i=void 0===r?"860x480":r,n=e.bitrate,a=void 0===n?800:n,s=e.framerate,l=void 0===s?30:s,A.label=1;case 1:switch(A.trys.push([1,3,,4]),c={type:"media-source"},t){case"audio":c.audio={contentType:o};break;case"audio-spatial":c.audio={contentType:o,spatialRendering:!0};break;case"video":p=i.toLowerCase().split("x"),d=p[0],u=p[1],c.video={contentType:o,bitrate:a,framerate:l,height:+d,width:+u}}return[4,navigator.mediaCapabilities.decodingInfo(c)];case 2:return[2,A.sent().supported];case 3:return A.sent(),[2,!1];case 4:return[2]}}))}))},isHDRSupported:function(){try{return window.matchMedia("(dynamic-range: high)").matches?HDR_CAPABILITY.SUPPORTED:window.matchMedia("(color-gamut: p3)").matches?HDR_CAPABILITY.WCG_DISPLAY_BUT_NO_HDR:HDR_CAPABILITY.NOT_SUPPORTED}catch(e){return HDR_CAPABILITY.NOT_SUPPORTED}},isDolbyVisionSupported:function(){return videoTool.isMediaSourceTypeSupported('video/mp4; codecs="dvhe"')},isDolbyAtomsSupported:function(e){return videoTool.isMediaSourceTypeSupported('audio/mp4; codecs="ec-3"')},getMediaSource:function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource},supportWidevine:function(){return __awaiter$6(this,void 0,void 0,(function(){var e,t;return __generator$6(this,(function(o){switch(o.label){case 0:if(e=[window.MediaKeys,window.WebKitMediaKeys].some((function(e){return e})),!e)return[2,!1];if(!(void 0!==window.navigator.requestMediaKeySystemAccess))return[2,!1];t=[{initDataTypes:["cenc"],audioCapabilities:[{robustness:"SW_SECURE_CRYPTO",contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{robustness:"SW_SECURE_CRYPTO",contentType:'video/mp4;codecs="avc1.42E01E"'}]}],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,window.navigator.requestMediaKeySystemAccess("com.widevine.alpha",t)];case 2:return o.sent(),[2,!0];case 3:return o.sent(),[2,!1];case 4:return[2]}}))}))},supportFairplay:function(){var e,t=KeySystems.FairPlayWebKit;return null===(e=window.WebKitMediaKeys)||void 0===e?void 0:e.isTypeSupported(t,"video/mp4")},supportWebGL:function(){var e,t=document.createElement("canvas");try{e=t.getContext("webgl")}catch(e){return!1}return!!e}},stringTool={arrayToString:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},base64ToUint8Array:function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),o=window.atob(t),r=new Uint8Array(o.length),i=0;i<o.length;++i)r[i]=o.charCodeAt(i);return r},arrayBufferToBase64:function(e){for(var t="",o=new Uint8Array(e),r=o.byteLength,i=0;i<r;i++)t+=String.fromCharCode(o[i]);return window.btoa(t)},stringToArray:function(e){for(var t=e.length,o=new ArrayBuffer(2*t),r=new Uint16Array(o),i=0;i<t;i++)r[i]=e.charCodeAt(i);return r}},_a$7,LoopMode;!function(e){e[e.Timer=0]="Timer",e[e.RAF=1]="RAF"}(LoopMode||(LoopMode={}));var LoopRunnerPair=(_a$7={},_a$7[LoopMode.RAF]=[window.requestAnimationFrame.bind(window),window.cancelAnimationFrame.bind(window)],_a$7[LoopMode.Timer]=[window.setTimeout.bind(window),window.clearTimeout.bind(window)],_a$7),TaskLoop=function(){function e(e,t){this.running=!1,this.callback=e,t===LoopMode.RAF&&LoopRunnerPair[t][0]?this.mode=LoopMode.RAF:this.mode=LoopMode.Timer,this.runner=LoopRunnerPair[this.mode][0]}return e.prototype.start=function(e){var t=this;if(void 0===e&&(e=0),!this.running){this.running=!0;var o=function(){var r;t.running&&(null===(r=t.callback)||void 0===r||r.call(t),t.loopId=t.runner(o,e))};this.loopId=this.runner(o,e)}},e.prototype.stop=function(){this.running&&(this.running=!1,this.loopId&&LoopRunnerPair[this.mode][1](this.loopId),this.loopId=null)},e.prototype.destroy=function(){this.stop(),this.callback=null,this.loopId=null},e}(),DRM_ERR_CODE;function transformInitData(e,t,o){var r=stringTool.stringToArray(t),i=e.byteLength+4+r.byteLength+4+o.byteLength,n=0,a=new ArrayBuffer(i),s=new DataView(a),l=new Uint8Array(a,n,e.byteLength);l.set(e),n+=l.byteLength,s.setUint32(n,r.byteLength,!0),n+=4;var c=new Uint16Array(a,n,r.length);return c.set(r),n+=c.byteLength,s.setUint32(n,o.byteLength,!0),n+=4,new Uint8Array(a,n,o.byteLength).set(o),new Uint8Array(a,0,a.byteLength)}function getContentId(e){var t,o,r;return null===(r=null===(o=null===(t=stringTool.arrayToString(e).split("skd://"))||void 0===t?void 0:t[1])||void 0===o?void 0:o.split("?"))||void 0===r?void 0:r[0]}!function(e){e.UNKNOWN="70090000",e.KEY_SYS_ACCESS_FAILED="70090001",e.KEY_SESSION_CREATION_FAILED="70090002",e.KEY_SYS_NOT_SUPPORTED="70090003",e.KEY_SYS_NOT_REQUESTED="70090004",e.KEY_SESSION_NOT_EXIST="70090005",e.KEY_NOT_EXIST="70090006",e.INIT_DATA_EMPTY="70090007",e.FPS_SET_KEY_FAILED="70090008",e.FPS_CERTIFICATE_NOT_EXIST="7009009",e.HDCP_ERROR="70090010",e.LICENSE_REQUEST_FAILED="70090011",e.LICENSE_NOT_EXIST="70090012",e.KEY_SESSION_REQUEST_FAILED="70090013",e.KEY_SESSION_UPDATE_FAILED="70090014",e.KEY_EXPIRED="70090015",e.KEY_RELEASED="70090016",e.KEY_INTERNAL_ERROR="70090017"}(DRM_ERR_CODE||(DRM_ERR_CODE={}));var __extends$b=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$7=window&&window.__assign||function(){return __assign$7=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$7.apply(this,arguments)},__awaiter$5=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$5=window&&window.__generator||function(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},KeySystems;function getSupportedKeySystemConfig(e){switch(e){case KeySystems.FairPlayWebKit:return null;case KeySystems.Widevine:return{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"',robustness:"SW_SECURE_CRYPTO"}]};case KeySystems.FairPlay:return{initDataTypes:["skd"],videoCapabilities:[{contentType:"application/vnd.apple.mpegurl",robustness:""}]};default:return null}}!function(e){e.FairPlayWebKit="com.apple.fps.1_0",e.Widevine="com.widevine.alpha",e.FairPlay="com.apple.fps"}(KeySystems||(KeySystems={}));var ERR="error",DRM=function(e){function t(o,r,i){var n=e.call(this)||this;return n.started=!1,n.mediaKeyDescriptor=null,n.mediaKeyPromise=null,n.onVideoEncrypted=function(e){n.mediaKeyPromise?n.mediaKeyPromise.then((function(t){n.mediaKeyDescriptor?n.mediaKeyDescriptor.hasInitialized?n.logger.warn("Media key-session has been initialized but requested again"):n.mediaKeyDescriptor.mediaKeys?(n.media.setMediaKeys(n.mediaKeyDescriptor.mediaKeys),n.mediaKeyDescriptor.mediaKeySession?e.initData?(n.mediaKeyDescriptor.mediaKeySession.generateRequest(e.initDataType,e.initData).catch((function(e){n.emit(ERR,{code:DRM_ERR_CODE.KEY_SESSION_REQUEST_FAILED,message:"视频资源已加密，但CDM Session请求失败"})})),n.mediaKeyDescriptor.initData=e.initData,n.mediaKeyDescriptor.hasInitialized=!0):n.emit(ERR,{code:DRM_ERR_CODE.INIT_DATA_EMPTY,message:"视频资源已加密，但事件信息中没有用于创建请求的initData"}):n.emit(ERR,{code:DRM_ERR_CODE.KEY_SESSION_NOT_EXIST,message:"视频资源已加密，但CDM Session未创建"})):n.emit(ERR,{code:DRM_ERR_CODE.KEY_NOT_EXIST,message:"视频资源已加密，但尚未获取到MediaKey"}):n.emit(ERR,{code:DRM_ERR_CODE.KEY_NOT_EXIST,message:"视频资源已加密，但尚未获取到MediaKey"})})):n.emit(ERR,{code:DRM_ERR_CODE.KEY_SYS_NOT_REQUESTED,message:"视频资源已加密，但尚未请求CDM"})},n.onVideoWebkitneedkey=function(e){var o=n.config.fpsCustomContentId(e.initData),r=t.serverCertificate[KeySystems.FairPlayWebKit];if(r){var i=n.config.fpsCustomTransformInitData(e.initData,o,r);n.mediaKeyDescriptor.initData=i,n.mediaKeyDescriptor.mediaKeySession?n.logger.warn("Media key-session has already been initialized"):(n.mediaKeyDescriptor.mediaKeySession=n.createSessionWithMediaKey(n.mediaKeyDescriptor.mediaKeys,i),n.mediaKeyDescriptor.assetID=o,n.mediaKeyDescriptor.mediaKeySession.onwebkitkeyadded=n.onFPSKeySessionKeyAdded,n.mediaKeyDescriptor.mediaKeySession.onwebkitkeyerror=n.onFPSKeySessionKeyError,n.mediaKeyDescriptor.mediaKeySession.onwebkitkeymessage=function(e){n.onMediaKeySessionMessage(n.mediaKeyDescriptor.mediaKeySession,e)})}else n.emit(ERR,{code:DRM_ERR_CODE.FPS_CERTIFICATE_NOT_EXIST,message:"视频资源已加密，但 Fairplay 服务端证书未配置"})},n.onFPSKeySessionKeyAdded=function(e){},n.onFPSKeySessionKeyError=function(e){var t=n.mediaKeyDescriptor.mediaKeySession.error;if(t.systemCode){var o={1212433232:[DRM_ERR_CODE.HDCP_ERROR,"你可能链接了不支持HDCP标准的显示器"]};o[t.systemCode]&&n.emit(ERR,{code:o[t.systemCode][0],message:o[t.systemCode][1]})}else n.emit(ERR,{code:DRM_ERR_CODE.UNKNOWN,message:"未知错误"})},n.media=o,n.logger=i,n.config=__assign$7({keySystem:null,fpsCustomContentId:getContentId,fpsCustomTransformInitData:transformInitData},r),n}return __extends$b(t,e),Object.defineProperty(t.prototype,"isFairPlay",{get:function(){var e=this.config.keySystem;return e===KeySystems.FairPlay||e===KeySystems.FairPlayWebKit},enumerable:!1,configurable:!0}),t.isKeySystemSupported=function(e){var t,o,r;return null===(r=((t={})[KeySystems.FairPlayWebKit]=[null===(o=self.WebKitMediaKeys)||void 0===o?void 0:o.isTypeSupported(e,"video/mp4")],t[KeySystems.FairPlay]=[uaTool.browser.safari,self.MediaKeys,self.navigator.requestMediaKeySystemAccess],t[KeySystems.Widevine]=[self.MediaKeys,self.navigator.requestMediaKeySystemAccess],t)[e])||void 0===r?void 0:r.every(Boolean)},t.prototype.destroy=function(){this.removeAllListeners(),this.logger=null},t.prototype.configure=function(e){var o=this;this.config=__assign$7(__assign$7({},this.config),e),this.config.certificate&&Object.keys(this.config.certificate).forEach((function(e){t.serverCertificate[e]=o.config.certificate[e]}))},t.prototype.hasStarted=function(){return this.started},t.prototype.init=function(e){return __awaiter$5(this,void 0,void 0,(function(){return __generator$5(this,(function(o){switch(o.label){case 0:return[4,this.reset()];case 1:return o.sent(),e&&this.configure(e),"string"!=typeof t.serverCertificate[this.config.keySystem]?[3,3]:[4,this.requestServerCertificate(this.config.keySystem,t.serverCertificate[this.config.keySystem])];case 2:o.sent(),o.label=3;case 3:return this.bind(),[2]}}))}))},t.prototype.reset=function(){return __awaiter$5(this,void 0,void 0,(function(){var e,t,o;return __generator$5(this,(function(r){switch(r.label){case 0:if(this.started=!1,!this.config.keySystem||!this.mediaKeyDescriptor)return[2];if((o={})[KeySystems.FairPlayWebKit]=this.cleanupFPSSession,o[KeySystems.FairPlay]=this.cleanupMediaKeySession,o[KeySystems.Widevine]=this.cleanupMediaKeySession,e=o,this.videoEncryptedEventPicker(!1),!e[this.config.keySystem])return[3,4];t=this.mediaKeyDescriptor.mediaKeySession,this.mediaKeyPromise=null,this.mediaKeyDescriptor=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e[this.config.keySystem].call(this,t)];case 2:case 3:return r.sent(),[3,4];case 4:return[2]}}))}))},t.prototype.bind=function(){var e=this.config.keySystem;e&&(t.isKeySystemSupported(e)?(this.started=!0,this.mediaKeyPromise=this.createKeySystemAccess(e),this.videoEncryptedEventPicker(!0)):this.logger.warn("当前环境不支持 ".concat(e)))},t.prototype.cleanupMediaKeySession=function(e){return this.media&&e?(e.onmessage=null,e.onkeystatuseschange=null,e.close().catch((function(){})),this.media.setMediaKeys(null)):Promise.resolve()},t.prototype.videoEncryptedEventPicker=function(e){var t;void 0===e&&(e=!0);var o=((t={})[KeySystems.FairPlayWebKit]=["webkitneedkey",this.onVideoWebkitneedkey],t[KeySystems.Widevine]=["encrypted",this.onVideoEncrypted],t[KeySystems.FairPlay]=["encrypted",this.onVideoEncrypted],t)[this.config.keySystem],r=o[0],i=o[1];e?this.media.addEventListener(r,i):this.media.removeEventListener(r,i)},t.prototype.createSessionWithMediaKey=function(e,t){var o;return((o={})[KeySystems.FairPlayWebKit]=this.createFPSWebkitSession,o[KeySystems.Widevine]=this.createMediaKeySession,o[KeySystems.FairPlay]=this.createMediaKeySession,o)[this.config.keySystem].call(this,e,t)},t.prototype.createKeySystemAccess=function(e){var t;return((t={})[KeySystems.Widevine]=this.requestKeySystemAccess,t[KeySystems.FairPlay]=this.requestKeySystemAccess,t[KeySystems.FairPlayWebKit]=this.requestFPSMediaKeys,t)[this.config.keySystem].call(this,e)},t.prototype.requestLicense=function(e,t){var o;if(this.config.licenseUrl)return((o={})[KeySystems.FairPlayWebKit]=this.createFPSLicenseRequest,o[KeySystems.Widevine]=this.createWidevineLicenseRequest,o[KeySystems.FairPlay]=this.createFPSLicenseRequest,o)[this.config.keySystem].call(this,e,t);this.emit(ERR,{code:DRM_ERR_CODE.LICENSE_NOT_EXIST,message:"视频资源已加密，但未配置解密证书地址"})},t.prototype.requestServerCertificate=function(e,o){return __awaiter$5(this,void 0,void 0,(function(){var r;return __generator$5(this,(function(i){switch(i.label){case 0:return[4,netTool.xhr({method:"GET",responseType:"arraybuffer",url:o})];case 1:return r=i.sent().data,t.serverCertificate[e]=new Uint8Array(r),[2]}}))}))},t.prototype.requestKeySystemAccess=function(e){return __awaiter$5(this,void 0,void 0,(function(){var t,o;return __generator$5(this,(function(r){switch(r.label){case 0:if(!(t=getSupportedKeySystemConfig(e)))return this.emit(ERR,{code:DRM_ERR_CODE.KEY_SYS_NOT_SUPPORTED,message:"".concat(e," 不支持")}),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,self.navigator.requestMediaKeySystemAccess(e,[t])];case 2:return o=r.sent(),[2,this.onMediaKeySystemObtained(e,o)];case 3:return r.sent(),this.emit(ERR,{code:DRM_ERR_CODE.KEY_SYS_ACCESS_FAILED,message:"访问CDM失败, keySystem ".concat(e)}),[2];case 4:return[2]}}))}))},t.prototype.onMediaKeySystemObtained=function(e,o){return __awaiter$5(this,void 0,void 0,(function(){var r;return __generator$5(this,(function(i){switch(i.label){case 0:return[4,o.createMediaKeys()];case 1:r=i.sent(),this.mediaKeyDescriptor={hasInitialized:!1,mediaKeySession:null,mediaKeySystemAccess:o,mediaKeys:r},i.label=2;case 2:return i.trys.push([2,5,,6]),e!==KeySystems.FairPlay?[3,4]:[4,r.setServerCertificate(t.serverCertificate[KeySystems.FairPlay])];case 3:i.sent(),i.label=4;case 4:return this.createSessionWithMediaKey(r),[2,r];case 5:return i.sent(),this.emit(ERR,{code:DRM_ERR_CODE.KEY_SESSION_CREATION_FAILED,message:"CDM Session初始化失败"}),[2];case 6:return[2]}}))}))},t.prototype.createMediaKeySession=function(e){var t=this;if(this.mediaKeyDescriptor.mediaKeySession)this.logger.warn("Media key-session has already been initialized");else{var o={"output-restricted":[DRM_ERR_CODE.HDCP_ERROR,"你可能链接了不支持HDCP标准的显示器"],"output-downscaled":[DRM_ERR_CODE.HDCP_ERROR,"你可能链接了不支持HDCP标准的显示器"],"status-pending":null,"internal-error":[DRM_ERR_CODE.KEY_INTERNAL_ERROR,"内部错误"],usable:null,expired:[DRM_ERR_CODE.KEY_EXPIRED,"MediaKey已过期"],released:[DRM_ERR_CODE.KEY_RELEASED,"MediaKey已从CDM中注销"]};this.mediaKeyDescriptor.mediaKeySession=e.createSession(),this.mediaKeyDescriptor.mediaKeySession.onkeystatuseschange=function(e){var r,i,n;null===(n=null===(i=null===(r=e.target)||void 0===r?void 0:r.keyStatuses)||void 0===i?void 0:i.forEach)||void 0===n||n.call(i,(function(e,r){if(t.mediaKeyDescriptor&&o[e]){var i=o[e],n=i[0],a=i[1];t.emit(ERR,{code:n,message:a})}}))},this.mediaKeyDescriptor.mediaKeySession.onmessage=function(e){t.onMediaKeySessionMessage(t.mediaKeyDescriptor.mediaKeySession,e)}}},t.prototype.onMediaKeySessionMessage=function(e,t){var o=this;this.requestLicense(t,(function(t){var r=t.data;if(o.config.licenseResponseSetup&&(r=o.config.licenseResponseSetup(r)||r),r){var i=e.update(r);null==i||i.catch((function(e){o.emit(ERR,{code:DRM_ERR_CODE.KEY_SESSION_UPDATE_FAILED,message:"CDM Session更新失败，请检查证书解析"})}))}else o.emit(ERR,{code:DRM_ERR_CODE.KEY_SESSION_UPDATE_FAILED,message:"CDM Session更新失败，请检查证书解析"})}))},t.prototype.createWidevineLicenseRequest=function(e,t){var o=this,r={method:"POST",responseType:"arraybuffer",body:e.message,url:this.config.licenseUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.config.licenseRequestSetup&&(r=this.config.licenseRequestSetup(r)),netTool.xhr(r).then((function(e){t(e)})).catch((function(e){var t=e||{},r=t.code,i=t.message,n="".concat(DRM_ERR_CODE.LICENSE_REQUEST_FAILED,".").concat(null!=r?r:"0");o.emit(ERR,{code:n,message:"证书请求失败 [code: ".concat(r,"] ").concat(i)})}))},t.prototype.createFPSLicenseRequest=function(e,t){var o=this,r=e.message,i=encodeURIComponent(stringTool.arrayBufferToBase64(r)),n={method:"POST",responseType:"arraybuffer",body:"spc=".concat(i,"&assetId=").concat(this.mediaKeyDescriptor.assetID),url:this.config.licenseUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.config.licenseRequestSetup&&(n=this.config.licenseRequestSetup(n)),netTool.xhr(n).then((function(e){t(e)})).catch((function(e){o.logger.warn("license request error",e),o.emit(ERR,{code:DRM_ERR_CODE.LICENSE_REQUEST_FAILED,message:"证书请求失败"})}))},t.prototype.requestFPSMediaKeys=function(){var e=new window.WebKitMediaKeys(KeySystems.FairPlayWebKit);return this.media.webkitSetMediaKeys(e),this.mediaKeyDescriptor={mediaKeySession:null,initData:null,hasInitialized:!1,mediaKeySystemAccess:null,mediaKeys:this.media.webkitKeys},Promise.resolve(e)},t.prototype.createFPSWebkitSession=function(e,t){if(e){var o=e.createSession("video/mp4",t);if(o)return o;this.emit(ERR,{code:DRM_ERR_CODE.KEY_SESSION_CREATION_FAILED,message:"Webkit CDM Session创建失败"})}else this.emit(ERR,{code:DRM_ERR_CODE.FPS_SET_KEY_FAILED,message:"Webkit MediaKey创建失败"})},t.prototype.cleanupFPSSession=function(e){return e?(this.media.webkitSetMediaKeys(null),e.onwebkitkeyadded=null,e.onwebkitkeyerror=null,e.onwebkitkeymessage=null,Promise.resolve()):Promise.resolve()},t.serverCertificate={},t}(s$1),defaultPlayerConfig={type:exports.PLAY_MODE.VOD,interruptPlayNextMinTime:1,backupUrlsMaxRetryCount:5,maxPreloadTimeout:3e4,maxBufferingTimeout:3e4,maxStateStalledTime:3e4,maxPlaytimeStalledTime:1e4,isPlayList:!1,preloadType:exports.PRELOAD_TYPE.AUTO_LOAD,maxVideoNodeCount:1,minFillBlackBorder:10},AutoPlayPolicy=function(){function e(e,t){this._logger=new Logger(t.instanceId,"AutoPlayPolicy"),this._videoElement=e}return e.prototype.userTrigger=function(){var e,t=this;this._triggerDefer=new SimpleDefer,this._logger.log("userTrigger(), start");var o=this._videoElement.play();if(this._videoElement.pause(),0===this._videoElement.readyState)o&&o.catch((function(o){e>0&&(clearTimeout(e),e=0),t._logger.log("userTrigger(), catch: ",o.name,o.message),videoTool.isAutoPlayBlockedMessage(o.message)?t._triggerDefer.reject(o):(t._logger.log("userTrigger() over, catched."),t._triggerDefer.resolve())})),e=window.setTimeout((function(){t._logger.log("userTrigger() over, timeout."),t._triggerDefer.resolve()}),300);else{this._logger.log("userTrigger() over, sync.");var r=uaTool.browser.safari&&!uaTool.mobile?400:0;window.setTimeout((function(){t._triggerDefer.resolve()}),r)}return this._triggerDefer.promise},e.prototype.destroy=function(){this._videoElement=null},e}(),__extends$a=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$6=window&&window.__assign||function(){return __assign$6=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$6.apply(this,arguments)},__decorate$8=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$8=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$4=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$4=window&&window.__generator||function(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},CHANNEL_MAP;!function(e){e[e.cdn=1]="cdn",e[e.npm=0]="npm"}(CHANNEL_MAP||(CHANNEL_MAP={}));var logMethodCall$9=logMethodCallDecoratorCreator("KernelProxy"),loadKernelDeferMap={},KernelProxy=function(e){function t(t){var o,r,i,n=this;return(n=e.call(this)||this)._volume=1,n._videoElements=[],n._addedEvts=[],void 0===t.instanceId&&(t.instanceId=comTool.createGUID()),n._logger=new Logger(t.instanceId,"KernelProxy"),n._config=__assign$6(__assign$6(__assign$6({},defaultPlayerConfig),t),{maxVideoNodeCount:null!==(i=null!==(o=t.maxVideoNodeCount)&&void 0!==o?o:null===(r=t.originKernelConfig)||void 0===r?void 0:r.maxVideoNodeCount)&&void 0!==i?i:defaultPlayerConfig.maxVideoNodeCount}),t.logLevel>PLAYER_LOG_LEVEL.NONE&&enableConsoleOutput(),n._config.videoElements||(n._config.videoElements=n.createVideoElements()),n.createVideoElementsContainer(),n._kernelEvtHandler=n.kernelEvtHandler.bind(n),n.collectUsage(n.prepareUsageData()),n}return __extends$a(t,e),Object.defineProperty(t.prototype,"isCollected",{get:function(){return t._isCollected},set:function(e){t._isCollected=e},enumerable:!1,configurable:!0}),t.prototype.prepareUsageData=function(){var e=CHANNEL_MAP[CHANNEL$1],t=urlTool.getTopFrameUrl(),o=null==t?void 0:t.split("?")[0],r=urlTool.getDomainOfURL(t);return{attaid:"05700050920",token:"3619167286",topUrl:"".concat(encodeURIComponent(t)),pageUrl:"".concat(encodeURIComponent(o)),domain:"".concat(encodeURIComponent(r)),channel:"".concat(e),from:"".concat(0),version:VERSION$3,_dc:"".concat(Math.random())}},t.prototype.collectUsage=function(e){if(!this.isCollected){this.isCollected=!0;var t=Object.keys(KernelFactory$1.kernelMap).join("$");(new Image).src="https://h.trace.qq.com/kv?".concat(urlTool.object2string(__assign$6(__assign$6({},e),{kernel:t}),"&"))}},Object.defineProperty(t.prototype,"config",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.config)||this._config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useWorker",{get:function(){var e;return!!(null===(e=this._kernel)||void 0===e?void 0:e.useWorker)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kernelName",{get:function(){var e;return null===(e=this._kernel)||void 0===e?void 0:e.kernelName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElements",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.videoElements)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoElement",{get:function(){var e;return null===(e=this._kernel)||void 0===e?void 0:e.currentVideoElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){var e;return!!(null===(e=this._kernel)||void 0===e?void 0:e.supportPreload)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.duration)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.playtime)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoInfos",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.videoInfos)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preloadVideoInfos",{get:function(){var e;return null===(e=this._kernel)||void 0===e?void 0:e.preloadVideoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){var e;return null===(e=this._kernel)||void 0===e?void 0:e.currentVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfoIdx",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.currentVideoInfoIdx)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalVideoInfoCount",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.totalVideoInfoCount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){var e;return!!(null===(e=this._kernel)||void 0===e?void 0:e.supportPlaybackRate)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"played",{get:function(){var e;return!!(null===(e=this._kernel)||void 0===e?void 0:e.played)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.state)||exports.VIDEO_STATE.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.videoSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.videoBuffered)||[]},enumerable:!1,configurable:!0}),t.prototype.captureVideo=function(e,t,o,r,i){var n;return null===(n=this._kernel)||void 0===n?void 0:n.captureVideo(e,t,o,r,i)},t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this._logger)||void 0===e||e.log.apply(e,t)},t.prototype.warn=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this._logger)||void 0===e||e.warn.apply(e,t)},t.prototype.error=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this._logger)||void 0===e||e.error.apply(e,t)},t.prototype.hasAppended=function(e){var t;return!!(null===(t=this._kernel)||void 0===t?void 0:t.hasAppended(e))},t.prototype.hasPreloaded=function(e){var t;return!!(null===(t=this._kernel)||void 0===t?void 0:t.hasPreloaded(e))},Object.defineProperty(t.prototype,"volume",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.volume)||this._volume},set:function(e){this._volume=e,this._kernel?this._kernel.volume=e:this.emit(exports.PLAY_EVENT.VOLUME_CHANGE,{volume:e})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){var e;return(null===(e=this._kernel)||void 0===e?void 0:e.playbackRate)||this._playbackRate},set:function(e){this._playbackRate=e,this._kernel?this._kernel.playbackRate=e:this.emit(exports.PLAY_EVENT.RATE_CHANGE,{playbackRate:e})},enumerable:!1,configurable:!0}),t.prototype.resizeVideoElements=function(e){var t;null===(t=this._kernel)||void 0===t||t.resizeVideoElements(e)},t.prototype.resize=function(e){var t;null===(t=this._kernel)||void 0===t||t.resize(e)},t.prototype.seek=function(e){var t;return null===(t=this._kernel)||void 0===t?void 0:t.seek(e)},t.prototype.play=function(e,t){var o;return __awaiter$4(this,void 0,void 0,(function(){var r;return __generator$4(this,(function(i){switch(i.label){case 0:return e?[4,this.checkWhetherNeedToSwitchKernel(e,t)]:[3,2];case 1:if(r=i.sent().error)return this.emit(exports.PLAY_EVENT.ERROR,{videoInfo:{error:r}}),[2,Promise.reject(r)];i.label=2;case 2:return[2,null===(o=this._kernel)||void 0===o?void 0:o.play(e,t)]}}))}))},t.prototype.load=function(e,t){var o;return __awaiter$4(this,void 0,void 0,(function(){var r;return __generator$4(this,(function(i){switch(i.label){case 0:return e?[4,this.checkWhetherNeedToSwitchKernel(e,t)]:[3,2];case 1:if(r=i.sent().error)return this.emit(exports.PLAY_EVENT.ERROR,{videoInfo:{error:r}}),[2,Promise.reject(r)];i.label=2;case 2:return[2,null===(o=this._kernel)||void 0===o?void 0:o.load(e,t)]}}))}))},t.prototype.playNext=function(e){var t;null===(t=this._kernel)||void 0===t||t.playNext(e)},t.prototype.pause=function(e){var t;null===(t=this._kernel)||void 0===t||t.pause(e)},t.prototype.stop=function(e){var t;null===(t=this._kernel)||void 0===t||t.stop(e)},t.prototype.appendNext=function(e){var t;return!!(null===(t=this._kernel)||void 0===t?void 0:t.appendNext(e))},t.prototype.preloadNext=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return null===(e=this._kernel)||void 0===e?void 0:e.preloadNext.apply(e,t)},t.prototype.clearAllPreload=function(){var e;null===(e=this._kernel)||void 0===e||e.clearAllPreload()},t.prototype.triggerAutoplay=function(){var e,t=this;if(!this._kernel){this._logger.log("triggerAutoplay(), start");var o=this._videoElements.map((function(e){return new AutoPlayPolicy(e,{instanceId:t._config.instanceId}).userTrigger()}));return Promise.all(o)}return null===(e=this._kernel)||void 0===e?void 0:e.triggerAutoplay()},t.prototype.setAudioTrack=function(e){return this._kernel?this._kernel.setAudioTrack(e):Promise.reject(new Error(AUDIO_TRACK_ERROR_MSG.KERNEL_NOT_EXISTS))},t.prototype.getAudioTrackList=function(){return this.currentVideoInfo?this.currentVideoInfo.audioTracks:[]},t.prototype.getCurrentAudioTrack=function(){return this.currentVideoInfo?this.currentVideoInfo.currentAudioTrack:NaN},t.prototype.setLevel=function(e,t,o){return __awaiter$4(this,void 0,void 0,(function(){var r,i,n,a,s;return __generator$4(this,(function(l){switch(l.label){case 0:return this._kernel?(r="string"==typeof e?__assign$6(__assign$6({},o),{url:e}):e,i=this.currentVideoInfo,[4,this.checkWhetherNeedToSwitchKernel(r,null,!0)]):[2,Promise.reject("切换清晰度时找不到内核")];case 1:return n=l.sent(),a=n.isKernelSwitched,(null==(s=n.error)?void 0:s.message)?[2,Promise.reject(null==s?void 0:s.message)]:a?[2,this.setLevelWhenKernelSwitched(__assign$6(__assign$6(__assign$6({},r),{backupUrls:t}),o),i)]:"string"==typeof e?[2,this._kernel.setLevel(e,t,o)]:[2,this._kernel.setLevel(e)]}}))}))},t.prototype.destroy=function(){var e,t;this._videoElements&&(this._videoElements.forEach((function(e){videoTool.destroyElement(e)})),this._videoElements=null),(null===(e=this.videoElementsContainer)||void 0===e?void 0:e.parentNode)&&this.videoElementsContainer.remove(),this._kernel&&(this.setKernelEvts(!1),null===(t=this._kernel)||void 0===t||t.destroy(),this._kernel=null),this.removeAllListeners(),this._kernelEvtHandler=null,this._config=null},t.prototype.checkWhetherNeedToSwitchKernel=function(e,t,o){return void 0===o&&(o=!1),__awaiter$4(this,void 0,void 0,(function(){var r,i,n,a,s;return __generator$4(this,(function(l){switch(l.label){case 0:return r=e instanceof Array?e[0]:e,i=r.kernelName||(null==t?void 0:t.kernelName),(n=KernelFactory$1.selectKernel(e,i,this._config.kernelPriority))?KernelFactory$1.kernelMap[n]?[3,2]:[4,this.loadKernel(n)]:[3,3];case 1:l.sent(),l.label=2;case 2:if(KernelFactory$1.kernelMap[n]&&!KernelFactory$1.kernelMap[n].isEnvSupport)return a=getUrlConfigVideoType(r),[2,{isKernelSwitched:!1,error:{code:ERROR_CODE.KERNEL_NOT_SPT,message:n===exports.KERNEL_NAME.ORIGIN?"无法支持".concat(a,"格式播放"):"".concat(a,"格式需要").concat(n,"内核播放，但当前环境不支持此内核")}}];l.label=3;case 3:return s=KernelFactory$1.kernelMap[n]?n:exports.KERNEL_NAME.ORIGIN,this._kernel&&this._kernel.kernelName!==s&&(this._kernel.played&&!o&&this.emit(exports.PLAY_EVENT.STOPED,{videoInfo:this._kernel.currentVideoInfo,endState:exports.END_STATE.INTERRUPT}),this.setKernelEvts(!1),this._kernel.destroy(),this._kernel=null),this._kernel?[3,5]:[4,this.createKernel(s)];case 4:return l.sent(),[2,{isKernelSwitched:!0,error:null}];case 5:return[2,{isKernelSwitched:!1,error:null}]}}))}))},t.prototype.loadKernel=function(e,t){return void 0===t&&(t=3),__awaiter$4(this,void 0,void 0,(function(){var o,r,i,n;return __generator$4(this,(function(a){switch(a.label){case 0:return(o=getKernelCdnPath(e,this._config.autoLoadKernelVerMap))?loadKernelDeferMap[e]?(this._logger.log("auto download kernel [".concat(o,"] has been started!")),[4,loadKernelDeferMap[e].promise]):[3,2]:[2,!1];case 1:return r=a.sent(),this._logger.log("auto download kernel [".concat(o,"] succ=").concat(r)),[2,r];case 2:loadKernelDeferMap[e]=new SimpleDefer,this._logger.log("auto download kernel [".concat(o,"]")),i=!1,n=0,a.label=3;case 3:if(!(n<t))return[3,9];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,domTool.loadScript("".concat(CDN_PATH_PREFIX+o,"?max_age=86400"),null,1e4)];case 5:return a.sent(),this._logger.log("auto download kernel [".concat(o,"] succ=true")),i=!0,[3,7];case 6:return a.sent(),i=!1,this._logger.error("auto download kernel [".concat(o,"] failed")),[3,7];case 7:if(i)return[3,9];a.label=8;case 8:return n++,[3,3];case 9:return loadKernelDeferMap[e].resolve(i),[2,i]}}))}))},t.prototype.createKernel=function(e){this._kernel=KernelFactory$1.createKernel(e,this._config),void 0!==this._volume&&(this._kernel.volume=this._volume),void 0!==this._playbackRate&&(this._kernel.playbackRate=this._playbackRate),this.setKernelEvts(!0)},t.prototype.createVideoElements=function(){for(var e=this._config,t=e.instanceId,o=e.videoElementConfig,r=e.maxVideoNodeCount,i=__assign$6(__assign$6({preload:this._config.preloadType===exports.PRELOAD_TYPE.META_DATA?"metadata":"auto"},o),{playerid:t}),n=0;n<r;n++){var a=domTool.createVideoDom(i);this._videoElements.push(a)}return this._videoElements},t.prototype.createVideoElementsContainer=function(){var e=this._config.container,t=domTool.getElementFromConfig(e);this.videoElementsContainer=domTool.creatDom('\n      <div class="'.concat(VIDEO_CONTAINER_CLASS,'" style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:0;">\n      </div>\n    ').trim()),domTool.append(t,this.videoElementsContainer)},t.prototype.on=function(t,o,r){return e.prototype.on.call(this,t,o,r),this.proxyEvent(t),this},t.prototype.once=function(t,o,r){return e.prototype.once.call(this,t,o,r),this.proxyEvent(t,!0),this},t.prototype.setKernelEvts=function(e){var t=this;if(this._kernel){e&&this.setKernelEvts(!1);var o=e?this._kernel.on:this._kernel.off;this._addedEvts.forEach((function(e){o.apply(t._kernel,[e,t._kernelEvtHandler])}))}},t.prototype.kernelEvtHandler=function(e){this.setLevelWhenKernelSwitchedDefer?this.checkSetLevelOverWhenKernelSwitched(e)&&(this.setLevelWhenKernelSwitchedDefer=null):this.emit(e.type,e.data)},t.prototype.setLevelWhenKernelSwitched=function(e,t){return this.emit(exports.PLAY_EVENT.SETLEVEL_START,{videoInfo:t,mode:SET_LEVEL_MODE.HARD}),this._kernel.play(e,{startTime:(null==t?void 0:t.playtime)||0}),this.setLevelWhenKernelSwitchedDefer=new SimpleDefer,this.setLevelWhenKernelSwitchedDefer.promise},t.prototype.checkSetLevelOverWhenKernelSwitched=function(e){var t;return e.type===exports.PLAY_EVENT.STATE_CHANGE&&e.data.new===exports.VIDEO_STATE.PLAYING?(this.setLevelWhenKernelSwitchedDefer.resolve(),this.emit(exports.PLAY_EVENT.SETLEVEL_OVER,{videoInfo:this.currentVideoInfo}),!0):e.type===exports.PLAY_EVENT.ERROR&&(this.setLevelWhenKernelSwitchedDefer.reject(null===(t=e.data.videoInfo)||void 0===t?void 0:t.error),this.emit(exports.PLAY_EVENT.SETLEVEL_OVER,{videoInfo:this.currentVideoInfo,fail:!0}),!0)},t.prototype.proxyEvent=function(e,t){void 0===t&&(t=!1),this._addedEvts.includes(e)||(this._addedEvts.push(e),this._kernel&&(t?this._kernel.once(e,this._kernelEvtHandler):this._kernel.on(e,this._kernelEvtHandler)))},t._isCollected=!1,__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"play",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"load",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object]),__metadata$8("design:returntype",void 0)],t.prototype,"setAudioTrack",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Array,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[]),__metadata$8("design:returntype",void 0)],t.prototype,"destroy",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[Object,Object,Object]),__metadata$8("design:returntype",Promise)],t.prototype,"checkWhetherNeedToSwitchKernel",null),__decorate$8([logMethodCall$9,__metadata$8("design:type",Function),__metadata$8("design:paramtypes",[String]),__metadata$8("design:returntype",void 0)],t.prototype,"createKernel",null),t}(s$1),UrlParamKey$1;function assignApiToPrototype(e,t,o){for(var r=Object.getPrototypeOf(e),i=Object.getOwnPropertyNames(t),n=0,a=o.length;n<a;n++){var s=o[n];-1!==i.indexOf(s)||"function"!=typeof r[s]||(t[s]=r[s].bind(e))}}!function(e){e.forceKernel="__forceKernel"}(UrlParamKey$1||(UrlParamKey$1={}));var KernelFactory=function(){function e(){}return e.registerKernel=function(e,t){this.kernelMap&&(this.kernelMap[e]=t)},e.getKernelByName=function(t){return e.kernelMap[t]},e.create=function(e){return new KernelProxy(e)},e.createKernel=function(t,o){if(t){var r=e.kernelMap[t];if(!r)throw new Error("Can't find [".concat(t,"] kernel"));if(r.isEnvSupport){var i=new r(o);return r.exportApis&&assignApiToPrototype(i,KernelProxy.prototype,r.exportApis),i}window.console.log("Browser does not support kernelName[".concat(t,"]"))}return new e.kernelMap.origin(o)},e.checkKernelIsSupportUrlConfig=function(e,t){var o=getUrlConfigVideoType(t);return!!this.selectKernelWithAssign(e,o)},e.selectKernel=function(e,t,o){var r=e instanceof Array?e[0]:e,i=getUrlConfigVideoType(r);return this.selectKernelFromUrl()||this.selectKernelWhenDrm(r)||this.selectKernelWithAssign(t,i)||t||this.selectKernelIfSpecialVideoType(r,i)||this.selectKernelByCodec(r)||this.selectKernelFromInstalledList(i,o)||this.selectKernelInPresetMap(i)},e.selectKernelFromUrl=function(){return urlTool.getUrlParamByKey(location.href,UrlParamKey$1.forceKernel)},e.selectKernelWhenDrm=function(e){var t;return[KeySystems.FairPlay,KeySystems.FairPlayWebKit].includes(null===(t=e.drmConfig)||void 0===t?void 0:t.keySystem)?exports.KERNEL_NAME.ORIGIN:e.vcodec===CODEC.H264&&e.chachaParam?exports.KERNEL_NAME.HLS_JS:e.vcodec===CODEC.H265&&e.chachaParam?!uaTool.mobile&&videoTool.supportHevc()?exports.KERNEL_NAME.HLS_JS:exports.KERNEL_NAME.WASM:null},e.selectKernelByCodec=function(e){var t=e.vcodec;return void 0===t||t!==CODEC.H265||videoTool.supportHevc()?null:exports.KERNEL_NAME.WASM},e.selectKernelWithAssign=function(t,o){var r;if(!t)return null;var i=e.getKernelByName(t);return i&&i.isEnvSupport&&(i.canPlayType===CAN_PLAY_ALL||(null===(r=i.canPlayType)||void 0===r?void 0:r.includes(o)))?t:null},e.selectKernelIfSpecialVideoType=function(t,o){if("hls"===o){if(t.vcodec===CODEC.H265&&videoTool.supportMSE())return exports.KERNEL_NAME.HLS_JS;if(e.kernelMap[exports.KERNEL_NAME.ORIGIN].canPlayType.includes(o))return exports.KERNEL_NAME.ORIGIN}return null},e.selectKernelFromInstalledList=function(t,o){var r;o?(r=o,Object.keys(exports.KERNEL_NAME).forEach((function(e){-1===o.indexOf(exports.KERNEL_NAME[e])&&r.push(exports.KERNEL_NAME[e])}))):r=KERNEL_NAME_BY_PRIORITY;for(var i=r.filter((function(t){return!!e.kernelMap[t]})),n=0;n<i.length;n++){var a=this.selectKernelWithAssign(i[n],t);if(a)return a}return null},e.selectKernelInPresetMap=function(e){return VIDEO_TYPE_2_KERNEL_NAME_MAP[e]},e.kernelMap={},e}(),KernelFactory$1=KernelFactory,KERNEL_NAME;exports.KERNEL_NAME=void 0,KERNEL_NAME=exports.KERNEL_NAME||(exports.KERNEL_NAME={}),KERNEL_NAME.ORIGIN="origin",KERNEL_NAME.DEMUX_2_FMP4="demux2fmp4",KERNEL_NAME.FLV_JS="flv.js",KERNEL_NAME.HLS_JS="hls.js",KERNEL_NAME.WASM="wasm",KERNEL_NAME.WEBRTC="webrtc";var KERNEL_NAME_BY_PRIORITY=[exports.KERNEL_NAME.HLS_JS,exports.KERNEL_NAME.FLV_JS,exports.KERNEL_NAME.DEMUX_2_FMP4,exports.KERNEL_NAME.ORIGIN,exports.KERNEL_NAME.WASM,exports.KERNEL_NAME.WEBRTC],VIDEO_TYPE_2_KERNEL_NAME_MAP={flv:exports.KERNEL_NAME.FLV_JS,hls:exports.KERNEL_NAME.HLS_JS,webrtc:exports.KERNEL_NAME.WEBRTC};function getKernelCdnPath(e,t){var o;void 0===t&&(t={});var r=LOCAL_DEV?"latest":t[e]||VERSION$3,i="core/".concat(r);return((o={})[exports.KERNEL_NAME.HLS_JS]="".concat(i,"/txhlsjs-kernel.js"),o[exports.KERNEL_NAME.FLV_JS]="".concat(i,"/flvjs-kernel.js"),o[exports.KERNEL_NAME.DEMUX_2_FMP4]="".concat(i,"/demux2fmp4-kernel.js"),o[exports.KERNEL_NAME.WASM]="".concat(i,"/wasm-kernel.js"),o[exports.KERNEL_NAME.WEBRTC]="".concat(i,"/webrtc-kernel.js"),o)[e]}function compareUrlConfig(e,t){return!(!e||!t)&&(!(!e.uid||!t.uid||e.uid!==t.uid)||e===t)}function fileExtension2VideoType(e){return-1!==["m3u8","m3u"].indexOf(e)?"hls":e}function checkUrlConfigVailed(e,t){var o;if(!e)return{code:ERROR_CODE.NULL_URL,message:ERROR_MSG.NULL_URL,fatal:!0};var r=null===(o=KernelFactory$1.getKernelByName(t))||void 0===o?void 0:o.canPlayType,i=function(e,o){if(!e.url)return{code:ERROR_CODE.NULL_URL,message:ERROR_MSG.NULL_URL,fatal:!0};if(!e.url.startsWith("blob:")){var r=getUrlConfigVideoType(e);if(r&&o&&-1===o.indexOf(r)){var i=VIDEO_TYPE_2_KERNEL_NAME_MAP[r],n="".concat(t!==exports.KERNEL_NAME.ORIGIN?"".concat(t,"内核"):"","无法播放").concat(r,"格式")+"".concat(i?"，需要使用".concat(i,"内核"):"");return{code:ERROR_CODE.MISSING_KERNEL,message:n,fatal:!0}}}};if(!(e instanceof Array))return i(e,r);for(var n=0,a=e.length;n<a;n++){var s=i(e[n],r);if(s)return s}}function getUrlConfigVideoType(e){var t,o=(e||{}).url;return!o||o.startsWith("blob:")?"":null===(t=fileExtension2VideoType(urlTool.getFileExtension(o)))||void 0===t?void 0:t.toLocaleLowerCase()}var __extends$9=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),CheckHealth=function(e){function t(t){var o=e.call(this)||this;return o.stateStartTimeStamp=0,o.preFramePlaytime=0,o.playtimeStalledFrameCount=0,o.videoNode=t,o.setVideoNodeEvts(!0),o}return __extends$9(t,e),t.prototype.loop=function(){var e=+new Date;this.checkStateStalled(e),this.checkPlaytimeStalled()},t.prototype.destroy=function(){this.setVideoNodeEvts(!1),this.removeAllListeners(),this.stateStartTimeStamp=0,this.videoNode=null,this.videoNodeEvtMap=null,this.preFramePlaytime=0,this.playtimeStalledFrameCount=0},t.prototype.setVideoNodeEvts=function(e){var t,o=this;this.videoNodeEvtMap||(this.videoNodeEvtMap=((t={})[VIDEO_NODE_EVENT.STATE_CHANGE]=this.videoNodeStateChange.bind(this),t)),Object.keys(this.videoNodeEvtMap).forEach((function(t){e?o.videoNode.on(t,o.videoNodeEvtMap[t]):o.videoNode.off(t,o.videoNodeEvtMap[t])}))},t.prototype.videoNodeStateChange=function(e){this.stateStartTimeStamp=+new Date},t.prototype.checkStateStalled=function(e){var t=this.videoNode,o=t.config,r=t.state;-1!==[exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.SEEKING].indexOf(r)&&(this.stateStartTimeStamp<=0||o.maxStateStalledTime<=0||e-this.stateStartTimeStamp>o.maxStateStalledTime&&(this.stateStartTimeStamp=0,this.emit(HEALTH_EVTS.STATE_STUCK,{code:ERROR_CODE.STATE_STUCK,message:ERROR_MSG.PLAY_STUCK,state:r})))},t.prototype.checkPlaytimeStalled=function(){var e=this.videoNode,t=e.config,o=e.state,r=e.videoElement;o!==exports.VIDEO_STATE.PLAYING||r.duration<=0||r.currentTime<=0||t.maxPlaytimeStalledTime<=0||(this.preFramePlaytime>0&&(this.preFramePlaytime!==r.currentTime?this.playtimeStalledFrameCount=0:(this.playtimeStalledFrameCount++,16.7*this.playtimeStalledFrameCount>t.maxPlaytimeStalledTime&&(this.playtimeStalledFrameCount=0,this.emit(HEALTH_EVTS.PLAYTIME_STUCK,{code:ERROR_CODE.ORG_PLAY_STUCK_ERR,message:ERROR_MSG.PLAY_STUCK,state:o})))),this.preFramePlaytime=r.currentTime)},t}(s$1),HEALTH_EVTS;!function(e){e.STATE_STUCK="state-stuck",e.PLAYTIME_STUCK="playtime-stuck"}(HEALTH_EVTS||(HEALTH_EVTS={}));var PerformanceMonitor=function(){function e(e){var t=this;this.totalVideoFrames=0,this.droppedVideoFrames=0,this.totalDecodeTimeInMs=0,this.presentedVideoFrames=0,this.videoFrameCallback=function(e,o){t.totalDecodeTimeInMs+=1e3*o.processingDuration,t.presentedVideoFrames=o.presentedFrames,t.video.requestVideoFrameCallback(t.videoFrameCallback)},this.video=e,this.setupRVFC()}return e.prototype.report=function(){var e=videoTool.getVideoPlaybackQuality(this.video),t=e.totalVideoFrames,o=e.droppedVideoFrames;this.totalVideoFrames=t,this.droppedVideoFrames=o;var r=this.totalDecodeTimeInMs/this.presentedVideoFrames;isNaN(r)&&(r=-1);var i=this.droppedVideoFrames/this.totalVideoFrames*100;return isNaN(i)&&(i=-1),{totalDecodeTimeInMs:this.totalDecodeTimeInMs,droppedVideoFrames:this.droppedVideoFrames,presentedVideoFrames:this.presentedVideoFrames,totalVideoFrames:this.totalVideoFrames,averageDecodeTimeInMs:r,frameDroppedInPercentage:i}},e.prototype.stop=function(){this.setupRVFC(!1)},e.prototype.setupRVFC=function(e){void 0===e&&(e=!0),this.video instanceof HTMLVideoElement&&"requestVideoFrameCallback"in HTMLVideoElement.prototype&&(e?this.videoFrameCallbackId=this.video.requestVideoFrameCallback(this.videoFrameCallback):this.video.cancelVideoFrameCallback(this.videoFrameCallbackId))},e}(),__decorate$7=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$7=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_a$6,VALID_PREVIOUS_STATE_MAP=(_a$6={},_a$6[exports.VIDEO_STATE.LOAD_START]=[exports.VIDEO_STATE.IDLE],_a$6[exports.VIDEO_STATE.CANPLAY]=[exports.VIDEO_STATE.LOAD_START],_a$6[exports.VIDEO_STATE.PLAYING]=[exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.SEEKED,exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.BUFFERING],_a$6[exports.VIDEO_STATE.BUFFERING]=[exports.VIDEO_STATE.PLAYING],_a$6[exports.VIDEO_STATE.PAUSE]=[exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.BUFFERING],_a$6[exports.VIDEO_STATE.SEEKING]=[exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.SEEKING],_a$6[exports.VIDEO_STATE.SEEKED]=[exports.VIDEO_STATE.SEEKING],_a$6[exports.VIDEO_STATE.END]=[exports.VIDEO_STATE.LOAD_START,exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.SEEKING,exports.VIDEO_STATE.SEEKED,exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.PAUSE],_a$6[exports.VIDEO_STATE.IDLE]=[exports.VIDEO_STATE.END],_a$6),VALID_STATE_IN_LEVEL_SWITCHING=[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE],logMethodCall$8=logMethodCallDecoratorCreator("StateMgr"),StateMgr=function(){function e(e){var t;this.videoEvtHandler=((t={})[VIDEO_EVTS.canplay]=this.onCanplayEvt.bind(this),t[VIDEO_EVTS.playing]=this.setPlaying.bind(this),t[VIDEO_EVTS.waiting]=this.setWaiting.bind(this),t[VIDEO_EVTS.pause]=this.onPauseEvt.bind(this),t[VIDEO_EVTS.seeking]=this.onSeekingEvt.bind(this),t[VIDEO_EVTS.seeked]=this.onSeekedEvt.bind(this),t),this.videoNode=e,this.logger=new Logger(e.config.instanceId,"StateMgr")}return e.prototype.destroy=function(){this.videoNode=null},e.prototype.validCallState=function(e){var t;return null===(t=VALID_PREVIOUS_STATE_MAP[e])||void 0===t?void 0:t.includes(this.videoNode.state)},e.prototype.setEnded=function(){this.setVideoNodeState(exports.VIDEO_STATE.END),this.setVideoNodeState(exports.VIDEO_STATE.IDLE)},e.prototype.setLoadStart=function(){this.setVideoNodeState(exports.VIDEO_STATE.LOAD_START)},e.prototype.setCanplay=function(){this.setVideoNodeState(exports.VIDEO_STATE.CANPLAY)},e.prototype.setWaiting=function(){this.setVideoNodeState(exports.VIDEO_STATE.BUFFERING)},e.prototype.setPlaying=function(){this.setVideoNodeState(exports.VIDEO_STATE.PLAYING)},e.prototype.onSetLevelOver=function(){this.videoNode.state===exports.VIDEO_STATE.PAUSE&&this.setVideoNodeState(exports.VIDEO_STATE.PLAYING)},e.prototype.receiveVideoEvt=function(e){var t,o;null===(o=(t=this.videoEvtHandler)[e])||void 0===o||o.call(t)},e.prototype.setVideoNodeState=function(e){!this.videoNode.getLevelSwitching()||VALID_STATE_IN_LEVEL_SWITCHING.includes(e)?VALID_PREVIOUS_STATE_MAP[e].includes(this.videoNode.state)?this.videoNode.state=e:this.logger.log("can not set state from ".concat(this.videoNode.state," to ").concat(e)):this.logger.log("can not set state 2 ".concat(e," when level switching"))},e.prototype.onCanplayEvt=function(){(uaTool.os.ios||uaTool.browser.safari)&&this.isVideoElementPlaying()&&this.videoNode.state===exports.VIDEO_STATE.BUFFERING?this.setVideoNodeState(exports.VIDEO_STATE.PLAYING):this.setVideoNodeState(exports.VIDEO_STATE.CANPLAY)},e.prototype.onPauseEvt=function(){this.setVideoNodeState(exports.VIDEO_STATE.PAUSE)},e.prototype.onSeekingEvt=function(){this.setVideoNodeState(exports.VIDEO_STATE.SEEKING)},e.prototype.onSeekedEvt=function(){this.setVideoNodeState(exports.VIDEO_STATE.SEEKED),(uaTool.os.ios||uaTool.browser.safari)&&this.isVideoElementPlaying()&&this.setVideoNodeState(exports.VIDEO_STATE.PLAYING)},e.prototype.isVideoElementPlaying=function(){return!this.videoNode.videoElement.paused&&!this.videoNode.videoElement.ended},__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"destroy",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[String]),__metadata$7("design:returntype",void 0)],e.prototype,"validCallState",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setEnded",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setLoadStart",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setCanplay",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setWaiting",null),__decorate$7([logMethodCall$8,__metadata$7("design:type",Function),__metadata$7("design:paramtypes",[]),__metadata$7("design:returntype",void 0)],e.prototype,"setPlaying",null),e}(),__extends$8=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$5=window&&window.__assign||function(){return __assign$5=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$5.apply(this,arguments)},__decorate$6=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$6=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},IGNORE_EVT_TYPE$1=[VIDEO_EVTS.timeupdate,VIDEO_EVTS.progress,VIDEO_EVTS.frameRender],logMethodCall$7=logMethodCallDecoratorCreator("BaseVideoNode"),BaseVideoNode=function(e){function t(t){var o,r=e.call(this)||this;r._played=!1,r._evtBlocking=!1,r._pauseCloseToEndStateCheckTimeoutId=0,r._targetSeekTime=-1,r._userStartTime=0,r._isUserSeek=!1,r.isUserSwitchAudioTrack=!1,r._setLoadingDelayTimeoutId=0,r.loadTimeoutId=0,r.levelSwitchTargetPlaytime=-1,r.setLevelMode=SET_LEVEL_MODE.SOFT,r.altAudio=!1,r._logger=new Logger(t.instanceId,"BaseVideoNode"),r._config=t,r.stateMgr=new StateMgr(r),r.checkPlayHealth=new CheckHealth(r),r.setHealthEvents(),r.mainTaskLoop=new TaskLoop(r.mainLoopInProcess.bind(r),LoopMode.RAF);var i=r._config.container;return r._video=r.findFreeVideoElement(),r._autoPlayPolicy=new AutoPlayPolicy(r._video,{instanceId:t.instanceId}),r._state=exports.VIDEO_STATE.IDLE,r._playbackRate=1,r._idx=0,r._videoInfo=null,r._pauseType=void 0,r._videoEventMap=((o={})[VIDEO_EVTS.loadstart]=r.onVideoEventLoadStart.bind(r),o[VIDEO_EVTS.timeupdate]=r.onVideoEventTimeUpdate.bind(r),o[VIDEO_EVTS.durationchange]=r.onVideoEventDurationChange.bind(r),o[VIDEO_EVTS.volumechange]=r.onVideoEventVolumeChange.bind(r),o[VIDEO_EVTS.canplay]=r.onVideoEventCanplay.bind(r),o[VIDEO_EVTS.playing]=r.onVideoEventPlaying.bind(r),o[VIDEO_EVTS.pause]=r.onVideoEventPause.bind(r),o[VIDEO_EVTS.waiting]=r.onVideoEventWaiting.bind(r),o[VIDEO_EVTS.seeking]=r.onVideoEventSeeking.bind(r),o[VIDEO_EVTS.seeked]=r.onVideoEventSeeked.bind(r),o[VIDEO_EVTS.loadeddata]=r.onVideoEventLoadeddata.bind(r),o[VIDEO_EVTS.loadedmetadata]=r.onVideoEventLoadedmetadata.bind(r),o[VIDEO_EVTS.ended]=r.onVideoEventEnded.bind(r),o[VIDEO_EVTS.error]=r.onVideoEventError.bind(r),o[VIDEO_EVTS.progress]=r.onVideoEventProgress.bind(r),o[VIDEO_EVTS.ratechange]=r.onVideoEventRateChange.bind(r),o[VIDEO_EVTS.resize]=r.onVideoEventResize.bind(r),o),r._drm=new DRM(r._video,t.drmConfig,r._logger),r._drm.on("error",r.onDrmError.bind(r)),r._eventMap={video:r.onVideoEvents.bind(r)},r._eventAddedMap={},r._videoElementContainer=domTool.getElementFromConfig(i).querySelector(".".concat(VIDEO_CONTAINER_CLASS)),videoTool.appendElement(r._video,r._videoElementContainer),r.addVideoElementResizeObserver(),r.performanceMonitor=new PerformanceMonitor(r._video),r}return __extends$8(t,e),t.prototype.setLevel=function(e){if(void 0===e&&(e=SET_LEVEL_MODE.HARD),!this.checkCanSetLevel())return Promise.reject(new Error("setLevel can't start"));this._logger.log("setLevel(), succ exec: ",this._videoInfo);var t=this._videoInfo.playtime;this.load(this._videoInfo,{startTime:t}),this.play();var o=new SimpleDefer;return this._levelSwitchingDefer=o,this.levelSwitchTargetPlaytime=t,this.setLoading(!0),this.emit(VIDEO_NODE_EVENT.SETLEVEL_START,{videoInfo:this._videoInfo,mode:e}),o.promise},t.prototype.setAudioTrack=function(e){return this.checkCanSetAudioTrack()?Promise.reject(AUDIO_TRACK_ERROR_MSG.NOT_SUPPORT):Promise.reject(AUDIO_TRACK_ERROR_MSG.STATE_INVALID)},t.prototype.isCurrentContentDRMEncrypted=function(){return this._state!==exports.VIDEO_STATE.IDLE&&this._drm.hasStarted()},t.prototype.getLevelSwitching=function(){return!!this._levelSwitchingDefer},t.prototype.hasAltAudio=function(){return this.altAudio},t.prototype.checkSetLevelOver=function(e){if(this.getLevelSwitching()){var t=!1,o=!1,r=!1;this._config.type===exports.PLAY_MODE.LIVE?(t=e===VIDEO_EVTS.playing,r=e===VIDEO_EVTS.timeupdate):(t=e===VIDEO_EVTS.playing&&videoTool.supportMediaFragmentsURISpec(this._config.enableMediaFragmentsURI),o=e===VIDEO_EVTS.seeked&&!videoTool.supportMediaFragmentsURISpec(this._config.enableMediaFragmentsURI),r=e===VIDEO_EVTS.timeupdate&&this._video.currentTime-this.levelSwitchTargetPlaytime>=.3),(t||o||r)&&(this._logger.log("setLevelOver(), reason: "+"succOnPlaying=".concat(t,"/succOnSeeked=").concat(o,"/succOnTimeupdate=").concat(r)),this.setLevelOver())}},t.prototype.onAudioTrackSwitched=function(e,t){void 0===t&&(t=!1),this.audioTrackSwitchingDefer&&(this.audioTrackSwitchingDefer.resolve({userTrigger:this.isUserSwitchAudioTrack,id:e,fail:t}),this.audioTrackSwitchingDefer=null,this.emit(VIDEO_NODE_EVENT.SET_AUDIO_TRACK_OVER,{videoInfo:this._videoInfo,id:e,fail:t,userTrigger:this.isUserSwitchAudioTrack}))},t.prototype.checkCanSetAudioTrack=function(){return this.altAudio?this._played?!this.audioTrackSwitchingDefer||(this._logger.warn("setAudioTrack(), in progress"),!1):(this._logger.warn("setAudioTrack(), can only be invoked after content plays"),!1):(this._logger.warn("setAudioTrack(), current content does not contain alternative audio track"),!1)},t.prototype.setLevelOver=function(){this._levelSwitchingDefer&&(this._levelSwitchingDefer.resolve(),this._levelSwitchingDefer=null,this.levelSwitchTargetPlaytime=-1,this.setLoading(!1),this.stateMgr.onSetLevelOver(),this.emit(VIDEO_NODE_EVENT.SETLEVEL_OVER,{videoInfo:this._videoInfo}))},t.prototype.checkCanSetLevel=function(){return this._played?this.getLevelSwitching()?(this._logger.warn("setLevel(), in progress."),!1):!this._videoInfo||this._videoInfo.playtime<=0?(this._logger.warn("setLevel(), setLevel can't start."),!1):!(this._config.type===exports.PLAY_MODE.VOD&&this._videoInfo.playtime+1>=this._videoInfo.duration)||(this._logger.warn("setLevel(), video is about to end."),!1):(this._logger.warn("setLevel(), play is not triggered."),!1)},t.prototype.checkCanSeek=function(e,t){return void 0===t&&(t=!1),this._videoInfo?this._video.duration<=0?(this._logger.log("seek(), cannot seek when the duration is 0"),!1):e-this._videoInfo.duration>=1?(this._logger.log("seek(), return because too large time, uid=".concat(this._videoInfo.uid,"/idx=").concat(this.idx,"/time=").concat(e)+"/duration=".concat(this._videoInfo.duration)),!1):void 0===this.setLevelMode||this.setLevelMode===SET_LEVEL_MODE.SMOOTH||!this.getLevelSwitching()||!t||(this._logger.log("seek(), cannot seek when hard/soft level switching"),!1):(this._logger.log("seek(), return because null videoInfo, time=".concat(e,"/idx=").concat(this.idx)),!1)},t.prototype.findFreeVideoElement=function(){for(var e=this._config.videoElements,t=null,o=0;o<e.length;o++){var r=e[o];if(void 0===r.dataset.used||r.dataset.used===VIDEO_ELEMENT_STATE.FREE){t=e[o];break}}if(!t)throw new Error("Unable to find free video element!");return t.dataset.used=VIDEO_ELEMENT_STATE.USED,t},t.prototype.setMainLoopEnable=function(e){e?this.mainTaskLoop.start():this.mainTaskLoop.stop()},t.prototype.mainLoopInProcess=function(){this.updateAccuratePlaytime(),this.checkPlayHealth.loop()},t.prototype.updateAccuratePlaytime=function(){var e;this._state!==exports.VIDEO_STATE.PLAYING||this._video.duration<=0||this._video.readyState<VIDEO_READY_STATE.HAVE_ENOUGH_DATA||(null===(e=this.onAccurateTimeupdate)||void 0===e||e.call(this,this._video.currentTime,this._video.duration),this.updatePlaytime(this._video.currentTime,!0))},t.prototype.setCheckLoadTimeoutEnable=function(e){var t=this;if(e){if(this._config.maxPreloadTimeout<=0)return;this.loadTimeoutId=window.setTimeout((function(){t.errorHandler({code:ERROR_CODE.ORG_LOAD_TIMEOUT,message:ERROR_MSG.PRELOAD_VIDEO_TIMEOUT})}),this._config.maxPreloadTimeout)}else this.loadTimeoutId>0&&(clearTimeout(this.loadTimeoutId),this.loadTimeoutId=0)},t.prototype.setEndInner=function(){this._state!==exports.VIDEO_STATE.END&&this._state!==exports.VIDEO_STATE.IDLE&&(this._logger.log("setEndInner(), idx=".concat(this._idx,"/uid=").concat(this._videoInfo.uid,"/playtime=").concat(this._videoInfo.playtime)+"/duration=".concat(this._videoInfo.duration,"}")),this.stateMgr.setEnded(),this.emit(VIDEO_NODE_EVENT.PLAY_OVER,{isUserStop:!1,endState:exports.END_STATE.NORMAL,videoInfo:this._videoInfo}))},t.prototype.stopInner=function(e,t){var o;this._video&&this._videoInfo&&(this.setMainLoopEnable(!1),this.setCheckLoadTimeoutEnable(!1),this._isUserSeek=!1,this._logger.log("stopInner(), uid/state/idx: ".concat(null===(o=this._videoInfo)||void 0===o?void 0:o.uid,"/").concat(this.state,"/").concat(this.idx)),this.setVideoEvents(!1),this._config.clearVideoAfterStop?videoTool.clear(this._video):this._video.pause(),this._config.createVideoNodeWhenLoad&&(this._video.dataset.used=VIDEO_ELEMENT_STATE.FREE),this._videoInfo&&(this._videoInfo.extraVars.isLoadstarted=!1,this._videoInfo=null),this._pauseCloseToEndStateCheckTimeoutId>0&&(window.clearTimeout(this._pauseCloseToEndStateCheckTimeoutId),this._pauseCloseToEndStateCheckTimeoutId=0),this.state!==exports.VIDEO_STATE.IDLE&&(e||(this.stateMgr.setEnded(),this._played=!1,this._levelSwitchingDefer=null,(null==t?void 0:t.error)&&this.emit(VIDEO_NODE_EVENT.ERROR,{videoInfo:t}))))},t.prototype.onVideoEventPause=function(){this._pauseType!==PAUSE_TYPE.INNER&&this.stateMgr.receiveVideoEvt(VIDEO_EVTS.pause)},t.prototype.onVideoEventPlaying=function(){this.setCheckLoadTimeoutEnable(!1),this._isUserSeek=!1,this.updateVideoSize(),uaTool.browser.x5&&this.onVideoEventDurationChange(),this._videoInfo.hasFirstPlaying||this.emit(VIDEO_NODE_EVENT.FIRST_PLAYING,{videoInfo:this._videoInfo}),this.stateMgr.receiveVideoEvt(VIDEO_EVTS.playing),this._videoInfo&&(this._videoInfo.hasFirstPlaying=!0),this._userStartTime=0,this.checkSetLevelOver(VIDEO_EVTS.playing)},t.prototype.onVideoEventRateChange=function(){this.emit(VIDEO_NODE_EVENT.RATE_CHANGE,{playbackRate:this.playbackRate,videoInfo:this._videoInfo})},t.prototype.onVideoEventEnded=function(){this._logger.log("setEndInner(), reason=endedEvt"),this.setEndInner()},t.prototype.onVideoEventSeeked=function(){this.stateMgr.receiveVideoEvt(VIDEO_EVTS.seeked),this.checkSetLevelOver(VIDEO_EVTS.seeked),this.resumeAfterSeek(),this._isUserSeek=!1},t.prototype.resumeAfterSeek=function(){this._played&&!this._video.ended&&this._isUserSeek&&(this._video.paused?this._config.remainPauseStateAfterSeek||this.videoplay():this.stateMgr.setPlaying())},t.prototype.onVideoEventCanplay=function(){this.setCheckLoadTimeoutEnable(!1),this._videoInfo&&(this._videoInfo.qualityInfo.canplaytime||(this._videoInfo.qualityInfo.canplaytime=videoTool.getBuffered(this._video)),this.stateMgr.receiveVideoEvt(VIDEO_EVTS.canplay))},t.prototype.onVideoEventResize=function(){this.updateVideoSize(!0)},t.prototype.onVideoEventDurationChange=function(){this._video.duration>0&&this._video.duration!==this._videoInfo.duration&&(this._videoInfo.duration=this._video.duration,this._logger.log("onVideoEventDurationChange(), uid=".concat(this._videoInfo.uid,"/duration=").concat(this._videoInfo.duration,"/")+"idx=".concat(this.idx)),this.emit(VIDEO_NODE_EVENT.DURATION_CHANGE,{videoInfo:this._videoInfo}))},t.prototype.onVideoEventVolumeChange=function(){this.emit(VIDEO_NODE_EVENT.VOLUME_CHANGE,{volume:this.volume,videoInfo:this._videoInfo})},t.prototype.onVideoEventTimeUpdate=function(){0!==this._video.currentTime&&(this.updatePlaytime(this._video.currentTime),this.checkSetLevelOver(VIDEO_EVTS.timeupdate),this._state===exports.VIDEO_STATE.BUFFERING&&this.stateMgr.setPlaying())},t.prototype.onVideoEventLoadStart=function(){},t.prototype.onVideoEventWaiting=function(){this.stateMgr.receiveVideoEvt(VIDEO_EVTS.waiting)},t.prototype.onVideoEventSeeking=function(){this.stateMgr.receiveVideoEvt(VIDEO_EVTS.seeking)},t.prototype.onVideoEventProgress=function(){this.emit(VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE,{videoInfo:this._videoInfo})},t.prototype.onVideoEventLoadedmetadata=function(e){this.updateVideoSize(),this.emit(VIDEO_NODE_EVENT.METADATA_CHANGE,{videoInfo:this._videoInfo})},t.prototype.updateVideoSize=function(e){void 0===e&&(e=!1);var t=this._video.videoWidth,o=this._video.videoHeight;!this._videoInfo||this._videoInfo.videoWidth===t&&this._videoInfo.videoHeight===o||(this._videoInfo.videoWidth=t,this._videoInfo.videoHeight=o,this.emit(VIDEO_NODE_EVENT.VIDEO_RESIZE,{videoInfo:this._videoInfo,isNative:e}),this.adjustmentVideoSizeIfSmallBorder())},t.prototype.addVideoElementResizeObserver=function(){var e=this;window.ResizeObserver&&this._video instanceof HTMLVideoElement&&(this.videoResizeObserver=new ResizeObserver((function(t){e.adjustmentVideoSizeIfSmallBorder()})),this.videoResizeObserver.observe(this._video))},t.prototype.removeVideoElementResizeObserver=function(){this.videoResizeObserver&&this._video&&this._video instanceof HTMLVideoElement&&(this.videoResizeObserver.disconnect(),this.videoResizeObserver.unobserve(this._video),this.videoResizeObserver=null)},t.prototype.adjustmentVideoSizeIfSmallBorder=function(){if(this._video instanceof HTMLVideoElement&&this._videoInfo&&!(this._config.minFillBlackBorder<=0)){var e=domTool.getDomSize(this._video),t=e.width,o=e.height,r=this._videoInfo.videoWidth*(o/this._videoInfo.videoHeight),i=this._videoInfo.videoHeight*(t/this._videoInfo.videoWidth),n=this._config.minFillBlackBorder;r<t&&r>=t-n||i<o&&i>=o-n?videoTool.setElementFitType(this._video,"cover"):videoTool.setElementFitType(this._video,"contain")}},t.prototype.onVideoEventLoadeddata=function(){this.emit(VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE,{videoInfo:this._videoInfo})},t.prototype.onVideoEventError=function(){this.errorHandler()},t.prototype.errorHandler=function(e){var t=this.parseErrorData(e);this._logger.log("errorHandler(), error: ",t),this.retryWhenError(t)},t.prototype.parseErrorData=function(e){var t,o,r;if(e)return{code:void 0===(t=e.code)?ERROR_CODE.UNKNOWN_ERR:t,message:void 0===(o=e.message)?ERROR_MSG.UNKNOWN:o};var i=VIDEO_ELEMENT_ERROR[null===(r=this.videoElement.error)||void 0===r?void 0:r.code]||{code:ERROR_CODE.UNKNOWN_ERR,message:ERROR_MSG.UNKNOWN};return{code:i.code,message:i.message}},t.prototype.retryWhenError=function(e){var t=this._videoInfo,o=this.setRetryUrl(t),r=t.config.expireTimeStamp,i=void 0!==r&&r<+new Date;if(!e.fatal&&!i&&o){var n=t.getRetryCount();return this._logger.log("retryOnError(), retryCount=",n),this.emit(VIDEO_NODE_EVENT.RETRY,__assign$5({error:e,retryCount:n,videoInfo:t},o)),this.stopInner(!0),this.stateMgr.setWaiting(),this._state!==exports.VIDEO_STATE.BUFFERING&&this.setLoading(!0),void this.doRetry(t)}this._logger.log("retryOnError(), fatal."),this._videoInfo.error=e,this._levelSwitchingDefer&&this._levelSwitchingDefer.reject(),this.stopInner(!1,this._videoInfo)},t.prototype.doRetry=function(e){var t=e.playtime,o=this._video.currentTime>0?this._video.currentTime:t,r=this._played?o:this._userStartTime,i=this._played?this.play.bind(this):this.load.bind(this);e.playtime=r,i(e,{startTime:r})},t.prototype.onDrmError=function(e){var t=e.data,o=t.code,r=t.message;this._logger.log("onDrmError(), code=".concat(o,"/msg=").concat(r)),this._videoInfo.error=e.data,this.stopInner(!1,this._videoInfo)},t.prototype.setHealthEvents=function(){var e=this,t=function(t){e._logger.warn("get health evt!!! evt=".concat(t.type,"/uid=").concat(e._videoInfo.uid,"/state=").concat(e._state)),e.retryWhenError(t.data)};this.checkPlayHealth.on(HEALTH_EVTS.STATE_STUCK,t),this.checkPlayHealth.on(HEALTH_EVTS.PLAYTIME_STUCK,t)},t.prototype.setVideoEvents=function(e){var t,o=this;this._eventAddedMap.videoEventAdded!==e&&(this._logger.log("setVideoEvents(), idx=".concat(this._idx,"/value=").concat(e,"/uid=").concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid)),this._eventAddedMap.videoEventAdded=e,Object.keys(this._videoEventMap).forEach((function(t){e?o._video.addEventListener(t,o._eventMap.video):o._video.removeEventListener(t,o._eventMap.video)})))},t.prototype.setLoading=function(e,t){var o=this;void 0===t&&(t=0),this._setLoadingDelayTimeoutId>0&&(window.clearTimeout(this._setLoadingDelayTimeoutId),this._setLoadingDelayTimeoutId=0),e?t>0?this._setLoadingDelayTimeoutId=window.setTimeout((function(){o.emit(VIDEO_NODE_EVENT.SET_LOADING,{show:!0})}),t):this.emit(VIDEO_NODE_EVENT.SET_LOADING,{show:!0}):this.emit(VIDEO_NODE_EVENT.SET_LOADING,{show:!1})},t.prototype.onVideoEvents=function(e){var t,o=this;if(this.state!==exports.VIDEO_STATE.IDLE&&this._videoInfo&&!this._evtBlocking){IGNORE_EVT_TYPE$1.includes(e.type)||this._logger.log("videoevt, uid=".concat(this._videoInfo.uid,"/idx=").concat(this.idx,"/type=").concat(e.type,"/")+"time=".concat(this._video.currentTime,"/duration=").concat(this._video.duration)),this.emit(VIDEO_NODE_EVENT.ELEMENT_EVTS,{videoInfo:this._videoInfo,elementEvtType:e.type});var r=Math.abs(this._videoInfo.duration-this._videoInfo.playtime)<.1&&this._videoInfo.duration>0;"pause"===e.type&&r?this._pauseCloseToEndStateCheckTimeoutId=window.setTimeout((function(){o._videoEventMap[e.type]&&o._videoEventMap[e.type](e)}),0):("ended"===e.type&&this._pauseCloseToEndStateCheckTimeoutId>0&&(window.clearTimeout(this._pauseCloseToEndStateCheckTimeoutId),this._pauseCloseToEndStateCheckTimeoutId=0),this._videoEventMap[e.type]&&this._videoEventMap[e.type](e))}else this._logger.log("videoevt discard, idx=".concat(this._idx,"/uid=").concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid,"/evttype=").concat(e.type,"/")+"state=".concat(this.state,"/evtBlocking=").concat(this._evtBlocking))},t.prototype.createStream=function(e){return null},t.prototype.setRetryUrl=function(e){var t=e.loadingUrl;return e.setNextBackUrl()?{prevUrl:t,curUrl:e.loadingUrl}:null},t.prototype.triggerAutoplay=function(){var e=this;return this._evtBlocking=!0,this._autoPlayPolicy.userTrigger().then((function(){return e._evtBlocking=!1})).catch((function(t){throw e._evtBlocking=!1,t}))},Object.defineProperty(t.prototype,"useWorker",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idx",{get:function(){return this._idx},set:function(e){this._idx=e,this._video.dataset.idx="".concat(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElement",{get:function(){return this._video},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){return{width:this._video.videoWidth,height:this._video.videoHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){return videoTool.getBuffered(this._video)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._video.playbackRate},set:function(e){this._playbackRate=e;try{this._video.playbackRate=e}catch(e){this._logger.warn("set playbackRate: ".concat(null==e?void 0:e.message))}},enumerable:!1,configurable:!0}),t.prototype.videoplay=function(){var e,t=this;this._logger.log("videoplay(), uid=".concat(null===(e=this._videoInfo)||void 0===e?void 0:e.uid,"/state=").concat(this.state,"/idx=").concat(this.idx));var o=this._video.play();return o?o.catch((function(e){t._logger.warn("".concat(t.idx," play() catch: ").concat(e.name,", ").concat(e.message));var o=videoTool.isAutoPlayBlockedMessage(e.message);o&&t.setLoading(!1),t.emit(VIDEO_NODE_EVENT.PLAY_PROMISE_CATCHED,{videoInfo:t._videoInfo,isAutoPlayBlocked:o})})):o=Promise.resolve(),this._video.playbackRate=this._playbackRate,o},Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){return this._videoInfo},enumerable:!1,configurable:!0}),t.prototype.pause=function(){this._played?this.stateMgr.validCallState(exports.VIDEO_STATE.PAUSE)?this.pauseInner(PAUSE_TYPE.USER):this._logger.log("call pause in invaild state ".concat(this._state)):this._logger.warn("pause(), VideoNode has not been played")},t.prototype.pauseInner=function(e){var t;void 0===e&&(e=PAUSE_TYPE.INNER),this._logger.log("pause(), uid=".concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid,"/state=").concat(this.state,"/idx=").concat(this.idx,"/type=").concat(e)),this._pauseType=e,this._video.pause()},t.prototype.resume=function(){throw new Error("not implements")},Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return!uaTool.browser.x5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var e=this._videoInfo?this._videoInfo.duration:0;return Number.isNaN(e)?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._video.muted?0:this._video.volume},set:function(e){e<0||e>1?this._logger.warn("The volume value range is [0,1]"):(this._video.volume=e,this._video.muted=e<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){return this._videoInfo?this._videoInfo.playtime:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){var t;if(this._state!==e){var o=this._state;this._state=e,this._videoInfo&&(this._videoInfo.state=this._state),this._logger.log("set state(), uid=".concat(null===(t=this._videoInfo)||void 0===t?void 0:t.uid,"/idx=").concat(this._idx,"/old=").concat(o,"/new=").concat(e));var r={videoInfo:this._videoInfo,new:e,old:o};e===exports.VIDEO_STATE.PAUSE?(r.pauseType=this._pauseType||PAUSE_TYPE.SYS,this._pauseType=void 0):e===exports.VIDEO_STATE.SEEKING?(r.seekingTime=this._targetSeekTime,r.isUserSeek=this._isUserSeek,this._targetSeekTime=-1):e===exports.VIDEO_STATE.SEEKED&&(r.isUserSeek=this._isUserSeek),this.setLoadingOnStateChange(),this.emit(VIDEO_NODE_EVENT.STATE_CHANGE,r)}},enumerable:!1,configurable:!0}),t.prototype.stop=function(){this.stopInner()},t.prototype.updatePlaytime=function(e,t){if(void 0===t&&(t=!1),this._videoInfo){var o=this.performanceMonitor.report(),r=o.averageDecodeTimeInMs,i=o.totalVideoFrames,n=o.droppedVideoFrames,a=o.frameDroppedInPercentage;this._videoInfo.qualityInfo.droppedVideoFrames=n,this._videoInfo.qualityInfo.totalVideoFrames=i,this._videoInfo.qualityInfo.averageDecodeTimeInMs=r,this._videoInfo.qualityInfo.frameDroppedInPercentage=a,this._videoInfo.playtime!==e&&(this._videoInfo.playtime=e),t||this.emit(VIDEO_NODE_EVENT.TIME_UPDATE,{videoInfo:this._videoInfo})}},t.prototype.destroy=function(){var e,t,o,r;this.stopInner(),this._video&&(this._eventMap&&(this.setVideoEvents(!1),this._eventMap=null),videoTool.clear(this._video),videoTool.removeElement(this._video,this._videoElementContainer),this._video.dataset.used=VIDEO_ELEMENT_STATE.FREE),null===(e=this._autoPlayPolicy)||void 0===e||e.destroy(),null===(t=this.stateMgr)||void 0===t||t.destroy(),this.removeAllListeners(),this.removeVideoElementResizeObserver(),null===(o=this._drm)||void 0===o||o.destroy(),this._autoPlayPolicy=null,this._video=null,this._videoInfo=null,this._videoElementContainer=null,this._played=!1,this._config=null,null===(r=this.checkPlayHealth)||void 0===r||r.destroy(),this.mainTaskLoop.destroy(),this.performanceMonitor.stop(),this._logger.log("VideoNode has been destroyed!")},t.prototype.setLoadingOnStateChange=function(){if(this._played)if([exports.VIDEO_STATE.BUFFERING,exports.VIDEO_STATE.SEEKING].includes(this._state)){this.setLoading(!0,500)}else(this._config.type===exports.PLAY_MODE.LIVE&&exports.VIDEO_STATE.CANPLAY!==this._state||this._config.type===exports.PLAY_MODE.VOD)&&this.setLoading(!1);else this.setLoading(!1)},__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[String]),__metadata$6("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Object]),__metadata$6("design:returntype",Promise)],t.prototype,"setAudioTrack",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Boolean]),__metadata$6("design:returntype",void 0)],t.prototype,"setCheckLoadTimeoutEnable",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[]),__metadata$6("design:returntype",void 0)],t.prototype,"setEndInner",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Boolean,Object]),__metadata$6("design:returntype",void 0)],t.prototype,"stopInner",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[Object]),__metadata$6("design:returntype",void 0)],t.prototype,"retryWhenError",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[]),__metadata$6("design:returntype",void 0)],t.prototype,"pause",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[String]),__metadata$6("design:returntype",void 0)],t.prototype,"pauseInner",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[]),__metadata$6("design:returntype",void 0)],t.prototype,"stop",null),__decorate$6([logMethodCall$7,__metadata$6("design:type",Function),__metadata$6("design:paramtypes",[]),__metadata$6("design:returntype",void 0)],t.prototype,"destroy",null),t}(s$1),__extends$7=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__decorate$5=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$5=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$6=logMethodCallDecoratorCreator("OrgVideoNode"),OrgVideoNode=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$7(t,e),t.prototype.onVideoEventCanplay=function(){var t;null===(t=this._canplayDefer)||void 0===t||t.resolve(),e.prototype.onVideoEventCanplay.call(this)},t.prototype.onVideoEventLoadedmetadata=function(){e.prototype.onVideoEventLoadedmetadata.call(this),(uaTool.os.ios||uaTool.browser.safari)&&[exports.PRELOAD_TYPE.META_DATA,exports.PRELOAD_TYPE.AUTO].includes(this._config.preloadType)&&this.onVideoEventCanplay()},t.prototype.onVideoEventLoadeddata=function(){e.prototype.onVideoEventLoadeddata.call(this),this.checkPlayInitSeek()},t.prototype.onVideoEventTimeUpdate=function(){e.prototype.onVideoEventTimeUpdate.call(this),this.checkPlayInitSeek()},t.prototype.onVideoEventLoadStart=function(){this.resolveWaitVideoLoadStartEvt()},t.prototype.load=function(e,t){var o=this;return!!e.loadingUrl&&(e.config.drmConfig&&this.performanceMonitor.stop(),this.stopInner(!0),this._drm.init(e.config.drmConfig),this._videoInfo=e,this._videoInfo.extraVars.isLoadstarted=!0,this.setVideoEvents(!0),this.stateMgr.setLoadStart(),this.assignStartTime((null==t?void 0:t.startTime)||0),this._video.src=this._videoInfo.loadingUrl,this._logger.log("load(), loadingUrl=".concat(this._videoInfo.loadingUrl,", uid=").concat(this._videoInfo.uid)),this._config.preloadType===exports.PRELOAD_TYPE.AUTO_LOAD&&this._video.load(),this.setCheckLoadTimeoutEnable(!0),this._canplayDefer=new SimpleDefer,this.waitVideoLoadStartEvt().then((function(){o._logger.log("load(), video load succ...")})).catch((function(){o._logger.error("load(), video load cannot be trigger..."),o.onVideoEventCanplay()})),!0)},t.prototype.play=function(e,t){var o=this;this._logger.log("play(), uid=".concat(null==e?void 0:e.uid,"/idx=").concat(this.idx,"/state=").concat(this.state)),this._played=!0,e&&!e.extraVars.isLoadstarted&&this.load(e,t);var r=null;return uaTool.browser.safari&&this._canplayDefer?this._canplayDefer.promise.then((function(){o.videoplay()})):r=this.videoplay(),this.setMainLoopEnable(!0),r},t.prototype.assignStartTime=function(e){if(this._config.type!==exports.PLAY_MODE.LIVE){this._userStartTime=e;var t=!Number.isNaN(e)&&e>=0?e:0;t<=0||(videoTool.supportMediaFragmentsURISpec(this._config.enableMediaFragmentsURI)&&!this._videoInfo.loadingUrl.startsWith("blob:")?(this._logger.log("assignStartTime by #t"),this._videoInfo.setLoadingUrlStartTime(t)):(this._logger.log("assignStartTime with seek()"),this._needPlaySeektime=t))}},t.prototype.checkPlayInitSeek=function(){this._needPlaySeektime>0&&this._videoInfo&&this._video.duration>0&&(this._logger.log("checkPlayInitSeek(), idx=".concat(this.idx,"/seektime=").concat(this._needPlaySeektime)),this.seek(this._needPlaySeektime),this._needPlaySeektime=0)},t.prototype.stopInner=function(t,o){this._canplayDefer=null,this._needPlaySeektime=0,e.prototype.stopInner.call(this,t,o)},t.prototype.seek=function(e,t){void 0===t&&(t=!1);var o=e;return!!this.checkCanSeek(o,t)&&(uaTool.browser.x5&&Math.abs(o-this._videoInfo.duration)<=1&&(o=this._videoInfo.duration-1),this._isUserSeek=t,this._logger.log("seek(), uid".concat(this._videoInfo.uid,"/idx=").concat(this.idx,"/time=").concat(o,"/duration=").concat(this._video.duration,"/")+"state=".concat(this.state)),this._targetSeekTime=o,this._video.currentTime=o,!0)},t.prototype.updateAccuratePlaytime=function(){e.prototype.updateAccuratePlaytime.call(this);var t=Math.abs(this._video.duration-this._video.currentTime),o=this._config.originKernelConfig.advanceEndTime;o>0&&t<=o&&(this._logger.log("setEndInner(), reason=leftTimeCheck"),this.setEndInner())},t.prototype.setEndInner=function(){this.state!==exports.VIDEO_STATE.END&&this.state!==exports.VIDEO_STATE.IDLE&&(this.onAccurateTimeupdate&&this.onAccurateTimeupdate(0),this.updatePlaytime(this._video.currentTime)),e.prototype.setEndInner.call(this)},t.prototype.waitVideoLoadStartEvt=function(){var e=this;this._waitVideoLoadStartEvtDefer=new SimpleDefer;return window.setTimeout((function(){"rejected"!==e._waitVideoLoadStartEvtDefer.state&&e._waitVideoLoadStartEvtDefer.reject()}),50),this._waitVideoLoadStartEvtDefer.promise},t.prototype.resolveWaitVideoLoadStartEvt=function(){this._waitVideoLoadStartEvtDefer&&this._waitVideoLoadStartEvtDefer.resolve()},__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Object,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"load",null),__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Object,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"play",null),__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Boolean,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"stopInner",null),__decorate$5([logMethodCall$6,__metadata$5("design:type",Function),__metadata$5("design:paramtypes",[Number,Object]),__metadata$5("design:returntype",void 0)],t.prototype,"seek",null),t}(BaseVideoNode),__extends$6=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__decorate$4=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$4=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$5=logMethodCallDecoratorCreator("OrgIOSVideoNode"),PAUSE_TIME_THRESHOLD=5e3,OrgIOSVideoNode=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastPausePlayTime=null,t.lastPauseTimeStamp=null,t.disableSeekEvt=!1,t}return __extends$6(t,e),Object.defineProperty(t,"shouldUseResumeFix",{get:function(){return uaTool.os.ios&&comTool.compareVersion(uaTool.os.version,"15.0")>=0},enumerable:!1,configurable:!0}),t.prototype.setLevel=function(t){return void 0===t&&(t=SET_LEVEL_MODE.HARD),this.clearPauseMemTime(),e.prototype.setLevel.call(this,t)},t.prototype.onVideoEventPause=function(){return this.isOriginHlsPlaying()&&(this.lastPausePlayTime=this._video.currentTime,this.lastPauseTimeStamp=Date.now()),e.prototype.onVideoEventPause.call(this)},t.prototype.onVideoEventSeeking=function(){if(this.clearPauseMemTime(),!this.disableSeekEvt)return e.prototype.onVideoEventSeeking.call(this)},t.prototype.onVideoEventSeeked=function(){this.disableSeekEvt?this.disableSeekEvt=!1:e.prototype.onVideoEventSeeked.call(this)},t.prototype.onVideoEventPlaying=function(){return t.shouldUseResumeFix&&this.lastPausePlayTime&&Date.now()-this.lastPauseTimeStamp>PAUSE_TIME_THRESHOLD&&(this.disableSeekEvt=!0,this._video.currentTime=this.lastPausePlayTime),this.clearPauseMemTime(),e.prototype.onVideoEventPlaying.call(this)},t.prototype.clearPauseMemTime=function(){this.lastPausePlayTime=null,this.lastPauseTimeStamp=null},t.prototype.isOriginHlsPlaying=function(){var e=this.currentVideoInfo.loadingUrl;return"hls"===fileExtension2VideoType(urlTool.getFileExtension(e)).toLowerCase()},__decorate$4([logMethodCall$5,__metadata$4("design:type",Function),__metadata$4("design:paramtypes",[Object]),__metadata$4("design:returntype",void 0)],t.prototype,"setLevel",null),t}(OrgVideoNode),__awaiter$3=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$3=window&&window.__generator||function(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}};function detectStream(e){return __awaiter$3(this,void 0,void 0,(function(){var t,o,r,i,n,a,s,l,c,p;return __generator$3(this,(function(d){switch(d.label){case 0:t={httpCode:-1},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,netTool.xhr({url:e,retryCount:0,responseType:"arraybuffer",range:[0,102400]})];case 2:o=d.sent(),r=o.data,p=o.target,i=o.startTimestamp,t.httpCode=p.status,n=r.byteLength/1024,a=(+new Date-i)/1e3,t.downloadSpeed="".concat(Math.floor(n/a),"kb/s");try{t.headers=p.getAllResponseHeaders()}catch(e){}return[3,4];case 3:return s=d.sent(),c=(l=s||{}).error,p=l.target,t.httpCode=null==p?void 0:p.status,t.error=c,[3,4];case 4:return[2,t]}}))}))}var __assign$4=window&&window.__assign||function(){return __assign$4=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$4.apply(this,arguments)},GUID_LEN=8,VideoInfo=function(){function e(e,t){this.playtime=0,this.currentAudioTrack=NaN,this.duration=0,this.performance={},this.startTime=0,this.state=exports.VIDEO_STATE.IDLE,this.fileSize=0,this.videoWidth=0,this.videoHeight=0,this.hasFirstPlaying=!1,this.startPts=0,this.discontinuityTimeRanges=[],this.videoFrameRate=0,this.audioTracks=[],this._logger=new Logger(t.instanceId,"VideoInfo"),this._extraVars={},this._qualityInfo={},this._uid=comTool.createGUID(GUID_LEN),this._config=e,this._playerConfig=t,this.codecs=this._config.codec?__assign$4({},this._config.codec):{video:"",audio:""},this.reset(),this._logger.log("new VideoInfo(), uid: ".concat(this.uid))}return e.prototype.toJSON=function(){return this.serializedString()},e.prototype.toString=function(){return this.serializedString()},Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qualityInfo",{get:function(){return this._qualityInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loadingUrl",{get:function(){return this._loadingUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraVars",{get:function(){return this._extraVars},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._nextBackUrlIdx=0,this._retryCount=0,this.performance={},this._loadingUrl=this._config.url,this.audioTracks=[]},e.prototype.setLoadingUrlStartTime=function(e){this._loadingUrl&&e>0&&(this._loadingUrl="".concat(this._loadingUrl.split("#t=")[0],"#t=").concat(e))},e.prototype.setDependVideoInfo=function(e){return this.startTime=e?e.startTime+e.duration:0,this._logger.log("setDependVideoInfo succ, uid/starttime: ".concat(this.uid,"/").concat(this.startTime)),!0},e.prototype.setNextBackUrl=function(){return!(!this._config.url||this._retryCount>=this._playerConfig.backupUrlsMaxRetryCount)&&(this._retryCount++,this._config.backupUrls&&this._config.backupUrls.length>0?this._nextBackUrlIdx>=this._config.backupUrls.length?(this._loadingUrl=this._config.url,this._nextBackUrlIdx=0):(this._loadingUrl=this._config.backupUrls[this._nextBackUrlIdx],this._nextBackUrlIdx++):this._loadingUrl=this._config.url,!0)},e.prototype.getRetryCount=function(){return this._retryCount},e.prototype.destroy=function(){this.extraVars.stream=null},e.prototype.serializedString=function(){var e,t;return"VideoInfo{u:".concat(this._loadingUrl,",t:").concat(this.playtime,",s:").concat(this.state,",ec:").concat((null===(e=this.error)||void 0===e?void 0:e.code)||"",",em:").concat((null===(t=this.error)||void 0===t?void 0:t.message)||"",",r:").concat(this._nextBackUrlIdx,"}")},e}(),__extends$5=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign$3=window&&window.__assign||function(){return __assign$3=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$3.apply(this,arguments)},__decorate$3=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$3=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$2=window&&window.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},__generator$2=window&&window.__generator||function(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},__spreadArray$2=window&&window.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var r,i=0,n=t.length;i<n;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},IGNORE_EVT_TYPE=[VIDEO_NODE_EVENT.TIME_UPDATE,VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE,VIDEO_NODE_EVENT.VIDEO_FRAME_RENDER],IGNORE_VIDEO_EVT=[VIDEO_EVTS.timeupdate,VIDEO_EVTS.progress,VIDEO_EVTS.frameRender],logMethodCall$4=logMethodCallDecoratorCreator("BasePlayer"),BasePlayer=function(e){function t(t){var o,r,i=e.call(this)||this;return i._firstPlaying=!1,i._hasUserGestures=!1,i._volume=1,i._playbackRate=1,i._playBlocking=!1,i.lastVideoInfo=null,i._logger=new Logger(t.instanceId,"BasePlayer"),i._config=t,i._videoInfos=[],i._curUrlIdx=-1,i._curVideoNode=null,i._preloaders=[],i._vnList=[],i._eventMap={videonode:i.videonodeEventHandler.bind(i),document:i.visibilityChangeHandler.bind(i)},i._played=!1,i.videoEvt2PlayerEvtMap=((o={})[VIDEO_NODE_EVENT.DURATION_CHANGE]=exports.PLAY_EVENT.DURATION_CHANGE,o[VIDEO_NODE_EVENT.VOLUME_CHANGE]=exports.PLAY_EVENT.VOLUME_CHANGE,o[VIDEO_NODE_EVENT.ERROR]=exports.PLAY_EVENT.ERROR,o[VIDEO_NODE_EVENT.METADATA_CHANGE]=exports.PLAY_EVENT.METADATA_CHANGE,o[VIDEO_NODE_EVENT.SETLEVEL_OVER]=exports.PLAY_EVENT.SETLEVEL_OVER,o[VIDEO_NODE_EVENT.SETLEVEL_START]=exports.PLAY_EVENT.SETLEVEL_START,o[VIDEO_NODE_EVENT.SET_LOADING]=exports.PLAY_EVENT.SET_LOADING,o[VIDEO_NODE_EVENT.STATE_CHANGE]=exports.PLAY_EVENT.STATE_CHANGE,o[VIDEO_NODE_EVENT.TIME_UPDATE]=exports.PLAY_EVENT.TIME_UPDATE,o[VIDEO_NODE_EVENT.VIDEO_BUFFER_CHANGE]=exports.PLAY_EVENT.VIDEO_BUFFER_CHANGE,o[VIDEO_NODE_EVENT.LOAD_PROGRESS]=exports.PLAY_EVENT.LOAD_PROGRESS,o[VIDEO_NODE_EVENT.FIRST_PLAYING]=exports.PLAY_EVENT.VIDEONODE_FIRST_PLAYING,o[VIDEO_NODE_EVENT.RATE_CHANGE]=exports.PLAY_EVENT.RATE_CHANGE,o[VIDEO_NODE_EVENT.RETRY]=exports.PLAY_EVENT.RETRY_BACKURL,o[VIDEO_NODE_EVENT.ELEMENT_EVTS]=exports.PLAY_EVENT.ELEMENT_EVTS,o[VIDEO_NODE_EVENT.PLAY_OVER]=exports.PLAY_EVENT.STOPED,o[VIDEO_NODE_EVENT.VIDEO_RESIZE]=exports.PLAY_EVENT.VIDEO_RESIZE,o[VIDEO_NODE_EVENT.VIDEO_FRAME_RENDER]=exports.PLAY_EVENT.VIDEO_FRAME_RENDER,o[VIDEO_NODE_EVENT.SET_AUDIO_TRACK_OVER]=exports.PLAY_EVENT.SET_AUDIO_TRACK_OVER,o[VIDEO_NODE_EVENT.SET_AUDIO_TRACK_START]=exports.PLAY_EVENT.SET_AUDIO_TRACK_START,o),i.videoEvtHandlerMap=((r={})[VIDEO_NODE_EVENT.STATE_CHANGE]=i.onVideoNodeStateChange.bind(i),r[VIDEO_NODE_EVENT.PLAY_PROMISE_CATCHED]=i.onVideoNodePlayPromiseCatched.bind(i),r[VIDEO_NODE_EVENT.FIRST_PLAYING]=i.onVideoNodeFirstPlaying.bind(i),r[VIDEO_NODE_EVENT.PLAY_OVER]=i.onVideoNodePlayOver.bind(i),r[VIDEO_NODE_EVENT.ERROR]=i.onVideoNodeError.bind(i),r),document.addEventListener("visibilitychange",i._eventMap.document),i._config.createVideoNodeWhenLoad||i.createVideoNodes(i._config.maxVideoNodeCount),i}return __extends$5(t,e),t.prototype.decideSetLevelMode=function(e){return this._vnList.length<2?SET_LEVEL_MODE.HARD:e||SET_LEVEL_MODE.SOFT},t.prototype.createVideoNode=function(e){return uaTool.os.ios?new OrgIOSVideoNode(e):new OrgVideoNode(e)},t.prototype.createVideoNodes=function(e){for(var t=0;t<e;t++){var o=this.createVideoNode(this._config);o.idx=t,o.volume=this._volume,o.playbackRate=this._playbackRate,o.videoElement instanceof HTMLElement&&(o.videoElement.dataset.idx="".concat(t)),this._vnList.push(o)}},t.prototype.createStream=function(e){return null},t.prototype.setPlayEvents=function(e,t){var o=this;e&&(t&&this.setPlayEvents(e,!1),this._logger.log("set VideoNode evts, idx=".concat(e.idx,"/value=").concat(t)),Object.keys(VIDEO_NODE_EVENT).forEach((function(r){(t?e.on:e.off).apply(e,[VIDEO_NODE_EVENT[r],o._eventMap.videonode])})))},t.prototype.videonodeEventHandler=function(e){this.logVideoNodeEvts(e);var t=!0;this.videoEvtHandlerMap[e.type]&&(t=this.videoEvtHandlerMap[e.type](e)),t&&e.type in this.videoEvt2PlayerEvtMap&&this.emit(this.videoEvt2PlayerEvtMap[e.type],e.data)},t.prototype.onVideoNodeStateChange=function(e){return e.data.new===exports.VIDEO_STATE.PAUSE&&e.data.pauseType===PAUSE_TYPE.INNER?(this._logger.log("inner pause does not emit event."),!1):(e.data.new===exports.VIDEO_STATE.PLAYING&&(this._checkPlayBlocked=!1),this.setKeepScreenAlive(e.data.new===exports.VIDEO_STATE.PLAYING),!0)},t.prototype.onVideoNodePlayPromiseCatched=function(e){return this._checkPlayBlocked&&e.data.isAutoPlayBlocked&&(this._checkPlayBlocked=!1,this.playBlocked()),!0},t.prototype.onVideoNodeFirstPlaying=function(e){return this._firstPlaying||(this.emit(exports.PLAY_EVENT.FIRST_PLAYING,{videoInfo:this.currentVideoInfo}),this._firstPlaying=!0,this._hasUserGestures=!0),!0},t.prototype.onVideoNodePlayOver=function(e){if(this._config.isPlayList||this.nextVideoInfo)this.emit(exports.PLAY_EVENT.VIDEONODE_PLAY_OVER,{videoInfo:this.currentVideoInfo}),this.checkPlayNext();else{var t=this.currentVideoInfo;this.stopInner(exports.END_STATE.NORMAL,!0,t),this.emit(exports.PLAY_EVENT.VIDEONODE_PLAY_OVER,{videoInfo:t})}return!1},t.prototype.onVideoNodeError=function(e){var t=(e.data||{}).videoInfo;return this.detectSourceOnError(t),this.stopInner(exports.END_STATE.ERROR,!0,t),!1},t.prototype.logVideoNodeEvts=function(e){var t,o;if(!(IGNORE_EVT_TYPE.includes(e.type)||e.type===VIDEO_NODE_EVENT.ELEMENT_EVTS&&IGNORE_VIDEO_EVT.includes(e.data.elementEvtType))){var r=e.data;e.type===VIDEO_NODE_EVENT.STATE_CHANGE?r="[".concat(e.data.old,"->").concat(e.data.new,"]"):e.type===VIDEO_NODE_EVENT.ELEMENT_EVTS&&(r="[elementEvtType=".concat(e.data.elementEvtType,"]")),this._logger.log("get VideoNode evt, type=".concat(e.type,"/uid=").concat(null===(o=null===(t=this._curVideoNode)||void 0===t?void 0:t.currentVideoInfo)||void 0===o?void 0:o.uid,"/data="),r)}},t.prototype.playBlocked=function(){var e=this;this._playBlocking=!0,this._triggerAutoplayPromise=null,setTimeout((function(){e.emit(exports.PLAY_EVENT.AUTOPLAY_BLOCKED,{videoInfo:e.currentVideoInfo})}),0),this.setLoading(!1)},t.prototype.setLoading=function(e){this.emit(exports.PLAY_EVENT.SET_LOADING,{show:e})},t.prototype.setKeepScreenAlive=function(e){var t=this,o=window.navigator.wakeLock;if(o)if(e){if(this.screenWakeLock)return;o.request("screen").then((function(e){t.screenWakeLock=e})).catch((function(){}))}else{if(!this.screenWakeLock)return;this.screenWakeLock.release(),this.screenWakeLock=null}},t.prototype.visibilityChangeHandler=function(){this.setKeepScreenAlive(this.state===exports.VIDEO_STATE.PLAYING)},t.prototype.captureVideo=function(e,t,o,r,i){var n,a=this.currentVideoElement;if(a){if(a instanceof HTMLVideoElement)try{var s=videoTool.captureVideo(a,{dx:e,dy:t,dw:o,dh:r});return Promise.resolve(s)}catch(e){return Promise.reject(e)}return null===(n=a.captureVideo)||void 0===n?void 0:n.call(a,e,t,o,r)}},t.prototype.triggerAutoplay=function(){var e=this;if(this._triggerAutoplayPromise)return this._triggerAutoplayPromise;this._logger.log("triggerAutoplay(), start");for(var t=[],o=this._vnList.length,r=0;r<o;r++){var i=this._vnList[r].triggerAutoplay();t.push(i)}return this._triggerAutoplayPromise=Promise.all(t),this._triggerAutoplayPromise.catch((function(t){e._logger.log("play() triggerAutoplay catched: ",t),e.playBlocked()})),this._triggerAutoplayPromise},Object.defineProperty(t.prototype,"useWorker",{get:function(){return!!this._curVideoNode&&this._curVideoNode.useWorker},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElements",{get:function(){var e;return null===(e=this._vnList)||void 0===e?void 0:e.map((function(e){return e.videoElement}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoElement",{get:function(){return this._curVideoNode?this._curVideoNode.videoElement:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoInfos",{get:function(){return this._videoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preloadVideoInfos",{get:function(){return this._preloaders.map((function(e){return e.videoInfo}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){return this._curVideoNode?this._curVideoNode.videoSize:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){return this._curVideoNode?this._curVideoNode.videoBuffered:[{start:0,end:0}]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){return this._curVideoNode?this._curVideoNode.currentVideoInfo:this.lastVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextVideoInfo",{get:function(){return this._videoInfos[this._curUrlIdx+1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfoIdx",{get:function(){return this._curVideoNode?this._videoInfos.indexOf(this._curVideoNode.currentVideoInfo):-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalVideoInfoCount",{get:function(){return this._videoInfos.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),t.prototype.resizeVideoElements=function(e){var t=this.videoElements;!e||!t||t.length<=0||(t.forEach((function(t){videoTool.resizeElement(t,e)})),this.emit(exports.PLAY_EVENT.RESIZE,e))},t.prototype.resize=function(e){this.resizeVideoElements(e)},t.prototype.hasAppended=function(e){return!!this._videoInfos.find((function(t){return compareUrlConfig(t.config,e)}))},t.prototype.hasPreloaded=function(e){return!!this.preloadVideoInfos.find((function(t){return compareUrlConfig(t.config,e)}))},t.prototype.seek=function(e){var t;return this.state!==exports.VIDEO_STATE.IDLE&&(!(e<0)&&(!!(null===(t=this._curVideoNode)||void 0===t?void 0:t.currentVideoInfo)&&this._curVideoNode.seek(e,!0)))},t.prototype.pause=function(e){this._played?this.pauseInner(e||PAUSE_TYPE.USER):this._logger.warn("pause(), player has not been played")},t.prototype.pauseInner=function(e){void 0===e&&(e=PAUSE_TYPE.INNER),this.state!==exports.VIDEO_STATE.PAUSE&&this._curVideoNode&&this._curVideoNode.pauseInner(e)},Object.defineProperty(t.prototype,"played",{get:function(){return this._played},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._curVideoNode?this._curVideoNode.duration:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){return this._curVideoNode?this._curVideoNode.playtime:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._curVideoNode?this._curVideoNode.state:exports.VIDEO_STATE.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){this._playbackRate=e;for(var t=this._vnList.length,o=0;o<t;o++)this._vnList[o].playbackRate=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=e;for(var t=this._vnList.length,o=0;o<t;o++)this._vnList[o].volume=e},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];null===(e=this._logger)||void 0===e||e.log.apply(e,t)},t.prototype.resumeInner=function(){var e;this._played&&(null===(e=this._curVideoNode)||void 0===e?void 0:e.currentVideoInfo)&&(0===this._curVideoNode.duration||this._curVideoNode.playtime<this._curVideoNode.duration)&&this._curVideoNode.videoplay()},t.prototype.appendNext=function(e){if(this._config.isPlayList)if(this._played){var t=checkUrlConfigVailed(e,this.kernelName);if(!t){var o=this._videoInfos.find((function(t){return compareUrlConfig(t.config,e)}));if(o)return this._logger.warn("appendNext(), duplicate append! uid[".concat(o.uid,"]")),!1;var r=this.preloadVideoInfos.find((function(t){return compareUrlConfig(t.config,e)}));return r||(r=new VideoInfo(e,this._config)),this.clearAllPreloadInner(r),this._videoInfos=this._videoInfos.slice(0,this._curUrlIdx+1),this._videoInfos=this._videoInfos.concat(r),this._logger.log("appendNext() succ, appendVideoInfo=",r),this.emit(exports.PLAY_EVENT.LIST_CHANGE),this.appendAfter(r),!0}this._logger.warn("appendNext(), urlconfig err=",t)}else this._logger.warn("appendNext(), player has not been played");else this._logger.warn("appendNext() only supported when [isPlayList] is true")},t.prototype.preloadNext=function(){for(var e=this,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(this._config.isPlayList)if(this.supportPreload)if(this._played){var r=checkUrlConfigVailed(t,this.kernelName);if(!r){var i=[];t.forEach((function(t){var o=e._videoInfos.findIndex((function(e){return compareUrlConfig(e.config,t)}));-1!==o&&o<=e._curUrlIdx?e._logger.warn("preloadInner() fail, because this videoInfo has been played."):-1!==o&&o>=e._curUrlIdx+1+1?e._logger.warn("preloadInner() fail, can not skip next to preload."):!e.nextVideoInfo||compareUrlConfig(e.nextVideoInfo.config,t)?-1!==e.preloadVideoInfos.findIndex((function(e){return compareUrlConfig(e.config,t)}))?e._logger.warn("preloadInner() fail, the VideoInfo has been preloaded."):e.nextVideoInfo&&compareUrlConfig(t,e.nextVideoInfo.config)?i.push(e.nextVideoInfo):i.push(new VideoInfo(t,e._config)):e._logger.warn("preloadInner() fail, the next has been appended, you only can preload next.")})),this.preloadInner.apply(this,__spreadArray$2([!1,{startTime:0,kernelName:this.kernelName}],i,!1))}}else this._logger.warn("preloadNext() fail, player has not been played.");else this._logger.warn("preloadNext() fail, browser not support preload.");else this._logger.warn("preloadNext() only supported when [isPlayList] is true")},t.prototype.preloadInner=function(e,t){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[],n=o.length;if(!(n<=0)){for(var a=0;a<n;a++)if(o[a]){this.clearPreloader(o[a]);var s=this.preparePreloader(e,o[a]);s&&(o[a].setDependVideoInfo(this.currentVideoInfo),s.load(e,this,o[a],t),i.push(s))}this._preloaders=this._preloaders.concat(i),this._logger.log("preload(), preloader's length: ",this._preloaders.length),i.length>0&&this.emit(exports.PLAY_EVENT.PRELOAD_START,{preloadVideoInfos:i.map((function(e){return e.videoInfo}))})}},t.prototype.checkPlayNext=function(){var e;this._played&&(this._logger.log("checkPlayNext(), curUrlIdx=".concat(this._curUrlIdx,"/urlLength=").concat(this._videoInfos.length,"/")+"nextStartTime: ".concat(null===(e=this.nextVideoInfo)||void 0===e?void 0:e.playtime)),this.nextVideoInfo?this.playNextInner():this._logger.log("playlist over>>>, total len: ",this._videoInfos.length))},t.prototype.playNext=function(e){this._played?this.playNextInner({isInterrupt:!0}):this._logger.warn("playNext(), player has not been played")},t.prototype.playNextInner=function(e){var t=(e||{}).isInterrupt;this._logger.log("playNextInner(), curUrlIdx=".concat(this._curUrlIdx,"/")+"urlLength=".concat(this._videoInfos.length,"/isInterrupt=").concat(t));var o=Math.abs(this.playtime-this.duration)<=this._config.interruptPlayNextMinTime;if(t&&o&&this.state===exports.VIDEO_STATE.PLAYING)this._logger.log("playNextInner(), playNext right now! return!");else if(this._curUrlIdx+1>=this._videoInfos.length)this._logger.warn("There is no next VideoInfo.");else{this._curUrlIdx+=1,this.setPlayEvents(this._curVideoNode,!1),t&&this._curVideoNode.pauseInner();var r=this._videoInfos[this._curUrlIdx];this.clearAllPreloadInner(r),t&&this.emit(exports.PLAY_EVENT.VIDEONODE_PLAY_OVER,{videoInfo:this.currentVideoInfo}),this.playInner()}},t.prototype.play=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){var o,r,i=this;return __generator$2(this,(function(n){return this.state!==exports.VIDEO_STATE.IDLE||e?(o=function(){if(!i._played&&-1===i._curUrlIdx){var e=i._videoInfos[0],t=!i.supportPreload||1!==i.findPreloadIdxByVideoInfo(e);e&&t&&(i._played=!0,i._curUrlIdx=0,i.playInner())}},r=function(){(i._logger.log("triggerAutoplay(), over"),e)?i.loadInner(e,t)&&(i.setLoading(!0),o()):i._played?i._playBlocking||videoTool.cannotDetectAutoPlayBlock()?(i._playBlocking=!1,setTimeout((function(){var e,t;(null===(t=null===(e=i._curVideoNode)||void 0===e?void 0:e.videoBuffered)||void 0===t?void 0:t.length)<=0&&i.setLoading(!0),i.resumeInner()}),0)):-1!==[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.CANPLAY,exports.VIDEO_STATE.SEEKED].indexOf(i.state)?i.resumeInner():i._logger.log("play() has been called, but cannot do nothing."):(i.setLoading(!0),o())},this._checkPlayBlocked=!0,this._vnList.length<=1||this._hasUserGestures?(this._logger.log("play(), skip triggerAutoplay()."),r()):this.triggerAutoplay().then(r).catch((function(){i._config.type===exports.PLAY_MODE.VOD&&e&&i.loadInner(e,t)})),[2]):(this._logger.warn("play(), no urlConfig when idle state"),[2])}))}))},t.prototype.load=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$2(this,(function(o){return!e||e instanceof Array&&e.length<=0?(this.clearBeforeLoad(),[2]):(this.loadInner(e,t),[2])}))}))},t.prototype.loadInner=function(e,t){var o=this;this.clearBeforeLoad();var r=checkUrlConfigVailed(e,this.kernelName);if(r)return this.emit(exports.PLAY_EVENT.ERROR,{videoInfo:{error:r}}),!1;this._config.createVideoNodeWhenLoad&&(this._vnList.forEach((function(e){return e.destroy()})),this._vnList.length=0,this.createVideoNodes(this._config.maxVideoNodeCount)),this.emit(exports.PLAY_EVENT.RESTART);var i=(t||{}).startTime,n=void 0===i?0:i;this._firstPlayTimeArg=Math.max(0,n),this._videoInfos=[].concat(e).map((function(e){return new VideoInfo(e,o._config)})),this.emit(exports.PLAY_EVENT.LIST_CHANGE);var a=this._videoInfos[0];return this.preloadInner(!0,__assign$3(__assign$3({},t),{startTime:n,kernelName:this.kernelName}),a),!0},t.prototype.clearBeforeLoad=function(){var e;null===(e=this._vnList)||void 0===e||e.forEach((function(e){videoTool.clear(e.videoElement)})),this.stopInner(this._played?exports.END_STATE.INTERRUPT:exports.END_STATE.NORMAL,this._played,this._played?this.currentVideoInfo:null)},t.prototype.checkAutoPreloadNext=function(e){var t=this.currentVideoInfo.config.autoPreloadLeftTime;t<=0||(t>=this.currentVideoInfo.duration&&this.currentVideoInfo.playtime>0||t>=e)&&this.nextVideoInfo&&-1===this.preloadVideoInfos.indexOf(this.nextVideoInfo)&&this.preloadInner(!1,{startTime:0,kernelName:this.kernelName},this.nextVideoInfo)},t.prototype.clearAllPreload=function(){this.clearAllPreloadInner()},t.prototype.clearAllPreloadInner=function(e){var t=this;!this._preloaders||this._preloaders.length<=0||this._preloaders.filter((function(t){return t.videoInfo!==e})).forEach((function(e){t.clearPreloader(e.videoInfo)}))},t.prototype.findPreloadIdxByVideoInfo=function(e){return e?this._preloaders.findIndex((function(t){return t.videoInfo===e})):-1},t.prototype.clearPreloader=function(e,t){if(this._preloaders&&!(this._preloaders.length<=0)&&e){var o=this.findPreloadIdxByVideoInfo(e);if(-1!==o)if(-1!==o)this._preloaders.splice(o,1)[0].clear(t)}},t.prototype.stop=function(e){void 0===e&&(e=exports.END_STATE.INTERRUPT),this.state!==exports.VIDEO_STATE.IDLE&&this.stopInner(e,!0)},t.prototype.stopInner=function(e,t,o){var r;void 0===e&&(e=exports.END_STATE.NORMAL),void 0===t&&(t=!1),void 0===o&&(o=null),(null===(r=this._config)||void 0===r?void 0:r.type)===exports.PLAY_MODE.VOD&&this.clearAllPreloadInner();var i=this._videoInfos;if(this._videoInfos=[],this.lastVideoInfo=this.currentVideoInfo,this._vnList)for(var n=this._vnList.length,a=0;a<n;a++)this._vnList[a].stop(),this.setPlayEvents(this._vnList[a],!1);this._curUrlIdx=-1,i&&i.forEach((function(e){e.destroy()})),this._firstPlaying=!1,this._played=!1,this._curVideoNode=null;var s=null==o?void 0:o.error,l=s?exports.END_STATE.ERROR:e;this._logger.log("stopInner(), endState=".concat(l)),t&&(this.emit(exports.PLAY_EVENT.STOPED,{videoInfo:o,isUserStop:e===exports.END_STATE.INTERRUPT,endState:l}),s&&this.emit(exports.PLAY_EVENT.ERROR,{videoInfo:o}))},t.prototype.checkSetLevelError=function(e){return this._played?e?this.currentVideoInfo?this.currentVideoInfo.playtime<=0?"播放未开始":this._config.type===exports.PLAY_MODE.VOD&&this.currentVideoInfo.playtime+1>=this.currentVideoInfo.duration&&this.currentVideoInfo.duration!==1/0?"播放即将结束":e===this.currentVideoInfo.loadingUrl?"切换的视频地址没有变化":null:"找不到当前播放信息":"切换的视频地址为空":"播放未开始"},t.prototype.setAudioTrack=function(e){return Promise.reject(AUDIO_TRACK_ERROR_MSG.NOT_SUPPORT)},t.prototype.getAudioTrackList=function(){return this.currentVideoInfo?this.currentVideoInfo.audioTracks:[]},t.prototype.getCurrentAudioTrack=function(){return this.currentVideoInfo?this.currentVideoInfo.currentAudioTrack:NaN},t.prototype.setLevel=function(e,t,o){var r;"string"==typeof e?r=e:(r=e.url,t=e.backupUrls,o=e);var i=this.checkSetLevelError(r);return i?(this._logger.warn("setLevel(), ".concat(i)),Promise.reject(new Error(i))):(this._urlBeforeSetLevel={url:r,backupUrls:t},this.currentVideoInfo.config.url=r,t&&(this.currentVideoInfo.config.backupUrls=t),o&&(Object.assign(this._urlBeforeSetLevel,o),Object.assign(this.currentVideoInfo.config,o)),this.currentVideoInfo.reset(),this.setLevelInner(this.currentVideoInfo.config))},t.prototype.setCurVideoNode=function(e,t){void 0===t&&(t=!1),(this._curVideoNode!==e||t)&&(this._curVideoNode&&(this._curVideoNode.onAccurateTimeupdate=null,this.setPlayEvents(this._curVideoNode,!1)),e&&(this._curVideoNode=e,this._curVideoNode.onAccurateTimeupdate=this.checkAccuratePlaytime.bind(this),this.setPlayEvents(this._curVideoNode,!0)))},t.prototype.detectSourceOnError=function(e){var t=this,o=e||{},r=o.loadingUrl,i=o.uid;r?detectStream(r).then((function(e){t._logger.error("detectSourceOnError=".concat(jsonTool.safelyStringify(__assign$3({uid:i},e))))})).catch((function(e){t._logger.error("detectSourceOnError err",null==e?void 0:e.message)})):this._logger.error("detectSourceOnError, url=null")},t.prototype.destroy=function(){if(this.stopInner(),this._vnList)for(var e=this._vnList.length,t=0;t<e;t++)this._vnList[t].destroy();this._preloaders&&(this._preloaders.forEach((function(e){e.clear()})),this._preloaders=null),document.removeEventListener("visibilitychange",this._eventMap.document),this.removeAllListeners(),this.setKeepScreenAlive(!1),this._videoInfos=null,this._curVideoNode=null,this._vnList=null,this._eventMap=null,this.lastVideoInfo=null},__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"playBlocked",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"resizeVideoElements",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Number]),__metadata$3("design:returntype",void 0)],t.prototype,"seek",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"resumeInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"appendNext",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"preloadNext",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Boolean,Object,Object]),__metadata$3("design:returntype",void 0)],t.prototype,"preloadInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"checkPlayNext",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"playNext",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",void 0)],t.prototype,"playNextInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object,Object]),__metadata$3("design:returntype",Promise)],t.prototype,"play",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object,Object]),__metadata$3("design:returntype",Promise)],t.prototype,"load",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[String]),__metadata$3("design:returntype",void 0)],t.prototype,"stop",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[String,Object,Object]),__metadata$3("design:returntype",void 0)],t.prototype,"stopInner",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object]),__metadata$3("design:returntype",Promise)],t.prototype,"setAudioTrack",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[Object,Array,Object]),__metadata$3("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate$3([logMethodCall$4,__metadata$3("design:type",Function),__metadata$3("design:paramtypes",[]),__metadata$3("design:returntype",void 0)],t.prototype,"destroy",null),t}(s$1),__assign$2=window&&window.__assign||function(){return __assign$2=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$2.apply(this,arguments)},defaultOriginKernelConfig={maxVideoNodeCount:1,advanceEndTime:uaTool.browser.x5?.1:0,prePlayNextTime:uaTool.browser.x5?.2:0};function mergeKernelConfig(e){return __assign$2(__assign$2({},e),{originKernelConfig:__assign$2(__assign$2({},defaultOriginKernelConfig),e.originKernelConfig)})}var __decorate$2=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$2=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$3=logMethodCallDecoratorCreator("OrgPreLoader"),OrgPreLoader=function(){function e(e){var t;this.playerConfig=e,this._defer=new SimpleDefer,this._logger=new Logger(e.instanceId,"OrgPreLoader"),this._evtMaps=((t={})[VIDEO_NODE_EVENT.STATE_CHANGE]=this.firstLoadStateChangeHandler.bind(this),t[VIDEO_NODE_EVENT.ERROR]=this.errorHandler.bind(this),t)}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._defer.promise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoInfo",{get:function(){return this._videoInfo},enumerable:!1,configurable:!0}),e.prototype.getVideoNode=function(){var e;return null===(e=this._videoInfo)||void 0===e?void 0:e.extraVars.preloadVideoNode},e.prototype.errorHandler=function(e){this.preloadFail(e.data.videoInfo.error)},e.prototype.firstLoadStateChangeHandler=function(e){e.data.new===exports.VIDEO_STATE.CANPLAY&&this.preloadSucc()},e.prototype.preloadSucc=function(){this._logger.log("preload url ready>>>>>> uid=".concat(this._videoInfo.uid)),this.clearInner(!0),this._evtDispatcher.emit(exports.PLAY_EVENT.PRELOAD_VIDEONODE_OVER,{videoInfo:this._videoInfo}),this._defer.resolve()},e.prototype.preloadFail=function(e){this._logger.log("preload url fail>>>>>> uid: ".concat(this._videoInfo.uid)),this.clearInner(),this._evtDispatcher.emit(exports.PLAY_EVENT.PRELOAD_VIDEONODE_ERROR,{videoInfo:this._videoInfo}),this._videoInfo.error=e,this._defer.reject(e)},e.prototype.setVideoNodeEvents=function(e){var t=this,o=this.getVideoNode();Object.keys(this._evtMaps).forEach((function(r){e?o.on(r,t._evtMaps[r]):o.off(r,t._evtMaps[r])}))},e.prototype.load=function(e,t,o,r){this._videoInfo=o,this._evtDispatcher=t,this.setVideoNodeEvents(!0),this._logger.log("load(), isFirstLoad=".concat(e)),this.getVideoNode().load(o,r)},e.prototype.clearInner=function(e,t){if(this._videoInfo){var o=this.getVideoNode();o&&(this._logger.log("clear(), uid=".concat(this._videoInfo.uid,"/keep=").concat(e)),this.setVideoNodeEvents(!1),e||(this._videoInfo.extraVars.preloadVideoNode=null,o.stop()),t&&this._evtDispatcher.emit(exports.PLAY_EVENT.PRELOAD_VIDEONODE_CLEAR,{videoInfo:this._videoInfo}))}},e.prototype.clear=function(e){this.clearInner(e,!0)},__decorate$2([logMethodCall$3,__metadata$2("design:type",Function),__metadata$2("design:paramtypes",[Boolean,s$1,Object,Object]),__metadata$2("design:returntype",void 0)],e.prototype,"load",null),__decorate$2([logMethodCall$3,__metadata$2("design:type",Function),__metadata$2("design:paramtypes",[Boolean]),__metadata$2("design:returntype",void 0)],e.prototype,"clear",null),e}(),__extends$4=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__decorate$1=window&&window.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a},__metadata$1=window&&window.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},logMethodCall$2=logMethodCallDecoratorCreator("MultiPlayer"),MultiPlayer=function(e){function t(t){var o,r=e.call(this,mergeKernelConfig(t))||this;return r._needHideVideoNode=null,r._videonodeEventMap=((o={})[VIDEO_NODE_EVENT.STATE_CHANGE]=r.onCurVideoNodeStateChange.bind(r),o),r}return __extends$4(t,e),Object.defineProperty(t,"canPlayType",{get:function(){return videoTool.supportVideoFormat()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){return videoTool.supportSameTimePlay()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kernelName",{get:function(){return exports.KERNEL_NAME.ORIGIN},enumerable:!1,configurable:!0}),t.prototype.seek=function(t){return!this.getLevelSwitching()&&e.prototype.seek.call(this,t)},t.prototype.createVideoNodes=function(t){e.prototype.createVideoNodes.call(this,t);for(var o=0;o<this._vnList.length;o++){var r=this._vnList[o];0===o?this._firstVideoNode=r:this.visibleVideoNode(r,!1)}},t.prototype.videonodeEventHandler=function(t){this._videonodeEventMap[t.type]&&this._videonodeEventMap[t.type](t),e.prototype.videonodeEventHandler.call(this,t)},t.prototype.onCurVideoNodeStateChange=function(e){if(e.data.new===exports.VIDEO_STATE.PLAYING&&(this.switchVideoNode(),!this.currentVideoInfo.extraVars.isStartPlay)){this.currentVideoInfo.extraVars.isStartPlay=!0;var t=this.currentVideoInfo?this.currentVideoInfo.uid:null;this._logger.log("videoNodeStartPlay: uid[".concat(t,"]")),this.emit(exports.PLAY_EVENT.VIDEONODE_START_PLAY,{videoInfo:this.currentVideoInfo})}},t.prototype.onVideoNodeStateChange=function(t){return!(this.getLevelSwitching()&&!VALID_STATE_IN_LEVEL_SWITCHING.includes(t.data.new))&&e.prototype.onVideoNodeStateChange.call(this,t)},t.prototype.pauseInner=function(t){void 0===t&&(t=PAUSE_TYPE.INNER),this._prePlayNext?this._logger.warn("pause when preplaynext, return!!"):e.prototype.pauseInner.call(this,t)},t.prototype.resumeInner=function(){this.getLevelSwitching()?this._setLevelVideoNode.play():e.prototype.resumeInner.call(this)},t.prototype.loadInner=function(t,o){for(var r,i=(null===(r=this._vnList)||void 0===r?void 0:r.length)||0,n=0;n<i;n++)this.visibleVideoNode(this._vnList[n],!1);return e.prototype.loadInner.call(this,t,o)},t.prototype.playInner=function(e){var t=this;if(this.getLevelSwitching())return this._setLevelVideoNode.play(),void this._logger.log("play(), setlevel");if(this._videoInfos.length<=0||!this._videoInfos[this._curUrlIdx])this._logger.warn("play(), !videoInfo");else{var o=this._videoInfos[this._curUrlIdx],r=this._curVideoNode?this._curVideoNode.state:exports.VIDEO_STATE.IDLE,i=this.findPreloadIdxByVideoInfo(o),n=function(n){var a,s,l;t._logger.log("playInner(), playImpl(), preloadSucc=".concat(n));var c,p=!1;((c=-1!==i?null===(s=null===(a=t._preloaders[i])||void 0===a?void 0:a.videoInfo)||void 0===s?void 0:s.extraVars.preloadVideoNode:null)||(c=t.getIdleVideoNode()),!c&&t._curVideoNode&&t._curVideoNode.state===exports.VIDEO_STATE.IDLE&&(c=t._curVideoNode,p=!0),c||t._logger.warn("can not find idle videonode!"),t.setCurVideoNode(c,p),-1!==i)&&t._preloaders.splice(i,1)[0].clear(!0);t._needHideVideoNode?t._needHideVideoNode===t._curVideoNode?(t.visibleVideoNode(t._curVideoNode,!0),t._logger.log("visibleVideoNode, need==current")):n&&t.switchVideoNode():(t.visibleVideoNode(t._curVideoNode,!0),t._logger.log("visibleVideoNode, null need")),t._curVideoNode.state!==exports.VIDEO_STATE.PLAYING&&t._curVideoNode.play(o,{startTime:e}),t.emit(exports.PLAY_EVENT.VIDEONODE_CHANGE,{videoInfo:t.currentVideoInfo}),n&&(0!==t._videoInfos.indexOf(t.currentVideoInfo)&&(t.emit(exports.PLAY_EVENT.DURATION_CHANGE,{videoInfo:t.currentVideoInfo}),t.emit(exports.PLAY_EVENT.STATE_CHANGE,{videoInfo:t.currentVideoInfo,new:t._curVideoNode.state,old:r})),t.currentVideoInfo.extraVars.isStartPlay||(t.currentVideoInfo.extraVars.isStartPlay=!0,t._logger.log("videoNodeStartPlay: uid[".concat(t.currentVideoInfo.uid,"]")),t.emit(exports.PLAY_EVENT.VIDEONODE_START_PLAY,{videoInfo:t.currentVideoInfo}))),t._logger.log("playInner(), playImpl(), uid=".concat(null===(l=t.currentVideoInfo)||void 0===l?void 0:l.uid,"/")+"urlIdx=".concat(t._curUrlIdx,"/state=").concat(t._curVideoNode.state))},a=0;-1!==i?(o.hasFirstPlaying&&(a=window.setTimeout((function(){t.emit(exports.PLAY_EVENT.STATE_CHANGE,{videoInfo:o,new:exports.VIDEO_STATE.BUFFERING,old:r})}),200)),this._preloaders[i].promise.then((function(){clearTimeout(a),t._logger.log("play(), preloadVideoNode succ, uid=".concat(o.uid)),n(!0)})).catch((function(e){t._logger.log("play(), preloadVideoNode error, uid=".concat(o.uid,"/error="),e),e.code in ERROR_CODE&&(clearTimeout(a),o.error=e,t.stopInner(exports.END_STATE.ERROR,!0,o))}))):o.error?(this._logger.log("play(), got preload error"),this.stopInner(exports.END_STATE.ERROR,!0,o)):n(!1)}},t.prototype.visibleVideoNode=function(e,t){var o;e&&e.videoElement&&(this.setVideoElementState(e.videoElement,t),this._logger.log(">>>visibleVideoNode<<<, value=".concat(t,"/uid=").concat(null===(o=e.currentVideoInfo)||void 0===o?void 0:o.uid)))},t.prototype.setVideoElementState=function(e,t){var o=t?this._volume:0;e.volume!==o&&(e.volume=o);var r=this._volume<=0||!t;e.muted!==r&&(e.muted=r),domTool.css(e,"zIndex",t?"0":"-1"),domTool.css(e,"visibility",t?"inherit":"hidden")},t.prototype.switchVideoNode=function(){if(this._needHideVideoNode&&this._curVideoNode!==this._needHideVideoNode){this._logger.log(">>>>>switchVideoNode<<<<<"),this.visibleVideoNode(this._curVideoNode,!0);var e=this._needHideVideoNode;this.visibleVideoNode(e,!1),e&&e.stop(),this._needHideVideoNode=null}},t.prototype.playNextInner=function(t){this._needHideVideoNode=this._curVideoNode,this._prePlayNext=!1,e.prototype.playNextInner.call(this,t)},t.prototype.appendAfter=function(e){var t=!this._curVideoNode||this._curVideoNode.state===exports.VIDEO_STATE.IDLE;this._played&&this._curUrlIdx+1===this._videoInfos.indexOf(e)&&t&&this.playNextInner()},t.prototype.preparePreloader=function(e,t){this._logger.log("preparePreloader(), isFirstLoad=",e);var o=this.getIdleVideoNode();return o?(t.extraVars.preloadVideoNode=o,e&&(this.setCurVideoNode(o),this.visibleVideoNode(o,!0)),new OrgPreLoader(this._config)):null},t.prototype.getIdleVideoNode=function(){if(this._firstVideoNode){var e=this._firstVideoNode;return this._firstVideoNode=null,e}for(var t=null,o=this._vnList.length,r=0;r<o;r++)if(this._vnList[r].state===exports.VIDEO_STATE.IDLE&&this._vnList[r]!==this._curVideoNode){t=this._vnList.splice(r,1)[0];break}return t&&this._vnList.push(t),t},t.prototype.getLevelSwitching=function(){return!!this._setLevelVideoNode},t.prototype.setLevelInner=function(e){var t=this,o=this.decideSetLevelMode(null==e?void 0:e.setLevelMode);if(this._logger.log("setLevelMode=".concat(o)),o===SET_LEVEL_MODE.HARD||o===SET_LEVEL_MODE.SMOOTH)return this._curVideoNode.setLevel(o);var r=new SimpleDefer,i=this.currentVideoInfo;this._logger.log("setLevelInner(), uid: ".concat(i.uid)),this.pauseInner(),this.setPlayEvents(this._curVideoNode,!1),this.emit(exports.PLAY_EVENT.SETLEVEL_START,{videoInfo:i,mode:SET_LEVEL_MODE.SMOOTH}),this.setLoading(!0);var n=this._curVideoNode.playtime,a=this.getIdleVideoNode();a?this.visibleVideoNode(a,!1):(this._curVideoNode.stop(),a=this._curVideoNode),i.extraVars.isLoadstarted=!1,this._setLevelVideoNode=a,this._setLevelVideoNode.setLevelEvtMap={};var s=this._curVideoNode;this.setCurVideoNode(a,!0);return a.setLevelEvtMap[VIDEO_NODE_EVENT.STATE_CHANGE]=function(e){e.data.new===exports.VIDEO_STATE.PLAYING&&(t._logger.log("setLevel succ>>>>>> uid: ".concat(i.uid),e),t.clearSetLevelThings(!0),t.switchVideoNodeWhenSetLevelSucc(s),r.resolve(),t.emit(exports.PLAY_EVENT.SETLEVEL_OVER,{videoInfo:i}),t.setLoading(!1))},a.setLevelEvtMap[VIDEO_NODE_EVENT.ERROR]=function(e){var o;t._logger.log("setLevel fail>>>>>> uid: ".concat(i.uid),e),t.clearSetLevelThings(),t._logger.log(">>>>>rollbackLevelVideoNode<<<<<"),t._urlBeforeSetLevel&&(Object.assign(t.currentVideoInfo.config,t._urlBeforeSetLevel),t.currentVideoInfo.reset(),t._urlBeforeSetLevel=null),t.setPlayEvents(t._curVideoNode,!0),t.resumeInner(),r.reject(new Error("setLevel failed, ".concat(null===(o=i.error)||void 0===o?void 0:o.message))),t.emit(exports.PLAY_EVENT.SETLEVEL_OVER,{videoInfo:i,fail:!0}),t.setLoading(!1)},a.on(VIDEO_NODE_EVENT.STATE_CHANGE,a.setLevelEvtMap[VIDEO_NODE_EVENT.STATE_CHANGE]),a.on(VIDEO_NODE_EVENT.ERROR,a.setLevelEvtMap[VIDEO_NODE_EVENT.ERROR]),a.play(i,{startTime:n}),r.promise},t.prototype.switchVideoNodeWhenSetLevelSucc=function(e){this._logger.log(">>>>>switchLevelVideoNode<<<<<"),e===this._curVideoNode?this.visibleVideoNode(this._curVideoNode,!0):(this.visibleVideoNode(this._curVideoNode,!0),this.visibleVideoNode(e,!1),null==e||e.stop())},t.prototype.clearSetLevelThings=function(e){if(this.getLevelSwitching()){var t=this._setLevelVideoNode;t.setLevelEvtMap&&(Object.keys(t.setLevelEvtMap).forEach((function(e){t.off(e,t.setLevelEvtMap[e])})),t.setLevelEvtMap=null),e||t.stop(),this.clearAllPreloadInner(),this._setLevelVideoNode=null}},t.prototype.checkAccuratePlaytime=function(e,t){var o,r,i=this._config.originKernelConfig.prePlayNextTime,n=Math.abs(t-e);if(i>0&&n<i&&!this._prePlayNext){this._prePlayNext=!0;var a=this.findPreloadIdxByVideoInfo(this.nextVideoInfo);if(this.nextVideoInfo&&-1!==a){var s=null===(r=null===(o=this._preloaders[a])||void 0===o?void 0:o.videoInfo)||void 0===r?void 0:r.extraVars.preloadVideoNode;s&&(this._logger.log("preplay next!! idx/state: ".concat(s.idx,"/").concat(s.state)),s.play())}}this.checkAutoPreloadNext(n)},t.prototype.stopInner=function(t,o,r){void 0===t&&(t=exports.END_STATE.NORMAL),void 0===o&&(o=!1),void 0===r&&(r=null),this._firstVideoNode=null,this._prePlayNext=!1,this.clearSetLevelThings(!0),e.prototype.stopInner.call(this,t,o,r)},t.prototype.destroy=function(){this._needHideVideoNode=null,this._setLevelVideoNode=null,this._firstVideoNode=null;var t=this.videoElements;e.prototype.destroy.call(this),t.forEach((function(e){e instanceof HTMLVideoElement&&(e.volume=1,e.muted=!1,domTool.css(e,{zIndex:"0",visibility:"inherit"}),e.dataset.idx="0")}))},t.isEnvSupport=!0,__decorate$1([logMethodCall$2,__metadata$1("design:type",Function),__metadata$1("design:paramtypes",[Number]),__metadata$1("design:returntype",void 0)],t.prototype,"playInner",null),__decorate$1([logMethodCall$2,__metadata$1("design:type",Function),__metadata$1("design:paramtypes",[]),__metadata$1("design:returntype",void 0)],t.prototype,"switchVideoNode",null),t}(BasePlayer),__extends$3=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),BaseLivePlayer=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$3(t,e),t.prototype.playInner=function(e){var t=this._videoInfos[0];this.setPlayEvents(this._curVideoNode,!0),this._curVideoNode.play(t),this.emit(exports.PLAY_EVENT.VIDEONODE_CHANGE,{videoInfo:t})},t.prototype.resumeInner=function(){var e;this._played&&(null===(e=this._curVideoNode)||void 0===e?void 0:e.currentVideoInfo)&&this._curVideoNode.videoplay()},t.prototype.loadInner=function(t,o){return!!e.prototype.loadInner.call(this,t,o)&&(this.setCurVideoNode(this._vnList[0]),this._curVideoNode.load(this._videoInfos[0]),!0)},t.prototype.appendAfter=function(e){},t.prototype.checkAccuratePlaytime=function(e,t){},t.prototype.preparePreloader=function(e,t){return null},t.prototype.getIdleVideoNode=function(){return this._vnList[0]},t.prototype.setLevelInner=function(e){return this._curVideoNode.setLevel(e.setLevelMode)},t.prototype.playBlocked=function(){e.prototype.playBlocked.call(this),this.pause()},Object.defineProperty(t.prototype,"supportPreload",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextVideoInfo",{get:function(){return this.currentVideoInfo},enumerable:!1,configurable:!0}),t}(BasePlayer);["seek","hasAppended","hasPreloaded","playNext","appendNext","preloadNext","clearAllPreload","appendAfter","checkPlayNext","playNextInner","checkAutoPreloadNext","clearAllPreloadInner"].forEach((function(e){BaseLivePlayer.prototype[e]=function(){console.warn("[thumbplayer] ".concat(e,"() is not support due to live stream"))}}));var __extends$2=window&&window.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),LivePlayer=function(e){function t(t){return e.call(this,mergeKernelConfig(t))||this}return __extends$2(t,e),Object.defineProperty(t.prototype,"kernelName",{get:function(){return exports.KERNEL_NAME.ORIGIN},enumerable:!1,configurable:!0}),t}(BaseLivePlayer),OrgPlayer=function(){function e(e){return e.type===exports.PLAY_MODE.LIVE?new LivePlayer(e):new MultiPlayer(e)}return Object.defineProperty(e,"canPlayType",{get:function(){return videoTool.supportVideoFormat()},enumerable:!1,configurable:!0}),e.isEnvSupport=!0,e.VERSION=VERSION$3,e.BUILD_TIME=BUILD_TIME$2,e}(),kernelEvtBus=new s$1,ThumbPlayerCore$1=Object.freeze({__proto__:null,MultiPlayer:MultiPlayer,OrgPlayer:OrgPlayer,OrgVideoNode:OrgVideoNode,OrgPreloader:OrgPreLoader,originDefaultConfig:defaultOriginKernelConfig,VideoInfo:VideoInfo,BaseVideoNode:BaseVideoNode,BasePlayer:BasePlayer,BaseLivePlayer:BaseLivePlayer,defaultPlayerConfig:defaultPlayerConfig,EvtEmitter:s$1,SimpleDefer:SimpleDefer,get DrmKeySystems(){return KeySystems},KernelFactory:KernelFactory$1,get KERNEL_NAME(){return exports.KERNEL_NAME},KernelProxy:KernelProxy,kernelEvtBus:kernelEvtBus,get SET_LEVEL_MODE(){return SET_LEVEL_MODE},get PLAY_MODE(){return exports.PLAY_MODE},CAN_PLAY_ALL:CAN_PLAY_ALL,VIDEO_CONTAINER_CLASS:VIDEO_CONTAINER_CLASS,get END_STATE(){return exports.END_STATE},get VIDEO_READY_STATE(){return VIDEO_READY_STATE},get VIDEO_EVTS(){return VIDEO_EVTS},get VIDEO_STATE(){return exports.VIDEO_STATE},get ERROR_CODE(){return ERROR_CODE},VIDEO_ELEMENT_ERROR:VIDEO_ELEMENT_ERROR,get ERROR_MSG(){return ERROR_MSG},get PLAY_EVENT(){return exports.PLAY_EVENT},get VIDEO_NODE_EVENT(){return VIDEO_NODE_EVENT},get MSE_EVENTS(){return MSE_EVENTS},get PAUSE_TYPE(){return PAUSE_TYPE},get PLAYER_LOG_LEVEL(){return PLAYER_LOG_LEVEL},get PRELOAD_TYPE(){return exports.PRELOAD_TYPE},get CODEC(){return CODEC},get VIDEO_CODEC(){return exports.VIDEO_CODEC},get AUDIO_CODEC(){return exports.AUDIO_CODEC},get CONTAINER_FORMAT(){return exports.CONTAINER_FORMAT},get HDR_CAPABILITY(){return HDR_CAPABILITY},get VIDEO_ELEMENT_STATE(){return VIDEO_ELEMENT_STATE},CDN_PATH_PREFIX:CDN_PATH_PREFIX,get CACHE_SIZE_KEY(){return CACHE_SIZE_KEY},get AUDIO_TRACK_ERROR_MSG(){return AUDIO_TRACK_ERROR_MSG},commonTool:comTool,uaTool:uaTool,logTool:logtool,logMethodCallDecoratorCreator:logMethodCallDecoratorCreator,logMethodCallDecoratorCreater:logMethodCallDecoratorCreator,Logger:Logger,enableConsoleOutput:enableConsoleOutput,get LogMode(){return LogMode},dumpLog:dumpLog,cookieTool:cookieTool,lsTool:lsTool,urlTool:urlTool,domTool:domTool,netTool:netTool,videoTool:videoTool,stringTool:stringTool,jsonTool:jsonTool,TaskLoop:TaskLoop,get LoopMode(){return LoopMode},CHANNEL:CHANNEL$1,BUILD_TIME:BUILD_TIME$2,VERSION:VERSION$3,LOCAL_DEV:LOCAL_DEV});KernelFactory$1.registerKernel(exports.KERNEL_NAME.ORIGIN,OrgPlayer),window.ThumbPlayerCore=ThumbPlayerCore$1;var ThumbPlayerCore=Object.freeze({__proto__:null,MultiPlayer:MultiPlayer,OrgPlayer:OrgPlayer,OrgVideoNode:OrgVideoNode,OrgPreloader:OrgPreLoader,originDefaultConfig:defaultOriginKernelConfig,VideoInfo:VideoInfo,BaseVideoNode:BaseVideoNode,BasePlayer:BasePlayer,BaseLivePlayer:BaseLivePlayer,defaultPlayerConfig:defaultPlayerConfig,EvtEmitter:s$1,SimpleDefer:SimpleDefer,get DrmKeySystems(){return KeySystems},KernelFactory:KernelFactory$1,get KERNEL_NAME(){return exports.KERNEL_NAME},KernelProxy:KernelProxy,kernelEvtBus:kernelEvtBus,get SET_LEVEL_MODE(){return SET_LEVEL_MODE},get PLAY_MODE(){return exports.PLAY_MODE},CAN_PLAY_ALL:CAN_PLAY_ALL,VIDEO_CONTAINER_CLASS:VIDEO_CONTAINER_CLASS,get END_STATE(){return exports.END_STATE},get VIDEO_READY_STATE(){return VIDEO_READY_STATE},get VIDEO_EVTS(){return VIDEO_EVTS},get VIDEO_STATE(){return exports.VIDEO_STATE},get ERROR_CODE(){return ERROR_CODE},VIDEO_ELEMENT_ERROR:VIDEO_ELEMENT_ERROR,get ERROR_MSG(){return ERROR_MSG},get PLAY_EVENT(){return exports.PLAY_EVENT},get VIDEO_NODE_EVENT(){return VIDEO_NODE_EVENT},get MSE_EVENTS(){return MSE_EVENTS},get PAUSE_TYPE(){return PAUSE_TYPE},get PLAYER_LOG_LEVEL(){return PLAYER_LOG_LEVEL},get PRELOAD_TYPE(){return exports.PRELOAD_TYPE},get CODEC(){return CODEC},get VIDEO_CODEC(){return exports.VIDEO_CODEC},get AUDIO_CODEC(){return exports.AUDIO_CODEC},get CONTAINER_FORMAT(){return exports.CONTAINER_FORMAT},get HDR_CAPABILITY(){return HDR_CAPABILITY},get VIDEO_ELEMENT_STATE(){return VIDEO_ELEMENT_STATE},CDN_PATH_PREFIX:CDN_PATH_PREFIX,get CACHE_SIZE_KEY(){return CACHE_SIZE_KEY},get AUDIO_TRACK_ERROR_MSG(){return AUDIO_TRACK_ERROR_MSG},commonTool:comTool,uaTool:uaTool,logTool:logtool,logMethodCallDecoratorCreator:logMethodCallDecoratorCreator,logMethodCallDecoratorCreater:logMethodCallDecoratorCreator,Logger:Logger,enableConsoleOutput:enableConsoleOutput,get LogMode(){return LogMode},dumpLog:dumpLog,cookieTool:cookieTool,lsTool:lsTool,urlTool:urlTool,domTool:domTool,netTool:netTool,videoTool:videoTool,stringTool:stringTool,jsonTool:jsonTool,TaskLoop:TaskLoop,get LoopMode(){return LoopMode},CHANNEL:CHANNEL$1,BUILD_TIME:BUILD_TIME$2,VERSION:VERSION$3,LOCAL_DEV:LOCAL_DEV}),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},sha256={exports:{}};(function(module){(function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(o){return new Sha256(t,!0).update(o)[e]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var o=0;o<OUTPUT_TYPES.length;++o){var r=OUTPUT_TYPES[o];t[r]=createOutputMethod(r,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,t){return function(o,r){return new HmacSha256(o,t,!0).update(r)[e]()}},createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,o){return t.create(e).update(o)};for(var o=0;o<OUTPUT_TYPES.length;++o){var r=OUTPUT_TYPES[o];t[r]=createHmacOutputMethod(r,e)}return t};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,o){var r,i=typeof e;if("string"===i){var n,a=[],s=e.length,l=0;for(r=0;r<s;++r)(n=e.charCodeAt(r))<128?a[l++]=n:n<2048?(a[l++]=192|n>>6,a[l++]=128|63&n):n<55296||n>=57344?(a[l++]=224|n>>12,a[l++]=128|n>>6&63,a[l++]=128|63&n):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++r)),a[l++]=240|n>>18,a[l++]=128|n>>12&63,a[l++]=128|n>>6&63,a[l++]=128|63&n);e=a}else{if("object"!==i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var c=[],p=[];for(r=0;r<64;++r){var d=e[r]||0;c[r]=92^d,p[r]=54^d}Sha256.call(this,t,o),this.update(p),this.oKeyPad=c,this.inner=!0,this.sharedMemory=o}Sha256.prototype.update=function(e){if(!this.finalized){var t,o=typeof e;if("string"!==o){if("object"!==o)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var r,i,n=0,a=e.length,s=this.blocks;n<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(i=this.start;n<a&&i<64;++n)s[i>>2]|=e[n]<<SHIFT[3&i++];else for(i=this.start;n<a&&i<64;++n)(r=e.charCodeAt(n))<128?s[i>>2]|=r<<SHIFT[3&i++]:r<2048?(s[i>>2]|=(192|r>>6)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]):r<55296||r>=57344?(s[i>>2]|=(224|r>>12)<<SHIFT[3&i++],s[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),s[i>>2]|=(240|r>>18)<<SHIFT[3&i++],s[i>>2]|=(128|r>>12&63)<<SHIFT[3&i++],s[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=s[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,o,r,i,n,a,s,l,c=this.h0,p=this.h1,d=this.h2,u=this.h3,A=this.h4,_=this.h5,E=this.h6,g=this.h7,f=this.blocks;for(e=16;e<64;++e)t=((i=f[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,o=((i=f[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,f[e]=f[e-16]+t+f[e-7]+o<<0;for(l=p&d,e=0;e<64;e+=4)this.first?(this.is224?(n=300032,g=(i=f[0]-1413257819)-150054599<<0,u=i+24177077<<0):(n=704751109,g=(i=f[0]-210244248)-1521486534<<0,u=i+143694565<<0),this.first=!1):(t=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),r=(n=c&p)^c&d^l,g=u+(i=g+(o=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&_^~A&E)+K[e]+f[e])<<0,u=i+(t+r)<<0),t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),r=(a=u&c)^u&p^n,E=d+(i=E+(o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&A^~g&_)+K[e+1]+f[e+1])<<0,t=((d=i+(t+r)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),r=(s=d&u)^d&c^a,_=p+(i=_+(o=(E>>>6|E<<26)^(E>>>11|E<<21)^(E>>>25|E<<7))+(E&g^~E&A)+K[e+2]+f[e+2])<<0,t=((p=i+(t+r)<<0)>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),r=(l=p&d)^p&u^s,A=c+(i=A+(o=(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&E^~_&g)+K[e+3]+f[e+3])<<0,c=i+(t+r)<<0;this.h0=this.h0+c<<0,this.h1=this.h1+p<<0,this.h2=this.h2+d<<0,this.h3=this.h3+u<<0,this.h4=this.h4+A<<0,this.h5=this.h5+_<<0,this.h6=this.h6+E<<0,this.h7=this.h7+g<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,o=this.h2,r=this.h3,i=this.h4,n=this.h5,a=this.h6,s=this.h7,l=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(l+=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]),l},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,o=this.h2,r=this.h3,i=this.h4,n=this.h5,a=this.h6,s=this.h7,l=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,o>>24&255,o>>16&255,o>>8&255,255&o,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,n>>24&255,n>>16&255,n>>8&255,255&n,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||l.push(s>>24&255,s>>16&255,s>>8&255,255&s),l},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256);var adPluginMap={};function setAdPlugin(e,t){adPluginMap[e]=t}function getAdPlugin(e){return adPluginMap[e]}var AdPluginName="__thumbplayer-ad",AD_TYPE,ErrorCode,ErrorMsg,H5_EXT_EVENT,H5_PLAY_EVENT;function isPreOrPostAd(e){return-1!==[exports.AD_TYPE.PRE,exports.AD_TYPE.POST].indexOf(e.adType)}exports.AD_TYPE=void 0,AD_TYPE=exports.AD_TYPE||(exports.AD_TYPE={}),AD_TYPE.PRE="preAd",AD_TYPE.ZT="ZT",AD_TYPE.POST="postAd",exports.ErrorCode=void 0,ErrorCode=exports.ErrorCode||(exports.ErrorCode={}),ErrorCode.SUC="0",ErrorCode.UNKNOWN="70040000",ErrorCode.AD_END_DEFAULT_FAIL="70040002",ErrorCode.AD_REQ_INFO_DEFAULT_FAIL="70040003",ErrorCode.GETINFO_PLUGIN_MISSING="70040001",ErrorCode.GETINFO_NET="70014001",ErrorCode.GETINFO_TIMEOUT="70014003",ErrorCode.GETINFO_PARSE="70014004",ErrorCode.GETINFO_INNER="70014005",ErrorCode.GETINFO_SERVER_CODE_PREFIX="70013",ErrorCode.GETINFO_LIVE_SERVER_CODE_PREFIX="70023",ErrorCode.GETINFO_UNIFIED_LIVE_SERVER_CODE_PREFIX="70033",ErrorCode.UNPAIED_1080P="70013091.0",exports.ErrorMsg=void 0,ErrorMsg=exports.ErrorMsg||(exports.ErrorMsg={}),ErrorMsg.GETINFO_PLUGIN_MISSING="没有找到获取视频信息插件",ErrorMsg.GETINFO_INNER="获取视频信息内部错误",ErrorMsg.GETINFO_NET="无法获取视频信息",ErrorMsg.GETINFO_TIMEOUT="获取视频信息超时",ErrorMsg.GETINFO_PARSE="视频信息无法解析",ErrorMsg.GETINFO_CODE="播放后台返回错误",exports.PLAY_EVENT_EXT=void 0,H5_EXT_EVENT=exports.PLAY_EVENT_EXT||(exports.PLAY_EVENT_EXT={}),H5_EXT_EVENT.SET_LOADING="SET_LOADING",H5_EXT_EVENT.PROXY_HTTP_START="PROXY_HTTP_START",H5_EXT_EVENT.PROXY_HTTP_END="PROXY_HTTP_END",H5_EXT_EVENT.GETINFO_START="GETINFO_START",H5_EXT_EVENT.GETINFO_OVER="GETINFO_OVER",H5_EXT_EVENT.VID_CHANGE="VID_CHANGE",H5_EXT_EVENT.DESTROY="DESTROY",H5_EXT_EVENT.DATASET_UPDATE="data-set:update",H5_EXT_EVENT.DATASET_STATE_UPDATE="data-set:stateUpdate",H5_EXT_EVENT.RETRY_PLAY="retryPlay",H5_EXT_EVENT.DEGRADE_CODEC_PLAY="degradeCodecPlay",H5_EXT_EVENT.FLOW_NODE_PRELOAD="FLOW_NODE_PRELOAD",H5_EXT_EVENT.FLOW_NODE_START="FLOW_NODE_START",H5_EXT_EVENT.FLOW_NODE_END="FLOW_NODE_END",H5_EXT_EVENT.FLOW_NODE_ABORT="FLOW_NODE_ABORT",exports.H5_PLAY_EVENT=void 0,H5_PLAY_EVENT=exports.H5_PLAY_EVENT||(exports.H5_PLAY_EVENT={}),H5_PLAY_EVENT.PLAY_SESSION_START="PLAY_SESSION_START",H5_PLAY_EVENT.AD_REQ_INFO_START="AD_REQ_INFO_START",H5_PLAY_EVENT.AD_REQ_INFO_END="AD_REQ_INFO_END",H5_PLAY_EVENT.AD_REQ_ASSETS_START="AD_REQ_ASSETS_START",H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED="AD_AUTOPLAY_BLOCKED",H5_PLAY_EVENT.AD_PLAYING="AD_PLAYING",H5_PLAY_EVENT.AD_VOLUME_CHANGE="AD_VOLUME_CHANGE",H5_PLAY_EVENT.AD_ASSETS_LOADED="AD_ASSETS_LOADED",H5_PLAY_EVENT.AD_PAUSE="AD_PAUSE",H5_PLAY_EVENT.AD_END="AD_END",H5_PLAY_EVENT.AD_TIME_UPDATE="AD_TIME_UPDATE",H5_PLAY_EVENT.VIDEO_REQ_INFO_START="VIDEO_REQ_INFO_START",H5_PLAY_EVENT.VIDEO_REQ_INFO_END="VIDEO_REQ_INFO_END",H5_PLAY_EVENT.VIDEO_LOAD_START="VIDEO_LOAD_START",H5_PLAY_EVENT.VIDEO_LOAD_PROGRESS="VIDEO_LOAD_PROGRESS",H5_PLAY_EVENT.VIDEO_DURATION_CHANGE="VIDEO_DURATION_CHANGE",H5_PLAY_EVENT.VIDEO_METADATA_CHANGE="VIDEO_METADATA_CHANGE",H5_PLAY_EVENT.VIDEO_TIMEUPDATE="VIDEO_TIMEUPDATE",H5_PLAY_EVENT.VIDEO_VOLUME_CHANGE="VIDEO_VOLUME_CHANGE",H5_PLAY_EVENT.VIDEO_RATE_CHANGE="VIDEO_RATE_CHANGE",H5_PLAY_EVENT.VIDEO_CANPLAY="VIDEO_CANPLAY",H5_PLAY_EVENT.VIDEO_PLAYING="VIDEO_PLAYING",H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED="VIDEO_AUTOPLAY_BLOCKED",H5_PLAY_EVENT.VIDEO_PAUSE="VIDEO_PAUSE",H5_PLAY_EVENT.VIDEO_BUFFERING="VIDEO_BUFFERING",H5_PLAY_EVENT.VIDEO_SEEKING="VIDEO_SEEKING",H5_PLAY_EVENT.VIDEO_SEEKED="VIDEO_SEEKED",H5_PLAY_EVENT.VIDEO_SETLEVEL_START="VIDEO_SETLEVEL_START",H5_PLAY_EVENT.VIDEO_SETLEVEL_END="VIDEO_SETLEVEL_END",H5_PLAY_EVENT.VIDEO_RESIZE="VIDEO_RESIZE",H5_PLAY_EVENT.VIDEO_END="VIDEO_END",H5_PLAY_EVENT.PLAY_SESSION_END="PLAY_SESSION_END";var pluginStorage={},pluginExists=function(e){return Object.prototype.hasOwnProperty.call(pluginStorage,e)},getPlugin=function(e){return pluginExists(e)?pluginStorage[e]:void 0};function registerPlugin(e,t){if("string"!=typeof e)throw new Error('Illegal plugin name, "'.concat(e,'", must be a string, was ').concat(typeof e,"."));if("function"!=typeof t)throw new Error('Illegal plugin for "'.concat(e,'", must be a function, was ').concat(typeof t,"."));if(!pluginExists(e))return pluginStorage[e]=t,t;console.warn('A plugin named "'.concat(e,'" already exists. You may want to avoid re-registering plugins!'))}function deregisterPlugin(e){pluginExists(e)&&delete pluginStorage[e]}function getPlugins(e){var t;return void 0===e&&(e=Object.keys(pluginStorage)),e.forEach((function(e){var o=getPlugin(e);o&&((t=t||{})[e]=o)})),t}var methodPrefix="hook",playHooks=Object.values(exports.H5_PLAY_EVENT),Plugin=function(e){function t(o,r,i){var n=this.constructor,a=e.call(this)||this;if(a.player=o,a.config=r,a.hookMap={},n===t)throw new Error("Plugin must be sub-classed; not directly instantiated.");a.logger_=new Logger(o.config.instanceId,a.constructor.pluginName);var s=(i||{}).msg;return a.msg=s,a.registerHook(),a}return __extends$d(t,e),t.prototype.log=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).log)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.warn=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).warn)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.error=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).error)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.debug=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).debug)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.info=function(){for(var e,t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===(t=(e=this.logger_).info)||void 0===t||t.call.apply(t,__spreadArray$4([e],o,!1))},t.prototype.hasPlugin=function(e){return!!pluginExists(e)},t.prototype.destroy=function(){var e,t=this.player,o=this.name;(null===(e=t.plugins)||void 0===e?void 0:e[o])&&delete t.plugins[o],this.unRegisterHook(),this.hookMap=null,this.player=null,this.removeAllListeners()},t.prototype.hookPlaySessionStart=function(e){},t.prototype.hookAdReqInfoStart=function(e){},t.prototype.hookAdReqInfoEnd=function(e){},t.prototype.hookAdReqAssetsStart=function(e){},t.prototype.hookAdAutoplayBlocked=function(e){},t.prototype.hookAdPlaying=function(e){},t.prototype.hookAdVolumeChange=function(e){},t.prototype.hookAdAssetsLoaded=function(e){},t.prototype.hookAdPause=function(e){},t.prototype.hookAdEnd=function(e){},t.prototype.hookAdTimeUpdate=function(e){},t.prototype.hookVideoReqInfoStart=function(e){},t.prototype.hookVideoReqInfoEnd=function(e){},t.prototype.hookVideoLoadStart=function(e){},t.prototype.hookVideoMetadataChange=function(e){},t.prototype.hookVideoLoadProgress=function(e){},t.prototype.hookVideoDurationChange=function(e){},t.prototype.hookVideoTimeupdate=function(e){},t.prototype.hookVideoVolumeChange=function(e){},t.prototype.hookVideoResize=function(e){},t.prototype.hookVideoRateChange=function(e){},t.prototype.hookVideoCanplay=function(e){},t.prototype.hookVideoPlaying=function(e){},t.prototype.hookVideoAutoplayBlocked=function(e){},t.prototype.hookVideoPause=function(e){},t.prototype.hookVideoBuffering=function(e){},t.prototype.hookVideoSeeking=function(e){},t.prototype.hookVideoSeeked=function(e){},t.prototype.hookVideoSetlevelStart=function(e){},t.prototype.hookVideoSetlevelEnd=function(e){},t.prototype.hookVideoEnd=function(e){},t.prototype.hookPlaySessionEnd=function(e){},t.prototype.registerHook=function(){var e=this;playHooks.forEach((function(t){var o=getHookMethodName(t);e.hookMap[t]=function(t){var r;return null===(r=e[o])||void 0===r?void 0:r.call(e,t.data)},e.player.on(t,e.hookMap[t])}))},t.prototype.unRegisterHook=function(){var e=this;playHooks.forEach((function(t){e.hookMap[t]&&e.player.off(t,e.hookMap[t])}))},t.VERSION="",t.pluginName="",t}(s$1);function isFunctionPlugin(e){var t="string"==typeof e?getPlugin(e):e;return"function"==typeof t&&!Object.prototype.isPrototypeOf.call(Plugin.prototype,t.prototype)}function createPluginFactory(e,t){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i,n=o[0];if(isFunctionPlugin(t))i=t.apply(n,o);else{var a=t;a.prototype.name=e,i=new(a.bind.apply(a,__spreadArray$4([void 0],o,!1)))}return i&&(n.plugins[e]=i),i}function getHookMethodName(e){return methodPrefix+e.toLowerCase().replace(/^[a-z]/,(function(e){return e.toUpperCase()})).replace(/_[a-z]/g,(function(e){return e[1].toUpperCase()}))}var VideoReqInfoPluginName="__thumbplayer-video-request";function isVideoId(e){return"string"==typeof e||"number"==typeof e}var DRM_TYPE={NONE:0,CHACHA:3,FAIR_PLAY:4,WIDEVINE:5,ChinaDRM:6},DRM_VALUE={NONE:0,CHACHA:8,FAIR_PLAY:16,WIDEVINE:32},DATA_EVENTS,DATA_STATE,LOG_TYPE,BUFFER_REASON,PersistedUserSettings;exports.DATA_EVENTS=void 0,DATA_EVENTS=exports.DATA_EVENTS||(exports.DATA_EVENTS={}),DATA_EVENTS.UPDATE="data-set:update",DATA_EVENTS.STATE_UPDATE="data-set:stateUpdate",exports.DATA_STATE=void 0,DATA_STATE=exports.DATA_STATE||(exports.DATA_STATE={}),DATA_STATE.INIT="PLAYER:init",DATA_STATE.SESSION_START="PLAYER:session_start",DATA_STATE.SESSION_END="PLAYER:session_end",DATA_STATE.GET_INFO="PLAYER:getinfo",DATA_STATE.GET_INFO_START="PLAYER:getinfo_start",DATA_STATE.GET_INFO_END="PLAYER:getinfo_end",DATA_STATE.SUBTITLE="PLAYER:subtitle",DATA_STATE.SUBTITLE_START="PLAYER:subtitle_start",DATA_STATE.SUBTITLE_END="PLAYER:subtitle_end",DATA_STATE.LOAD_START="PLAYER:load_start",DATA_STATE.LOAD_END="PLAYER:load_end",DATA_STATE.LOAD="PLAYER:load",DATA_STATE.BUFFER="PLAYER:buffer",DATA_STATE.BUFFER_START="PLAYER:buffer_start",DATA_STATE.BUFFER_END="PLAYER:buffer_end",DATA_STATE.SEEK="PLAYER:seek",DATA_STATE.SEEK_START="PLAYER:seek_start",DATA_STATE.SEEK_END="PLAYER:seek_end",DATA_STATE.USER_SEEK_START="PLAYER:user_seek_start",DATA_STATE.USER_SEEK_END="PLAYER:user_seek_end",DATA_STATE.END="PLAYER:end",DATA_STATE.ERROR="PLAYER:error",DATA_STATE.FATAL_ERROR="PLAYER:fatal_error",DATA_STATE.FIRST_PLAY="PLAYER:firstPlay",DATA_STATE.IDLE="PLAYER:idle",DATA_STATE.PLAYING="PLAYER:playing",DATA_STATE.SET_LEVEL="PLAYER:setLevel",DATA_STATE.SET_LEVEL_START="PLAYER:setLevel_start",DATA_STATE.SET_LEVEL_END="PLAYER:setLevel_end",DATA_STATE.PAUSE="PLAYER:pause",DATA_STATE.PAUSE_START="PLAYER:pause_start",DATA_STATE.PAUSE_END="PLAYER:pause_end",DATA_STATE.SET_RATE="PLAYER:setRate",DATA_STATE.RETRY_BACKURL="PLAYER:retryBackUrl",DATA_STATE.RETRY_PLAY="PLAYER:retryPlay",DATA_STATE.AUTO_PLAY_BLOCKED="PLAYER:autoplayBlocked",exports.LOG_TYPE=void 0,LOG_TYPE=exports.LOG_TYPE||(exports.LOG_TYPE={}),LOG_TYPE.USER_ACTION="log:userAction",LOG_TYPE.PLUGIN_ACTION="log:pluginAction",LOG_TYPE.CORE_EVENT="log:coreEvent",LOG_TYPE.API_INVOKE="log:apiInvoke",LOG_TYPE.UNCATEGORIZED="log:uncategorized",exports.BUFFER_REASON=void 0,BUFFER_REASON=exports.BUFFER_REASON||(exports.BUFFER_REASON={}),BUFFER_REASON[BUFFER_REASON.NETWORK_UNSTABLE=1400027]="NETWORK_UNSTABLE",BUFFER_REASON[BUFFER_REASON.PARALLEL_DOWNLOAD=1400028]="PARALLEL_DOWNLOAD",BUFFER_REASON[BUFFER_REASON.CDN_NO_CONNECTION=1400007]="CDN_NO_CONNECTION",BUFFER_REASON[BUFFER_REASON.CDN_URL_SWITCH_SUCCESS=1400029]="CDN_URL_SWITCH_SUCCESS",BUFFER_REASON[BUFFER_REASON.CDN_SLOW=1400030]="CDN_SLOW",BUFFER_REASON[BUFFER_REASON.CDN_URL_SWITCH_UNSUCCESS=1400031]="CDN_URL_SWITCH_UNSUCCESS",BUFFER_REASON[BUFFER_REASON.CDN_TIMEOUT=1400026]="CDN_TIMEOUT",BUFFER_REASON[BUFFER_REASON.CDN_TIMEOUT_URL_SWITCH=1400032]="CDN_TIMEOUT_URL_SWITCH",BUFFER_REASON[BUFFER_REASON.BYTERATE_ERROR=1400033]="BYTERATE_ERROR",BUFFER_REASON[BUFFER_REASON.DOWNLOAD_TOO_SHORT=1400034]="DOWNLOAD_TOO_SHORT",BUFFER_REASON[BUFFER_REASON.P2P_UPLOAD_SLOW=1400035]="P2P_UPLOAD_SLOW",BUFFER_REASON[BUFFER_REASON.DEFAULT=0]="DEFAULT",exports.LOCAL_KEY=void 0,function(e){e.GUID="thumbplayer-h5-guid",e.VOLUME="thumbplayer-h5-volume"}(exports.LOCAL_KEY||(exports.LOCAL_KEY={})),exports.PersistedUserSettings=void 0,PersistedUserSettings=exports.PersistedUserSettings||(exports.PersistedUserSettings={}),PersistedUserSettings.definition="user-setting:definition",PersistedUserSettings.volume="user-setting:volume",PersistedUserSettings.playbackRate="user-setting:playbackRate",PersistedUserSettings.subtitle="user-setting:subtitle",PersistedUserSettings.audioTrack="user-setting:audioTrack";var DEFAULT_KEY={loginid:"",loginex:"",logintype:"",hh_ip:"",hc_main_login:"",hc_vuserid:"",hc_openid:"",hc_appid:"",hc_access_token:"",hc_vuession:"",vip:0,codec:CODEC.H264,freetype:0,videoCapability:"",mobile:0,guid:"",ua:"",uip:"",device:"",resolution:"",osver:"",p2pver:"",appVer:"",playerver:"",playertype:0,playercore:"",confid:"",downloadkit:0,online:1,p2p:0,sstrength:0,network:0,testid:0,curcore:"",curcorever:"",speed:0,quic:0,platform:"",flowid:"",vid:"",cid:"",columnId:"",livepid:"",interactid:"",url:"",referrer:"",topUrl:"",drm:0,drmtype:0,fmt:0,cdnid:0,dltype:"",rate:0,clip:0,status:0,duration:0,type:0,cdnuip:"",cdnip:"",ptag:"",sdtfrom:"",authfrom:"",currentDefnList:[],currentDefn:"",currentAudioTrack:0,currentAudioTrackList:[],currentSubtitle:"",currentSubtitleList:[],sessionBufferCount:0,sessionRetryBackUrlCount:0,sessionRetryPlayCount:0},COMMON_DATA_KEY={},_a$1$1;Object.keys(DEFAULT_KEY).forEach((function(e){return COMMON_DATA_KEY[e]=e}));var FreezeKey="thumbplayer-h5-dataset",KeySystemToDrmType=(_a$1$1={},_a$1$1[KeySystems.Widevine]=DRM_TYPE.WIDEVINE,_a$1$1[KeySystems.FairPlay]=DRM_TYPE.FAIR_PLAY,_a$1$1[KeySystems.FairPlayWebKit]=DRM_TYPE.FAIR_PLAY,_a$1$1.none=DRM_TYPE.NONE,_a$1$1),confIdMap={default:0,hlsProgressive:1,hlsFragPrefetch:2},DataSet=function(e){function t(o,r,i){var n=e.call(this,o,r,i)||this;return n.player=o,n.isSeeking=!1,n.isBuffering=!1,n.isSettingLevel=!1,n.isLoading=!1,n.lastPlay=0,n.playDuration=0,n.prevPlayTimeS=0,n.sessionBufferCount=0,n.sessionRetryBackUrlCount=0,n.sessionRetryPlayCount=0,n.commonMapFreeze={},n.stateMapFreeze={},n.isLive=!1,n.evtIdMap={},n.writeCommon=function(e,o,r){var i=n.commonMap[e];return n.commonMap[e]=o,t.canUseProxy||n.emit(exports.DATA_EVENTS.UPDATE,{key:e,oldVal:i,newVal:o}),!!r&&n.freeze("common",e,r)},n.writeState=function(e,o,r){var i=o.type||exports.LOG_TYPE.UNCATEGORIZED,a=n.stateMap[e],s=n.getStartEventData(e);return n.stateMap[e]=__assign$a(__assign$a(__assign$a({},i===exports.LOG_TYPE.CORE_EVENT?n.stats:{}),{type:i,ftime:+new Date,name:e,eventId:n.generateEvtId()}),o),!t.canUseProxy&&n.commonMap[COMMON_DATA_KEY.flowid]&&n.emit(exports.DATA_EVENTS.STATE_UPDATE,{key:e,oldVal:a,newVal:n.stateMap[e],startEvent:s}),!!r&&n.freeze("state",e,r)},n.onClose=function(){var e=+new Date;return{code:exports.ErrorCode.SUC,playDuration:n.playDuration,ftime:e}},n.getStats=function(){return __assign$a(__assign$a({playDuration:n.playDuration},n.stats),n.visualStats)},n.generateFlowId=function(){return comTool.createGUID(32)},n.generateEvtId=function(){return comTool.createGUID(8)},n.getStartEventData=function(e){var t;return((t={})[exports.DATA_STATE.SEEK_END]=n.stateMap[exports.DATA_STATE.SEEK_START],t[exports.DATA_STATE.BUFFER_END]=n.stateMap[exports.DATA_STATE.BUFFER_START],t[exports.DATA_STATE.LOAD_END]=n.stateMap[exports.DATA_STATE.LOAD_START],t[exports.DATA_STATE.SET_LEVEL_END]=n.stateMap[exports.DATA_STATE.SET_LEVEL_START],t[exports.DATA_STATE.PAUSE_END]=n.stateMap[exports.DATA_STATE.PAUSE_START],t[exports.DATA_STATE.GET_INFO_END]=n.stateMap[exports.DATA_STATE.GET_INFO_START],t)[e]},n.resetState=function(){n.isBuffering=!1,n.isSeeking=!1,n.isSettingLevel=!1},n.finalCleanup=function(e,t){var o,r,i=t.error,a=t.loadingUrl,s=t.config,l=null!==(r=null===(o=null==s?void 0:s.backupUrls)||void 0===o?void 0:o.findIndex((function(e){return e===a})))&&void 0!==r?r:-1;n.isSeeking&&(n.writeState(exports.DATA_STATE.SEEK_END,{currentUrl:a,urlIndex:l,type:exports.LOG_TYPE.CORE_EVENT,ftime:e,error:i,code:(null==i?void 0:i.code)||exports.ErrorCode.SUC,name:exports.DATA_STATE.SEEK_END,eventId:n.evtIdMap[exports.DATA_STATE.SEEK_START]}),n.isSeeking=!1),n.isBuffering&&(n.writeState(exports.DATA_STATE.BUFFER_END,{currentUrl:a,urlIndex:l,type:exports.LOG_TYPE.CORE_EVENT,ftime:e,code:(null==i?void 0:i.code)||exports.ErrorCode.SUC,error:i,name:exports.DATA_STATE.BUFFER_END,eventId:n.evtIdMap[exports.DATA_STATE.BUFFER_START]}),n.isBuffering=!1),n.isSettingLevel&&(n.isSettingLevel=!1,n.writeState(exports.DATA_STATE.SET_LEVEL_END,{currentUrl:a,urlIndex:l,type:exports.LOG_TYPE.CORE_EVENT,ftime:e,code:(null==i?void 0:i.code)||exports.ErrorCode.SUC,error:i,name:exports.DATA_STATE.SET_LEVEL_END,eventId:n.evtIdMap[exports.DATA_STATE.SET_LEVEL_START]})),n.isLoading&&(n.isLoading=!1,n.writeState(exports.DATA_STATE.LOAD_END,{type:exports.LOG_TYPE.CORE_EVENT,currentUrl:a,urlIndex:l,ftime:e,error:i,code:(null==i?void 0:i.code)||exports.ErrorCode.SUC,name:exports.DATA_STATE.LOAD_END,eventId:n.evtIdMap[exports.DATA_STATE.LOAD_START]}))},n.onAutoplayBlocked=function(e){n.writeState(exports.DATA_STATE.AUTO_PLAY_BLOCKED,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.AUTO_PLAY_BLOCKED,eventId:n.generateEvtId(),ftime:+new Date})},n.onRetryLoad=function(e){var t=e.data,o=t.prevUrl,r=t.curUrl,i=t.error,a=void 0===i?{}:i;n.writeState(exports.DATA_STATE.RETRY_BACKURL,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.RETRY_BACKURL,eventId:n.generateEvtId(),prevUrl:o,currentUrl:r,ftime:+new Date,error:a,code:null==a?void 0:a.code}),n.sessionRetryBackUrlCount++,n.writeCommon(COMMON_DATA_KEY.sessionRetryBackUrlCount,n.sessionRetryBackUrlCount)},n.onRetryPlay=function(e){var t=e.data.retryTimes;n.writeState(exports.DATA_STATE.RETRY_PLAY,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.RETRY_PLAY,eventId:n.generateEvtId(),ftime:+new Date,ext:{retryTimes:t}}),n.sessionRetryPlayCount++,n.writeCommon(COMMON_DATA_KEY.sessionRetryPlayCount,n.sessionRetryPlayCount)},n.onBuffering=function(e){if(!n.isBuffering){n.isBuffering=!0;var t=n.generateEvtId();n.evtIdMap[exports.DATA_STATE.BUFFER_START]=t,n.writeState(exports.DATA_STATE.BUFFER_START,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.BUFFER_START,eventId:t,prevState:e.old,ftime:+new Date}),n.sessionBufferCount++,n.writeCommon(COMMON_DATA_KEY.sessionBufferCount,n.sessionBufferCount)}},n.onLoadStart=function(e){var t,o,r,i,a,s,l,c;n.resetState();var p=null===(t=e.videoInfo)||void 0===t?void 0:t.config,d=+new Date;n.writeCommon(COMMON_DATA_KEY.curcore,n.player.kernelName);var u=null===(o=KernelFactory$1.getKernelByName(n.player.kernelName))||void 0===o?void 0:o.VERSION;n.writeCommon(COMMON_DATA_KEY.curcorever,u),n.writeCommon(COMMON_DATA_KEY.drmtype,KeySystemToDrmType[(null===(r=p.drmConfig)||void 0===r?void 0:r.keySystem)||"none"]),n.writeCommon(COMMON_DATA_KEY.playertype,n.player.kernelName===exports.KERNEL_NAME.ORIGIN?0:1);var A=null===(a=(i=n.player.corePlayer).getHls)||void 0===a?void 0:a.call(i),_=null===(l=(s=n.player.corePlayer).getP2P)||void 0===l?void 0:l.call(s);if(_&&n.writeCommon(COMMON_DATA_KEY.p2pver,null===(c=_.getVersion)||void 0===c?void 0:c.call(_)),A){var E=A.config||{},g=E.progressive,f=E.startFragPrefetch,h=confIdMap.default;g&&(h+=confIdMap.hlsProgressive),f&&(h+=confIdMap.hlsFragPrefetch),h&&n.writeCommon(COMMON_DATA_KEY.confid,h)}n.isLoading=!0;var v=n.generateEvtId();n.evtIdMap[exports.DATA_STATE.LOAD_START]=v,n.writeState(exports.DATA_STATE.LOAD_START,{type:exports.LOG_TYPE.CORE_EVENT,eventId:v,name:exports.DATA_STATE.LOAD_START,ftime:d})},n.onEnd=function(e){n.writeState(exports.DATA_STATE.END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.END,eventId:n.generateEvtId(),ftime:+new Date,ext:{playDuration:n.playDuration},code:exports.ErrorCode.SUC})},n.onIdle=function(e,t){},n.onSeeking=function(e){var t,o,r=+new Date;n.isSeeking&&n.writeState(exports.DATA_STATE.SEEK_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SEEK_END,ftime:r,eventId:n.evtIdMap[exports.DATA_STATE.SEEK_START],ext:{isUserSeek:(null===(o=null===(t=n.stateMap[exports.DATA_STATE.SEEK_START])||void 0===t?void 0:t.ext)||void 0===o?void 0:o.isUserSeek)||!1}}),n.isLive||n.resetState(),n.isSeeking=!0;var i=n.generateEvtId();n.evtIdMap[exports.DATA_STATE.SEEK_START]=i,n.writeState(exports.DATA_STATE.SEEK_START,{type:exports.LOG_TYPE.CORE_EVENT,ftime:r,name:exports.DATA_STATE.SEEK_START,eventId:i,ext:{inBufferedRange:videoTool.checkTimeInBuffer(e.seekingTime,n.player.videoBuffered),isUserSeek:e.isUserSeek}})},n.onSeeked=function(e){n.isSeeking&&(n.isSeeking=!1,n.writeState(exports.DATA_STATE.SEEK_END,{type:exports.LOG_TYPE.CORE_EVENT,eventId:n.evtIdMap[exports.DATA_STATE.SEEK_START],ftime:+new Date,name:exports.DATA_STATE.SEEK_END,ext:{isUserSeek:e.isUserSeek},code:exports.ErrorCode.SUC}))},n.onPause=function(e){var t=e.pauseType,o=n.generateEvtId();n.evtIdMap[exports.DATA_STATE.PAUSE_START]=o,n.writeState(exports.DATA_STATE.PAUSE_START,{type:exports.LOG_TYPE.CORE_EVENT,ftime:+new Date,name:exports.DATA_STATE.PAUSE_START,eventId:o,pauseType:t})},n.onPlaying=function(e){var t=+new Date;n.isBuffering&&(n.writeState(exports.DATA_STATE.BUFFER_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.BUFFER_END,ftime:t,eventId:n.evtIdMap[exports.DATA_STATE.BUFFER_START]}),n.isBuffering=!1),n.lastPlay=t,n.evtIdMap[exports.DATA_STATE.PAUSE_START]&&(n.writeState(exports.DATA_STATE.PAUSE_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.PAUSE_END,eventId:n.evtIdMap[exports.DATA_STATE.PAUSE_START],ftime:t,code:exports.ErrorCode.SUC}),delete n.evtIdMap[exports.DATA_STATE.PAUSE_START])},n.onCanPlay=function(e){var t=+new Date;n.isLoading&&(n.writeState(exports.DATA_STATE.LOAD_END,{type:exports.LOG_TYPE.CORE_EVENT,ftime:t,name:exports.DATA_STATE.LOAD_END,eventId:n.evtIdMap[exports.DATA_STATE.LOAD_START],code:exports.ErrorCode.SUC}),n.isLoading=!1)},n.onSetLevelStart=function(e){var t=+new Date;n.isSeeking&&(n.isSeeking=!1,n.writeState(exports.DATA_STATE.SEEK_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SEEK_END,ftime:t,eventId:n.evtIdMap[exports.DATA_STATE.SEEK_START]})),n.resetState(),n.isSettingLevel=!0;var o=n.generateEvtId();n.evtIdMap[exports.DATA_STATE.SET_LEVEL_START]=o,n.writeState(exports.DATA_STATE.SET_LEVEL_START,{type:exports.LOG_TYPE.CORE_EVENT,ftime:t,eventId:o,name:exports.DATA_STATE.SET_LEVEL_START,ext:{defn:n.commonMap.currentDefn,mode:e.data.mode}})},n.onSetLevelEnd=function(e){var t=e.data,o=((void 0===t?{}:t).videoInfo||{}).error;n.isSettingLevel=!1,n.writeCommon(COMMON_DATA_KEY.curcore,n.player.kernelName),n.writeState(exports.DATA_STATE.SET_LEVEL_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SET_LEVEL_END,ftime:+new Date,eventId:n.evtIdMap[exports.DATA_STATE.SET_LEVEL_START],error:o,code:(null==o?void 0:o.code)||exports.ErrorCode.SUC})},n.onError=function(e){var t,o,r=(e.data||{}).videoInfo,i=r||{},a=i.error,s=i.state,l=i.currentFragSn,c=i.currentFragUrl,p=i.loadingUrl,d=i.config,u=+new Date;n.writeState(exports.DATA_STATE.ERROR,{currentUrl:p,urlIndex:null!==(o=null===(t=null==d?void 0:d.backupUrls)||void 0===t?void 0:t.findIndex((function(e){return e===p})))&&void 0!==o?o:-1,type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.ERROR,eventId:n.generateEvtId(),fragUrl:c,ext:{fragSn:l},code:a.code,error:a,ftime:u,prevState:s}),n.finalCleanup(u,r)},n.onDurationChange=function(e){var t=e.data,o=((void 0===t?{}:t).videoInfo||{}).duration,r=void 0===o?0:o;n.commonMap.duration=r},n.onFirstPlay=function(e){var t=+new Date;n.writeState(exports.DATA_STATE.FIRST_PLAY,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.FIRST_PLAY,ftime:t,eventId:n.generateEvtId()})},n.onTimeChange=function(e){var t=Math.floor(n.player.playtime);t&&t!==n.prevPlayTimeS&&(n.prevPlayTimeS=t,n.playDuration||(n.playDuration=0),n.playDuration+=1)},n.onStateChange=function(e){var t,o=e.data,r=o.new,i=((t={})[exports.VIDEO_STATE.BUFFERING]=n.onBuffering,t[exports.VIDEO_STATE.LOAD_START]=n.onLoadStart,t[exports.VIDEO_STATE.END]=n.onEnd,t[exports.VIDEO_STATE.IDLE]=n.onIdle,t[exports.VIDEO_STATE.SEEKING]=n.onSeeking,t[exports.VIDEO_STATE.SEEKED]=n.onSeeked,t[exports.VIDEO_STATE.PAUSE]=n.onPause,t[exports.VIDEO_STATE.PLAYING]=n.onPlaying,t[exports.VIDEO_STATE.CANPLAY]=n.onCanPlay,t[exports.VIDEO_STATE.SEEKING]=n.onSeeking,t);i[r]&&i[r](o)},n.onRateChange=function(e){n.writeState(exports.DATA_STATE.SET_RATE,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SET_RATE,eventId:n.generateEvtId(),ftime:+new Date})},n.onVideoReqInfoStart=function(){var e=n.generateEvtId();n.evtIdMap[exports.DATA_STATE.GET_INFO_START]=e,n.writeState(exports.DATA_STATE.GET_INFO_START,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.GET_INFO_START,eventId:e,ftime:+new Date})},n.onVideoReqInfoEnd=function(e){var t=e.data,o=t.code,r=t.data,i=void 0===r?{}:r;n.sessionRetryBackUrlCount=0,n.evtIdMap[exports.DATA_STATE.GET_INFO_START]&&n.writeState(exports.DATA_STATE.GET_INFO_END,{type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.GET_INFO_END,code:o,ext:{reqBody:urlTool.object2string(i.reqParams||{},"&"),reqPath:i.reqPath||"",retryCount:i.alreadyRetryCount||0},error:i.error||{},eventId:n.evtIdMap[exports.DATA_STATE.GET_INFO_START],ftime:+new Date})},n.onPlaySessionStart=function(e){var t=e.data;n.writeCommon(COMMON_DATA_KEY.flowid,t.flowid),isVideoId(t.playItem)&&n.writeCommon(COMMON_DATA_KEY.vid,t.playItem),n.emit(exports.DATA_EVENTS.STATE_UPDATE,{key:exports.DATA_STATE.INIT,oldVal:void 0,newVal:n.stateMap[exports.DATA_STATE.INIT],startEvent:void 0}),n.writeState(exports.DATA_STATE.SESSION_START,{eventId:n.generateEvtId(),type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.SESSION_START,ftime:+new Date})},n.onPlaySessionEnd=function(e){var t=e.data.code,o=t===exports.ErrorCode.SUC?__assign$a({},n.stateMap[exports.DATA_STATE.END]):__assign$a({},n.stateMap[exports.DATA_STATE.ERROR]);t!==exports.ErrorCode.SUC&&n.removeUserSetting([exports.PersistedUserSettings.definition,exports.PersistedUserSettings.audioTrack]),n.writeState(exports.DATA_STATE.SESSION_END,__assign$a(__assign$a({},o),{code:t,eventId:n.generateEvtId(),name:exports.DATA_STATE.SESSION_END,type:exports.LOG_TYPE.CORE_EVENT,ftime:+new Date})),n.playDuration=0,n.prevPlayTimeS=0,n.sessionBufferCount=0,n.sessionRetryBackUrlCount=0,n.sessionRetryPlayCount=0},n.getGUID=function(){var e=lsTool.getData(exports.LOCAL_KEY.GUID);if(e)return e;var t=comTool.createGUID(32);return lsTool.setData(exports.LOCAL_KEY.GUID,t),t},n.isTabFocused=function(){var e=["hidden","msHidden","webkitHidden"].find((function(e){return void 0!==document[e]}));return e?document[e]?0:1:-1},n.isPlayerInViewport=function(){var e=n.player.container;if(!e.offsetParent)return 0;var t=e.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight,r=window.innerWidth||document.documentElement.clientWidth,i=t.top<=o&&t.top+t.height>=0,a=t.left<=r&&t.left+t.width>=0;return+(i&&a)},n.commonMap=t.canUseProxy?new Proxy({},{get:function(e,t,o){return Reflect.get(e,t,o)},set:function(e,t,o,r){if("string"!=typeof t)return!1;if(n.commonMapFreeze[t])return!1;var i=Reflect.get(e,t,r),a=Reflect.set(e,t,o,r);return i!==o&&n.emit(exports.DATA_EVENTS.UPDATE,{key:t,oldVal:i,newVal:o}),a}}):{},n.stateMap=t.canUseProxy?new Proxy({},{get:function(e,t,o){return Reflect.get(e,t,o)},set:function(e,t,o,r){if("string"!=typeof t)return!1;if(n.stateMapFreeze[t])return!1;var i=Reflect.get(e,t,r),a=Reflect.set(e,t,o,r);return n.commonMap[COMMON_DATA_KEY.flowid]&&n.emit(exports.DATA_EVENTS.STATE_UPDATE,{key:t,oldVal:i,newVal:o,startEvent:n.getStartEventData(t),startEventData:n.getStartEventData(t)}),a}}):{},n.isLive=n.player.config.type===exports.PLAY_MODE.LIVE,n.setEnv(),n.collectBaseInfo(),n.collectVideoCapability(),n.persistUserSetting(),n}return __extends$d(t,e),Object.defineProperty(t.prototype,"stats",{get:function(){var e,t,o,r,i,n,a,s=this.player,l=s.playbackRate,c=s.volume,p=s.played,d=s.playtime,u=s.currentVideoInfo;return{volume:c,playbackRate:l,played:p,playtime:d,urlIndex:null!==(o=null===(t=null===(e=null==u?void 0:u.config)||void 0===e?void 0:e.backupUrls)||void 0===t?void 0:t.findIndex((function(e){return e===u.loadingUrl})))&&void 0!==o?o:-1,frameDroppedInPercentage:null!==(i=null===(r=null==u?void 0:u.qualityInfo)||void 0===r?void 0:r.frameDroppedInPercentage)&&void 0!==i?i:-1,averageDecodeTimeInMs:null!==(a=null===(n=null==u?void 0:u.qualityInfo)||void 0===n?void 0:n.averageDecodeTimeInMs)&&void 0!==a?a:-1,currentUrl:null==u?void 0:u.loadingUrl,paused:this.paused,fragUrl:null==u?void 0:u.currentFragUrl}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visualStats",{get:function(){return{isTabFocused:this.isTabFocused(),isPlayerInViewport:this.isPlayerInViewport()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){var e,t;return null===(t=null===(e=this.player)||void 0===e?void 0:e.currentVideoElement)||void 0===t?void 0:t.paused},enumerable:!1,configurable:!0}),t.prototype.defrost=function(e,t,o){switch(void 0===o&&(o="secret"),e){case"state":return this.stateMapFreeze[t]===o&&(delete this.stateMapFreeze[t],!0);case"common":return this.commonMapFreeze[t]===o&&(delete this.commonMapFreeze[t],!0)}},t.prototype.freeze=function(e,t,o){switch(void 0===o&&(o="secret"),e){case"state":return this.stateMapFreeze[t]?(this.player.log("".concat(t,"已锁定")),!1):(this.stateMapFreeze[t]=o,!0);case"common":return this.commonMapFreeze[t]?(this.player.log("".concat(t,"已锁定")),!1):(this.commonMapFreeze[t]=o,!0);default:return!1}},t.prototype.setEnv=function(){var e=this;this.player.on(exports.PLAY_EVENT.STATE_CHANGE,this.onStateChange),this.player.on(exports.PLAY_EVENT.FIRST_PLAYING,this.onFirstPlay),this.player.on(exports.PLAY_EVENT.TIME_UPDATE,this.onTimeChange),this.player.on(exports.PLAY_EVENT.DURATION_CHANGE,this.onDurationChange),this.player.on(exports.PLAY_EVENT.ERROR,this.onError),this.player.on(exports.PLAY_EVENT.SETLEVEL_START,this.onSetLevelStart),this.player.on(exports.PLAY_EVENT.SETLEVEL_OVER,this.onSetLevelEnd),this.player.on(exports.PLAY_EVENT.RATE_CHANGE,this.onRateChange),this.player.on(exports.PLAY_EVENT.RETRY_BACKURL,this.onRetryLoad),this.player.on(exports.PLAY_EVENT.AUTOPLAY_BLOCKED,this.onAutoplayBlocked),this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_START,this.onVideoReqInfoStart),this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,this.onVideoReqInfoEnd),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,this.onPlaySessionStart),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd),this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,(function(t){var o=t.data;if(o.code!==exports.ErrorCode.SUC){var r=o.data,i=((null==r?void 0:r.error)||{}).code;e.writeState(exports.DATA_STATE.ERROR,{eventId:e.generateEvtId(),type:exports.LOG_TYPE.CORE_EVENT,name:exports.DATA_STATE.ERROR,code:i,ftime:+new Date})}})),this.msg.on(exports.PLAY_EVENT_EXT.RETRY_PLAY,this.onRetryPlay)},t.prototype.collectBaseInfo=function(){var e=uaTool.os,t=uaTool.mobile;this.writeCommon(COMMON_DATA_KEY.mobile,t?1:0,FreezeKey),this.writeCommon(COMMON_DATA_KEY.online,1,FreezeKey),this.writeCommon(COMMON_DATA_KEY.resolution,"".concat(screen.width,"*").concat(screen.height,"*").concat(window.devicePixelRatio||1),FreezeKey),this.writeCommon(COMMON_DATA_KEY.ua,navigator.userAgent.replace(/,/g,"\\,"),FreezeKey),this.writeCommon(COMMON_DATA_KEY.osver,"".concat(e.osName," ").concat(e.version),FreezeKey),this.writeCommon(COMMON_DATA_KEY.playertype,0),this.writeCommon(COMMON_DATA_KEY.confid,confIdMap.default),this.writeCommon(COMMON_DATA_KEY.playercore,Object.keys(KernelFactory$1.kernelMap).join(","),FreezeKey),this.writeCommon(COMMON_DATA_KEY.playerver,VERSION$3),this.writeCommon(COMMON_DATA_KEY.speed,0),this.writeCommon(COMMON_DATA_KEY.drm,0),this.writeCommon(COMMON_DATA_KEY.url,location.href,FreezeKey),this.writeCommon(COMMON_DATA_KEY.topUrl,urlTool.getTopFrameUrl(),FreezeKey),this.writeCommon(COMMON_DATA_KEY.referrer,document.referrer,FreezeKey),this.writeCommon(COMMON_DATA_KEY.guid,this.getGUID())},t.prototype.collectVideoCapability=function(){try{var e={concurrency:navigator.hardwareConcurrency},t={av1:+videoTool.supportAV1(),hevc:+videoTool.supportHevc(),dolby:+videoTool.isDolbyVisionSupported()},o={hls:+videoTool.supportVideoFormat().includes("hls")},r=videoTool.isHDRSupported(),i=jsonTool.safelyStringify({codec:t,format:o,hdr:r,hw:e}).replace(/,/g,"\\,");this.writeCommon(COMMON_DATA_KEY.videoCapability,i),this.log("device capability info: ".concat(i))}catch(e){}},t.prototype.persistUserSetting=function(){var e=this,o={},r=this.player.config,i=r.disableUserSettingCache,n=r.type,a=function(e){var t;return(null===(t=null==i?void 0:i.indexOf)||void 0===t?void 0:t.call(i,e))>-1};t.SETTING_CONFIG.forEach((function(t){var r=t.dsKey,i=t.lsKey,s=t.oldDsKey,l="".concat(i,"_").concat(n);if(!(a(r)||s&&a(s))){o[r]=l;var c=lsTool.getData(l);c&&r&&e.writeCommon(r,c)}})),this.msg.on(exports.PLAY_EVENT_EXT.DATASET_UPDATE,(function(e){var t=e.data,r=t.newVal,i=t.key;o[i]&&lsTool.setData(o[i],r)}))},t.prototype.removeUserSetting=function(e){var t=this;("string"==typeof e?[e]:e).forEach((function(e){t.writeCommon(e,"")}))},t.pluginName="dataset",t.UserSettingKeyPrefix="__thumbplayer_setting_",t.SETTING_CONFIG=[{oldDsKey:COMMON_DATA_KEY.currentDefn,dsKey:exports.PersistedUserSettings.definition,lsKey:"".concat(t.UserSettingKeyPrefix,"_definition")},{oldDsKey:COMMON_DATA_KEY.currentSubtitle,dsKey:exports.PersistedUserSettings.subtitle,lsKey:"".concat(t.UserSettingKeyPrefix,"_subtitle")},{oldDsKey:COMMON_DATA_KEY.currentAudioTrack,dsKey:exports.PersistedUserSettings.audioTrack,lsKey:"".concat(t.UserSettingKeyPrefix,"_audioTrack")},{dsKey:exports.PersistedUserSettings.volume,lsKey:"".concat(t.UserSettingKeyPrefix,"_volume")},{dsKey:exports.PersistedUserSettings.playbackRate,lsKey:"".concat(t.UserSettingKeyPrefix,"_playbackRate")}],t.canUseProxy=void 0!==window.Proxy,t}(Plugin);function proxyPlayEvent(e,t){var o,r=((o={})[exports.PLAY_EVENT.DURATION_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_DURATION_CHANGE,getParam:function(e){return{duration:e.videoInfo.duration}}},o[exports.PLAY_EVENT.METADATA_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_METADATA_CHANGE,getParam:function(e){return{width:e.videoInfo.videoWidth,height:e.videoInfo.videoHeight}}},o[exports.PLAY_EVENT.VIDEO_BUFFER_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_LOAD_PROGRESS,getParam:function(){return{bufferRange:e.videoBuffered}}},o[exports.PLAY_EVENT.TIME_UPDATE]={evt:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,getParam:function(e){return{playtime:e.videoInfo.playtime}}},o[exports.PLAY_EVENT.VOLUME_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_VOLUME_CHANGE,getParam:function(){return{volume:e.volume}}},o[exports.PLAY_EVENT.RATE_CHANGE]={evt:exports.H5_PLAY_EVENT.VIDEO_RATE_CHANGE,getParam:function(){return{rate:e.playbackRate}}},o[exports.PLAY_EVENT.VIDEO_RESIZE]={evt:exports.H5_PLAY_EVENT.VIDEO_RESIZE,getParam:function(e){return{videoWidth:e.videoInfo.videoWidth,videoHeight:e.videoInfo.videoHeight}}},o[exports.PLAY_EVENT.AUTOPLAY_BLOCKED]={evt:exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,getParam:function(){}},o[exports.PLAY_EVENT.SETLEVEL_OVER]={evt:exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,getParam:function(e){var t,o,r,i=null!==(r=null===(o=null===(t=e.videoInfo)||void 0===t?void 0:t.error)||void 0===o?void 0:o.code)&&void 0!==r?r:exports.ErrorCode.UNKNOWN;return{code:e.fail?i:exports.ErrorCode.SUC}}},o);Object.keys(r).forEach((function(o){t.on(o,(function(t){var i=r[o],n=i.evt,a=i.getParam;e.emit(n,a(t.data))}))}))}var adEvents=[exports.H5_PLAY_EVENT.AD_REQ_INFO_START,exports.H5_PLAY_EVENT.AD_REQ_INFO_END,exports.H5_PLAY_EVENT.AD_REQ_ASSETS_START,exports.H5_PLAY_EVENT.AD_ASSETS_LOADED,exports.H5_PLAY_EVENT.AD_END,exports.H5_PLAY_EVENT.AD_PLAYING,exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,exports.H5_PLAY_EVENT.AD_PAUSE,exports.H5_PLAY_EVENT.AD_TIME_UPDATE,exports.H5_PLAY_EVENT.AD_VOLUME_CHANGE],FullScreenMode;function proxyAdEvent(e){var t=getAdPlugin(e.config.instanceId);t&&adEvents.forEach((function(o){t.on(o,(function(t){var r=t.data;e.emit(o,r)}))}))}function requestFakeFullScreen(e,t){void 0===t&&(t=!0),domTool.insertStyle(styleStr,styleTag),e.classList.toggle(FakeFullscreenClass,t)}function isFakeFullscreen(e){return e.classList.contains(FakeFullscreenClass)}exports.FullScreenMode=void 0,FullScreenMode=exports.FullScreenMode||(exports.FullScreenMode={}),FullScreenMode.FAKE_FULLSCREEN="fakeFullscreen",FullScreenMode.FULL_SCREEN="fullscreen";var FakeFullscreenClass="thumbplayer-fake-fullscreen",styleTag="thumbplayer-fake-fullscreen-style",styleStr="\n.".concat(FakeFullscreenClass," {\n  position: fixed !important;\n  top: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  left: 0 !important;\n  width: 100% !important;\n  height: 100% !important;\n  z-index: 9999 !important;\n}\n");function requestElFullScreen(e,t){if(void 0===t&&(t=!0),!(e instanceof HTMLElement))return Promise.reject("requestElFullScreen: container is not an element");var o=function(e){var t;return null===(t=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.msRequestFullscreen)||void 0===t?void 0:t.bind(e)},r=function(e){var t;return null===(t=e.cancelFullScreen||e.mozCancelFullScreen||e.webkitCancelFullScreen||e.exitFullscreen||e.webkitExitFullscreen||e.msExitFullscreen)||void 0===t?void 0:t.bind(e)},i=o(e)||o(document),n=r(e)||r(document),a=t?i:n;try{return Promise.resolve(a())}catch(e){return Promise.reject(e)}}function requestVideoFullScreen(e,t){return void 0===t&&(t=!0),__awaiter$7(this,void 0,void 0,(function(){var o,r;return __generator$7(this,(function(i){if(!(e&&e instanceof HTMLVideoElement))throw new Error("videoRequestFullScreen: video is not an VideoElement");if(o=e.requestFullscreen||e.webkitEnterFullscreen||e.webkitRequestFullScreen,!(r=t?o:e.webkitExitFullscreen))throw new Error("Video Fullscreen API is not supported.");return[2,r.call(e)]}))}))}function isElFullScreen(e){if(!e)return!1;var t=document;if(!(t.fullscreen||t.mozFullScreen||t.webkitIsFullScreen||t.msFullscreenElement))return!1;var o=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement;return o===e||o===document}function isVideoFullScreen(e){return!!e&&((e.webkitDisplayingFullscreen||"fullscreen"===e.webkitPresentationMode)&&!isEnterPipInApple(e))}function isEnterPipInApple(e){return!(!uaTool.os.ios&&!uaTool.browser.safari)&&(document.pictureInPictureEnabled||document.pictureInPictureElement===e)}var VIDEO_FULLSCREEN_TAG="fullscreen_handler",fullscreenEvents$1=["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"],FullScreenLogics=function(){function e(e){var t=this;this.player=e,this.fullscreenChangeHandler=function(){var e=t.fullscreenMode;t.player.emit(exports.PLAY_EVENT.FULLSCREEN_CHANGE,{isEnter:Boolean(e),mode:e})},this.logger=new Logger(e.config.instanceId,"FullscreenLogics"),this.listenFullScreenEvts(!0)}return Object.defineProperty(e.prototype,"fullscreenMode",{get:function(){var e=this.player,t=e.container,o=e.currentVideoElement;return isElFullScreen(t)||isVideoFullScreen(o)?exports.FullScreenMode.FULL_SCREEN:isFakeFullscreen(t)?exports.FullScreenMode.FAKE_FULLSCREEN:null},enumerable:!1,configurable:!0}),e.prototype.requestFullScreen=function(e,t,o){return void 0===e&&(e=!0),void 0===o&&(o=!0),__awaiter$7(this,void 0,void 0,(function(){var r,i,n,a,s,l;return __generator$7(this,(function(c){switch(c.label){case 0:if(r=this.player,i=r.container,n=r.currentVideoElement,a=this.fullscreenMode,s=this.getFullScreenMode(t),e&&a){if(a===s)return[2];this.requestFullScreen(!1,a,!1)}if(!e&&!a||!e&&a!==s)return[2];c.label=1;case 1:if(c.trys.push([1,7,,8]),s===exports.FullScreenMode.FAKE_FULLSCREEN)return requestFakeFullScreen(i,e),o&&a!==exports.FullScreenMode.FULL_SCREEN&&this.player.emit(exports.PLAY_EVENT.FULLSCREEN_CHANGE,{isEnter:e,mode:e?s:null}),[2];c.label=2;case 2:return c.trys.push([2,4,,6]),[4,requestElFullScreen(i,e)];case 3:return c.sent(),[3,6];case 4:return c.sent(),[4,requestVideoFullScreen(n,e)];case 5:return c.sent(),[3,6];case 6:return[3,8];case 7:throw l=c.sent(),this.logger.error("@FullscreenLogics.requestFullScreen, isEnter=".concat(e,", mode=").concat(s,", err=").concat(l)),l;case 8:return[2]}}))}))},e.prototype.destroy=function(){this.listenFullScreenEvts(!1)},e.prototype.getFullScreenMode=function(e){return e||(!uaTool.mobile||uaTool.os.ios?exports.FullScreenMode.FULL_SCREEN:exports.FullScreenMode.FAKE_FULLSCREEN)},e.prototype.listenFullScreenEvts=function(e){var t=this;void 0===e&&(e=!0);var o=e?document.addEventListener.bind(document):document.removeEventListener.bind(document);fullscreenEvents$1.forEach((function(e){o(e,t.fullscreenChangeHandler)})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_LOAD_START,(function(){t.player.videoElements.forEach((function(o){if(o instanceof HTMLVideoElement&&!o.dataset[VIDEO_FULLSCREEN_TAG]){var r=e?o.addEventListener.bind(o):o.removeEventListener.bind(o);r("webkitendfullscreen",t.fullscreenChangeHandler),r("webkitbeginfullscreen",t.fullscreenChangeHandler),o.dataset[VIDEO_FULLSCREEN_TAG]=e?String(!0):null}}))}))},e}(),BridgeMessageName;!function(e){e.STORAGE_INIT_FAILED="storageInitFailed",e.STORAGE_READY="storageReady",e.REQUEST_STORE_LOG="requestStoreLog",e.STORE_LOG_SUCCESS="storeLogSuccess",e.STORE_LOG_FAILED="storeLogFailed",e.REQUEST_REPORT_LOG="requestReportLog",e.REPORT_LOG_SUCCESS="reportLogSuccess",e.REPORT_LOG_FAILED="reportLogFailed"}(BridgeMessageName||(BridgeMessageName={}));var REMOTE_STORAGE_CLASS_NAME="thumbplayer-remote-storage-bridge",DEFAULT_IFRAME_TIMEOUT=1e4,REPORT_TIMEOUT=3e4,MessageBridge=function(){function e(e,t){var o=this;this.sender=e,this.receiver=t,this.callbackMap={},this.hasDestroy=!1,this.onReceiverMessage=function(e){o.receiverMessageHandler(e)},this.sender.addEventListener("message",this.onReceiverMessage)}return e.prototype.postMessage=function(e){if(this.hasDestroy)throw new Error("Cannot exec postMessage after destroy");this.receiver.postMessage(e,"*")},e.prototype.on=function(e,t){this.hasDestroy||(this.callbackMap[e]||(this.callbackMap[e]=[]),this.callbackMap[e].push(t))},e.prototype.off=function(e,t){if(!this.hasDestroy){var o=this.callbackMap[e];if(null==o?void 0:o.length){var r=o.indexOf(t);-1!==r&&o.splice(r,1)}}},e.prototype.destroy=function(){var e;this.hasDestroy=!0,null===(e=this.sender)||void 0===e||e.removeEventListener("message",this.onReceiverMessage),this.sender=null,this.receiver=null,this.callbackMap=null},e.prototype.receiverMessageHandler=function(e){var t,o=this;if(this.isBridgeMessage(e.data)&&!this.hasDestroy){var r=e.data;null===(t=this.callbackMap[r.name])||void 0===t||t.forEach((function(e){e(r,o.postMessage.bind(o))}))}},e.prototype.isBridgeMessage=function(e){return"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"string"==typeof(null==e?void 0:e.instanceId)},e}(),RemoteStorageBridge=function(e){function t(o,r,i){void 0===i&&(i=DEFAULT_IFRAME_TIMEOUT);var n=e.call(this,self,t.getIframe(o,i).contentWindow)||this;return n.instanceId=r,n.timeout=i,t.instanceCount+=1,n}return __extends$d(t,e),t.getIframe=function(e,o){if(void 0===o&&(o=DEFAULT_IFRAME_TIMEOUT),t.iframeEl)return t.iframeEl;var r=document.createElement("iframe");return r.src=e,document.body.append(r),r.style.display="none",r.classList.add(REMOTE_STORAGE_CLASS_NAME),t.iframeEl=r,t.rejectTimeout=window.setTimeout((function(){t.storageDefer.reject(new Error("IFrame wait timeout"))}),o),r},t.prototype.storeLogs=function(e){return __awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(o){switch(o.label){case 0:return[4,t.storageDefer.promise];case 1:return o.sent(),[4,this.postMessagePromise({name:BridgeMessageName.REQUEST_STORE_LOG,instanceId:this.instanceId,data:e},BridgeMessageName.STORE_LOG_SUCCESS,BridgeMessageName.STORE_LOG_FAILED)];case 2:return o.sent(),[2]}}))}))},t.prototype.report=function(e){return __awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(o){switch(o.label){case 0:return[4,t.storageDefer.promise];case 1:return o.sent(),[4,this.postMessagePromise({name:BridgeMessageName.REQUEST_REPORT_LOG,instanceId:this.instanceId,data:e},BridgeMessageName.REPORT_LOG_SUCCESS,BridgeMessageName.REPORT_LOG_FAILED,REPORT_TIMEOUT)];case 2:return o.sent(),[2]}}))}))},t.prototype.postMessagePromise=function(e,t,o,r){var i=this;return void 0===r&&(r=this.timeout),new Promise((function(n,a){var s=e.instanceId,l=setTimeout((function(){a(new Error("PostMessage response timeout: ".concat(e.name," / ").concat(e.instanceId))),c(!1)}),r),c=function(e){void 0===e&&(e=!1);var r=e?i.on.bind(i):i.off.bind(i);r(o,p),r(t,d),e||clearTimeout(l)},p=function(e){s===e.instanceId&&(a(e.data),c(!1))},d=function(e){s===e.instanceId&&(n(e),c(!1))};c(!0),i.postMessage(e)}))},t.prototype.destroy=function(){var o;t.instanceCount-=1,t.instanceCount<=0&&(clearTimeout(t.rejectTimeout),t.rejectTimeout=null,null===(o=t.iframeEl)||void 0===o||o.remove(),t.iframeEl=null,t.instanceCount=0,t.storageDefer=new SimpleDefer,e.prototype.destroy.call(this))},t.prototype.receiverMessageHandler=function(o){if(this.isBridgeMessage(o.data))return o.data.name===BridgeMessageName.STORAGE_READY?(t.storageDefer.resolve(),void clearTimeout(t.rejectTimeout)):void e.prototype.receiverMessageHandler.call(this,o)},t.storageDefer=new SimpleDefer,t.instanceCount=0,t}(MessageBridge),PageWatcher=function(e){function t(){var o=e.call(this)||this;return o.emitPageLeave=function(){"hidden"===document.visibilityState&&(Date.now()-o.pageLeaveTimeStamp<=t.THROTTLE_GAP||(o.pageLeaveTimeStamp=Date.now(),o.emit(PageWatcherEvent.PageLeave)))},o.emitPageUnload=function(){Date.now()-o.pageUnloadTimeStamp<=t.THROTTLE_GAP||(o.pageUnloadTimeStamp=Date.now(),o.emit(PageWatcherEvent.UNLOAD))},o.setPageLeave(),o.setPageUnload(),o}return __extends$d(t,e),t.prototype.setPageLeave=function(){window.addEventListener("pagehide",this.emitPageLeave),document.addEventListener("visibilitychange",this.emitPageLeave)},t.prototype.setPageUnload=function(){window.addEventListener("beforeunload",this.emitPageUnload),window.addEventListener("unload",this.emitPageUnload)},t.THROTTLE_GAP=10,t}(s$1),PageWatcherEvent;!function(e){e.PageLeave="pageLeave",e.UNLOAD="unload"}(PageWatcherEvent||(PageWatcherEvent={}));var singleton=new PageWatcher,PageWatcher$1={instance:singleton,PageWatcherEvent:PageWatcherEvent};function collectData(){return{vuid:cookieTool.get("vqq_vuserid")||cookieTool.get("vuserid"),openid:cookieTool.get("openid")||cookieTool.get("vqq_openid"),guid:lsTool.getData(exports.LOCAL_KEY.GUID)}}var WHITE_LIST_URL="//v.qq.com/cache/wuji/object?appid=tenvideo_offline_log&schemaid=whileList&schemakey=d5dccc35902346b2bdcbcef774fefe99",cbIndex=0,WhiteListType;function fetchWhiteList(e){var t=encodeURIComponent('projectId="'.concat(e,'"')),o="".concat(WHITE_LIST_URL,"&include=encryptValue,type&filter=").concat(t,"&otype=jsonp");return cbIndex+=1,netTool.jsonp(o,{name:"offline_log"+cbIndex%200,timeout:3e3})}function validateWhiteList(e){return __awaiter$7(this,void 0,void 0,(function(){var t,o;return __generator$7(this,(function(r){switch(r.label){case 0:t=collectData(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,fetchWhiteList(e)];case 2:return o=r.sent(),[2,Object.entries(WhiteListType).some((function(e){var r=e[0],i=e[1],n=t[r];return n&&o.data.some((function(e){return e.type===i&&e.encryptValue===sha256.exports.sha256(n)}))}))];case 3:return r.sent(),[2,!1];case 4:return[2]}}))}))}!function(e){e.vuid="2",e.guid="5",e.openid="6"}(WhiteListType||(WhiteListType={}));var OfflineLogPlugin=function(e){function t(o,r,i){var n=e.call(this,o,r,i)||this;return n.pageWatcher=PageWatcher$1.instance,n.logInfoChange={},n.isDestroy=!1,n.onPageLeave=function(){n.storeLogs()},n.storeLogs=function(e){return __awaiter$7(n,void 0,void 0,(function(){var t,o,r,i,n;return __generator$7(this,(function(a){switch(a.label){case 0:if(!(t=this.instanceId))return[2];if(o=Logger.cache[t],r={logs:o,info:this.logInfoChange,ext:e},i=e||r.logs.length||Boolean(Object.keys(this.logInfoChange).length),Logger.cache[t]=[],this.logInfoChange={},!i)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.remoteStorage.storeLogs(r)];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),this.logger.error("Error occur when store offlineLog: ".concat(n)),[3,4];case 4:return[2]}}))}))},n.onPlayerError=function(e){var t,o,r;n.logInfoChange.code=null===(r=null===(o=null===(t=e.data)||void 0===t?void 0:t.videoInfo)||void 0===o?void 0:o.error)||void 0===r?void 0:r.code,n.storeLogs()},n.config=__assign$a(__assign$a({},DEFAULT_CONFIG$1),r||{}),n.logger=new Logger(n.instanceId,t.pluginName),n.remoteStorage=new RemoteStorageBridge(RECORDER_DEPLOY_URL,n.instanceId),RemoteStorageBridge.storageDefer.promise.then((function(){n.isDestroy||(n.setPollLogger(),n.setPageWatcher(),n.setPlayerEvt())})).catch((function(e){n.logger.error("Error occur when init DB: ".concat(e))})),n.logEnvInfo(),n.checkWhiteList(),n}return __extends$d(t,e),Object.defineProperty(t,"isEnvSupport",{get:function(){return"function"==typeof window.Proxy},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){return __awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),this.isDestroy=!0,this.setPollLogger(!1),this.setPageWatcher(!1),this.setPlayerEvt(!1),[4,this.storeLogs({clearContentCache:!0})];case 1:case 2:return t.sent(),[3,4];case 3:return this.remoteStorage.destroy(),e.prototype.destroy.call(this),[7];case 4:return[2]}}))}))},t.prototype.report=function(e,o){return __awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(r){switch(r.label){case 0:if(!e&&!t.isInWhiteList)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.remoteStorage.report({downloadOnFailed:e,reportSource:o})];case 2:return r.sent(),[2,{status:!0,msg:""}];case 3:return[2,{status:!1,msg:r.sent().message}];case 4:return[2]}}))}))},t.prototype.logEnvInfo=function(){try{this.logger.log("UserAgent: ".concat(navigator.userAgent)),this.logger.log("URL: ".concat(location.href)),this.logger.log("TOP URL: ".concat(urlTool.getTopFrameUrl())),this.logger.log("instanceId: ".concat(this.player.config.instanceId)),this.logger.log("Kernel List: ".concat(Object.keys(KernelFactory$1.kernelMap).join(",")))}catch(e){}},t.prototype.checkWhiteList=function(){return __awaiter$7(this,void 0,void 0,(function(){var e,o,r;return __generator$7(this,(function(i){switch(i.label){case 0:return t.hasCheckWhiteList?[2]:(e=this.config.platform,t.hasCheckWhiteList=!0,o=t,[4,validateWhiteList(e)]);case 1:if(o.isInWhiteList=i.sent(),!t.isInWhiteList)return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.report(!1,"white")];case 3:return i.sent(),[3,5];case 4:return r=i.sent(),this.logger.error("Error occur when reporting: ".concat(r)),[3,5];case 5:return[2]}}))}))},t.prototype.setPollLogger=function(e){void 0===e&&(e=!0);var t=this.config.pollTime,o=void 0===t?3e3:t;clearInterval(this.pollTimer),e&&(this.pollTimer=window.setInterval(this.storeLogs,o))},t.prototype.setPageWatcher=function(e){void 0===e&&(e=!0);var t=this.pageWatcher,o=e?t.on.bind(t):t.off.bind(t);o(PageWatcher$1.PageWatcherEvent.PageLeave,this.onPageLeave),o(PageWatcher$1.PageWatcherEvent.UNLOAD,this.onPageLeave)},t.prototype.setPlayerEvt=function(e){void 0===e&&(e=!0),(e?this.player.on.bind(this.player):this.player.off.bind(this.player))(exports.PLAY_EVENT.ERROR,this.onPlayerError)},t.prototype.hookVideoReqInfoEnd=function(e){var t,o,r=null===(o=null===(t=e.data)||void 0===t?void 0:t.error)||void 0===o?void 0:o.code;r&&(this.logInfoChange.code=r),this.logInfoChange.videoName=this.player.dataset.commonMap.videoName,this.storeLogs()},t.prototype.hookPlaySessionStart=function(){this.logInfoChange=this.collectLogInfo(),this.storeLogs()},t.prototype.hookPlaySessionEnd=function(e){this.logInfoChange.code=e.code,this.storeLogs({clearInfoCache:!0})},t.prototype.collectLogInfo=function(){var e=this.player.dataset.commonMap,t=e.guid,o=e.drm,r=e.videoName,i=e.vid,n=e.hc_vuserid,a=e.flowid,s=e.platform;return{code:"",drm:Boolean(o),startTime:Date.now(),endTime:Date.now(),guid:t,ua:navigator.userAgent,url:location.href,videoName:r,vid:i,platform:s,vuid:n,instanceId:this.instanceId,id:a}},Object.defineProperty(t.prototype,"instanceId",{get:function(){return this.player.config.instanceId},enumerable:!1,configurable:!0}),t.pluginName="offlineLog",t.hasCheckWhiteList=!1,t.isInWhiteList=!1,t}(Plugin),DEFAULT_CONFIG$1={platform:"1",disable:!1,pollTime:3e3},RECORDER_DEPLOY_URL="https://v.qq.com/thumbplayer-offline-log.html",PlayLimitConfigValidateMsg;!function(e){e.EMPTY_CONFIG="配置不能为空",e.POINTS_BOTH_EMPTY="startPoint / endPoint 配置不能同时为空",e.START_TIME_BELOW_ZERO="startPoint.value 值不能小于 0",e.END_TIME_BELOW_START_TIME="endPoint.value 值不能小于 startPoint.value"}(PlayLimitConfigValidateMsg||(PlayLimitConfigValidateMsg={}));var DEFAULT_PRIORITY=0,DEFAULT_END_STATE=exports.END_STATE.NORMAL,DEFAULT_PLAYTIME_BOUNDARY={startTime:0,startPriority:DEFAULT_PRIORITY,endTime:1/0,endPriority:DEFAULT_PRIORITY,endState:exports.END_STATE.NORMAL},ruleValidator={emptyConfigCheck:function(e){if(!e)return PlayLimitConfigValidateMsg.EMPTY_CONFIG},emptyStartAndEndCheck:function(e){var t=e.startPoint,o=e.endPoint;if(!t&&!o)return PlayLimitConfigValidateMsg.POINTS_BOTH_EMPTY},startBelowZero:function(e){var t=e.startPoint;if(t&&t.value<0)return PlayLimitConfigValidateMsg.START_TIME_BELOW_ZERO},endBelowStart:function(e){var t=e.startPoint,o=e.endPoint;if(t&&o&&t.value>=o.value)return PlayLimitConfigValidateMsg.END_TIME_BELOW_START_TIME}},CONFIG_ID_START=0,PlaytimeLimiterPlugin=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.configRules=ruleValidator,t.nextId=CONFIG_ID_START,t.limitConfigMap={},t.isCanplayEmitted=!1,t.canplaySeekPos=null,t.hookVideoTimeupdate=function(e){if(!(e.playtime<t.range.endTime))return t.player.corePlayer.stop(t.range.endState),s$1.STOP_IMMEDIATE_PROPAGATION},t.hookPlaySessionEnd=function(){t.isCanplayEmitted=null,t.canplaySeekPos=null},t}return __extends$d(t,e),Object.defineProperty(t.prototype,"range",{get:function(){return this.limitRange||(this.limitRange=this.mergePlaytimeLimitConfigs(Object.values(this.limitConfigMap))),__assign$a({},this.limitRange)},enumerable:!1,configurable:!0}),t.prototype.addLimitConfig=function(e){var t;if(!this.validatePlayTimeConfig(e))return null;var o=null!==(t=e.id)&&void 0!==t?t:this.generateID();return this.limitConfigMap[o]=__assign$a(__assign$a({},e),{vidOrUrl:this.player.vid||this.player.url}),this.onConfigChange(),o},t.prototype.deleteLimitConfig=function(e){delete this.limitConfigMap[e],this.onConfigChange()},t.prototype.clearAllConfig=function(e){var t=this;Object.entries(this.limitConfigMap).forEach((function(o){var r=o[0];o[1].vidOrUrl!==e&&delete t.limitConfigMap[r]})),this.limitRange=null},t.prototype.getLimitConfig=function(e){return this.limitConfigMap[e]},t.prototype.setLimitConfig=function(e,t){return!(!this.getLimitConfig(e)||!this.validatePlayTimeConfig(t))&&(this.limitConfigMap[e]=t,this.onConfigChange(),!0)},t.prototype.generateID=function(){return this.nextId++},t.prototype.validatePlayTimeConfig=function(e){var t=this;return Object.values(this.configRules).every((function(o){var r=o(e);return!r||(t.player.log(r),!1)}))},t.prototype.mergePlaytimeLimitConfigs=function(e){var t=this,o=__assign$a({},DEFAULT_PLAYTIME_BOUNDARY);return e.forEach((function(e){var r=e.startPoint,i=e.endPoint;o=t.mergeStartPoint(o,r),o=t.mergeEndPoint(o,i)})),o},t.prototype.mergeStartPoint=function(e,t){return this.shouldUpdateStartTime(e,t)?__assign$a(__assign$a({},e),{startTime:t.value,startPriority:t.priority||DEFAULT_PRIORITY}):e},t.prototype.shouldUpdateStartTime=function(e,t){if(!t)return!1;var o=t.value,r=t.priority,i=void 0===r?DEFAULT_PRIORITY:r,n=e.startTime,a=e.startPriority;return o<e.endTime&&(i>a||i===a&&o>n)},t.prototype.mergeEndPoint=function(e,t){return this.shouldUpdateEndTime(e,t)?__assign$a(__assign$a({},e),{endTime:t.value,endPriority:t.priority||DEFAULT_PRIORITY,endState:t.endState||DEFAULT_END_STATE}):e},t.prototype.shouldUpdateEndTime=function(e,t){if(!t)return!1;var o=t.value,r=t.priority,i=void 0===r?DEFAULT_PRIORITY:r,n=e.startTime,a=e.endPriority,s=e.endTime;return o>n&&(i>a||i===a&&o<s)},t.prototype.onConfigChange=function(){if(this.limitRange=this.mergePlaytimeLimitConfigs(Object.values(this.limitConfigMap)),!(this.player.playtime>=this.range.startTime))return this.seekPlayer(this.range.startTime),__assign$a({},this.limitRange)},t.prototype.hookVideoCanplay=function(){!this.isCanplayEmitted&&this.canplaySeekPos&&(this.player.seek(this.canplaySeekPos),this.canplaySeekPos=null),this.isCanplayEmitted=!0},t.prototype.seekPlayer=function(e){this.isCanplayEmitted?this.player.seek(this.canplaySeekPos):this.canplaySeekPos=e},t.pluginName="playtimeLimiter",t}(Plugin),report=function(e){var t=e.data,o=void 0===t?{}:t,r=e.url,i=void 0===r?"":r,n=e.forceImage,a=void 0!==n&&n,s=constructPayload(o);!a&&s.length>MAX_LENGTH_OF_PAYLOAD?netTool.xhr({method:"POST",url:i,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}):(new Image).src="".concat(i,"&").concat(s)},constructPayload=function(e){void 0===e&&(e={});var t=Object.keys(e).reduce((function(t,o){var r;return t[o]=encodeURIComponent(null!==(r=e[o])&&void 0!==r?r:""),t}),{_dc:Math.random()});return urlTool.object2string(t,"&")},MAX_LENGTH_OF_PAYLOAD=2048,BaseReporter=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;return i.RELEASE_DELAY=3e5,i.reporter=report,i.reportedEvt={},i.FLOW_DATA_KEY="",i.REPORT_URL="",i.REPORT_KEY="",i.config=o,i}return __extends$d(t,e),t.prototype.saveToLS=function(e,t){var o=this.getPrevData();o[e]={data:t,ts:Date.now()},lsTool.setData(this.FLOW_DATA_KEY,JSON.stringify(o))},t.prototype.removeFromLS=function(e){var t=this.getPrevData();delete t[e],lsTool.setData(this.FLOW_DATA_KEY,JSON.stringify(t))},t.prototype.reportPrev=function(){var e=this,t=this.getPrevData();Object.keys(t).forEach((function(o){t[o].ts+e.RELEASE_DELAY<Date.now()&&(e.report(t[o].data),delete t[o])})),lsTool.setData(this.FLOW_DATA_KEY,JSON.stringify(t))},t.prototype.report=function(e){var t;if(void 0===e&&(e={}),!uaTool.spider){var o=__assign$a(__assign$a({},this.reportHeader),e);if(this.reporter({data:o,url:this.REPORT_URL,key:this.REPORT_KEY,forceImage:this.config.forceImage}),"function"==typeof(null===(t=this.config)||void 0===t?void 0:t.onAfterReport))try{this.config.onAfterReport(o)}catch(e){}}},t.prototype.handlePageHide=function(e){if(void 0===e&&(e={}),!uaTool.spider&&this.reporterForPageHide){var t=__assign$a(__assign$a({},this.reportHeader),e);this.reporterForPageHide({data:t,url:this.REPORT_URL,key:this.REPORT_KEY})}},t.prototype.getPrevData=function(){var e,t=lsTool.getData(this.FLOW_DATA_KEY)||"{}";try{e=JSON.parse(t)}catch(t){e={}}return e},t}(Plugin),VodQaReportBeaconAppKey="0WEB0QEJW44KW5A5",LiveQaReportBeaconAppKey="0WEB0CN7W9446C2I",VodQaReportCacheKey="__thumbplayer_vod_qa_report__",BeaconSDKPath="//beacon.cdn.qq.com/sdk/4.5.13/beacon_web.min.js",RequestMaxRetry=3,BeaconRequest=function(){function e(){}return e.loadBeaconSDK=function(){var t=this;return"function"==typeof window.BeaconAction?Promise.resolve():(e.SDKLoadingDefer||(e.SDKLoadingDefer=new Promise((function(e,o){return __awaiter$7(t,void 0,void 0,(function(){var t,r,i;return __generator$7(this,(function(n){switch(n.label){case 0:r=0,n.label=1;case 1:if(!(r<RequestMaxRetry))return[3,6];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,domTool.loadScript(BeaconSDKPath)];case 3:return n.sent(),e(),[3,6];case 4:return i=n.sent(),t=i,[3,5];case 5:return r++,[3,1];case 6:return o(t),[2]}}))}))}))),e.SDKLoadingDefer)},e.flushQueue=function(t){e.queues[t]&&e.instances[t]&&(e.queues[t].forEach((function(t){e.report(t)})),e.queues[t]=[])},e.clear=function(t){e.queues[t]=[]},e.report=function(t){var o=t.data,r=t.key,i=e.instances[r],n=(o||{}).stepname;i?i.onDirectUserAction(n,o):e.queues[r].push(t)},e.reportWhenPageHide=function(t){var o=t.data,r=t.key,i=e.instances[r],n=(o||{}).stepname;i&&i.onSendBeacon(n,o)},e.register=function(t,o){return __awaiter$7(this,void 0,void 0,(function(){var r,i,n,a;return __generator$7(this,(function(s){switch(s.label){case 0:if(r=t,i=!1,"object"==typeof t&&(r=t.appKey,i=!!t.isOversea),e.queues[r])return[2];e.queues[r]=[],o&&(e.SDKLoadingDefer=o),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,e.loadBeaconSDK()];case 2:return s.sent(),e.SDKLoadingDefer=null,n=new window.BeaconAction({appkey:r,strictMode:!1,isOversea:i}),e.instances[r]=n,e.flushQueue(r),[3,4];case 3:return a=s.sent(),console.error(a),[3,4];case 4:return[2]}}))}))},e.instances={},e.queues={},e}(),getQQFromCookie$1=function(){var e=cookieTool.get("luin")||cookieTool.get("uin");return e&&(e=e.replace(/\D/g,"").replace(/^0+/,"")),e},BufferThresholds=1200,PlatCode;!function(e){e.Web="web",e.H5="h5"}(PlatCode||(PlatCode={}));var DEFAULT_KEYS$1$1={cdnuip:"",iqq:"",pvid:"",qqopen_id:COMMON_DATA_KEY.hc_openid,playno:COMMON_DATA_KEY.flowid,cdnid:COMMON_DATA_KEY.cdnid,guid:COMMON_DATA_KEY.guid,fplayerver:COMMON_DATA_KEY.playerver,dsip:"",sstrength:"",devtype:"",nettype:"",freetype:"",platform:COMMON_DATA_KEY.platform,vplatform:COMMON_DATA_KEY.platform,codec:COMMON_DATA_KEY.codec,device:COMMON_DATA_KEY.device,resolution:COMMON_DATA_KEY.resolution,osver:COMMON_DATA_KEY.osver,playertype:COMMON_DATA_KEY.playertype,appver:COMMON_DATA_KEY.appVer,use_p2p:COMMON_DATA_KEY.p2p,p2p_play:COMMON_DATA_KEY.p2p,p2pver:COMMON_DATA_KEY.p2pver,playtype:"",scenesid:COMMON_DATA_KEY.sid,sid:COMMON_DATA_KEY.vid,livepid:COMMON_DATA_KEY.livepid,contentid:COMMON_DATA_KEY.cid,drm:COMMON_DATA_KEY.drmtype,videocapability:COMMON_DATA_KEY.videoCapability,playtime:"",isuserpay:"",live_type:"",xserverip:"",durl:"",lookback:"",live_tag:"",extraInfo:"",spanId:"",tuid:"",ext1:"",ext2:"",ext3:""},CMD$1,STEP_NAME$1;!function(e){e[e.START=205]="START",e[e.LOOP=263]="LOOP",e[e.ERROR=150]="ERROR"}(CMD$1||(CMD$1={})),function(e){e.START="live_loading",e.LOOP="live_period",e.ERROR="live_error"}(STEP_NAME$1||(STEP_NAME$1={}));var LiveQaReporterPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;i.REPORT_KEY=LiveQaReportBeaconAppKey,i.seq=0,i.lastPlayDuration=0,i.bufferHistory=[],i.flowHeader={cnntime:0,maxspeed:0,testspeed:0,downspeed:0,recnncount:0,loadingtime:0,blockcount:0,blocktime:0,errorcode:0,geturltime:0,fullecode:"",prdlength:0,get_stream_data_duration:0,get_sync_frame_duration:0,live_delay:0},i.isSettingLevel=!1,i.setEvtHandler=function(){i.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,i.onStateChange),i.player.on(exports.PLAY_EVENT.RETRY_BACKURL,i.onRetryUrl)},i.onRetryUrl=function(){i.flowHeader.recnncount=i.flowHeader.recnncount+1},i.onStateChange=function(e){var t,o=e.data,r=o.key,n=((t={})[exports.DATA_STATE.LOAD_END]=i.onLoad,t[exports.DATA_STATE.BUFFER_END]=i.onBuffer,t[exports.DATA_STATE.GET_INFO_END]=i.onGetinfoEnd,t[exports.DATA_STATE.SET_LEVEL_START]=i.onSetLevel,t[exports.DATA_STATE.SESSION_START]=i.onSessionStart,t[exports.DATA_STATE.SESSION_END]=i.onSessionEnd,t);n[r]&&n[r](o)},i.onSessionStart=function(){i.resetLoopData(),i.seq=0},i.onSessionEnd=function(e){var t=e.newVal,o=(void 0===t?{}:t).code;i.onPeriod({code:o}),i.seq=0,i.endPeriodReport(),i.reportedEvt={}},i.startPeriodReport=function(){i.endPeriodReport(),i.period=setInterval(i.onPeriod,6e4)},i.endPeriodReport=function(){i.period&&(clearInterval(i.period),i.period=null)},i.onSetLevel=function(){i.isSettingLevel=!0,i.onPeriod(),i.endPeriodReport()},i.onBuffer=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,n=void 0===r?{}:r,a=o.ftime,s=n.ftime;a-s<=BufferThresholds||i.bufferHistory.push({stime:s,etime:a})},i.onGetinfoEnd=function(e){var t=e.newVal,o=e.startEvent,r=t.ftime,n=o.ftime;i.flowHeader.geturltime=r-n},i.onLoad=function(e){if(!i.reportedEvt[CMD$1.START]||i.isSettingLevel){i.reportedEvt[CMD$1.START]=!0,i.isSettingLevel=!1;var t=e.startEvent,o=void 0===t?{}:t,r=e.newVal,n=void 0===r?{}:r,a=n.code;a===exports.ErrorCode.SUC&&(i.flowHeader.loadingtime=n.ftime-o.ftime,i.flowHeader.errorcode=a,i.flowHeader.fullecode=a,i.report({step:CMD$1.START,stepname:STEP_NAME$1.START,code:a}),i.startPeriodReport())}},i.onPeriod=function(e){var t=(e||{code:exports.ErrorCode.SUC}).code,o=void 0===t?exports.ErrorCode.SUC:t,r=i.bufferHistory.reduce((function(e,t){return[e[0]+1,e[1]+(t.etime-t.stime)]}),[0,0]),n=r[0],a=r[1],s=i.player.dataset.getStats().playDuration;i.flowHeader.blockcount=n,i.flowHeader.blocktime=a,i.flowHeader.prdlength=s-i.lastPlayDuration,i.flowHeader.errorcode=o,i.flowHeader.fullecode=o;var l={step:o===exports.ErrorCode.SUC?CMD$1.LOOP:CMD$1.ERROR,stepname:o===exports.ErrorCode.SUC?STEP_NAME$1.LOOP:STEP_NAME$1.ERROR,code:o};i.report(l),i.resetLoopData(),i.lastPlayDuration=s},i.resetLoopData=function(){i.bufferHistory=[],i.flowHeader=__assign$a(__assign$a({},i.flowHeader),{blockcount:0,blocktime:0,errorcode:0,loadingtime:0,fullecode:"",prdlength:0,recnncount:0,downspeed:0,live_delay:0})};var n=t.config.liveQaReporterConfig;return i.config={paramsKey:__assign$a(__assign$a({},DEFAULT_KEYS$1$1),(null==n?void 0:n.paramsKey)||{}),onAfterReport:null==n?void 0:n.onAfterReport,onBeforeReport:null==n?void 0:n.onBeforeReport},i.setEvtHandler(),BeaconRequest.register({appKey:i.REPORT_KEY,isOversea:!!(null==n?void 0:n.isOversea)},null==n?void 0:n.externalBeaconDefer),i.log("live-qa-reporter registered to ".concat(i.REPORT_KEY,", oversea: ").concat(!!(null==n?void 0:n.isOversea))),i.reporter=BeaconRequest.report,i}return __extends$d(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e,t,o=this.config.paramsKey,r=void 0===o?{}:o,i=this.player.getCommonKv;return __assign$a({videocapability:i(r.videocapability)||"",cdnuip:i(r.cdnuip)||"",iqq:i(r.iqq)||getQQFromCookie$1(),qqopen_id:i(r.qqopen_id)||"",pvid:cookieTool.get("pgv_pvid")||"",playno:i(r.playno)||"",cdnid:i(r.cdnid)||"",guid:i(r.guid)||"",fplayerver:i(r.fplayerver)||"",dsip:i(r.dsip)||"",sstrength:i(r.sstrength)||0,devtype:i(r.devtype)||0,nettype:i(r.nettype)||100,codec:i(r.codec)||CODEC.H264,freetype:i(r.freetype)||0,platform:i(r.platform)||"",vplatform:i(r.platform)||"",device:i(r.device)||"",resolution:i(r.resolution)||"",osver:i(r.osver)||"",playertype:i(r.playertype)||0,appver:i(r.appver)||"",use_p2p:i(r.use_p2p)||0,p2p_play:i(r.p2p_play)||0,p2pver:i(r.p2pver)||"",playtype:i(r.playtype)||1,scenesid:i(r.scenesid)||0,drm:i(r.drm)||0,sid:i(r.sid)||0,livepid:i(r.livepid)||0,contentid:i(r.contentid)||0,playtime:i(r.playtime)||0,isuerpay:i(r.isuserpay)||0,live_type:i(r.live_type)||0,xserverip:i(r.xserverip)||"",durl:i(r.durl)||(null===(t=null===(e=this.player)||void 0===e?void 0:e.currentVideoInfo)||void 0===t?void 0:t.loadingUrl)||"",lookback:i(r.lookback)||0,live_tag:i(r.live_tag)||0,extraInfo:i(r.extraInfo)||"",spanId:i(r.spanId)||"",tuid:i(r.tuid)||"",kernel:this.player.kernelName,plat_code:uaTool.mobile?PlatCode.H5:PlatCode.Web,domain:urlTool.getDomainOfURL(urlTool.getTopFrameUrl()),seq:this.seq,ext1:i(r.ext1)||"",ext2:i(r.ext2)||"",ext3:i(r.ext3)||""},this.flowHeader)},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.endPeriodReport(),BeaconRequest.clear(this.REPORT_KEY),e.prototype.destroy.call(this)},t.prototype.report=function(t){e.prototype.report.call(this,t),this.seq=this.seq+1},t.pluginName="live-qa-reporter",t}(BaseReporter),AdReportHelper=function(){function e(e){var t=this;this.reportData={},this.currentBufferHistory=[],this.onStateChange=function(e){var o,r=e.data,i=r.new,n=r.old,a=((o={})[exports.VIDEO_STATE.CANPLAY]=t.onCanPlay,o[exports.VIDEO_STATE.BUFFERING]=t.onBuffering,o[exports.VIDEO_STATE.END]=t.onEnd,o);a[i]&&a[i](e.data.videoInfo,n)},this.onError=function(e){var o,r,i=e.data.videoInfo;if(i){var n=i.uid,a=i.error,s=t.reportData[n];s&&(s.load>=0&&(t.emitToMainReporter({code:a.code,step:"30",stime:s.load,stepname:STEP_NAME.FIRST_LOAD,etime:Date.now(),url:i.loadingUrl,urlIndex:(null===(r=null===(o=i.config)||void 0===o?void 0:o.backupUrls)||void 0===r?void 0:r.findIndex((function(e){return e===i.loadingUrl})))||-1},s),s.load=-1),t.emitToMainReporter({step:"50",playDuration:i.playtime,code:a.code,stepname:STEP_NAME.END,tbcount:0,tbduration:0,scount:0,etime:Date.now(),bcount:t.currentBufferHistory.length,tduration:t.currentBufferHistory.reduce((function(e,t){return e+(t.etime-t.stime)}),0)},s))}},this.onFirstPlaying=function(e){var o=e.data.videoInfo;if(o){var r=t.reportData[o.uid];if(r){r.load>=0&&t.reportFirstLoad(o,r);var i=Date.now(),n={step:"32",stepname:STEP_NAME.FIRST_RENDERING,stime:i,etime:i,code:exports.ErrorCode.SUC};t.emitToMainReporter(n,r)}else;}},this.onVideoNodeChange=function(e){var o=e.data.videoInfo;o&&!t.reportData[o.uid]&&(t.reportData[o.uid]={seq:0,flowidSuffix:"_ad".concat(t.getAdClipNumber()),load:Date.now()})},this.reportFirstLoad=function(e,o){var r,i,n,a,s,l,c=null!==(a=null===(n=null===(i=null===(r=t.adPlayer.currentVideoInfo)||void 0===r?void 0:r.extraVars)||void 0===i?void 0:i.stream)||void 0===n?void 0:n.cacheSize)&&void 0!==a?a:0,p={step:"30",stepname:STEP_NAME.FIRST_LOAD,stime:o.load,etime:Date.now(),url:e.loadingUrl,urlIndex:(null===(l=null===(s=e.config)||void 0===s?void 0:s.backupUrls)||void 0===l?void 0:l.findIndex((function(t){return t===e.loadingUrl})))||-1,code:exports.ErrorCode.SUC,cachesize:c};t.emitToMainReporter(p,o),o.load=-1},this.onCanPlay=function(e){if(e){var o=t.reportData[e.uid];if(o){if(o.load>=0)return void t.reportFirstLoad(e,o);if(o.buffer>=0){var r=Date.now(),i=o.buffer;if(o.buffer=-1,r-i<=1200)return;t.currentBufferHistory.push({stime:i,etime:Date.now()});var n={step:"35",stime:i,stepname:STEP_NAME.BUFFERING,etime:Date.now(),ptime:t.adPlayer.playtime,code:exports.ErrorCode.SUC};return void t.emitToMainReporter(n,o)}}}},this.onEnd=function(e){if(e){var o=t.reportData[e.uid];if(o){var r={step:"50",playDuration:e.playtime,code:exports.ErrorCode.SUC,stepname:STEP_NAME.END,tbcount:0,tbduration:0,scount:0,etime:Date.now(),bcount:t.currentBufferHistory.length,tduration:t.currentBufferHistory.reduce((function(e,t){return e+(t.etime-t.stime)}),0)};t.emitToMainReporter(r,o)}}},this.onBuffering=function(e){if(e){var o=t.reportData[e.uid];o&&(o.buffer=Date.now())}},this.reporterPlugin=e}return e.prototype.destroy=function(){this.unbindCoreEvents()},e.prototype.init=function(e,t){this.adPlayer&&this.unbindCoreEvents();var o=e.currentVideoInfo;o&&(this.adPlayer=e,this.adType=t,this.bindCoreEvents(),this.reportData={},this.reportData[o.uid]={seq:0,flowidSuffix:"ad".concat(this.getAdClipNumber()),load:Date.now()})},e.prototype.getAdClipNumber=function(){return Object.keys(this.reportData).length},e.prototype.bindCoreEvents=function(){this.adPlayer.on(exports.PLAY_EVENT.STATE_CHANGE,this.onStateChange),this.adPlayer.on(exports.PLAY_EVENT.ERROR,this.onError),this.adPlayer.on(exports.PLAY_EVENT.VIDEONODE_FIRST_PLAYING,this.onFirstPlaying),this.adPlayer.on(exports.PLAY_EVENT.VIDEONODE_CHANGE,this.onVideoNodeChange)},e.prototype.unbindCoreEvents=function(){this.adPlayer.off(exports.PLAY_EVENT.STATE_CHANGE,this.onStateChange),this.adPlayer.off(exports.PLAY_EVENT.ERROR,this.onError),this.adPlayer.off(exports.PLAY_EVENT.VIDEONODE_FIRST_PLAYING,this.onFirstPlaying),this.adPlayer.off(exports.PLAY_EVENT.VIDEONODE_CHANGE,this.onVideoNodeChange)},e.prototype.emitToMainReporter=function(e,t){var o=__assign$a(__assign$a({code:exports.ErrorCode.SUC},e),{flowid:t.flowidSuffix,seq:t.seq,scenesid:SCENES_ID[this.adType]||SCENES_ID.otherAd,duration:this.adPlayer.duration,kernel:this.adPlayer.kernelName,vid:"",fmt:"",rate:"",cdnid:"",cdnip:"",drm:"",definition:"",dltype:""});t.seq+=1,this.reporterPlugin.emit("adReport",o)},e}(),STEP_NAME,SCENES_ID;!function(e){e.INIT="init_player",e.GETINFO="get_cdn_url",e.FIRST_LOAD="first_load",e.FIRST_RENDERING="first_rendering",e.BUFFERING="second_buffering",e.SEEKING="user_seek",e.END="play_done"}(STEP_NAME||(STEP_NAME={})),function(e){e[e.preAd=400]="preAd",e[e.ZT=401]="ZT",e[e.postAd=402]="postAd",e[e.otherAd=403]="otherAd",e[e.video=421]="video"}(SCENES_ID||(SCENES_ID={}));var DEFAULT_KEYS$2={platform:COMMON_DATA_KEY.platform,vplatform:COMMON_DATA_KEY.platform,flowid:COMMON_DATA_KEY.flowid,uin:"",QQopenid:COMMON_DATA_KEY.hc_openid,WXopenid:COMMON_DATA_KEY.hc_openid,logintype:COMMON_DATA_KEY.hc_main_login,guid:COMMON_DATA_KEY.guid,uip:"",cdnuip:COMMON_DATA_KEY.cdnuip,codec:COMMON_DATA_KEY.codec,cdnip:COMMON_DATA_KEY.cdnip,online:COMMON_DATA_KEY.online,p2p:COMMON_DATA_KEY.p2p,sstrength:COMMON_DATA_KEY.sstrength,network:COMMON_DATA_KEY.network,speed:COMMON_DATA_KEY.speed,device:COMMON_DATA_KEY.device,resolution:COMMON_DATA_KEY.resolution,testid:COMMON_DATA_KEY.testid,osver:COMMON_DATA_KEY.osver,p2pver:COMMON_DATA_KEY.p2pver,appver:COMMON_DATA_KEY.appVer,playerver:COMMON_DATA_KEY.playerver,playertype:COMMON_DATA_KEY.playertype,confid:COMMON_DATA_KEY.confid,cdnid:COMMON_DATA_KEY.cdnid,drm:COMMON_DATA_KEY.drmtype,scenesid:"",playtype:"",dltype:COMMON_DATA_KEY.dltype,vid:COMMON_DATA_KEY.vid,definition:COMMON_DATA_KEY.currentDefn,fmt:COMMON_DATA_KEY.fmt,rate:COMMON_DATA_KEY.rate,videocapability:COMMON_DATA_KEY.videoCapability,isad:"",duration:"",kernel:"",ext1:"",ext2:"",ext3:""},VodQaReporterPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;i.REPORT_KEY=VodQaReportBeaconAppKey,i.FLOW_DATA_KEY=VodQaReportCacheKey,i.seq=0,i.bufferHistory=[],i.seekHistory=[],i.initData={fmt:"",rate:"",cdnid:""},i.bufferCount=0,i.seekCount=0,i.setEvtHandler=function(){i.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,i.onStateChange),i.player.on(exports.PLAY_EVENT.SETLEVEL_OVER,(function(){i.bufferCount=0,i.seekCount=0})),window.addEventListener("pagehide",i.onPageHide)},i.onPageHide=function(){i.handlePageHide(i.collectFinalData())},i.onStateChange=function(e){var t,o=e.data,r=o.key,n=((t={})[exports.DATA_STATE.INIT]=i.onPlayerInit,t[exports.DATA_STATE.LOAD_END]=i.onLoad,t[exports.DATA_STATE.BUFFER_END]=i.onBuffer,t[exports.DATA_STATE.GET_INFO_END]=i.onGetinfoEnd,t[exports.DATA_STATE.SEEK_END]=i.onSeek,t[exports.DATA_STATE.SESSION_END]=i.onPlaySessionEnd,t[exports.DATA_STATE.FIRST_PLAY]=i.onFirstPlay,t[exports.DATA_STATE.SESSION_START]=i.reset,t[exports.DATA_STATE.RETRY_BACKURL]=function(){i.bufferCount=0,i.seekCount=0},t);n[r]&&n[r](o)},i.onPlayerInit=function(e){var t=e.newVal,o=t.ftime,r=t.ext,n=(void 0===r?{}:r).stime;i.report({stepname:STEP_NAME.INIT,step:"5",stime:n,etime:o,code:exports.ErrorCode.SUC})},i.onGetinfoEnd=function(e){var t=e.newVal,o=e.startEvent,r=t.ftime,n=t.code,a=o.ftime;i.report({stepname:STEP_NAME.GETINFO,step:"15",stime:a,etime:r,code:n})},i.onLoad=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,n=(void 0===r?{}:r).ftime,a=o,s=a.ftime,l=a.currentUrl,c=a.urlIndex,p=a.code;i.report({stepname:STEP_NAME.FIRST_LOAD,step:"30",stime:n,etime:s,url:l||"",urlindex:c+1,fileopenedtime:0,firstpacketreadtime:0,code:p})},i.onFirstPlay=function(){if(!i.reportedEvt[STEP_NAME.FIRST_RENDERING]){i.reportedEvt[STEP_NAME.FIRST_RENDERING]=!0;var e=+new Date;i.report({step:"32",stepname:STEP_NAME.FIRST_RENDERING,stime:e,etime:e,code:exports.ErrorCode.SUC})}},i.onBuffer=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,n=void 0===r?{}:r,a=o.ftime,s=o.playtime,l=o.currentUrl,c=o.code,p=n.ftime,d=n.prevState===exports.VIDEO_STATE.SEEKING?1:0,u=i.player.playbackRate>1?2:1;a-p<=BufferThresholds||(i.bufferHistory.push({stime:p,etime:a}),i.bufferCount<20&&(i.report({step:"35",stepname:STEP_NAME.BUFFERING,ptime:s,levent:d,stime:p,etime:a,scene:u,format:i.player.getCommonKv(i.config.paramsKey.fmt)||0,url:l||"",reason:0,code:c,vt:i.player.getCommonKv(i.config.paramsKey.cdnid)||0}),i.bufferCount+=1))},i.onSeek=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,n=void 0===r?{}:r,a=o.ftime,s=o.playtime,l=o.code,c=o.ext,p=void 0===c?{}:c,d=n.ftime,u=n.playtime;p.isUserSeek&&(i.seekHistory.push({lstime:d,letime:a}),i.seekCount<20&&(i.report({step:"40",stepname:STEP_NAME.SEEKING,lstime:d,letime:a,pstime:u,petime:s,format:i.player.getCommonKv(i.config.paramsKey.fmt)||0,code:l}),i.seekCount+=1))},i.onPlaySessionEnd=function(e){if(!i.reportedEvt[STEP_NAME.END]){i.reportedEvt[STEP_NAME.END]=!0;var t=e.newVal,o=void 0===t?{}:t,r=o.ftime,n=o.code,a=i.player.dataset.getStats().playDuration,s=[0===n.indexOf(exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX),0===n.indexOf("70014"),0===n.indexOf("7004"),"70011112"===n,"70011113"===n].some((function(e){return e})),l=s?exports.ErrorCode.SUC:n;i.report(__assign$a(__assign$a({step:"50",stepname:STEP_NAME.END,etime:r,playduration:a,code:l},i.seekStat),i.bufferStat)),i.removeFromLS(i.player.getCommonKv(COMMON_DATA_KEY.flowid)),i.seq=0}},i.onInit=function(){i.reportPrev()},i.collectFinalData=function(){var e=+new Date;if(i.player.getCommonKv(COMMON_DATA_KEY.flowid)&&!i.reportedEvt[STEP_NAME.END]){var t=i.player.dataset.getStats().playDuration;return __assign$a(__assign$a({step:"50",stepname:STEP_NAME.END,etime:e,code:exports.ErrorCode.SUC,playduration:t},i.seekStat),i.bufferStat)}},i.reset=function(){i.reportedEvt={},i.initData.fmt="",i.initData.rate="",i.initData.cdnid="",i.bufferHistory=[],i.seekHistory=[],i.bufferCount=0,i.seekCount=0};var n=t.config.vodQaReporterConfig;return i.config={paramsKey:__assign$a(__assign$a({},DEFAULT_KEYS$2),(null==n?void 0:n.paramsKey)||{}),onAfterReport:null==n?void 0:n.onAfterReport,onBeforeReport:null==n?void 0:n.onBeforeReport},i.setEvtHandler(),BeaconRequest.register({appKey:i.REPORT_KEY,isOversea:!!(null==n?void 0:n.isOversea)},null==n?void 0:n.externalBeaconDefer),i.log("vod-qa-reporter registered to ".concat(i.REPORT_KEY,", oversea: ").concat(!!(null==n?void 0:n.isOversea))),i.reporter=BeaconRequest.report,i.reporterForPageHide=BeaconRequest.reportWhenPageHide,i.onInit(),i.adReportHelper=new AdReportHelper(i),i.player.on(exports.H5_PLAY_EVENT.AD_REQ_ASSETS_START,(function(e){var o=e.data;setTimeout((function(){var e=getAdPlugin(null==t?void 0:t.config.instanceId)[o.adType===exports.AD_TYPE.ZT?"ztVideoAdPlayer":"videoAdPlayer"];e&&i.adReportHelper.init(e,o.adType)}))})),i.on("adReport",(function(t){e.prototype.report.call(i,__assign$a(__assign$a({},t.data),{flowid:"".concat(i.reportHeader.flowid,"_").concat(t.data.flowid),isad:1}))})),i}return __extends$d(t,e),Object.defineProperty(t.prototype,"seekStat",{get:function(){var e=this.seekHistory.reduce((function(e,t){var o=e[0],r=e[1],i=t.letime-t.lstime;return i>BufferThresholds?[o+1,r+i]:e}),[0,0]);return{tbcount:e[0],tbduration:e[1],scount:this.seekHistory.length}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferStat",{get:function(){return{tduration:this.bufferHistory.reduce((function(e,t){return e+(t.etime-t.stime)}),0),bcount:this.bufferHistory.length}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e=this,t=this.config.paramsKey,o=this.player.getCommonKv,r=this.player.dataset.getStats(),i=r.averageDecodeTimeInMs,n=r.frameDroppedInPercentage;return Object.entries(this.initData).forEach((function(r){var i=r[0];r[1]||(e.initData[i]=o(t[i])||"")})),{videocapability:o(t.videocapability)||"",platform:o(t.platform)||"",vplatform:o(t.platform)||"",flowid:o(t.flowid)||"",uin:o(t.uin)||getQQFromCookie$1(),QQopenid:o(t.QQopenid)||"",WXopenid:o(t.WXopenid)||"",logintype:o(t.logintype)||0,guid:o(t.guid)||"",uip:o(t.uip)||"",cdnuip:o(t.cdnuip)||"",cdnip:o(t.cdnip)||"",online:o(t.online)||1,p2p:o(t.p2p)||0,sstrength:o(t.sstrength)||0,network:o(t.network)||0,speed:o(t.speed)||0,device:o(t.device)||"",resolution:o(t.resolution)||"",testid:o(t.testid)||0,codec:o(t.codec)||CODEC.H264,osver:o(t.osver)||"",p2pver:o(t.p2pver)||"",appver:o(t.appver)||"",playerver:o(t.playerver)||"",confid:o(t.confid)||0,playertype:o(t.playertype)||0,cdnid:this.initData.cdnid,scenesid:o(t.scenesid)||SCENES_ID.video,playtype:0,dltype:o(t.dltype)||0,vid:o(t.vid)||"",fmt:this.initData.fmt,rate:this.initData.rate,drm:o(t.drm)||0,definition:o(t.definition)||"",duration:Math.round(o(t.duration)||this.player.duration),seq:this.seq,kernel:this.player.kernelName,domain:urlTool.getDomainOfURL(urlTool.getTopFrameUrl()),isad:0,ext1:o(t.ext1)||"",ext2:o(t.ext2)||"",ext3:o(t.ext3)||"",framedrop:n,avgdecodecost:i}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){window.removeEventListener("pagehide",this.onPageHide),BeaconRequest.clear(this.REPORT_KEY),e.prototype.destroy.call(this)},t.prototype.report=function(t){e.prototype.report.call(this,t),this.seq=this.seq+1},t.pluginName="vod-qa-reporter",t}(BaseReporter),OFFICIAL_PLUGIN={VOD_FLOW_REPORTER:"vod-flow-reporter",LIVE_FLOW_REPORTER:"live-flow-reporter",GETINFO_LIVE:"getinfo-live",GETINFO_VOD:"getinfo-vod",GETINFO_TC:"getinfo-tc",BARRAGE:"barrage",MARKID:"markid",CONTEXT_MENU:"context-menu",WATERMARK:"ui-watermark",UI_PREVIEW:"ui-preview",UI_PREVIEW_LIST:"ui-preview-list",POLL_DURATION:"poll-duration",REPORTERS:"reporters",UI_ROLE_FILTER:"ui-role-filter",SETTING_BTN:"setting-btn",CTRLBAR:"ctrlbar",ERROR_PAGE:"error-page",FULLSCREEN_RATIO:"fullscreen-ratio",INFO_PANEL:"info-panel",LIVE_POLL:"live-poll",POSTER:"poster",SUBTITLE:"subtitle",TIPS:"tips",UI_LOADING:"ui-loading",VR:"vr",TVK_UTILS:"tvk-utils",UNMUTE_BTN:"unmute-btn"},PLUGIN_MAP={"vod-flow-reporter":{cdnPath:"thumbplayer-plugin-atta-reporter",version:"1.4.104"},"live-flow-reporter":{cdnPath:"thumbplayer-plugin-atta-reporter",version:"1.4.104"},"getinfo-live":{pluginName:"__thumbplayer-video-request",version:"1.4.133"},"getinfo-vod":{pluginName:"__thumbplayer-video-request",version:"1.4.133"},"getinfo-tc":{pluginName:"__thumbplayer-video-request",version:"1.4.125"},barrage:{pluginName:"Barrage",version:"1.4.133"},markid:{pluginName:"ui-markid",version:"1.4.133"},"context-menu":{cdnPath:"thumbplayer-plugin-ui-contextmenu",version:"1.4.133"},"ui-preview-list":{cdnPath:"thumbplayer-plugin-ui-preview",version:"1.4.133"},"ui-preview":{cdnPath:"thumbplayer-plugin-ui-preview",version:"1.4.133"},"ui-watermark":{cdnPath:"thumbplayer-plugin-watermark",version:"1.4.133"},"poll-duration":{version:"1.4.133"},reporters:{version:"1.4.133"},"ui-role-filter":{version:"1.4.133"},"setting-btn":{version:"1.4.133"},ctrlbar:{version:"1.4.133"},"error-page":{version:"1.4.133"},"fullscreen-ratio":{version:"1.4.133"},"info-panel":{version:"1.4.133"},"live-poll":{version:"1.4.104"},poster:{version:"1.4.133"},subtitle:{version:"1.4.133"},tips:{version:"1.4.133"},"ui-loading":{version:"1.4.133"},vr:{version:"1.4.133"},"tvk-utils":{version:"1.4.133"},"unmute-btn":{version:"1.4.133"}},H5_PAUSE_TYPE,AUTO_PLAY_POLICY,PictureDirection;exports.H5_PAUSE_TYPE=void 0,H5_PAUSE_TYPE=exports.H5_PAUSE_TYPE||(exports.H5_PAUSE_TYPE={}),H5_PAUSE_TYPE.USER_CLICK="user-click",exports.AUTO_PLAY_POLICY=void 0,AUTO_PLAY_POLICY=exports.AUTO_PLAY_POLICY||(exports.AUTO_PLAY_POLICY={}),AUTO_PLAY_POLICY.IN_MUTED="autoPlayInMuted",AUTO_PLAY_POLICY.USER_GESTURE="autoPlayRequireByUserGesture",exports.PictureDirection=void 0,PictureDirection=exports.PictureDirection||(exports.PictureDirection={}),PictureDirection.NORMAL="normal",PictureDirection.VERTICAL="vertical",PictureDirection.HORIZON="horizon";var PluginablePlayer=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.plugins={},t.pluginMsg=new s$1,t.playerApiProxy={},t.pluginMsgProxy={on:t.pluginMsg.on.bind(t.pluginMsg),off:t.pluginMsg.off.bind(t.pluginMsg),once:t.pluginMsg.once.bind(t.pluginMsg)},t._destroyed=!1,t.loadPlugin=function(e){var o=e.config,r=e.timeout,i=e.version,n=e.crossOrigin,a=e.globalName,s=e.pluginName,l=void 0===s?a:s,c=e.insName,p=e.url;if(!p&&!PLUGIN_MAP[l])throw new Error("您所传入的插件不是官方插件，必须提供 url");if(!p&&PLUGIN_MAP[l]){var d=i||PLUGIN_MAP[l].version,u=PLUGIN_MAP[l].cdnPath||"thumbplayer-plugin-".concat(l);l=PLUGIN_MAP[l].pluginName||l,p="//vm.gtimg.cn/thumbplayer/plugins/".concat(u,"/").concat(d,"/index.min.js")}return c=c||l,domTool.loadScript(p,void 0,r,{crossOrigin:n}).then((function(){t._destroyed||(getPlugin(l)||registerPlugin(l,window[a]),t.plugins[c]||t.createPlugin(c,__assign$a(__assign$a({},o),{pluginName:l})))}))},t}return __extends$d(t,e),t.prototype.createPlugin=function(e,t){void 0===t&&(t={});var o=t.pluginName,r=void 0===o?e:o,i=getPlugin(r);if(!i)throw new Error("cannot find plugin: ".concat(r));this.triggerSetupEvent({name:e,plugin:i,instance:null},!0),createPluginFactory(e,i,this,t,{msg:this.pluginMsgProxy,api:this.playerApiProxy}),r===AdPluginName&&(setAdPlugin(this.config.instanceId,this.plugins[AdPluginName]),delete this.plugins[AdPluginName]),this.triggerSetupEvent({name:e,plugin:i,instance:null})},t.prototype.createPlugins=function(e){var t=this;e.forEach((function(e){try{"string"==typeof e?t.createPlugin(e):t.createPlugin.apply(t,e)}catch(e){console.error(e)}}))},t.prototype.triggerSetupEvent=function(e,t){var o=this;void 0===t&&(t=!1);var r="".concat(t?"before":"","pluginsetup");setTimeout((function(){o.pluginMsg.emit("".concat(r,":").concat(e.name),e)}))},t.registerPlugin=registerPlugin,t.deregisterPlugin=deregisterPlugin,t.getPlugins=getPlugins,t.getPlugin=getPlugin,t.isFunctionPlugin=isFunctionPlugin,t.pluginExists=pluginExists,t.isBasicPlugin=isFunctionPlugin,t}(s$1);function definePlugins(e){return e.map((function(e){return[e[0].pluginName,e[1]]}))}function autobind(e){return function(t,o,r){var i=e;if(!i){var n="on".length,a=o.slice(n).toLowerCase(),s=Object.keys(exports.PLAY_EVENT).find((function(e){return exports.PLAY_EVENT[e].toLowerCase()===a}));s?i=exports.PLAY_EVENT[s]:(s=Object.keys(exports.H5_PLAY_EVENT).find((function(e){return exports.H5_PLAY_EVENT[e].toLowerCase()===a})),i=exports.H5_PLAY_EVENT[s])}var l=r.value;r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i&&this.player?this.player.on(i,l.bind(this)):l.apply(this,e)}}}var logApiInvoke=function(e,t,o){var r=o.value;o.value=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i="";try{i=JSON.stringify(e)}catch(e){i="parse arg failed"}return this.setStateKv(t,{type:exports.LOG_TYPE.API_INVOKE,ftime:Date.now(),ext:{from:"thumbplayer-h5",args:i}}),r.apply(this,e)}},once=function(e,t,o){var r=o.value;o.value=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(!this["__hasRun".concat(t)])return this["__hasRun".concat(t)]=!0,r.apply(this,e)}},BaseFlowNode=function(e){function t(t){var o=e.call(this)||this;return o.flowid=t.flowid,o}return __extends$d(t,e),t.prototype.destroy=function(){this.removeAllListeners()},t.prototype.getName=function(){return""},t.prototype.replay=function(e,t){return Promise.reject("replay not implemented! (".concat(this.getName(),")"))},t.prototype.retry=function(e,t){},t}(s$1),FLOW_NODE_EVENT;exports.FLOW_NODE_EVENT=void 0,FLOW_NODE_EVENT=exports.FLOW_NODE_EVENT||(exports.FLOW_NODE_EVENT={}),FLOW_NODE_EVENT.PRELOAD_NEXT="PRELOAD_NEXT",FLOW_NODE_EVENT.PRELOAD="PRELOAD",FLOW_NODE_EVENT.START="START",FLOW_NODE_EVENT.END="END",FLOW_NODE_EVENT.ABORT="ABORT";var AdFlowNode=function(e){function t(t){var o,r=this;return(r=e.call(this,t)||this).config=t,r.onAdEnd=function(e){var t,o=e.data;o.adType===exports.AD_TYPE.PRE&&(r.config.corePlayer.volume=null===(t=getAdPlugin(r.config.instanceId))||void 0===t?void 0:t.getAdVolume()),r.isInValidAd(o)||r.endFlow()},r.onAdAssetsLoaded=function(e){var t=e.data;r.isInValidAd(t)||r.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{name:r.getName()})},r.onAdPlayBlocked=function(e){var t=e.data;r.isInValidAd(t)||(r.isPreload=!0)},r.logger=new Logger(t.instanceId,"AdFlowNode"),null===(o=getAdPlugin(t.instanceId))||void 0===o||o.on(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,r.onAdPlayBlocked),r}return __extends$d(t,e),t.prototype.getName=function(){return"AdFlowNode.".concat(this.config.startParam.adType)},t.prototype.start=function(){return this.logger.log("".concat(this.getName()," exec start")),this.emit(exports.FLOW_NODE_EVENT.START,{name:this.getName()}),this.checkCanPlayAd()?(this.isPreload=!1,this.bindAdEvents(),this.playAd()):(this.logger.log("".concat(this.getName()," skip exec start")),void this.endFlow())},t.prototype.preload=function(){var e,t=this;this.logger.log("".concat(this.getName()," exec preload")),this.emit(exports.FLOW_NODE_EVENT.PRELOAD,{name:this.getName()});var o=function(){t.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{forcePreload:!0,name:t.getName()})};return this.checkCanPlayAd()?(this.isPreload=!0,this.bindAdEvents(),null===(e=getAdPlugin(this.config.instanceId))||void 0===e?void 0:e.loadAd(this.startParam).then((function(e){!1===e&&o()})).catch(o)):(this.logger.log("".concat(this.getName()," skip exec preload")),void o())},t.prototype.pause=function(){var e,t;this.logger.log("".concat(this.getName()," exec pause")),null===(e=getAdPlugin(this.config.instanceId))||void 0===e||e.pauseAd(null===(t=this.startParam)||void 0===t?void 0:t.adType)},t.prototype.resume=function(){this.logger.log("".concat(this.getName()," exec resume")),this.playAd()},t.prototype.destroy=function(){var t=getAdPlugin(this.config.instanceId);t&&(t.off(exports.H5_PLAY_EVENT.AD_END,this.onAdEnd),t.off(exports.H5_PLAY_EVENT.AD_ASSETS_LOADED,this.onAdAssetsLoaded),t.off(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,this.onAdPlayBlocked)),e.prototype.destroy.call(this)},t.prototype.checkCanPlayAd=function(){return getAdPlugin(this.config.instanceId)&&this.startParam},t.prototype.bindAdEvents=function(){var e,t;null===(e=getAdPlugin(this.config.instanceId))||void 0===e||e.on(exports.H5_PLAY_EVENT.AD_END,this.onAdEnd),null===(t=getAdPlugin(this.config.instanceId))||void 0===t||t.on(exports.H5_PLAY_EVENT.AD_ASSETS_LOADED,this.onAdAssetsLoaded)},t.prototype.playAd=function(){var e,t=this;return null===(e=getAdPlugin(this.config.instanceId))||void 0===e?void 0:e.playAd(this.startParam).catch((function(){return t.endFlow()}))},Object.defineProperty(t.prototype,"startParam",{get:function(){return this.config.startParam},enumerable:!1,configurable:!0}),t.prototype.endFlow=function(){this.emit(exports.FLOW_NODE_EVENT.END,{name:this.getName()}),this.destroy()},t.prototype.isInValidAd=function(e){return e.adType!==this.config.startParam.adType},__decorate$9([once,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[]),__metadata$9("design:returntype",void 0)],t.prototype,"bindAdEvents",null),t}(BaseFlowNode),FlowManager=function(){function e(e){this.config=e,this.flowNodeList=[],this.currentFlowNodeIndex=0,this.lastNodeList=[],this.logger=new Logger(e.playerInstanceId,"FlowManager")}return Object.defineProperty(e.prototype,"onFlowEnd",{get:function(){return this.config.onFlowEnd||function(){}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onFlowEvts",{get:function(){return this.config.onFlowEvts||function(){}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFlowNode",{get:function(){return this.flowNodeList[this.currentFlowNodeIndex]},enumerable:!1,configurable:!0}),e.prototype.push=function(){for(var e,t=this,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];o.forEach((function(e){return t.bindNodeEvents(e)})),(e=this.flowNodeList).push.apply(e,o)},e.prototype.setLastNode=function(e){this.lastNodeList.push(e)},e.prototype.clear=function(){this.flowNodeList.forEach((function(e){return e.destroy()})),this.flowNodeList=[],this.lastNodeList=[],this.currentFlowNodeIndex=0},e.prototype.bindNodeEvents=function(e){var t,o=this,r=((t={})[exports.FLOW_NODE_EVENT.PRELOAD_NEXT]=function(t){var r,i=t.data;o.logger.log("".concat(e.getName()," emited: FLOW_NODE_EVENT.PRELOAD_NEXT")),o.config.disablePreload&&!(null==i?void 0:i.forcePreload)||null===(r=o.getNextNode(e))||void 0===r||r.preload()},t[exports.FLOW_NODE_EVENT.END]=function(t){var r=t.data;o.logger.log("".concat(e.getName()," emited: FLOW_NODE_EVENT.END")),r.videoEndState&&(o.videoEndState=r.videoEndState),e.removeAllListeners();var i=o.getNextNode(e);if(!i){var n=e.getName();return o.logger.log("no next node after ".concat(n,", clear")),o.clear(),o.onFlowEnd({code:exports.ErrorCode.SUC,endState:o.videoEndState,curFlowNodeName:n}),void(o.videoEndState="")}if(o.lastNodeList.includes(e)){n=e.getName();return o.logger.log("lastNodeList includes ".concat(n,", end")),o.onFlowEnd({code:exports.ErrorCode.SUC,curFlowNodeName:n})}o.currentFlowNodeIndex+=1,o.logger.log("next node start, current index is ".concat(o.currentFlowNodeIndex)),i.start()},t[exports.FLOW_NODE_EVENT.ABORT]=function(t){var r=t.data,i=e.getName();o.logger.log("".concat(i," emited: FLOW_NODE_EVENT.ABORT")),o.clear(),o.onFlowEnd(__assign$a(__assign$a({},r),{endState:r.endState||exports.END_STATE.ERROR,curFlowNodeName:i}))},t);Object.keys(exports.FLOW_NODE_EVENT).forEach((function(t){e.on(t,(function(e){var t=e.type,i=e.data;o.onFlowEvts(t,i),r[t]&&r[t]({data:i})}))}))},e.prototype.getNextNode=function(e){var t=this.flowNodeList.indexOf(e);if(-1!==t)return this.flowNodeList[t+1]},e}(),VideoFlowNode=function(e){function t(t){var o,r=e.call(this,t)||this;return r.config=t,r.isReplaying=!1,r.isDestroyed=!1,r.onVideoPlayBlocked=function(){return r.isPreload=!0},r.onVideoTimeUpdate=function(){var e;if(!r.isLive){var t=null!==(e=r.startParam.postAdReqLeftTime)&&void 0!==e?e:10;Number.isNaN(t)||r.corePlayer.playtime+t>=r.corePlayer.duration&&r.emitPreloadNext()}},r.onVideoStop=function(e){var t,o=e.data;r.isReplaying?r.isReplaying=!1:(null===(t=o.videoInfo)||void 0===t?void 0:t.error)||(r.flowOverHandler(),r.emit(exports.FLOW_NODE_EVENT.END,{videoEndState:o.endState,name:r.getName()}))},r.logger=new Logger(r.corePlayer.config.instanceId,"VideoFlowNode"),r.evtMap=((o={})[exports.PLAY_EVENT.TIME_UPDATE]=r.onVideoTimeUpdate,o[exports.PLAY_EVENT.STOPED]=r.onVideoStop,o[exports.PLAY_EVENT.AUTOPLAY_BLOCKED]=r.onVideoPlayBlocked,o),r.setPlayerEvents(!0),r}return __extends$d(t,e),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.corePlayer.config.type===exports.PLAY_MODE.LIVE},enumerable:!1,configurable:!0}),t.prototype.getName=function(){return"VideoFlowNode"},t.prototype.start=function(){return __awaiter$7(this,void 0,void 0,(function(){var e,t,o;return __generator$7(this,(function(r){switch(r.label){case 0:return this.logger.log("".concat(this.getName()," exec start")),this.emit(exports.FLOW_NODE_EVENT.START,{name:this.getName()}),this.isPreload?(this.isPreload=!1,this.logger.log("".concat(this.getName()," exec start on preloaded")),[4,this.loadDefer]):[3,2];case 1:return r.sent(),this.isLive&&this.corePlayer.resize({width:"100%"}),this.corePlayer.play(),[2];case 2:return this.isPreload=!1,[4,this.getVideoRsp()];case 3:return e=r.sent(),t=e.urlConfig,(o=e.kernelName)&&(this.startParam.videoLoadParam=__assign$a({kernelName:o},this.startParam.videoLoadParam)),"function"==typeof this.config.videoLoadParamModifier&&(this.startParam.videoLoadParam=this.config.videoLoadParamModifier(this.startParam.videoLoadParam)),this.corePlayer.play(t,this.startParam.videoLoadParam),[2]}}))}))},t.prototype.preload=function(){return __awaiter$7(this,void 0,void 0,(function(){var e,t,o;return __generator$7(this,(function(r){switch(r.label){case 0:return this.logger.log("".concat(this.getName()," exec preload")),this.emit(exports.FLOW_NODE_EVENT.PRELOAD,{name:this.getName()}),this.isPreload=!0,this.loadDefer=this.getVideoRsp(),[4,this.loadDefer];case 1:return e=r.sent(),t=e.urlConfig,(o=e.kernelName)&&(this.startParam.videoLoadParam=__assign$a({kernelName:o},this.startParam.videoLoadParam)),this.isLive?(this.corePlayer.volume=0,[4,this.corePlayer.play(t,this.startParam.videoLoadParam)]):[3,3];case 2:return r.sent(),this.corePlayer.resize({width:0}),[3,4];case 3:this.corePlayer.load(t,this.startParam.videoLoadParam),r.label=4;case 4:return[2]}}))}))},t.prototype.pause=function(e){this.logger.log("".concat(this.getName()," exec pause")),this.corePlayer.pause(e)},t.prototype.resume=function(){this.logger.log("".concat(this.getName()," exec resume")),this.corePlayer.play()},t.prototype.setLevel=function(e,t){var o,r;return void 0===t&&(t={}),__awaiter$7(this,void 0,void 0,(function(){var i,n,a=this;return __generator$7(this,(function(s){switch(s.label){case 0:return i=null===(o=this.corePlayer.currentVideoInfo)||void 0===o?void 0:o.config,this.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_START,{level:e}),[4,this.getLevelUrlConfig(e)];case 1:if(!(n=s.sent())||!n.url)throw new Error("setLevel url is empty");return t.setLevelMode?n.setLevelMode=t.setLevelMode:(null==i?void 0:i.drmConfig)||n.drmConfig||n.chachaParam?n.setLevelMode=SET_LEVEL_MODE.HARD:n.setLevelMode=void 0,[2,null===(r=this.corePlayer.setLevel(n.url,n.backupUrls,n))||void 0===r?void 0:r.catch((function(t){throw a.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,{code:(null==t?void 0:t.code)||exports.ErrorCode.UNKNOWN,message:null==t?void 0:t.message,level:e}),t}))]}}))}))},t.prototype.updatePlayParam=function(e){var t=__assign$a(__assign$a({},this.startParam.videoReqInfoParam),null==e?void 0:e.videoReqInfoParam),o=__assign$a(__assign$a({},this.startParam.videoLoadParam),null==e?void 0:e.videoLoadParam);this.startParam=__assign$a(__assign$a({},this.startParam),{videoReqInfoParam:t,videoLoadParam:o})},t.prototype.replay=function(e,t){return __awaiter$7(this,void 0,void 0,(function(){var o,r,i,n;return __generator$7(this,(function(a){switch(a.label){case 0:return this.updatePlayParam(t),isVideoId(e)?(this.logger.log("replay(), start request video info: ",this.startParam.videoReqInfoParam),[4,this.requestVideoInfo({emitFlowEvent:!1})]):(this.logger.log("replay(), start replay urlConfig: ",e),this.isReplaying=!0,[2,this.corePlayer.play(e,this.startParam.videoLoadParam)]);case 1:if(o=a.sent(),this.isDestroyed)return[2];if(i=(r=o||{}).error,n=r.urlConfig,!o)throw new Error("request video info failed");if(i)throw i;if(!n||!n.url)throw new Error("request video info failed because of empty UrlConfig");return this.isReplaying=!0,[2,this.corePlayer.play(n,this.startParam.videoLoadParam)]}}))}))},t.prototype.retry=function(e,t){var o=t||{},r=o.error,i=o.updatePlayParam,n=o.retryTimes,a=o.retryTimesInSession,s=o.degradeReason,l=void 0===s?0:s;if(e)return this.flowOverHandler(),void this.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$a(__assign$a({},r),{code:(null==r?void 0:r.code)||exports.ErrorCode.UNKNOWN,name:this.getName()}));this.logger.log("play retry, retryTimes=".concat(n,", retryTimesInSession=").concat(a)),this.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.RETRY_PLAY,{retryTimes:n,degradeReason:l}),0!==l&&this.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.DEGRADE_CODEC_PLAY,{degradeReason:l}),this.isPreload?(this.updatePlayParam(i),this.preload()):this.replay(this.startParam.vid,i)},t.prototype.destroy=function(){this.isDestroyed=!0,this.setPlayerEvents(!1),e.prototype.destroy.call(this)},t.prototype.emitPreloadNext=function(){this.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{forcePreload:!0,name:this.getName()})},t.prototype.requestVideoInfo=function(e){var t,o;return void 0===e&&(e={}),__awaiter$7(this,void 0,void 0,(function(){var r,i,n,a,s,l,c,p=this;return __generator$7(this,(function(d){switch(d.label){case 0:return r=this.config.videoReqInfoPlugin,i=e.extraData,n=void 0===i?{}:i,a=e.emitFlowEvent,s=void 0===a||a,r?(s&&this.tryEmit((function(){return p.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_START)})),null===(t=r.abort)||void 0===t||t.call(r),this.tryEmit((function(){return p.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.GETINFO_START)})),[4,r.request(this.startParam.vid,__assign$a(__assign$a(__assign$a({},this.startParam.videoReqInfoParam),{flowid:this.flowid}),n))]):[2];case 1:return l=d.sent(),this.tryEmit((function(){return p.config.extEvtDispatcher.emit(exports.PLAY_EVENT_EXT.GETINFO_OVER,l)})),c=(null===(o=l.error)||void 0===o?void 0:o.code)||exports.ErrorCode.SUC,s&&this.tryEmit((function(){return p.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,{code:c,data:l})})),[2,l]}}))}))},t.prototype.getVideoRsp=function(){return __awaiter$7(this,void 0,void 0,(function(){var e,t,o,r,i,n;return __generator$7(this,(function(a){switch(a.label){case 0:if(e=this.startParam.urlConfig)return[2,{urlConfig:e}];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.requestVideoInfo()];case 2:if(t=a.sent(),r=(o=t||{}).urlConfig,(i=o.error)||!isUrlConfigValid(r))throw i;return[2,t];case 3:return n=a.sent(),this.logger.log(n),this.flowOverHandler(),this.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$a(__assign$a({},n),{code:(null==n?void 0:n.code)||exports.ErrorCode.GETINFO_NET,name:this.getName()})),[2,{urlConfig:null}];case 4:return[2]}}))}))},t.prototype.setPlayerEvents=function(e){var t=this;void 0===e&&(e=!0);var o=e?this.corePlayer.on:this.corePlayer.off;Object.keys(this.evtMap).forEach((function(e){o.call(t.corePlayer,e,t.evtMap[e])}))},t.prototype.flowOverHandler=function(){},Object.defineProperty(t.prototype,"corePlayer",{get:function(){return this.config.corePlayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startParam",{get:function(){return this.config.startParam},set:function(e){this.config.startParam=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emitFromVideoNode",{get:function(){return this.config.emitFromVideoNode},enumerable:!1,configurable:!0}),t.prototype.getLevelUrlConfig=function(e){var t,o;return __awaiter$7(this,void 0,void 0,(function(){var r,i,n,a;return __generator$7(this,(function(s){switch(s.label){case 0:return isUrlConfig(e)?(r=e,[3,4]):[3,1];case 1:return"string"!=typeof e?[3,2]:(r={url:e},[3,4]);case 2:return i=__assign$a(__assign$a({},this.startParam.videoReqInfoParam),e),this.startParam=__assign$a(__assign$a({},this.startParam),{videoReqInfoParam:i}),[4,this.requestVideoInfo({emitFlowEvent:!1,extraData:i})];case 3:if(!(n=s.sent()))throw new Error;if(r=n.urlConfig,n.error)throw a=null===(o=null===(t=n.error.data)||void 0===t?void 0:t.params)||void 0===o?void 0:o.msg,this.emitFromVideoNode(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,{code:n.error.code||exports.ErrorCode.UNKNOWN,message:a||n.error.message,level:e}),n.error;s.label=4;case 4:return[2,r]}}))}))},t.prototype.tryEmit=function(e){try{e()}catch(e){this.logger.error(e)}},__decorate$9([once,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[]),__metadata$9("design:returntype",void 0)],t.prototype,"emitPreloadNext",null),t}(BaseFlowNode);function isUrlConfigValid(e){return Array.isArray(e)?e.every(isUrlConfig):isUrlConfig(e)}function isUrlConfig(e){return"string"==typeof(null==e?void 0:e.url)}var FlowPlayer=function(e){function t(t){var o=e.call(this)||this;o.isSettingLevel=!1,o.emitFromVideoNode=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.emit.apply(o,__spreadArray$4([e],t,!1))},o.onFlowEnd=function(e){var t,r=e.code,i=void 0===r?exports.ErrorCode.SUC:r,n=e.endState,a=void 0===n?exports.END_STATE.NORMAL:n,s=e.curFlowNodeName;o.log("onFlowEnd, code=".concat(i,", endState=").concat(a,", curFlowNodeName=").concat(s)),o.config.type===exports.PLAY_MODE.LIVE&&(null===(t=getAdPlugin(o.config.instanceId))||void 0===t||t.stopAd()),o.emit(exports.H5_PLAY_EVENT.PLAY_SESSION_END,__assign$a(__assign$a({},e),{endState:a,code:i,curFlowNodeName:s}))},o.onFlowEvts=function(e,t){var r,i=((r={})[exports.FLOW_NODE_EVENT.PRELOAD]=exports.PLAY_EVENT_EXT.FLOW_NODE_PRELOAD,r[exports.FLOW_NODE_EVENT.START]=exports.PLAY_EVENT_EXT.FLOW_NODE_START,r[exports.FLOW_NODE_EVENT.END]=exports.PLAY_EVENT_EXT.FLOW_NODE_END,r[exports.FLOW_NODE_EVENT.ABORT]=exports.PLAY_EVENT_EXT.FLOW_NODE_ABORT,r);o.pluginMsg.emit(i[e],t)};var r=t.useSingleVideoElement,i=void 0===r?uaTool.mobile:r;return o.corePlayer=new KernelProxy(__assign$a(__assign$a({},t),{maxVideoNodeCount:i?1:null==t?void 0:t.maxVideoNodeCount,createVideoNodeWhenLoad:i})),o.logger=new Logger(o.config.instanceId,"FlowPlayer"),o.flowManager=new FlowManager({playerInstanceId:o.config.instanceId,onFlowEnd:o.onFlowEnd,onFlowEvts:o.onFlowEvts,disablePreload:i}),o.proxyAllPlayEvent(),o.proxyStateChange(),o.proxyVideoStopped(),proxyPlayEvent(o,o.corePlayer),o.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){o.isSettingLevel=!1})),o}return __extends$d(t,e),Object.defineProperty(t.prototype,"videoReqInfoPlugin",{get:function(){return null},enumerable:!1,configurable:!0}),t.prototype.load=function(e,t){var o;return __awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(r){return e?(this.createFlowNodes(e,t),[2,null===(o=this.flowManager.currentFlowNode)||void 0===o?void 0:o.preload()]):[2,this.corePlayer.load()]}))}))},t.prototype.play=function(e,t){var o;return __awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(r){return e?(this.createFlowNodes(e,t),[2,null===(o=this.flowManager.currentFlowNode)||void 0===o?void 0:o.start()]):[2,this.resumePlay()]}))}))},t.prototype.setAudioTrack=function(e){return this.corePlayer.setAudioTrack(e)},t.prototype.getAudioTrackList=function(){return this.currentVideoInfo?this.currentVideoInfo.audioTracks:[]},t.prototype.getCurrentAudioTrack=function(){return this.currentVideoInfo?this.currentVideoInfo.currentAudioTrack:NaN},t.prototype.setLevel=function(e,t){return void 0===t&&(t={}),__awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(o){switch(o.label){case 0:if(!this.checkCanSetLevel())throw new Error("setLevel can't start");this.isSettingLevel=!0,o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.videoNode.setLevel(e,t)];case 2:return o.sent(),[3,5];case 3:throw o.sent();case 4:return this.isSettingLevel=!1,[7];case 5:return[2]}}))}))},t.prototype.preloadVid=function(e){throw new Error("Method not implemented.")},t.prototype.pause=function(e){var t=this.flowManager.currentFlowNode;return t?t.pause(e):this.corePlayer.pause(e)},t.prototype.seek=function(e){return this.corePlayer.seek(e)},t.prototype.stop=function(e){var t,o,r;if(this.flowManager.currentFlowNode){var i=this.flowManager.currentFlowNode.getName();this.log("stop(), endState=".concat(e,", curFlowNodeName=").concat(i)),this.flowManager.clear(),null===(o=getAdPlugin(null===(t=this.config)||void 0===t?void 0:t.instanceId))||void 0===o||o.stopAd(),null===(r=this.videoReqInfoPlugin)||void 0===r||r.abort(),this.corePlayer.stop(e),this.emit(exports.H5_PLAY_EVENT.PLAY_SESSION_END,{curFlowNodeName:i,code:exports.ErrorCode.SUC,endState:e||exports.END_STATE.INTERRUPT})}},t.prototype.destroy=function(){this.stop(),this.removeAllListeners(),this.corePlayer.destroy(),this._destroyed=!0},t.prototype.checkCanSetLevel=function(){return this.videoNode&&!this.isSettingLevel},t.prototype.loadPostAd=function(){this.videoNode&&this.flowManager.currentFlowNode===this.videoNode&&this.videoNode.emitPreloadNext()},t.prototype.prepareUsageData=function(){return this.corePlayer.prepareUsageData()},Object.defineProperty(t.prototype,"nodeBeforePreAd",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodeBeforePostAd",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoNode",{get:function(){return this.flowManager.flowNodeList.find((function(e){return e instanceof VideoFlowNode}))},enumerable:!1,configurable:!0}),t.prototype.proxyAllPlayEvent=function(){var e=this;Object.keys(exports.PLAY_EVENT).forEach((function(t){e.corePlayer.on(exports.PLAY_EVENT[t],(function(o){var r=o.data;return e.emit(exports.PLAY_EVENT[t],r)}))}))},t.prototype.proxyStateChange=function(){var e,t=this,o=((e={})[exports.VIDEO_STATE.LOAD_START]=exports.H5_PLAY_EVENT.VIDEO_LOAD_START,e[exports.VIDEO_STATE.CANPLAY]=exports.H5_PLAY_EVENT.VIDEO_CANPLAY,e[exports.VIDEO_STATE.BUFFERING]=exports.H5_PLAY_EVENT.VIDEO_BUFFERING,e[exports.VIDEO_STATE.SEEKING]=exports.H5_PLAY_EVENT.VIDEO_SEEKING,e[exports.VIDEO_STATE.SEEKED]=exports.H5_PLAY_EVENT.VIDEO_SEEKED,e);this.corePlayer.on(exports.PLAY_EVENT.STATE_CHANGE,(function(e){var r=e.data,i=r.new;if(o[i])return t.emit(o[i],{});i!==exports.VIDEO_STATE.PLAYING&&i!==exports.VIDEO_STATE.PAUSE||t.proxyPlayPause(i,r)}))},t.prototype.proxyVideoStopped=function(){var e=this;this.corePlayer.on(exports.PLAY_EVENT.STOPED,(function(t){var o,r=t.data,i=null===(o=null==r?void 0:r.videoInfo)||void 0===o?void 0:o.error,n=__assign$a(__assign$a({},r),{code:(null==i?void 0:i.code)||exports.ErrorCode.SUC});e.emit(exports.H5_PLAY_EVENT.VIDEO_END,n)}))},t.prototype.proxyPlayPause=function(e,t){var o;e===exports.VIDEO_STATE.PLAYING?this.emit(exports.H5_PLAY_EVENT.VIDEO_PLAYING,{isFirst:!(null===(o=t.videoInfo)||void 0===o?void 0:o.hasFirstPlaying)}):e===exports.VIDEO_STATE.PAUSE&&this.emit(exports.H5_PLAY_EVENT.VIDEO_PAUSE,{pauseType:t.pauseType})},t.prototype.resumePlay=function(){var e=this.flowManager.currentFlowNode;e?!1===e.isPreload?e.resume():e.start():this.corePlayer.play()},t.prototype.createFlowNodes=function(e,t){var o;this.flowManager.currentFlowNode&&(this.log("loadItem(), stop because of currentFlowNode is running"),this.stop());var r=comTool.createGUID();if(this.emit(exports.H5_PLAY_EVENT.PLAY_SESSION_START,{flowid:r,playItem:e}),!this._destroyed){var i=__assign$a({},t);isVideoId(e)?i.vid=e:i.urlConfig=e;var n=this.nodeBeforePreAd,a=this.nodeBeforePostAd;n instanceof BaseFlowNode&&this.flowManager.push(n);var s=new AdFlowNode({flowid:r,instanceId:this.config.instanceId,startParam:__assign$a({adType:exports.AD_TYPE.PRE},i.adParam),corePlayer:this.corePlayer});this.flowManager.push(s);var l=new VideoFlowNode({flowid:r,corePlayer:this.corePlayer,videoReqInfoPlugin:this.videoReqInfoPlugin,startParam:i,extEvtDispatcher:this.pluginMsg,emitFromVideoNode:this.emitFromVideoNode,videoLoadParamModifier:this.videoLoadParamModifier});if(this.flowManager.push(l),this.config.type!==exports.PLAY_MODE.LIVE){a instanceof BaseFlowNode&&this.flowManager.push(a);var c=new AdFlowNode({flowid:r,instanceId:this.config.instanceId,startParam:__assign$a({adType:exports.AD_TYPE.POST},i.adParam),corePlayer:this.corePlayer});this.flowManager.push(c),this.flowManager.setLastNode(c)}this.log("loadItem(), flowNodeList=".concat(null===(o=this.flowManager.flowNodeList)||void 0===o?void 0:o.map((function(e){return e.getName()}))))}},Object.defineProperty(t.prototype,"isCollected",{get:function(){return this.corePlayer._isCollected},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_kernel",{get:function(){return this.corePlayer._kernel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.corePlayer.config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useWorker",{get:function(){return this.corePlayer.useWorker},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kernelName",{get:function(){return this.corePlayer.kernelName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoElements",{get:function(){return this.corePlayer.videoElements},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoElement",{get:function(){return this.corePlayer.currentVideoElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPreload",{get:function(){return this.corePlayer.supportPreload},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.corePlayer.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playtime",{get:function(){return this.corePlayer.playtime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoInfos",{get:function(){return this.corePlayer.videoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preloadVideoInfos",{get:function(){return this.corePlayer.preloadVideoInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfo",{get:function(){return this.corePlayer.currentVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentVideoInfoIdx",{get:function(){return this.corePlayer.currentVideoInfoIdx},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalVideoInfoCount",{get:function(){return this.corePlayer.totalVideoInfoCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportPlaybackRate",{get:function(){return this.corePlayer.supportPlaybackRate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"played",{get:function(){return this.corePlayer.played},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.corePlayer.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoSize",{get:function(){return this.corePlayer.videoSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoBuffered",{get:function(){return this.corePlayer.videoBuffered},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return(e=this.logger).log.apply(e,t)},t.prototype.hasAppended=function(e){return this.corePlayer.hasAppended(e)},t.prototype.hasPreloaded=function(e){return this.corePlayer.hasPreloaded(e)},Object.defineProperty(t.prototype,"volume",{get:function(){return this.corePlayer.volume},set:function(e){this.corePlayer.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this.corePlayer.playbackRate},set:function(e){this.corePlayer.playbackRate=e},enumerable:!1,configurable:!0}),t.prototype.resizeVideoElements=function(e){return this.corePlayer.resizeVideoElements(e)},t.prototype.resize=function(e){return this.corePlayer.resize(e)},t.prototype.playNext=function(e){return this.corePlayer.playNext(e)},t.prototype.captureVideo=function(e,t,o,r,i){return this.corePlayer.captureVideo(e,t,o,r,i)},t.prototype.appendNext=function(e){return this.corePlayer.appendNext(e)},t.prototype.preloadNext=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return(e=this.corePlayer).preloadNext.apply(e,t)},t.prototype.clearAllPreload=function(){return this.corePlayer.clearAllPreload()},t.prototype.triggerAutoplay=function(){return this.corePlayer.triggerAutoplay()},t._isCollected=!1,t}(PluginablePlayer),_a$5,CHANNEL="npm";try{CHANNEL="npm"}catch(e){}var logMethodCall$1=logMethodCallDecoratorCreator("H5Player"),rotateTransformValue=(_a$5={},_a$5[exports.PictureDirection.VERTICAL]="rotateX(180deg)",_a$5[exports.PictureDirection.HORIZON]="rotateY(180deg)",_a$5[exports.PictureDirection.NORMAL]="none",_a$5),H5Player=function(e){function t(t){var o=e.call(this,__assign$a(__assign$a({},t.coreConfig),t))||this;o.plugins={},o.interactMod=null,o.getCommonKv=function(e){return o.dataset.commonMap[e]},o.getStateKv=function(e){return o.dataset.stateMap[e]},o.mutedVolume=1,o.hasMutePlayed=!1,o.mixin=function(e){var t="function"==typeof e?e():e;Object.keys(t).forEach((function(e){if(e in o)throw new Error("cannot override existing player method: ".concat(e));var r=t[e];"function"==typeof r?o[e]=r:console.error("mixin ".concat(r," is not a function"))}))},o.log("new H5Player(), input config=",jsonTool.safelyStringify(t));var r=Date.now(),i=t.container,n=t.plugins,a=t.mixins,s=t.lazyInitPlugins;if(o.container="string"==typeof i?document.querySelector(i):i,!o.container)throw new Error("cannot find container: ".concat(i));o.fullscreenLogics=new FullScreenLogics(o);return o.setMaxListeners(100),o.createClickMask(),o.createInnerPlugins(),n instanceof Array&&(s?setTimeout((function(){return o.createPlugins(n)})):o.createPlugins(n)),a instanceof Array&&a.forEach(o.mixin),o.initPluginApis(),o.forwardPluginEvents(),o.initContainerStyle(),o.setupEventFlagData(),o.setupLoopPlay(),o.checkAutoPlayInMute(),o.autoHideMouse(),o.applyStyleOnVideoNodeChange(),o.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){o.hasMutePlayed=!1})),o.setStateKv(exports.DATA_STATE.INIT,{type:exports.LOG_TYPE.CORE_EVENT,ftime:Date.now(),ext:{stime:r}}),o}return __extends$d(t,e),t.registerSavedCommonKey=function(e){DataSet.SETTING_CONFIG[e]?console.warn("key ".concat(e," already registered")):DataSet.SETTING_CONFIG.push({dsKey:e,lsKey:"__thumbplayer_custom_".concat(e,"__")})},t.prototype.load=function(t,o){return t?(this.cacheLoadParam(t,o),this.corePlayer.load(),e.prototype.load.call(this,t,this.getParamWithStartTime(t,o))):e.prototype.load.call(this)},t.prototype.play=function(t,o){return t?(this.cacheLoadParam(t,o),this.corePlayer.load(),e.prototype.play.call(this,t,this.getParamWithStartTime(t,o))):e.prototype.play.call(this)},t.prototype.createPlugin=function(t,o){void 0===o&&(o={}),e.prototype.createPlugin.call(this,t,o);var r=o.pluginName;(void 0===r?t:r)===AdPluginName&&proxyAdEvent(this)},t.prototype.replay=function(){var e,t,o=this.vid,r=this.playUrl;if(null===(t=null===(e=this.loadParam)||void 0===e?void 0:e.videoLoadParam)||void 0===t||delete t.startTime,o)return this.play(o,this.loadParam);if(r){var i=r.lastIndexOf("#");return i>0&&(r=r.slice(0,i)),this.play({url:r},this.loadParam)}this.log("Current player has no available vid or url to replay")},t.prototype.pause=function(t){return e.prototype.pause.call(this,t)},t.prototype.seek=function(t){var o=this.timeRange,r=o.startTime,i=o.endTime,n=Math.min(i,Math.max(r,t));return e.prototype.seek.call(this,n)},t.prototype.setPictureImage=function(e){void 0===e&&(e=exports.PictureDirection.NORMAL),this.pictureDirection=e,this.isPlayingAd?this.setAdVideoStyle({transform:rotateTransformValue[e]}):this.setVideoStyle({transform:rotateTransformValue[e]}),e===exports.PictureDirection.NORMAL&&(this.rotateDegree=0)},t.prototype.setRotate=function(e){"number"!=typeof e||Number.isNaN(e)||(this.rotateDegree=e,this.isPlayingAd?this.setAdVideoStyle({transform:"rotate(".concat(e,"deg)")}):this.setVideoStyle({transform:"rotate(".concat(e,"deg)")}))},t.prototype.getRotate=function(){return this.rotateDegree},t.prototype.requestFullScreen=function(e,t){return void 0===e&&(e=!0),__awaiter$7(this,void 0,void 0,(function(){return __generator$7(this,(function(o){return[2,this.fullscreenLogics.requestFullScreen(e,t)]}))}))},Object.defineProperty(t.prototype,"fullscreenMode",{get:function(){return this.fullscreenLogics.fullscreenMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this.corePlayer.volume},set:function(e){var t;this.corePlayer.volume=e,null===(t=getAdPlugin(this.config.instanceId))||void 0===t||t.setAdVolume(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeRange",{get:function(){return this.playtimeLimiter.range},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){var e,t,o=this;try{this.stop(),this.pluginMsg.emit(exports.PLAY_EVENT_EXT.DESTROY)}catch(e){this.log(e)}this.plugins&&(Object.keys(this.plugins).forEach((function(e){var t,r;null===(r=null===(t=o.plugins[e])||void 0===t?void 0:t.destroy)||void 0===r||r.call(t)})),delete this.plugins),setAdPlugin(null===(e=this.config)||void 0===e?void 0:e.instanceId,null),this.fullscreenLogics.destroy(),this.removeAllListeners(),this.pluginMsg.removeAllListeners(),this.corePlayer.destroy(),this.container.innerHTML="",null===(t=this.interactMod)||void 0===t||t.remove(),this.interactMod=null;var r=this.container.cloneNode();this.container.parentNode.replaceChild(r,this.container),this.container=r,clearTimeout(this.mouseMoveTimer),"none"===this.container.style.cursor&&(this.container.style.cursor="auto"),this._destroyed=!0},Object.defineProperty(t.prototype,"offlineLogPlugin",{get:function(){return this.plugins[OfflineLogPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pluginInstances",{get:function(){return this.plugins},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"player",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,PlaytimeLimiterPlugin.pluginName,{get:function(){return this.plugins[PlaytimeLimiterPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,DataSet.pluginName,{get:function(){return this.plugins[DataSet.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,OfflineLogPlugin.pluginName,{get:function(){return this.plugins[OfflineLogPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoReqInfoPlugin",{get:function(){return this.plugins[VideoReqInfoPluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vid",{get:function(){return isVideoId(this.currentPlayItem)?this.currentPlayItem:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){var e;return null===(e=this.currentVideoInfo)||void 0===e?void 0:e.loadingUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){return this.state===exports.VIDEO_STATE.PAUSE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return 0===this.volume},set:function(e){e?(this.mutedVolume=this.volume,this.volume=0):this.muted&&(this.volume=this.mutedVolume)},enumerable:!1,configurable:!0}),t.prototype.setStateKv=function(e,t,o){this.dataset.writeState(e,t,o)},t.prototype.setCommonKv=function(e,t,o){var r=this;"string"==typeof e?this.dataset.writeCommon(e,t,o):Object.keys(e).forEach((function(o){return r.dataset.writeCommon(o,e[o],t)}))},t.prototype.prepareUsageData=function(){return __assign$a(__assign$a({},e.prototype.prepareUsageData.call(this)),{from:"1",channel:CHANNEL})},Object.defineProperty(t.prototype,"videoReqParam",{get:function(){var e;return null===(e=this.loadParam)||void 0===e?void 0:e.videoReqInfoParam},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCollected",{get:function(){return FlowPlayer._isCollected},set:function(e){FlowPlayer._isCollected=e},enumerable:!1,configurable:!0}),t.prototype.getParamWithStartTime=function(e,t){var o;void 0===t&&(t={});var r=this.playtimeLimiter;if(!e)return t;if(null===(o=t.videoLoadParam)||void 0===o?void 0:o.startTime)return t;if("string"==typeof e||"number"==typeof e)r.clearAllConfig(e);else{if(Array.isArray(e))return t;r.clearAllConfig(e.url)}return t.playTimeLimit&&r.addLimitConfig(t.playTimeLimit),__assign$a(__assign$a({},t),{videoLoadParam:__assign$a(__assign$a({},t.videoLoadParam),{startTime:this.timeRange.startTime})})},t.prototype.createClickMask=function(){var e=this,t=this.config,o=t.enableInteractMod,r=void 0===o||o,i=t.type;if(r&&i!==exports.PLAY_MODE.LIVE){var n=document.createElement("div");n.classList.add("thumbplayer-user-mod"),domTool.css(n,{width:"100%",height:"100%",position:"absolute","z-index":1}),domTool.append(this.container,n),n.addEventListener("click",(function(){[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.CANPLAY].includes(e.state)?e.play():[exports.VIDEO_STATE.PLAYING,exports.VIDEO_STATE.BUFFERING].includes(e.state)&&e.pause(exports.H5_PAUSE_TYPE.USER_CLICK)})),this.interactMod=n}},t.prototype.initContainerStyle=function(){var e=this.container;e.style.outline="0 none",e.style.overflow="hidden",e.style.backgroundColor="#000","static"===getComputedStyle(e).position&&(e.style.position="relative")},t.prototype.forwardPluginEvents=function(){var e=this;this[DataSet.pluginName].on(exports.DATA_EVENTS.STATE_UPDATE,(function(t){var o=t.data;e.pluginMsg.emit(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,o)})),this[DataSet.pluginName].on(exports.DATA_EVENTS.UPDATE,(function(t){var o=t.data;e.pluginMsg.emit(exports.PLAY_EVENT_EXT.DATASET_UPDATE,o)})),this.on(exports.PLAY_EVENT.SET_LOADING,(function(t){var o=t.data;e.pluginMsg.emit(exports.PLAY_EVENT_EXT.SET_LOADING,{value:o.show})}))},t.prototype.createInnerPlugins=function(){var e;this.createPlugin(DataSet.pluginName),OfflineLogPlugin.isEnvSupport&&!(null===(e=this.config.offlineConfig)||void 0===e?void 0:e.disable)&&this.createPlugin(OfflineLogPlugin.pluginName),this.createPlugin(PlaytimeLimiterPlugin.pluginName),this.createPlugin(this.config.type===exports.PLAY_MODE.LIVE?LiveQaReporterPlugin.pluginName:VodQaReporterPlugin.pluginName)},t.prototype.cacheLoadParam=function(e,t){e&&(isVideoId(e)&&this.pluginMsg.emit(exports.PLAY_EVENT_EXT.VID_CHANGE,{oldVal:this.vid,newVal:e}),this.currentPlayItem=e,t&&Object.keys(t).length&&(this.loadParam=t))},t.prototype.setupEventFlagData=function(){var e=this;this.on(exports.H5_PLAY_EVENT.AD_PLAYING,(function(){return e.isPlayingAd=!0})),this.on(exports.H5_PLAY_EVENT.AD_END,(function(){return e.isPlayingAd=!1}))},t.prototype.setupLoopPlay=function(){var e=this;this.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(t){var o=t.data.endState===exports.END_STATE.NORMAL;e.config.loop&&o&&e.replay()})),this.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){if(t.data.isFirst&&e.config.loop){var o=e.currentVideoElement;o instanceof HTMLVideoElement&&(o.loop=isUrlConfig(e.currentPlayItem)&&e.corePlayer.kernelName===exports.KERNEL_NAME.ORIGIN)}}))},Object.defineProperty(t.prototype,"playUrl",{get:function(){var e=this.currentPlayItem;if(!isVideoId(e)&&!Array.isArray(e))return null==e?void 0:e.url},enumerable:!1,configurable:!0}),t.prototype.checkAutoPlayInMute=function(){var e=this;if(this.config.autoPlayInMute||this.config.autoPlayPolicy===exports.AUTO_PLAY_POLICY.IN_MUTED){var t=function(){var t;e.hasMutePlayed||(e.hasMutePlayed=!0,e.muted=!0,null===(t=getAdPlugin(e.config.instanceId))||void 0===t||t.setAdVolume(0),e.play())};this.on(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,(function(){return setTimeout(t)})),this.on(exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,t)}},t.prototype.autoHideMouse=function(){var e=this;this.container.addEventListener("mousemove",(function(){"none"===e.container.style.cursor&&(e.container.style.cursor="auto"),clearTimeout(e.mouseMoveTimer),e.mouseMoveTimer=setTimeout(e.hideMouseOnFullscreen.bind(e),5e3)}))},t.prototype.hideMouseOnFullscreen=function(){var e=document,t=e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement;(this.config.autoHideMouse||t)&&this.state===exports.VIDEO_STATE.PLAYING&&(this.container.style.cursor="none")},t.prototype.setVideoStyle=function(e){domTool.css(this.corePlayer.currentVideoElement,e)},t.prototype.setAdVideoStyle=function(e){var t,o,r,i=null===(r=null===(o=getAdPlugin(null===(t=this.config)||void 0===t?void 0:t.instanceId))||void 0===o?void 0:o.videoAdPlayer)||void 0===r?void 0:r.videoElements;i&&i.forEach((function(t){return domTool.css(t,e)}))},t.prototype.applyStyleOnVideoNodeChange=function(){var e=this,t=function(){if(void 0!==e.pictureDirection||void 0!==e.rotateDegree)return rotateTransformValue[e.pictureDirection]||"rotate(".concat(e.rotateDegree,"deg)")};this.corePlayer.on(exports.PLAY_EVENT.VIDEONODE_CHANGE,(function(){var o=t();o&&e.setVideoStyle({transform:o})})),this.on(exports.H5_PLAY_EVENT.AD_REQ_ASSETS_START,(function(o){if(isPreOrPostAd(o.data)){var r=t();r&&e.setAdVideoStyle({transform:r})}})),this.on(exports.H5_PLAY_EVENT.AD_END,(function(o){isPreOrPostAd(o.data)&&(t()&&e.setAdVideoStyle({transform:"none"}))}))},t.prototype.initPluginApis=function(){var e=this;this.playerApiProxy.replayInCurFlowNode=function(t,o){var r;return e.log("replayInCurFlowNode(), vid=".concat(t,", param=").concat(jsonTool.safelyStringify(o))),null===(r=e.flowManager.currentFlowNode)||void 0===r?void 0:r.replay(t,o)}},t.registerKernel=KernelFactory$1.registerKernel,t.KernelFactory=KernelFactory$1,__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[Object,Object]),__metadata$9("design:returntype",void 0)],t.prototype,"load",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[Object,Object]),__metadata$9("design:returntype",void 0)],t.prototype,"play",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[]),__metadata$9("design:returntype",void 0)],t.prototype,"replay",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[String]),__metadata$9("design:returntype",void 0)],t.prototype,"pause",null),__decorate$9([logMethodCall$1,__metadata$9("design:type",Function),__metadata$9("design:paramtypes",[Number]),__metadata$9("design:returntype",void 0)],t.prototype,"seek",null),t}(FlowPlayer);function createH5Player(e){return new H5Player(e)}H5Player.registerPlugin(DataSet.pluginName,DataSet),H5Player.registerPlugin(PlaytimeLimiterPlugin.pluginName,PlaytimeLimiterPlugin),H5Player.registerPlugin(OfflineLogPlugin.pluginName,OfflineLogPlugin),H5Player.registerPlugin(VodQaReporterPlugin.pluginName,VodQaReporterPlugin),H5Player.registerPlugin(LiveQaReporterPlugin.pluginName,LiveQaReporterPlugin);var BUILD_TIME$1=1663819818564,VERSION$2="1.6.5",ThumbPlayerH5=Object.freeze({__proto__:null,createH5Player:createH5Player,H5Player:H5Player,BUILD_TIME:BUILD_TIME$1,VERSION:VERSION$2,BaseReporter:BaseReporter,kernelEvtBus:kernelEvtBus,EvtEmitter:s$1,PLAY_EVENT:exports.PLAY_EVENT,VIDEO_STATE:exports.VIDEO_STATE,KERNEL_NAME:exports.KERNEL_NAME,PLAY_MODE:exports.PLAY_MODE,END_STATE:exports.END_STATE,PRELOAD_TYPE:exports.PRELOAD_TYPE,VIDEO_CODEC:exports.VIDEO_CODEC,CONTAINER_FORMAT:exports.CONTAINER_FORMAT,AUDIO_CODEC:exports.AUDIO_CODEC,get ErrorCode(){return exports.ErrorCode},get ErrorMsg(){return exports.ErrorMsg},get FullScreenMode(){return exports.FullScreenMode},getAdPlugin:getAdPlugin,adEvents:adEvents,BaseFlowNode:BaseFlowNode,get FLOW_NODE_EVENT(){return exports.FLOW_NODE_EVENT},BeaconRequest:BeaconRequest,ImageRequest:report,definePlugins:definePlugins,autobind:autobind,logApiInvoke:logApiInvoke,once:once,get H5_EXT_EVENT(){return exports.PLAY_EVENT_EXT},get H5_PLAY_EVENT(){return exports.H5_PLAY_EVENT},Plugin:Plugin,isFunctionPlugin:isFunctionPlugin,createPluginFactory:createPluginFactory,getHookMethodName:getHookMethodName,registerPlugin:registerPlugin,deregisterPlugin:deregisterPlugin,getPlugin:getPlugin,getPlugins:getPlugins,pluginExists:pluginExists,AdPluginName:AdPluginName,get AD_TYPE(){return exports.AD_TYPE},isPreOrPostAd:isPreOrPostAd,VideoReqInfoPluginName:VideoReqInfoPluginName,isVideoId:isVideoId,DRM_TYPE:DRM_TYPE,DRM_VALUE:DRM_VALUE,OFFICIAL_PLUGIN:OFFICIAL_PLUGIN,PLUGIN_MAP:PLUGIN_MAP,get H5_PAUSE_TYPE(){return exports.H5_PAUSE_TYPE},get AUTO_PLAY_POLICY(){return exports.AUTO_PLAY_POLICY},get PictureDirection(){return exports.PictureDirection},get DATA_EVENTS(){return exports.DATA_EVENTS},get DATA_STATE(){return exports.DATA_STATE},get LOG_TYPE(){return exports.LOG_TYPE},get BUFFER_REASON(){return exports.BUFFER_REASON},get LOCAL_KEY(){return exports.LOCAL_KEY},get PersistedUserSettings(){return exports.PersistedUserSettings},DEFAULT_KEY:DEFAULT_KEY,COMMON_DATA_KEY:COMMON_DATA_KEY});window.ThumbPlayerH5=ThumbPlayerH5;var ThumbPlayerH5$1=Object.freeze({__proto__:null,get AD_TYPE(){return exports.AD_TYPE},get AUTO_PLAY_POLICY(){return exports.AUTO_PLAY_POLICY},AdPluginName:AdPluginName,get BUFFER_REASON(){return exports.BUFFER_REASON},BUILD_TIME:BUILD_TIME$1,BaseFlowNode:BaseFlowNode,BaseReporter:BaseReporter,BeaconRequest:BeaconRequest,COMMON_DATA_KEY:COMMON_DATA_KEY,get DATA_EVENTS(){return exports.DATA_EVENTS},get DATA_STATE(){return exports.DATA_STATE},DEFAULT_KEY:DEFAULT_KEY,DRM_TYPE:DRM_TYPE,DRM_VALUE:DRM_VALUE,get ErrorCode(){return exports.ErrorCode},get ErrorMsg(){return exports.ErrorMsg},get FLOW_NODE_EVENT(){return exports.FLOW_NODE_EVENT},get FullScreenMode(){return exports.FullScreenMode},H5Player:H5Player,get H5_EXT_EVENT(){return exports.PLAY_EVENT_EXT},get H5_PAUSE_TYPE(){return exports.H5_PAUSE_TYPE},get H5_PLAY_EVENT(){return exports.H5_PLAY_EVENT},ImageRequest:report,get LOCAL_KEY(){return exports.LOCAL_KEY},get LOG_TYPE(){return exports.LOG_TYPE},OFFICIAL_PLUGIN:OFFICIAL_PLUGIN,PLUGIN_MAP:PLUGIN_MAP,get PersistedUserSettings(){return exports.PersistedUserSettings},get PictureDirection(){return exports.PictureDirection},Plugin:Plugin,VERSION:VERSION$2,VideoReqInfoPluginName:VideoReqInfoPluginName,adEvents:adEvents,autobind:autobind,createH5Player:createH5Player,createPluginFactory:createPluginFactory,definePlugins:definePlugins,deregisterPlugin:deregisterPlugin,getAdPlugin:getAdPlugin,getHookMethodName:getHookMethodName,getPlugin:getPlugin,getPlugins:getPlugins,isFunctionPlugin:isFunctionPlugin,isPreOrPostAd:isPreOrPostAd,isVideoId:isVideoId,logApiInvoke:logApiInvoke,once:once,pluginExists:pluginExists,registerPlugin:registerPlugin,get AUDIO_CODEC(){return exports.AUDIO_CODEC},get CONTAINER_FORMAT(){return exports.CONTAINER_FORMAT},get END_STATE(){return exports.END_STATE},EvtEmitter:s$1,get KERNEL_NAME(){return exports.KERNEL_NAME},get PLAY_EVENT(){return exports.PLAY_EVENT},get PLAY_MODE(){return exports.PLAY_MODE},get PRELOAD_TYPE(){return exports.PRELOAD_TYPE},get VIDEO_CODEC(){return exports.VIDEO_CODEC},get VIDEO_STATE(){return exports.VIDEO_STATE},kernelEvtBus:kernelEvtBus}),extendStatics$1=function(e,t){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},extendStatics$1(e,t)};function __extends$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var __assign$1=function(){return __assign$1=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$1.apply(this,arguments)};function __decorate(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a}function __metadata(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter$1(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function __generator$1(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}function __spreadArray$1(e,t,o){if(o||2===arguments.length)for(var r,i=0,n=t.length;i<n;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var isMobile=uaTool.mobile,txpHideClass="txp_none";function styleInject$5(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}var css_248z$6=".txp_video_error{position:absolute;top:0;left:0;width:100%;height:100%;z-index:99;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background-color:#111;color:#fff}.txp_video_error.txp_none,.txp_video_error .txp_none{display:none!important}.txp_video_error a{color:#fff;text-decoration:none}.txp_video_error .txp_error_title{margin:10px 20px;font-size:18px;line-height:1.6;text-align:center}.txp_video_error .txp_error_title .txp_btn{color:#ff6428;font-size:inherit}.txp_video_error .error-noise-bg{position:absolute;width:100%;height:100%;left:0;top:0;z-index:-1}.txp_video_error .txp_error_code{margin:30px 20px 0;line-height:1.5;color:#666;pointer-events:auto;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.txp_video_error .txp_error_code a{cursor:pointer;color:#666;border-bottom:1px solid}.txp_video_error .txp_error_code a:hover{color:#ff6428}.txp_video_error .txp_error_code::-moz-selection, .txp_video_error .txp_error_code ::-moz-selection{color:#fff;background:#eee}.txp_video_error .txp_error_code::selection,.txp_video_error .txp_error_code ::selection{color:#fff;background:#eee}.txp_video_error .txp_error_code::-moz-selection,.txp_video_error .txp_error_code ::-moz-selection{color:#fff;background:#eee}.txp_video_error .none{display:none}.txp_video_error .txp_link_refresh{color:#fc6526}.txp_video_error .txp_link_btn{display:block;margin-bottom:16px;padding:0 20px;border-radius:15px;background:#26262b;color:#fc6526;font-size:14px;line-height:30px;cursor:pointer}.txp_video_error .txp_link_btn:hover{color:#fff;background-color:#fc6526}.txp_video_error .txp_browser a{text-decoration:underline;cursor:pointer}.txp_video_error .txp_browser a:hover{color:#ff6428}";styleInject$5(css_248z$6);var queue=[],isReq=!1,qqlive=0,getClient=function(e){if(qqlive)e(qqlive);else if(queue.push(e),!isReq){if(isReq=!0,"qq.com"!=document.domain)throw new Error("document.domain is not qq.com");var t=document.createElement("iframe");t.src="javascript:'<script>window.onload=function(){document.write(\\'<script>document.domain=\\\"qq.com\\\";<\\\\/script>\\');document.close();};<\/script>'",t.style.cssText="display:none;",document.body.appendChild(t),t.getClient=function(e){qqlive=e;for(var t=queue.shift();t;)t&&t(e),t=queue.shift()},t.src="//v.qq.com/iframe/client.html"}},ErrorPagePluginName$1="error-page",ErrorPagePluginEvents$1={REPORT_LOG:"error-page:report-log"},defaultErrorText$1="出错啦",dataRoleMap$1={error:"txp-ui-error",errorMsg:"txp-ui-error-msg",errorHandler:"txp-ui-error-handler",errorRefresh:"txp-ui-error-refresh",errorCode:"txp-ui-error-code",background:"txp-ui-error-background",clientBtn:"txp-ui-error-client-btn",browserTip:"txp-ui-error-browser"},_a$4,ErrMsg;!function(e){e.DEFAULT="这个视频被外星人劫走，暂时看不了了~",e.LIMITED="很遗憾，对此视频的访问暂时受限",e.SENSITIVE="此视频包含敏感信息，已被管理员捉拿~",e.NO_COPYRIGHT="暂时没有获得该视频版权，努力为您争取中~",e.NO_COPYRIGHT_IN_REGION="很抱歉，由于版权限制，您所在的地区暂时无法播放该视频",e.NO_PLAYBACK_COPYRIGHTS="很抱歉，该视频暂无播放版权",e.ENV_NOT_SUPPORT_ENCRYPTION="该视频因版权方安全保密级别较高，当前浏览器不支持加密播放",e.ENV_NOT_SUPPORT_ENCRYPTION_LIVE="该直播因版权方安全保密级别较高，当前浏览器不支持加密播放"}(ErrMsg||(ErrMsg={}));var VodErrorCodeMap={default:ErrMsg.DEFAULT},LiveErrorCodeMap=(_a$4={},_a$4[70023097]=ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION_LIVE,_a$4[70023098]=ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION_LIVE,_a$4);VodErrorCodeMap[70013051]=VodErrorCodeMap[70013052]=VodErrorCodeMap[70013061]=VodErrorCodeMap[70013062]=VodErrorCodeMap[70013063]=VodErrorCodeMap[70013065]=VodErrorCodeMap[70013066]=VodErrorCodeMap[70013069]=VodErrorCodeMap[70013071]=VodErrorCodeMap[70013073]=VodErrorCodeMap[70013074]=VodErrorCodeMap[70013076]=VodErrorCodeMap[70013077]=VodErrorCodeMap[70013081]=VodErrorCodeMap[70013082]=VodErrorCodeMap[70013086]=VodErrorCodeMap[70013094]=ErrMsg.DEFAULT,VodErrorCodeMap[70013064]=VodErrorCodeMap[70013100]=ErrMsg.LIMITED,VodErrorCodeMap[70013080.3]=VodErrorCodeMap["70013080.10"]=VodErrorCodeMap[70013080.11]=VodErrorCodeMap[70013084]=ErrMsg.SENSITIVE,VodErrorCodeMap[70013080]=VodErrorCodeMap[70013080.7]=VodErrorCodeMap[70013080.9]=VodErrorCodeMap[70013083]=ErrMsg.NO_COPYRIGHT,VodErrorCodeMap[70013080.1]=ErrMsg.NO_COPYRIGHT_IN_REGION,VodErrorCodeMap[70013080.2]=ErrMsg.NO_PLAYBACK_COPYRIGHTS,VodErrorCodeMap[70013069.4]=VodErrorCodeMap["70013097.0"]=VodErrorCodeMap[70013097.2]=VodErrorCodeMap[70013098.1]=VodErrorCodeMap[70013080.14]=ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION;var DRM_MODULE_ERROR_CODE_REGEX=/^7009\d+(\.?-?\d+)?$/;function getGuidingMessage(e,t){switch(void 0===t&&(t=!1),(t?LiveErrorCodeMap:VodErrorCodeMap)[e]){case ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION:case ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION_LIVE:return"<p>为保护正版防止盗版，您可以尝试</p>";default:return"<p>您可以尝试</p>"}}function checkIfClientNeeded(e,t){void 0===t&&(t=!1);var o=t?LiveErrorCodeMap:VodErrorCodeMap;return!!DRM_MODULE_ERROR_CODE_REGEX.test(e)||[ErrMsg.NO_PLAYBACK_COPYRIGHTS,ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION,ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION_LIVE].some((function(t){return o[e]}))}function mapPlayerErrorCodeToMessageForTxvContent(e,t){return void 0===t&&(t=!1),DRM_MODULE_ERROR_CODE_REGEX.test(e)?t?ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION_LIVE:ErrMsg.ENV_NOT_SUPPORT_ENCRYPTION:null}function saveChannel(e){var t="qqlivechannel=channel1."+e;if(uaTool.browser.ie){var o=new Date;o.setTime(o.getTime()+864e5),document.cookie=t+";path=/;expires="+o.toUTCString()}else{var r=document.createElement("input");document.querySelector("body").append(r),r.style.position="absolute",r.style.top="-9999px",r.value=t,r.style.top=document.querySelector("body").scrollTop+"px",r.focus(),r.setSelectionRange(0,t.length),document.queryCommandSupported("copy")&&document.execCommand("copy",!0),r.remove()}}function openClient(e){if(e.support&&e.sso){try{saveChannel(e.atag)}catch(e){}try{getClient((function(t){t&&t.exist().done((function(){t.open(e.sso),e.success()})).fail((function(){e.error()}))}))}catch(e){console.log(e)}}}var qqbrowserHelper={exist:!1,isLatestChromeSupportDrm:function(){var e=uaTool.os;if(e.windows)return parseFloat(e.version)>6;if(e.mac){if(uaTool.browser.qqbrowser)return!1;var t=(e.version||"").split(".");return parseFloat((t[0]||"0")+"."+(t[1]||"0"))>10.1}return!e.linux&&void 0},detect:function(){var e=new SimpleDefer,t=document.createElement("meta");return t.name="referrer",t.content="always",document.head.prepend(t),this.isLatestChromeSupportDrm()?fetch("http://127.0.0.1:28653/api/handle",{method:"POST",body:JSON.stringify({action:"GetQBVersion",cmd:""})}).then((function(e){return e.json()})).then((function(o){t.remove();var r=!1,i=o.result||"";i&&(r=-1!==comTool.compareVersion(i,"10.2.2101.400")),r?(qqbrowserHelper.exist=!0,e.resolve({exist:!0})):(qqbrowserHelper.exist=!1,e.resolve({exist:!1}))})).catch((function(){t.remove(),qqbrowserHelper.exist=!1,e.resolve({exist:!1})})):e.reject(),e},download:function(){try{location.assign("http://dldir1.qq.com/invc/tt/QQBrowser_Setup_DRM.exe")}catch(e){}},open:function(e){if(qqbrowserHelper.exist){var t=document.createElement("meta");t.name="referrer",t.content="always",document.head.prepend(t),fetch("http://127.0.0.1:28653/api/handle",{method:"POST",body:JSON.stringify({action:"Open",cmd:encodeURIComponent(e)})}).then((function(){t.remove()})).catch((function(){t.remove()}))}else this.download()}},defaultNoiseConfig={enable:!isMobile,interval:150,performanceRatio:5,size:4,opacity:.05},WHITE_RGB_VALUE=16777215,ErrorPagePlugin=function(e){function t(t,o,r){var i,n=e.call(this,t,o,r)||this;return n.innerElements={},n.clientExistDefer=new SimpleDefer,n.noiseAnimation=function(e,t,o,r,i){var n=Math.floor(o/i),a=e.createImageData(t,n),s=new Uint32Array(a.data.buffer);e.clearRect(0,0,t,o);for(var l=0;l<s.length;l++)s[l]=((255*Math.random()*r|0)<<24)+WHITE_RGB_VALUE;for(l=0;l<=i;l++)e.putImageData(a,0,n*l)},n.browserTipClick=function(){qqbrowserHelper.open(location.href)},n.config=__assign$1(__assign$1({},t.config.errorPageConfig),o),n.config.noiseConfig=__assign$1(__assign$1({},defaultNoiseConfig),null===(i=n.config)||void 0===i?void 0:i.noiseConfig),n.insertDOM(),n.setupDOMEvents(),n.setupPlayerEvents(),n}return __extends$1(t,e),t.prototype.show=function(e){void 0===e&&(e=defaultErrorText$1);var t=this.player.getCommonKv(COMMON_DATA_KEY.flowid),o="object"==typeof e&&Boolean(null==e?void 0:e.img);if("string"==typeof e)this.innerElements.errorMsg.innerHTML=e,this.innerElements.errorCode.innerHTML=t||"",this.innerElements.background.classList.add(txpHideClass),this.innerElements.errorRefresh.classList.remove(txpHideClass);else{var r=e.text,i=void 0===r?defaultErrorText$1:r,n=e.code,a=void 0===n?"":n,s=e.img,l=void 0===s?"":s,c=e.hideRefresh,p=void 0!==c&&c;this.innerElements.errorMsg.innerHTML=i,this.innerElements.errorCode.innerHTML=a?String(a)+"-"+t:t,this.innerElements.background.src=l,this.innerElements.background.classList.toggle(txpHideClass,!l),this.innerElements.errorRefresh.classList.toggle(txpHideClass,p)}this.rootEl.classList.remove(txpHideClass),this.setNoise(!o)},t.prototype.hide=function(){this.rootEl.classList.add(txpHideClass),this.setNoise(!1),domTool.addClass(this.innerElements.clientBtn,txpHideClass),domTool.addClass(this.innerElements.browserTip,txpHideClass),domTool.addClass(this.innerElements.errorRefresh,txpHideClass)},t.prototype.destroy=function(){var t;this.setNoise(!1),this.rootEl.parentNode&&this.rootEl.remove(),this.innerElements={},null===(t=this.noiseBg)||void 0===t||t.remove(),this.noiseBg=null,this.rootEl=null,e.prototype.destroy.call(this)},t.prototype.insertDOM=function(){var e=this,t=this.player.container,o=this.config.noiseConfig,r='<div data-role="'+dataRoleMap$1.error+'" class="txp_video_error '+txpHideClass+'">\n      '+(o.enable?'<canvas class="error-noise-bg"></canvas>':"")+'\n      <img data-role="'+dataRoleMap$1.background+'" alt="error-background"/>\n      <div data-role="'+dataRoleMap$1.errorMsg+'" class="txp_error_title"></div>\n      <div data-role="'+dataRoleMap$1.errorHandler+'" class="txp_error_desc">\n        <span data-role="'+dataRoleMap$1.errorRefresh+'">\n          你可以 <a href="javascript:;" class="txp_link_refresh">刷新</a> 试试\n        </span>\n      </div>\n      <a data-role="'+dataRoleMap$1.clientBtn+'" class="txp_link_btn '+txpHideClass+'"></a>\n      <div data-role="'+dataRoleMap$1.browserTip+'" class="txp_browser '+txpHideClass+'"></div>\n      <div class="txp_error_code" data-role="'+dataRoleMap$1.errorCode+'"></div>\n    </div>';t.insertAdjacentHTML("beforeend",r),this.rootEl=t.querySelector('[data-role="'+dataRoleMap$1.error+'"]'),this.noiseBg=this.rootEl.querySelector("canvas"),Object.keys(dataRoleMap$1).forEach((function(o){e.innerElements[o]=t.querySelector('[data-role="'+dataRoleMap$1[o]+'"]')}))},t.prototype.setupDOMEvents=function(){var e=this;this.innerElements.errorRefresh.querySelector(".txp_link_refresh").addEventListener("click",(function(){e.config.useReplay?e.player.replay():location.reload()}));var o=0,r=0;this.innerElements.errorCode.addEventListener("click",(function(){(o+=1)>=5&&(o=0,e.emit(t.Events.REPORT_LOG)),r&&clearTimeout(r),r=window.setTimeout((function(){return o=0}),300)})),this.innerElements.clientBtn.addEventListener("click",(function(){e.clientExistDefer.promise.then((function(t){e.clickClientBtnOnExist(t)})).catch((function(){e.clickClientBtnOnNoExist()}))}))},t.prototype.setupPlayerEvents=function(){var e=this,t=this.player;t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(o){var r=o.data;if(e.config.showOnError){var i=r.code;if(i!==exports.ErrorCode.SUC){var n=e.config.img,a=e.config.hideRefresh,s=r.message,l=!1,c=t.config.type===exports.PLAY_MODE.LIVE;if(c&&r.data){if("setErrorView"!==r.data.name)return;var p=r.data.params,d=p.msg,u=p.hideRefresh,A=p.hideCode;d&&(s=d),LiveErrorCodeMap[i]&&(s=LiveErrorCodeMap[i]),u?domTool.addClass(e.innerElements.errorRefresh,txpHideClass):domTool.removeClass(e.innerElements.errorRefresh,txpHideClass),A?domTool.addClass(e.innerElements.errorCode,txpHideClass):domTool.removeClass(e.innerElements.errorCode,txpHideClass)}else i.startsWith(exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX)&&(s=e.getVodErrMsg(i));checkIfClientNeeded(i,c)&&(e.config.useClientBtn&&(e.checkClientExist(),e.setClientBtn(),a=!0,l=!0),e.config.useBrowserTip&&(e.setBrowserTip(),a=!0,l=!0),l&&(s=""+(mapPlayerErrorCodeToMessageForTxvContent(i,c)||s)+getGuidingMessage(i,c))),e.show({code:i,text:s,hideRefresh:a,img:n})}}})),t.on(exports.PLAY_EVENT.STATE_CHANGE,(function(t){var o=t.data.new;o!==exports.VIDEO_STATE.PLAYING&&o!==exports.VIDEO_STATE.CANPLAY||e.hide()})),t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){return e.hide()}))},t.prototype.getVodErrMsg=function(e){return VodErrorCodeMap[e]||VodErrorCodeMap.default},t.prototype.setClientBtn=function(){var e=this,t=uaTool.os.mac?"Mac客户端观看":"PC客户端观看";uaTool.os.mac?this.innerElements.clientBtn.innerHTML="打开"+t:this.clientExistDefer.promise.then((function(){e.innerElements.clientBtn.innerHTML="打开"+t})).catch((function(){e.innerElements.clientBtn.innerHTML="下载"+t})),domTool.removeClass(this.innerElements.clientBtn,txpHideClass)},t.prototype.setNoise=function(e){var t=this;void 0===e&&(e=!0);var o=this.config.noiseConfig,r=o.enable,i=o.performanceRatio,n=o.opacity;if(r&&this.noiseBg&&(clearInterval(this.noiseTimer),domTool.css(this.noiseBg,"display",e?"block":"none"),e)){var a=this.noiseBg.getContext("2d");this.resizeNoise();var s=this.noiseBg,l=s.width,c=s.height;if(!l||!c)return;this.noiseAnimation(a,l,c,n,i),this.noiseTimer=setInterval((function(){t.noiseAnimation(a,l,c,n,i)}),o.interval)}},t.prototype.resizeNoise=function(){if(this.noiseBg){var e=this.player.container,t=e.clientWidth,o=e.clientHeight,r=this.config.noiseConfig.size;this.noiseBg.width=t/r,this.noiseBg.height=o/r}},t.prototype.checkClientExist=function(){var e=this;try{getClient((function(t){t?t.exist().done((function(){e.clientExistDefer.resolve(t)})).fail((function(){e.clientExistDefer.reject()})):e.clientExistDefer.reject()}))}catch(e){this.clientExistDefer.reject()}},t.prototype.clickClientBtnOnExist=function(e){if(this.player.config.type===exports.PLAY_MODE.LIVE){var t="qqlive://sso/pid="+(this.player.getCommonKv(COMMON_DATA_KEY.livepid)||"")+"&projectid="+(this.player.vid||"");e.open(t)}else{var o=this.player.vid;openClient({support:!0,atag:"playererror",sso:"qqlive://sso/vbarid="+(this.player.getCommonKv(COMMON_DATA_KEY.cid)||"")+"&videoid="+o+"&start="+Math.max(this.player.playtime-5,0)+"&atag=web.playererror",success:function(){},error:function(){this.openDownLoadLink()}})}},t.prototype.clickClientBtnOnNoExist=function(){this.openDownLoadLink()},t.prototype.openDownLoadLink=function(){window.open("https://v.qq.com/download.html#"+(uaTool.os.mac?"Mac":"Windows"),"_blank")},t.prototype.setBrowserTip=function(){this.innerElements.browserTip.removeEventListener("click",this.browserTipClick),domTool.removeClass(this.innerElements.browserTip,txpHideClass),uaTool.os.mac?this.innerElements.browserTip.innerHTML="或下载最新 Chrome、Safari 浏览器观看":this.innerElements.browserTip.innerHTML="或下载最新 Chrome、Edge 浏览器观看"},t.Events=ErrorPagePluginEvents$1,t.pluginName=ErrorPagePluginName$1,t}(Plugin);H5Player.registerPlugin(ErrorPagePlugin.pluginName,ErrorPagePlugin);var FUNC_ERROR_TEXT="Expected a function",NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(e,t,o){var r,i,n,a,s,l,c=0,p=!1,d=!1,u=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function A(t){var o=r,n=i;return r=i=void 0,c=t,a=e.apply(n,o)}function _(e){return c=e,s=setTimeout(g,t),p?A(e):a}function E(e){var o=e-l;return void 0===l||o>=t||o<0||d&&e-c>=n}function g(){var e=now();if(E(e))return f(e);s=setTimeout(g,function(e){var o=t-(e-l);return d?nativeMin(o,n-(e-c)):o}(e))}function f(e){return s=void 0,u&&r?A(e):(r=i=void 0,a)}function h(){var e=now(),o=E(e);if(r=arguments,i=this,l=e,o){if(void 0===s)return _(l);if(d)return s=setTimeout(g,t),A(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=toNumber(t)||0,isObject(o)&&(p=!!o.leading,n=(d="maxWait"in o)?nativeMax(toNumber(o.maxWait)||0,t):n,u="trailing"in o?!!o.trailing:u),h.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=l=i=s=void 0},h.flush=function(){return void 0===s?a:f(now())},h}function throttle(e,t,o){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);return isObject(o)&&(r="leading"in o?!!o.leading:r,i="trailing"in o?!!o.trailing:i),debounce(e,t,{leading:r,maxWait:t,trailing:i})}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var o=reIsBinary.test(e);return o||reIsOctal.test(e)?freeParseInt(e.slice(2),o?2:8):reIsBadHex.test(e)?NAN:+e}var lodash_throttle=throttle,css_248z$1$1='.plugin_ctrl_txp_shadow{position:absolute;z-index:2;left:0;top:0;width:100%;height:100%}.plugin_ctrl_txp_shadow.txp_none{display:none}.plugin_ctrl_airplay_btn svg{-webkit-transform:scale(.9);transform:scale(.9)}.plugin_ctrl_center_btn{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;pointer-events:none}.plugin_ctrl_center_btn.txp_none{display:none}.plugin_ctrl_center_btn .txp_none{display:none!important}.plugin_ctrl_center_btn .btn_play{width:68px;height:68px;pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_play .icon_play{width:100%;height:100%}.plugin_ctrl_center_btn .btn_replay{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:0 22px;line-height:40px;border-radius:99em;color:#fff;font-size:14px;background-color:rgba(59,59,59,.95);pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_replay .icon_replay{margin-right:4px;width:15px;height:15px;fill:#fff}.plugin_ctrl_txp_gradient_bottom{position:absolute;z-index:3;left:0;bottom:0;width:100%;height:120px;background-image:-webkit-gradient(linear,left bottom, left top,color-stop(0, rgba(0,0,0,.5)),to(transparent));background-image:linear-gradient(0deg,rgba(0,0,0,.5) 0,transparent);opacity:1;-webkit-transition:opacity .15s ease-out;transition:opacity .15s ease-out;pointer-events:none}.plugin_ctrl_txp_gradient_bottom.txp_none{display:none}.plugin_ctrl_fake_fullscreen{overflow:hidden}._mod_thumbplayer_container_:-webkit-full-screen{width:100%!important;height:100%!important}._mod_thumbplayer_container_.thumbplayer-fullscreen{width:100%!important;height:100%!important}@-webkit-keyframes txp_icon_scale{0%{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}50%{-webkit-transform:scale(1.2);transform:scale(1.2);-webkit-transform-origin:center center;transform-origin:center center}to{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}}@keyframes txp_icon_scale{0%{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}50%{-webkit-transform:scale(1.2);transform:scale(1.2);-webkit-transform-origin:center center;transform-origin:center center}to{-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:center center;transform-origin:center center}}.plugin_ctrl_txp_bottom{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:6;bottom:0;left:0;width:100%;height:48px;line-height:1;max-width:100%;max-height:100%;overflow:initial;text-indent:0;text-align:left;white-space:normal;word-break:break-all;color:#fff;font-size:14px;font-family:PingFangSC-Regular,Helvetica Neue,Helvetica,Roboto,Microsoft Yahei,Arial,sans-serif;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-touch-callout:none}.plugin_ctrl_txp_bottom.txp_none{display:none}.plugin_ctrl_txp_bottom .txp_btn{position:relative;cursor:pointer;background:none;border:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-family:inherit}.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon{fill:#ff6022;cursor:pointer}.plugin_ctrl_txp_bottom .txp_icon_airplay .txp_icon_pip,.plugin_ctrl_txp_bottom .txp_icon_fake,.plugin_ctrl_txp_bottom .txp_icon_fullscreen,.plugin_ctrl_txp_bottom .txp_icon_volume,.plugin_ctrl_txp_bottom .txp_icon_volume_mute{stroke:#fff}.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_airplay,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_fake,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_fullscreen,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_pip,.plugin_ctrl_txp_bottom .txp_btn:hover .txp_icon_volume,.plugin_ctrl_txp_bottom .txp_btn_fake[data-status=true] .txp_icon_fake{stroke:#ff6022}.plugin_ctrl_txp_bottom .txp_btn_pip[data-status=true] .txp_icon_pip{stroke:#ff6022;fill:#ff6022}.plugin_ctrl_txp_bottom .txp_controls{display:-webkit-box;display:-ms-flexbox;display:flex;position:absolute;bottom:0;left:0;width:100%;height:100%}.plugin_ctrl_txp_bottom *,.plugin_ctrl_txp_bottom :after,.plugin_ctrl_txp_bottom :before{margin:0;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box;text-indent:0}.plugin_ctrl_txp_bottom a,.plugin_ctrl_txp_bottom a:hover,.plugin_ctrl_txp_bottom a:visited{color:#fff;text-decoration:none!important}.plugin_ctrl_txp_bottom :focus,.plugin_ctrl_txp_bottom a:active{outline:0 none}.plugin_ctrl_txp_bottom .txp_left_controls,.plugin_ctrl_txp_bottom .txp_right_controls{position:relative;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.plugin_ctrl_txp_bottom .txp_controls .txp_btn{height:100%;text-align:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.plugin_ctrl_txp_bottom .txp_left_controls .txp_btn{margin-right:16px;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none}.plugin_ctrl_txp_bottom .txp_left_controls .txp_btn:first-child{margin-left:16px}.plugin_ctrl_txp_bottom .txp_center_controls{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.plugin_ctrl_txp_bottom .txp_right_controls{z-index:8}.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn{margin-right:16px}.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_definition,.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_language,.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_playrate{margin-right:24px}.plugin_ctrl_txp_bottom .txp_left_controls .txp_icon{display:block;margin:auto}.plugin_ctrl_txp_bottom .txp_left_controls .txp_icon_next{pointer-events:none}.plugin_ctrl_txp_bottom .txp_right_controls .txp_icon{display:block}.plugin_ctrl_txp_bottom .txp_controls .txp_tooltip{position:absolute;z-index:14;height:26px;border-radius:16px;font-size:12px;line-height:18px;display:none;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;top:-30px;padding:4px 12px;white-space:nowrap;background-color:rgba(0,0,0,.8);left:50%;-webkit-transform:translate(-50%);transform:translate(-50%)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_fake .txp_tooltip{left:-15px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_play .txp_tooltip{left:-6px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_next .txp_tooltip{left:-11px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_controls .txp_btn_fullscreen .txp_tooltip{left:auto;right:-10px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_bottom .txp_btn_setting:hover .txp_icon_setting{-webkit-animation:txp_icon_rotate .3s ease both;animation:txp_icon_rotate .3s ease both}.plugin_ctrl_txp_bottom .txp_air_play:hover .txp_icon,.plugin_ctrl_txp_bottom .txp_btn_fake:hover .txp_icon,.plugin_ctrl_txp_bottom .txp_btn_fullscreen:hover .txp_icon,.plugin_ctrl_txp_bottom .txp_btn_pip:hover .txp_icon{-webkit-animation:txp_icon_scale .4s ease both;animation:txp_icon_scale .4s ease both}.plugin_ctrl_txp_bottom .txp_time_display{height:100%;margin-left:8px;white-space:nowrap;font-size:0;-webkit-box-flex:0;-ms-flex:none;flex:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour{margin-left:-8px}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_current,.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_duration{width:50px}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_current{text-align:right}.plugin_ctrl_txp_bottom .txp_time_display.reach_hour .txp_time_duration{text-align:left}.plugin_ctrl_txp_bottom .txp_time_display>div{display:inline;font-size:12px}.plugin_ctrl_txp_bottom .txp_time_display .txp_time_separator{margin:0 3px;color:hsla(0,0%,100%,.5)}.plugin_ctrl_txp_bottom .txp_time_display .txp_time_current,.plugin_ctrl_txp_bottom .txp_time_display .txp_time_duration{width:32px;text-align:center}.plugin_ctrl_txp_bottom .txp_time_display .txp_time_duration{color:hsla(0,0%,100%,.5)}.plugin_ctrl_txp_bottom .txp_time_display .txp_live_badge{position:relative;font-size:12px;display:inline;margin-top:-1px;line-height:40px;padding-left:10px;cursor:default}.plugin_ctrl_txp_bottom .txp_time_display .txp_live_badge:before{content:"";position:absolute;left:0;top:17px;display:inline-block;width:6px;height:6px;border-radius:100%;background-color:#ff7000}.plugin_ctrl_txp_bottom .txp_time_display .txp_live_badge_back:before{background-color:#bbb}.plugin_ctrl_txp_bottom .txp_time_display_live{margin-left:0}.plugin_ctrl_txp_bottom .txp_progress_bar_container{position:absolute;z-index:4;left:0;top:-8px;width:100%;height:8px;padding:0;vertical-align:top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}.plugin_ctrl_txp_bottom .txp_progress_bar_container:after{content:"";display:block;width:100%;height:12px;position:absolute;bottom:-2px;z-index:-1}.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover{z-index:9;cursor:pointer}.plugin_ctrl_txp_bottom .txp_progress_list{position:absolute;left:0;top:0;height:8px;width:100%}.plugin_ctrl_txp_bottom .txp_progress_list:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;background-color:hsla(0,0%,100%,.35);-webkit-transform:scaleY(.5);transform:scaleY(.5);-webkit-transition:all .15s ease;transition:all .15s ease;z-index:-1}.plugin_ctrl_txp_bottom .txp_progress_load,.plugin_ctrl_txp_bottom .txp_progress_play{position:absolute;left:0;top:0;height:100%;width:2px;background-color:#ff6429;-webkit-transform:scaleY(.5);transform:scaleY(.5);-webkit-transition:all .15s ease;transition:all .15s ease}.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_hover,.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_list:after,.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_load,.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_play,.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_progress_role{-webkit-transform:scaleY(1);transform:scaleY(1)}.plugin_ctrl_txp_bottom .txp_progress_load{background-color:hsla(0,0%,100%,.5)}.plugin_ctrl_txp_bottom .txp_progress_hover{position:absolute;width:10px;height:100%;bottom:0;background-color:#fff;border-radius:100%;background-clip:padding-box;opacity:0;-webkit-transform:scaleY(.5);transform:scaleY(.5);-webkit-transition:all .15s ease;transition:all .15s ease}.plugin_ctrl_txp_bottom .txp_progress_role{position:absolute;left:0;top:0;height:100%;width:2px;background-color:rgba(178,250,77,.5);-webkit-transform:scaleY(.5);transform:scaleY(.5);-webkit-transition:all .15s ease;transition:all .15s ease}.plugin_ctrl_txp_bottom .txp_btn_scrubber{position:absolute;width:12px;height:12px;top:-2px;margin-left:-6px;cursor:pointer;-webkit-transform:scale(0);transform:scale(0);-webkit-transition:all .15s ease;transition:all .15s ease}.plugin_ctrl_txp_bottom .txp_scrubber_indicator{position:relative;width:12px;height:12px;border-radius:100%;background-color:#ff6429}.plugin_ctrl_txp_bottom .txp_scrubber_indicator:before{content:"";position:absolute;left:-4px;top:-4px;width:20px;height:20px;border-radius:100%;display:block;background-color:rgba(254,100,41,.3)}.plugin_ctrl_txp_bottom .txp_progress_bar_container:hover .txp_btn_scrubber{-webkit-transform:scale(1);transform:scale(1)}.plugin_ctrl_txp_bottom .txp_btn_scrubber:hover .txp_scrubber_indicator:before{width:24px;height:24px;left:-6px;top:-6px}.plugin_ctrl_txp_bottom .txp_btn_play .txp_svg_symbol{visibility:hidden;opacity:0}.plugin_ctrl_txp_bottom .txp_btn_play[data-status=pause] .txp_svg_pause,.plugin_ctrl_txp_bottom .txp_btn_play[data-status=play] .txp_svg_play,.plugin_ctrl_txp_bottom .txp_btn_play[data-status=replay] .txp_svg_replay,.plugin_ctrl_txp_bottom .txp_btn_play[data-status=stop] .txp_svg_stop{visibility:visible;opacity:1;-webkit-animation:none;animation:none}.plugin_ctrl_txp_bottom .txp_popup{position:absolute;bottom:34px;z-index:20;width:100%;padding-bottom:24px;color:#eee;cursor:default}.plugin_ctrl_txp_bottom .txp_popup_content{background-color:rgba(0,0,0,.8);border-radius:4px}.plugin_ctrl_txp_bottom .txp_popup_audio_track,.plugin_ctrl_txp_bottom .txp_popup_definition,.plugin_ctrl_txp_bottom .txp_popup_language,.plugin_ctrl_txp_bottom .txp_popup_playrate{width:auto;left:50%;-webkit-transform:translate(-50%);transform:translate(-50%);font-size:0}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_popup_content,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_popup_content,.plugin_ctrl_txp_bottom .txp_popup_language .txp_popup_content,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_popup_content{padding-top:10px}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem{min-width:104px;position:relative;padding:10px 22px;font-size:14px;text-align:center;cursor:pointer;white-space:nowrap;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem:last-of-type,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem:last-of-type,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem:last-of-type,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem:last-of-type{padding-bottom:20px}.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_audio_track .txp_menuitem:hover,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_definition .txp_menuitem:hover,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_language .txp_menuitem:hover,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem:active,.plugin_ctrl_txp_bottom .txp_popup_playrate .txp_menuitem:hover{color:#ff6429}.plugin_ctrl_txp_bottom .txp_btn .txp_label{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;padding:1px 4px;cursor:pointer;color:#ececec;white-space:nowrap;border:2px solid #fff;border-radius:4px;font-weight:700}.plugin_ctrl_txp_bottom .txp_btn .txp_label:hover{color:#ff6022;border-color:#ff6022}.plugin_ctrl_txp_bottom .txp_btn_definition{position:relative;height:100%;white-space:nowrap;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none}.plugin_ctrl_txp_bottom .txp_volume{position:relative;display:table-cell;width:44px;height:45px;vertical-align:top;color:#fff}.plugin_ctrl_txp_bottom .txp_volume_text{padding-top:8px}.plugin_ctrl_txp_bottom .txp_btn_volume .txp_svg_symbol{display:none}.plugin_ctrl_txp_bottom .txp_btn_volume[data-status=mute] .txp_svg_volume_mute,.plugin_ctrl_txp_bottom .txp_btn_volume[data-status=normal] .txp_svg_volume{display:block}.plugin_ctrl_txp_bottom .txp_popup_volume{width:42px;-webkit-transform:translate(-50%);transform:translate(-50%);left:50%}.plugin_ctrl_txp_bottom .txp_popup_volume .txp_popup_content{overflow:hidden}.plugin_ctrl_txp_bottom .txp_volume_range{position:relative;margin:10px 19px;width:4px;height:90px;background-color:hsla(0,0%,65.1%,.5);border-radius:2px;cursor:pointer}.plugin_ctrl_txp_bottom .txp_volume_range:after{content:"";display:block;width:42px;height:90px;position:absolute;left:-19px;top:0}.plugin_ctrl_txp_bottom .txp_volume_range_current{position:absolute;left:0;bottom:0;width:100%;height:50%;background-color:#ff6429;border-radius:2px;z-index:1}.plugin_ctrl_txp_bottom .txp_volume_handle{position:absolute;top:-4px;left:-2px;width:8px;height:8px;background-color:#fff;border-radius:100%;cursor:pointer}.plugin_ctrl_txp_bottom .txp_volume_handle:before{content:"";display:block;position:absolute;left:-3px;top:-3px;width:14px;height:14px;opacity:0;-webkit-transform:scale(0);transform:scale(0);background-color:hsla(0,0%,100%,.2);border-radius:7px}.plugin_ctrl_txp_bottom .txp_volume_handle:after{content:"";width:32px;height:32px;display:block;position:absolute;left:-12px;top:-12px;z-index:-1;opacity:.5;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADAUExURQAAAP+ZAP+RAP9/AP+aAP9/AP+OCP//AP9/AP+qAP+QDf+SDP+TDv+TCv+RCP+ZAP+TC/+TCP+QC/+RCv+SCf+SCv+QCv+RCv+TCf+PD/+PCP+RDP+RCf+RCv+PCf+RB/+RCv+RCf6RCv+ZEf+RC/+RCf+RC/+RC/6RCv+OB/+QC/+RC/+RCv+TC/+QC/+SC/+RC/+RCv+RCv+RCv+RC/6RCv6RCv6RCv6SCv6SCv2QC/+RCv+SCv+RC/+RCv2RCn+uAUwAAABAdFJOUwAFBwYIBAsBAgMNExEYOAoWHit4JUtXYhoQHCg1MT4gRmmHD1SlsbaUIi5BIy1DUltIb2VygY+Jm6KYrHyYuqzDURAFAAAB/klEQVQ4y6WVWZeiMBSEhQZmDAgJO7LIIrivuNv2/P9/NTdRp7VlTmfO1BMP36kKl5ui1XrQD9DPm+hzq1lXqn3TlW3mKCXLApMsU7aBpHaUehMlJvGNsq+mzE6mlKEwGZSVX0yZnSBKBkJFoIGCAiFDEgVm+oUDO4Q0FeMOCGNVQ+hq+kAyDuwCFfuE9ECE+FgNwJSRz5yCNMCmdmiCQnsKqIaURxKCKVeone4onMWRDoriWTgiHbWg5D0cDAXRQGqH2GasJ/N0tUrniR6bNpDIEIW7JQtGGnDjKEmdhQtaOGkSjYHU0Gc4GEoowF17rE+c/tKrs6z2ln1noo/tLg6QdLdsyzTYH5nRxHG9bGOBNpnnOpPIHPk0XG5fQUFSNEzCOHHcem1t8/0+31rr2nWSOCRYU6glBekJVX8609O+t37Pd8PTabjL39deP9VnU7CkL85A0SjghGC4zKx8eDiW5fEwzK1sCZZwygKyGSiISgDJ0Xzhbba7Q/mrqs7lYbfdeIt5BNmBAhNiIByx0zMhuQbD47kaDKrzESxryDZ7dELP4MrNrP2prAYfH4OqvOytzF39H/h9NO/LcI/nZeCXS/PAuT8h91Lc1ow0rRl5XDPuxeW+CtyXi/u68hfAn0pRnitFeakU7pJ6rj0E+lvt8RcpfzX/Q9l/8/v4DS6tX+XyhPN2AAAAAElFTkSuQmCC);background-size:32px 32px;pointer-events:none}.plugin_ctrl_txp_bottom .txp_volume_handle:hover:before{opacity:1;-webkit-transform:scale(1);transform:scale(1)}.plugin_ctrl_txp_bottom .txp_volume_handle:hover:after{opacity:1}.plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_popup{width:24px}.plugin_ctrl_txp_bottom .txp_right_controls .txp_icon_popup{width:20px;height:20px;margin-top:0}.plugin_ctrl_txp_bottom .txp_btn_fake .txp_svg_symbol,.plugin_ctrl_txp_bottom .txp_btn_fullscreen .txp_svg_symbol{display:none}.plugin_ctrl_txp_bottom .txp_btn_fake[data-status=false] .txp_svg_fake,.plugin_ctrl_txp_bottom .txp_btn_fake[data-status=true] .txp_svg_fake_true,.plugin_ctrl_txp_bottom .txp_btn_fullscreen[data-status=false] .txp_svg_fullscreen,.plugin_ctrl_txp_bottom .txp_btn_fullscreen[data-status=true] .txp_svg_fullscreen_true{display:block}.plugin_ctrl_txp_bottom .txp_popup .txp_current{color:#ff6429}.plugin_ctrl_txp_bottom .txp_btn_loop .txp_svg_loop,.plugin_ctrl_txp_bottom .txp_btn_loop .txp_svg_loop_off{display:none}.plugin_ctrl_txp_bottom .txp_btn_loop[data-status=false] .txp_svg_loop_off,.plugin_ctrl_txp_bottom .txp_btn_loop[data-status=true] .txp_svg_loop,.plugin_ctrl_txp_bottom .txp_controls .txp_btn:hover .txp_tooltip{display:block}.plugin_ctrl_txp_bottom .txp_controls .txp_btn:visited .txp_tooltip{display:none}.plugin_ctrl_txp_bottom .txp_popup:hover{display:block}.plugin_ctrl_txp_bottom .txp_icon{position:relative;width:28px;height:28px;fill:#fff}.plugin_ctrl_txp_bottom .txp_icon:after,.plugin_ctrl_txp_bottom .txp_icon:before,.plugin_ctrl_txp_bottom .txp_icon_inner:after,.plugin_ctrl_txp_bottom .txp_icon_inner:before{content:"";position:absolute;-webkit-box-sizing:content-box;box-sizing:content-box}.plugin_ctrl_txp_bottom .txp_icon_inner{position:absolute;width:100%;height:100%}.plugin_ctrl_txp_bottom .txp_controls .txp_disabled{cursor:default;opacity:.5;pointer-events:none}.plugin_ctrl_txp_bottom .txp_gradient_top{display:none}.plugin_ctrl_txp_bottom .txp_btn_scrubber,.plugin_ctrl_txp_bottom .txp_progress_load,.plugin_ctrl_txp_bottom .txp_progress_play{-webkit-transition:-webkit-transform .15s ease;transition:-webkit-transform .15s ease;transition:transform .15s ease;transition:transform .15s ease, -webkit-transform .15s ease}.plugin_ctrl_txp_bottom .txp_none{display:none!important}.plugin_ctrl_txp_mode_fullscreen .txp_controls .txp_btn_fullscreen .txp_tooltip{left:auto;right:0;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl_txp_mode_fullscreen .txp_controls .txp_btn_fake .txp_tooltip{left:-26px;-webkit-transform:translate(0);transform:translate(0)}.plugin_ctrl--large .plugin_ctrl_txp_gradient_bottom{height:100px}.plugin_ctrl--large .plugin_ctrl_txp_bottom{height:88px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_popup{bottom:64px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_btn,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn{margin-right:24px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_btn .txp_label,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn .txp_label{height:26px;font-size:16px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_icon,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_icon{width:40px;height:40px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_time_display{margin-left:0}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_left_controls .txp_btn:first-child{margin-left:32px}.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_definition,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_language,.plugin_ctrl--large .plugin_ctrl_txp_bottom .txp_right_controls .txp_btn_playrate{margin-right:32px}.txp_interact_dot{position:absolute;top:2px;width:4px;height:4px;margin-left:-2px;border-radius:100%;background-color:#fff;-webkit-transition:all .1s;transition:all .1s}.txp_interact_dot:after{position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;content:""}.txp_interact_dot:hover{-webkit-transform:scale(2);transform:scale(2);-webkit-box-shadow:0 0 2px #ffb821;box-shadow:0 0 2px #ffb821}.txp_hotpoint_tip{color:#fff;position:relative;width:200px;bottom:60px;font-size:12px;line-height:24px;height:50px;padding:0 6px;background-color:rgba(0,0,0,.9);display:-webkit-box;overflow:hidden;text-overflow:ellipsis;-webkit-box-orient:vertical;-webkit-line-clamp:2;word-wrap:break-word}.txp_hotpoint_tip .txp_hotpoint_tip_title{color:#bbb}.txp_hotpoint_tip .txp_hotpoint_tip_detail{max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}',css_248z$5='.plugin_ctrl_txp_shadow{position:absolute;z-index:2;left:0;top:0;width:100%;height:100%}.plugin_ctrl_txp_shadow.txp_none{display:none}.plugin_ctrl_airplay_btn svg{-webkit-transform:scale(.9);transform:scale(.9)}.plugin_ctrl_center_btn{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;pointer-events:none}.plugin_ctrl_center_btn.txp_none{display:none}.plugin_ctrl_center_btn .txp_none{display:none!important}.plugin_ctrl_center_btn .btn_play{width:68px;height:68px;pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_play .icon_play{width:100%;height:100%}.plugin_ctrl_center_btn .btn_replay{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:0 22px;line-height:40px;border-radius:99em;color:#fff;font-size:14px;background-color:rgba(59,59,59,.95);pointer-events:auto;cursor:pointer}.plugin_ctrl_center_btn .btn_replay .icon_replay{margin-right:4px;width:15px;height:15px;fill:#fff}.plugin_ctrl_txp_gradient_bottom{position:absolute;z-index:3;left:0;bottom:0;width:100%;height:120px;background-image:-webkit-gradient(linear,left bottom, left top,color-stop(0, rgba(0,0,0,.5)),to(transparent));background-image:linear-gradient(0deg,rgba(0,0,0,.5) 0,transparent);opacity:1;-webkit-transition:opacity .15s ease-out;transition:opacity .15s ease-out;pointer-events:none}.plugin_ctrl_txp_gradient_bottom.txp_none{display:none}.plugin_ctrl_fake_fullscreen{overflow:hidden}._mod_thumbplayer_container_:-webkit-full-screen{width:100%!important;height:100%!important}._mod_thumbplayer_container_.thumbplayer-fullscreen{width:100%!important;height:100%!important}.plugin_ctrl_mobile_txp_bottom{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;z-index:6;bottom:0;left:0;width:100%;height:40px;overflow:initial;line-height:1;max-width:100%;max-height:100%;color:#fff;font-size:14px;font-family:PingFangSC-Regular,Helvetica Neue,Helvetica,Roboto,sans-serif;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-touch-callout:none}.plugin_ctrl_mobile_txp_bottom.txp_none{display:none}.plugin_ctrl_mobile_txp_bottom .txp_disabled{opacity:.5;pointer-events:none}.plugin_ctrl_mobile_txp_bottom *,.plugin_ctrl_mobile_txp_bottom :after,.plugin_ctrl_mobile_txp_bottom :before{margin:0;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box}.plugin_ctrl_mobile_txp_bottom a,.plugin_ctrl_mobile_txp_bottom a:hover,.plugin_ctrl_mobile_txp_bottom a:visited{color:#fff;text-decoration:none!important;pointer-events:auto}.plugin_ctrl_mobile_txp_bottom .txp_btn:active,.plugin_ctrl_mobile_txp_bottom .txp_btn:focus,.plugin_ctrl_mobile_txp_bottom a:focus{outline:0 none}.plugin_ctrl_mobile_txp_bottom .txp_icon{position:relative;display:inline-block;fill:#fff}.plugin_ctrl_mobile_txp_bottom .txp_icon:after,.plugin_ctrl_mobile_txp_bottom .txp_icon:before,.plugin_ctrl_mobile_txp_bottom .txp_icon_inner:after,.plugin_ctrl_mobile_txp_bottom .txp_icon_inner:before{content:"";position:absolute;-webkit-box-sizing:content-box;box-sizing:content-box}.plugin_ctrl_mobile_txp_bottom .txp_icon_inner{position:absolute;width:100%;height:100%}.plugin_ctrl_mobile_txp_bottom .txp_left_controls,.plugin_ctrl_mobile_txp_bottom .txp_right_controls{position:relative;float:left;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_left_controls{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.plugin_ctrl_mobile_txp_bottom .txp_right_controls{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.plugin_ctrl_mobile_txp_bottom .txp_btn{position:relative;cursor:pointer;background:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-family:PingFangSC-Regular,Helvetica Neue,Helvetica,Roboto,Microsoft Yahei,Arial,sans-serif;border:none;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_btn_play{width:60px;height:100%}.plugin_ctrl_mobile_txp_bottom .txp_btn_play .txp_icon_play{display:block;width:30px;height:30px;margin:auto;fill:#fff}.plugin_ctrl_mobile_txp_bottom .txp_btn_play use{display:none}.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_pause .txp_svg_pause,.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_play .txp_svg_play,.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_replay .txp_svg_replay,.plugin_ctrl_mobile_txp_bottom .txp_btn_play.play_btn_stop .txp_svg_stop{display:block}.plugin_ctrl_mobile_txp_bottom .txp_time_display{height:100%;padding:4px 8px 0 0;white-space:nowrap;font-size:0;-webkit-box-flex:0;-ms-flex:none;flex:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_time_display>div{display:inline;font-size:9px}.plugin_ctrl_mobile_txp_bottom .txp_time_display .txp_time_separator{margin:0 1px}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullscreen{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:45px;height:100%;-webkit-box-flex:0;-ms-flex:none;flex:none}.plugin_ctrl_mobile_txp_bottom .txp_icon_fullscreen{display:block;width:30px;height:30px;margin:auto}.plugin_ctrl_mobile_txp_bottom .txp_icon_fullscreen use{display:none}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullscreen[data-status=false] .txp_svg_fullscreen,.plugin_ctrl_mobile_txp_bottom .txp_btn_fullscreen[data-status=true] .txp_svg_fullscreen_true{display:block}.plugin_ctrl_mobile_txp_bottom .txp_unfullscreen .txp_btn_value{background-position:right 0}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullsize{width:45px;height:100%;-webkit-box-flex:0;-ms-flex:none;flex:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_btn_fullsize[data-status=false] .txp_svg_fullscreen,.plugin_ctrl_mobile_txp_bottom .txp_btn_fullsize[data-status=true] .txp_svg_fullscreen_true{display:block}.plugin_ctrl_mobile_txp_bottom .txp_unfullsize .txp_btn_value{background-position:right 0}.plugin_ctrl_mobile_txp_bottom .txp_progress_bar_container{position:relative;height:100%;padding:0;vertical-align:top;-webkit-box-flex:1000;-ms-flex:1000;flex:1000}.plugin_ctrl_mobile_txp_bottom .txp_progress_list{position:absolute;left:0;top:20px;width:100%;height:2px;background-color:rgba(31,31,31,.9);-webkit-transform:translateZ(0);transform:translateZ(0)}.plugin_ctrl_mobile_txp_bottom .txp_progress_play{position:absolute;left:0;top:0;height:100%;width:2px;background-color:#fd9000}.plugin_ctrl_mobile_txp_bottom .txp_btn_scrubber{position:absolute;width:30px;height:40px;margin-left:-10px}.plugin_ctrl_mobile_txp_bottom .txp_scrubber_indicator{position:absolute;top:16px;left:10px;width:10px;height:10px;border-radius:99em;background-color:#ff7000}.plugin_ctrl_mobile_txp_bottom .txp_scrubber_indicator:before{content:"";position:absolute;left:-4px;top:-4px;width:18px;height:18px;background-color:#ff7000;opacity:.4;border-radius:99em}.plugin_ctrl_mobile_txp_bottom .txp_btn_definition,.plugin_ctrl_mobile_txp_bottom .txp_btn_playrate{position:relative;padding:0 8px;height:44px;color:#fff;white-space:nowrap;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_mobile_txp_bottom .txp_btn_definition .txp_label,.plugin_ctrl_mobile_txp_bottom .txp_btn_playrate .txp_label{margin:auto}.plugin_ctrl_mobile_txp_bottom .txp_btn .txp_tooltip{display:none!important}.plugin_ctrl_mobile_txp_bottom .txp_right_controls{min-width:15px}.plugin_ctrl_mobile_txp_bottom .txp_none{display:none}.plugin_ctrl_mobile_txp_bottom~video::-webkit-media-controls,.plugin_ctrl_mobile_txp_bottom~video::-webkit-media-controls-start-playback-button{display:none!important}.plugin_ctrl_mod_overlay_wrapper{position:static}.plugin_ctrl_mod_overlay_wrapper ol,.plugin_ctrl_mod_overlay_wrapper ul{list-style:none}.plugin_ctrl_mod_overlay_wrapper li{vertical-align:top}.plugin_ctrl_mod_overlay_wrapper *{-webkit-box-sizing:border-box;box-sizing:border-box}.plugin_ctrl_mod_overlay_wrapper .mod_overlay{position:absolute;background:rgba(0,0,0,.75);left:0;top:0;right:0;bottom:0;z-index:998;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;color:#fff}.plugin_ctrl_mod_overlay_wrapper .mod_overlay.overlay_flex{display:-webkit-box;display:-ms-flexbox;display:flex}.plugin_ctrl_mod_overlay_wrapper .mod_overlay.txp_none{display:none}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select{width:100%;text-align:center}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select .title{font-size:16px}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select ul{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;font-size:18px;font-weight:700;padding:0 12px}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li{height:70px;margin-right:6px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:0 12px}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li div:last-child{margin-top:6px;font-size:14px;font-weight:500}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li.current{color:#ff6022}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li.current span{position:relative}.plugin_ctrl_mod_overlay_wrapper .mod_speed_select li.current span:after{content:"";width:100%;height:3px;background:#ff6022;position:absolute;bottom:-3px;left:0}.plugin_ctrl_mod_overlay_wrapper .txp_btn_playrate{position:relative;width:55px;height:44px;color:#fff;white-space:nowrap;text-align:center;-webkit-box-flex:0;-ms-flex:none;flex:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.plugin_ctrl_txp_mode_fullscreen .plugin_ctrl_mobile_txp_bottom{padding-bottom:env(safe-area-inset-bottom)}';function adaptMobileAdPlugin(e,t){uaTool.mobile&&(t.on(exports.H5_PLAY_EVENT.AD_PLAYING,(function(){return e.hide(!0)})),t.on(exports.H5_PLAY_EVENT.AD_END,(function(){return e.el.style.display=""})))}var Component=function(){function e(e,t,o){var r;this.player=e,this.config=o,this.CLICK_EVENT_NAME="click",this.eventMap={};var i=e.container;this.el=i.querySelector(t),this.isMobile=null==o?void 0:o.isMobile,this.isLive="live"===(null===(r=this.player.config)||void 0===r?void 0:r.type),this.showEl()}return e.isEnabled=function(e){return!0},e.prototype.destroy=function(){var e;(null===(e=this.el)||void 0===e?void 0:e.parentNode)&&this.el.remove(),this.setEvts(!0),this.el=null,this.player=null},e.prototype.setEvts=function(e){var t=this;void 0===e&&(e=!1);var o=e?this.player.off:this.player.on;Object.keys(this.eventMap).forEach((function(e){o.call(t.player,e,t.eventMap[e])}))},e.prototype.showEl=function(t){void 0===t&&(t=this.el),t&&t.classList.remove(e.hideClassName)},e.prototype.hideEl=function(t){void 0===t&&(t=this.el),t&&t.classList.add(e.hideClassName)},e.sel="",e.disabledClassName="txp_disabled",e.curClassName="txp_current",e.hideClassName="txp_none",e}(),hideCSS="txp_none",disableCSS="txp_disabled",shouldDisableState=[exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE,exports.VIDEO_STATE.LOAD_START],AirPlayBtn=function(e){function t(o,r,i){var n=e.call(this,o,t.sel,r)||this;n.config=r,n.ctrlbar=i,n.handlePlayerCanPlay=function(){n.hideDependOnKernel(),n.setBtnState(!0)},n.handleSetLevelEnd=function(){n.hideDependOnKernel()},n.handlePlayerSessionEnd=function(){n.setBtnState(!1)},n.handleClick=function(){var e,t;null===(t=null===(e=n.player.currentVideoElement)||void 0===e?void 0:e.webkitShowPlaybackTargetPicker)||void 0===t||t.call(e)};var a=!shouldDisableState.includes(n.player.state);return n.setupDOMEvents(),n.setupPlayerEvents(!0),n.show(),n.setBtnState(a),n}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile;return uaTool.browser.safari&&!t},t.prototype.show=function(){this.el.classList.remove(hideCSS)},t.prototype.hide=function(){this.el.classList.add(hideCSS)},t.prototype.setBtnState=function(e){if(e)return this.el.classList.remove(disableCSS);this.el.classList.add(disableCSS)},t.prototype.destroy=function(){var e;this.setupPlayerEvents(!1),null===(e=this.el)||void 0===e||e.remove()},t.prototype.setupPlayerEvents=function(e){void 0===e&&(e=!0);var t=e?this.player.on.bind(this.player):this.player.off.bind(this.player);t(exports.H5_PLAY_EVENT.VIDEO_CANPLAY,this.handlePlayerCanPlay),t(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.handlePlayerSessionEnd),t(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,this.handleSetLevelEnd)},t.prototype.setupDOMEvents=function(){this.el=this.player.container.querySelector(t.sel),this.el.addEventListener("click",this.handleClick)},t.prototype.hideDependOnKernel=function(){this.player.kernelName===exports.KERNEL_NAME.WASM?this.hide():this.show()},t.sel=".plugin_ctrl_airplay_btn",t.compName="AirPlayBtn",t}(Component),HOTPOINT_EVENTS$1;!function(e){e.HOT_MOUSE_OVER="ctrl:hotpoint-mouseover",e.HOT_MOUSE_MOVE="ctrl:hotpoint-mousemove",e.HOT_MOUSE_OUT="ctrl:hotpoint-mouseout"}(HOTPOINT_EVENTS$1||(HOTPOINT_EVENTS$1={}));var CtrlbarPluginName$2="ctrlbar",CTRL_EVENTS$2=__assign$1(__assign$1({FULLSCREEN_CHANGE:"windowFullscreenChange",FULLSCREEN_ERROR:"fullscreenError",FAKE_FULLSCREEN_CHANGE:"browserFullscreenChange",CLICK_PIPBTN:"ctrl:click-pipbtn",CLICK_NEXTBTN:"ctrl:click-nextbtn",CLICK_PLAYBTN:"ctrl:click-playbtn",CLICK_REPLAY:"ctrl:click-replay",SET_LANGUAGE:"ctrl:set-language",SET_LEVEL:"ctrl:set-level",SET_AUDIO:"ctrl:set-audio",SET_PLAYRATE:"ctrl:set-playrate",SET_VOLUME:"ctrl:set-volume",TOGGLE_OVERLAY:"ctrl:toggle-overlay",MOUSE_DONW:"ctrl:progress-mousedown",MOUSE_DOWN:"ctrl:progress-mousedown",MOUSE_MOVE:"ctrl:progress-mousemove",MOUSE_UP:"ctrl:progress-mouseup",SHOW:"ctrl:show",HIDE:"ctrl:hide"},HOTPOINT_EVENTS$1),{TEST_EVENT:"ctrl:inner-test-event",RESIZE:"ctrl:resize",SHOW_LEVELS:"ctrl:show-levels",HOVER_PROGRESS:"ctrl:hover-progress"}),pcRootClassName$1=".plugin_ctrl_txp_bottom",mobileRootClassName$1=".plugin_ctrl_mobile_txp_bottom",getRootClassName$1=function(e){return e?mobileRootClassName$1:pcRootClassName$1},shadowClassName$1=".plugin_ctrl_txp_shadow",gradientClassName$1=".plugin_ctrl_txp_gradient_bottom",containerClassName$1="_mod_thumbplayer_container_",largeSizeClassName$1="plugin_ctrl--large",bodyOverflowClassName$1="plugin_ctrl_fake_fullscreen",CTRL_SIZE$1,PlayBtnStatus$1;!function(e){e.LARGE="large",e.NORMAL="normal"}(CTRL_SIZE$1||(CTRL_SIZE$1={})),function(e){e.PAUSE="pause",e.PLAY="play",e.REPLAY="replay",e.STOP="stop"}(PlayBtnStatus$1||(PlayBtnStatus$1={}));var Popup=function(e){function t(t,o,r){var i=e.call(this,t,o.selector,o)||this;return i.ctrlbar=r,i.hideEl(),i.popup=i.isMobile?i.player.container.querySelector(o.modSelector):i.el.querySelector(".txp_popup"),i.el?(i.label=i.el.querySelector(".txp_label"),i.isMobile?i.label.addEventListener(i.CLICK_EVENT_NAME,(function(){!i.popup.classList.contains(Component.hideClassName)?i.hideEl(i.popup):(i.showEl(i.popup),i.popup.classList.add("overlay_flex")),i.ctrlbar.emit(CTRL_EVENTS$2.TOGGLE_OVERLAY,!0),i.hideEl(i.ctrlbar.el)})):(i.label.addEventListener("mouseover",(function(){return i.showEl(i.popup)})),i.el.addEventListener("mouseleave",(function(){i.hideEl(i.popup)}))),i.initItemClick(),i):i}return __extends$1(t,e),Object.defineProperty(t.prototype,"curClass",{get:function(){return this.isMobile?"current":Component.curClassName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this.selectedValue},set:function(e){var t,o=null===(t=this.popupOptions)||void 0===t?void 0:t.find((function(t){return String(t.value)===String(e)}));if(this.selectedValue=e,!o)return this.label.textContent="",void this.hideEl();this.showEl(),this.setCurrent(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"popupOptions",{get:function(){return this.allValue},set:function(e){var t=this,o=e.find((function(e){return String(e.value)===String(t.selectedValue)}));o?(this.setCurrent(o),this.showEl()):this.label.textContent="",this.allValue=e;var r=this.isMobile?"li":"div",i=/(<([^>]+)>)/;this.popup.querySelector(this.isMobile?".select_list":".txp_popup_content").innerHTML=e.map((function(e){return"<"+r+' \n      class="txp_menuitem '+(e.value===t.selected?t.curClass:"")+'" \n      data-label="'+(i.test(e.label)?"":e.label)+'"\n      data-value="'+e.value+'" \n      data-payload="'+(e.payload||"")+'">'+e.label+"</"+r+">"})).join("")},enumerable:!1,configurable:!0}),t.prototype.setCurrent=function(e){var t,o=this;this.label.innerHTML=null!==(t=null==e?void 0:e.btnLabel)&&void 0!==t?t:null==e?void 0:e.label,this.popup.querySelectorAll(".txp_menuitem").forEach((function(t){t.getAttribute("data-value")===String(e.value)?t.classList.add(o.curClass):t.classList.remove(o.curClass)}))},t.prototype.hookPlaySessionEnd=function(){this.el&&this.el.classList.add(Component.disabledClassName)},t.prototype.hookFlowNodeStart=function(e){"VideoFlowNode"===e.data.name&&this.el.classList.remove(Component.disabledClassName)},t.prototype.initItemClick=function(){var e=this;this.popup.addEventListener(this.CLICK_EVENT_NAME,(function(t){var o,r;e.player.setStateKv("ctrlbar:"+e.popupName+":"+e.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION});for(var i=t.target;i&&!(null===(o=i.classList)||void 0===o?void 0:o.contains("txp_menuitem"));)i=i.parentNode;e.isMobile&&(e.hideEl(e.popup),e.popup.classList.remove("overlay_flex"),e.ctrlbar.emit(CTRL_EVENTS$2.TOGGLE_OVERLAY,!1));var n=null==i?void 0:i.dataset;(null==n?void 0:n.value)&&n.value!==String(e.selected)&&(null===(r=e.onSelect)||void 0===r||r.call(e,n),e.config.hidePopupOnClick&&e.hideEl(e.popup))}))},t.compName="popup",t}(Component),AudioTrackPopup=function(e){function t(o,r,i){var n=e.call(this,o,__assign$1(__assign$1({},r),{selector:t.popupSelector}),i)||this;return n.popupName="audiotrack",n.onSelect=function(e){n.ctrlbar.emit(CTRL_EVENTS$2.SET_AUDIO,e)},n}return __extends$1(t,e),t.isEnabled=function(e){return!(e.isMobile||e.disableAudioTrack)},t.compName="AudioTrackPopup",t.popupSelector=".txp_right_controls .txp_btn_audio_track",t}(Popup);function onBtnClickPlay(e,t){t.isInRequest?e.triggerAutoplay().then((function(){return e.play()})):e.play()}var CenterBtn=function(e){function t(o,r,i){var n=e.call(this,o,t.sel,r)||this;return n.config=r,n.ctrlbar=i,n.prepareDOM(),n.initDOMEvents(),n.initPlayerEvents(),n}return __extends$1(t,e),t.isEnabled=function(e){var t=e.showCenterPlayBtn,o=e.showCenterReplayBtn;return t||o},t.prototype.initDOMEvents=function(){var e=this;this.playBtn.addEventListener("click",(function(){e.hideEl(e.playBtn),onBtnClickPlay(e.player,e.ctrlbar)})),this.replayBtn.addEventListener("click",(function(){e.hideEl(e.replayBtn),e.player.replay()}))},t.prototype.initPlayerEvents=function(){var e=this,t=this.player,o=function(){e.config.showCenterPlayBtn&&e.showEl(e.playBtn)};o(),t.on(exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,(function(e){e.data.adType===exports.AD_TYPE.PRE&&o()})),t.on(exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,o),t.on(exports.H5_PLAY_EVENT.AD_PLAYING,(function(){return e.hideEl(e.playBtn)})),t.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){t.data.isFirst&&e.hideEl(e.playBtn)})),t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(t){var o=t.data;e.hideEl(e.playBtn),e.config.showCenterReplayBtn&&o.endState===exports.END_STATE.NORMAL&&e.showEl(e.replayBtn)})),t.on(exports.H5_PLAY_EVENT.PLAY_SESSION_START,(function(){e.hideEl(e.replayBtn)}))},t.prototype.prepareDOM=function(){var e='<div class="'+t.sel.slice(1)+'">\n      <div class="btn_play '+Component.hideClassName+'">\n        <svg class="icon_play" viewBox="0 0 100 100">\n          <circle cx="50" cy="50" r="50" style="fill:#222;fill-opacity:0.75"></circle>\n          <path\n            transform="translate(36, 33)"\n            d="M0.6,2C0.6,2,0,3.5,0,16.9C0,30.3,0.6,32,0.6,32c0,1.5,1.6,2.5,2.9,1.8c0,0,3-0.5,15.2-6.6c12.2-6.1,14.2-8.4,14.2-8.4c1.5-0.7,1.5-2.8,0-3.6c0,0-3.3-3.1-14.2-8.6C7.9,1.1,3.5,0.2,3.5,0.2C2.1-0.5,0.6,0.5,0.6,2z"\n            style="fill:#fff;"\n          />\n        </svg>\n      </div>\n\n      <div class="btn_replay '+Component.hideClassName+'">\n        <svg class="icon_replay" viewBox="0 0 30 30">\n          <use xlink:href="#txp_svg_replay"></use>\n        </svg>\n        <div>重新播放</div>\n      </div>\n    </div>';this.ctrlbar.el.insertAdjacentHTML("beforebegin",e),this.el=this.player.container.querySelector(t.sel),this.playBtn=this.el.querySelector(".btn_play"),this.replayBtn=this.el.querySelector(".btn_replay")},t.sel=".plugin_ctrl_center_btn",t.compName="CenterBtn",t}(Component),DefinitionPopup=function(e){function t(o,r,i){var n=e.call(this,o,__assign$1(__assign$1({},r),{selector:t.popupSelector,modSelector:t.modSelector}),i)||this;return n.popupName="definition",n.onSelect=function(e){n.ctrlbar.emit(CTRL_EVENTS$2.SET_LEVEL,e)},n.onShowLevel=function(){n.ctrlbar.emit(CTRL_EVENTS$2.SHOW_LEVELS)},n.label.addEventListener("mouseover",n.onShowLevel),n}return __extends$1(t,e),t.isEnabled=function(){return!0},t.compName="DefinitionPopup",t.popupSelector=".txp_right_controls .txp_btn_definition",t.modSelector=".mod_overlay.definition",t}(Popup),FakeFullscreen=function(e){function t(o,r,i){var n=e.call(this,o,t.sel,r)||this;return n.ctrlbar=i,n.tip=n.el.querySelector(".txp_tooltip"),n.el.classList.remove(Component.hideClassName),n.setupDOMEvents(),n}return __extends$1(t,e),t.isEnabled=function(e){var t=e.disableFakeFullscreen,o=e.useH5FakeFullscreen,r=e.isMobile;return void 0!==o?!!o:void 0!==t?!t:!(!uaTool.os.android&&r)},Object.defineProperty(t.prototype,"isFullScreen",{get:function(){return this.player.fullscreenMode===exports.FullScreenMode.FAKE_FULLSCREEN},enumerable:!1,configurable:!0}),t.prototype.setTipStatus=function(e){this.el.dataset.status=String(e),this.isMobile||(this.tip.innerText=e?"退出网页全屏":"网页全屏")},t.prototype.requestFullScreen=function(e){void 0===e&&(e="enter");var o="enter"===e;this.player.container.classList.toggle(t.fullscreenClassName,o),this.player.requestFullScreen(o,exports.FullScreenMode.FAKE_FULLSCREEN)},t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener(this.CLICK_EVENT_NAME,(function(){e.player.setStateKv("ctrlbar:"+t.compName+":"+e.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION}),e.requestFullScreen(e.isFullScreen?"exit":"enter")})),this.isMobile||(this.el.addEventListener("mouseover",(function(){e.showEl(e.tip)})),this.el.addEventListener("mouseout",(function(){e.hideEl(e.tip)}))),this.player.on(exports.PLAY_EVENT.FULLSCREEN_CHANGE,(function(){var t=e.isFullScreen;e.setTipStatus(t),e.ctrlbar.emit(CTRL_EVENTS$2.FAKE_FULLSCREEN_CHANGE,t)}))},t.sel=".txp_right_controls .txp_btn_fake",t.fullscreenClassName="plugin_ctrl_txp_mode_fullscreen",t.compName="FakeFullscreen",t}(Component),fullscreenClassName="thumbplayer-fullscreen",fullscreenEvents=["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"],Fullscreen=function(e){function t(o,r,i){var n=e.call(this,o,t.sel,r)||this;return n.ctrlbar=i,n.onFullscreenChange=function(){var e=n.isFullScreen;n.setDOMStatus(e?FullscreenStatus.Exit:FullscreenStatus.Enter),n.ctrlbar.emit(CTRL_EVENTS$2.FULLSCREEN_CHANGE,e),e?n.player.container.classList.add(fullscreenClassName):n.player.container.classList.remove(fullscreenClassName)},n.tip=n.el.querySelector(".txp_tooltip"),n.setupDOMEvents(),n.isMobile||n.listenDblclick(),n}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile,o=e.useH5FakeFullscreen;return void 0!==o?!o:!(!uaTool.os.ios&&t)},Object.defineProperty(t.prototype,"isFullScreen",{get:function(){return this.player.fullscreenMode===exports.FullScreenMode.FULL_SCREEN},enumerable:!1,configurable:!0}),t.prototype.setDOMStatus=function(e){this.el.dataset.status=e,this.isMobile||(this.tip.innerText=e===FullscreenStatus.Exit?"退出全屏":"全屏")},t.prototype.requestFullScreen=function(e){var t=this;return void 0===e&&(e="enter"),this.player.requestFullScreen("enter"===e,exports.FullScreenMode.FULL_SCREEN).catch((function(e){t.ctrlbar.emit(CTRL_EVENTS$2.FULLSCREEN_ERROR,e)}))},t.prototype.listenDblclick=function(){var e=this;this.player.container.querySelector(shadowClassName$1).addEventListener("dblclick",(function(){var t;(null===(t=e.ctrlbar.instances.FakeFullscreen)||void 0===t?void 0:t.isFullScreen)?e.ctrlbar.instances.FakeFullscreen.requestFullScreen("exit"):e.requestFullScreen(e.isFullScreen?"exit":"enter")}))},t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener("click",(function(){e.player.setStateKv("ctrlbar:"+t.compName+":click",{type:exports.LOG_TYPE.USER_ACTION,message:"fullscreen="+e.isFullScreen}),e.requestFullScreen(e.isFullScreen?"exit":"enter")})),this.isMobile||(this.el.addEventListener("mouseover",(function(){return e.showEl(e.tip)})),this.el.addEventListener("mouseout",(function(){return e.hideEl(e.tip)}))),this.player.on(exports.PLAY_EVENT.FULLSCREEN_CHANGE,this.onFullscreenChange),fullscreenEvents.forEach((function(t){document.addEventListener(t,e.onFullscreenChange)}))},t.sel=".txp_right_controls .txp_btn_fullscreen",t.compName="Fullscreen",t}(Component),FullscreenStatus,HOTPOINT_TIP_TYPE;!function(e){e.Enter="false",e.Exit="true"}(FullscreenStatus||(FullscreenStatus={})),function(e){e.DEFAULT="default",e.WITH_PREVIEW="with-preview",e.NONE="none"}(HOTPOINT_TIP_TYPE||(HOTPOINT_TIP_TYPE={}));var THROTTLE_WAIT=16.6,mouseEvtMap={mouseover:HOTPOINT_EVENTS$1.HOT_MOUSE_OVER,mousemove:HOTPOINT_EVENTS$1.HOT_MOUSE_MOVE,mouseout:HOTPOINT_EVENTS$1.HOT_MOUSE_OUT},HotPoint=function(e){function t(o,r,i){var n,a=e.call(this,o,t.sel,r)||this;return a.ctrlbar=i,a.hotPointMap={},a.isReady=!1,a.onVideoCanPlay=function(){a.isReady||(a.isReady=!0,a.renderDom())},a.onPlaySessionEnd=function(){a.isReady=!1,a.tipEl.classList.add(t.hideClassName),a.clearHotPoints()},a.config.hotPointTipType||(a.config.hotPointTipType=HOTPOINT_TIP_TYPE.DEFAULT),a.mouseEvtHandler=a.mouseEvtHandler.bind(a),a.mouseEvtFuncMap={mouseover:a.onMouseOver.bind(a),mousemove:lodash_throttle(a.onMouseMove.bind(a),THROTTLE_WAIT,{trailing:!1}),mouseout:a.onMouseOut.bind(a)},a.eventMap=((n={})[exports.H5_PLAY_EVENT.VIDEO_CANPLAY]=a.onVideoCanPlay,n[exports.H5_PLAY_EVENT.PLAY_SESSION_END]=a.onPlaySessionEnd,n),a.config.hotPointTipType===HOTPOINT_TIP_TYPE.DEFAULT&&a.setupTip(),a.setEvts(!1),a.logger=new Logger(a.player.config.instanceId,"Ctrl:HotPoints"),a}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.clearHotPoints=function(){Object.values(this.hotPointMap).forEach((function(e){var t=e.el;t instanceof HTMLElement&&t.remove()})),this.hotPointMap={}},t.prototype.addHotPoints=function(e){var t=this;if(null==e?void 0:e.length){var o=e.map((function(e){var o=__assign$1({},e);return o.uuid=comTool.createGUID(),t.hotPointMap[o.uuid]=o,o}));return this.isReady&&this.renderDom(),o}},t.prototype.deleteHotPoints=function(e){var t=this;e.forEach((function(e){var o,r=t.hotPointMap[e];r&&(null===(o=r.el)||void 0===o||o.remove(),delete t.hotPointMap[e])}))},t.prototype.setEvts=function(t){var o=this;void 0===t&&(t=!1);var r=t?this.el.removeEventListener:this.el.addEventListener;Object.keys(mouseEvtMap).forEach((function(e){r.call(o.el,e,o.mouseEvtHandler,!1)})),e.prototype.setEvts.call(this,t)},t.prototype.isValidHotPoint=function(e){return e.timing<=this.player.duration},t.prototype.renderDom=function(){var e=this;Object.entries(this.hotPointMap).forEach((function(t){var o=t[0],r=t[1];if(!(r.el instanceof HTMLElement)){var i=e.createPointElement(r);i&&(e.el.insertAdjacentElement("beforeend",i),e.hotPointMap[o]=__assign$1(__assign$1({},r),{el:i}))}}))},t.prototype.createPointElement=function(e){if(this.isValidHotPoint(e)){var o=document.createElement("div"),r=e.timing/this.player.duration*100;return o.classList.add(t.defaultPointClass),o.style.left=r+"%",o.dataset.info=JSON.stringify(e),o}this.logger.warn("ctrlbar: hotpoint 入值非法，已忽略",e)},t.prototype.setupTip=function(){var e;this.config.hotPointCustomTipEl?e=this.config.hotPointCustomTipEl:(e=document.createElement("div")).classList.add(t.defaultTipClass),e.classList.add(t.hideClassName),this.el.insertAdjacentElement("beforeend",e),this.tipEl=e},Object.defineProperty(t.prototype,"offsetLeft",{get:function(){return this.player.container.getBoundingClientRect().left},enumerable:!1,configurable:!0}),t.prototype.mouseEvtHandler=function(e){var t=e.target.dataset;if(t.info){var o=this.config.hotPointTipType,r=JSON.parse(t.info);o===HOTPOINT_TIP_TYPE.DEFAULT&&this.mouseEvtFuncMap[e.type]({point:r,mouseEvent:e}),this.ctrlbar.emit(mouseEvtMap[e.type],{point:r,mouseEvent:e,hotPointTipType:o})}},t.prototype.onMouseOver=function(e){var o=e.point;this.tipEl&&o.text&&(this.tipEl.textContent=o.text,this.tipEl.classList.remove(t.hideClassName))},t.prototype.onMouseMove=function(e){if(this.tipEl){var t=e.mouseEvent,o=this.player.container,r=this.tipEl.getBoundingClientRect().width,i=t.clientX-this.offsetLeft-r/2;i<0&&(i=0),i>o.clientWidth-r&&(i=o.clientWidth-r),this.tipEl.style.transform="translateX("+i+"px)"}},t.prototype.onMouseOut=function(){this.tipEl&&this.tipEl.classList.add(t.hideClassName)},t.sel=".txp_hotpoint",t.compName="HotPoint",t.defaultPointClass="txp_interact_dot",t.defaultTipClass="txp_hotpoint_tip",t}(Component),LanguagePopup=function(e){function t(o,r,i){var n=e.call(this,o,__assign$1(__assign$1({},r),{selector:t.popupSelector,modSelector:t.modSelector}),i)||this;return n.popupName="language",n.onSelect=function(e){n.ctrlbar.emit(CTRL_EVENTS$2.SET_LANGUAGE,e)},n}return __extends$1(t,e),t.isEnabled=function(e){return!(e.isMobile||e.disableLang)},t.compName="LanguagePopup",t.modSelector=".mod_overlay.language",t.popupSelector=".txp_right_controls .txp_btn_language",t}(Popup),Progress=function(e){function t(o,r,i){var n,a=e.call(this,o,t.sel,r)||this;a.ctrlbar=i,a.isMouseDown=!1,a.maxPercent=1,a.isActive=!0,a.shouldHideHoverTime=!1,a.onMouseMove=function(e){if(e.preventDefault(),a.isMouseDown){var t=Math.min(a.getPercentByClientX(e),a.maxPercent);a.updateProgress(t),a.ctrlbar.emit(CTRL_EVENTS$2.MOUSE_MOVE,t),e.preventDefault()}},a.onMouseUp=function(e){if(e.preventDefault(),document.removeEventListener("touchmove",a.onMouseMove),document.removeEventListener("mousemove",a.onMouseMove),document.removeEventListener("touchend",a.onMouseUp),document.removeEventListener("mouseup",a.onMouseUp),a.isMouseDown){a.player.setStateKv("ctrlbar:"+t.compName+":"+(a.isMobile?"touchend":"mouseup"),{type:exports.LOG_TYPE.USER_ACTION,eventId:a.evtId}),a.isMouseDown=!1;var o=parseFloat(a.progressPlayed.style.width)/100;a.doSeek(o),a.ctrlbar.emit(CTRL_EVENTS$2.MOUSE_UP,o)}},a.onMouseDown=function(e){if(e.preventDefault(),document.addEventListener("touchend",a.onMouseUp),document.addEventListener("mouseup",a.onMouseUp),document.addEventListener("touchmove",a.onMouseMove,{passive:!1}),document.addEventListener("mousemove",a.onMouseMove,{passive:!1}),a.evtId=a.player.dataset.generateEvtId(),a.player.setStateKv("ctrlbar:"+t.compName+":"+(a.isMobile?"touchstart":"mousedown"),{type:exports.LOG_TYPE.USER_ACTION,eventId:a.evtId}),a.player.state!==exports.VIDEO_STATE.IDLE){a.beforeSeek(),a.isMouseDown=!0;var o=Math.min(a.getPercentByClientX(e),a.maxPercent);a.updateProgress(o),a.ctrlbar.emit(CTRL_EVENTS$2.MOUSE_DOWN,o)}},a.eventMap=((n={})[exports.PLAY_EVENT.TIME_UPDATE]=a.onTimeUpdate.bind(a),n[exports.PLAY_EVENT.STATE_CHANGE]=a.onStateChange.bind(a),n[exports.PLAY_EVENT.VIDEO_BUFFER_CHANGE]=function(){return a.updateBufferedBar()},n),a.setEvts(),a.progressLoaded=a.el.querySelector(".txp_progress_load"),a.progressPlayed=a.el.querySelector(".txp_progress_play"),a.scrubber=a.el.querySelector(".txp_btn_scrubber"),a.tooltip=a.el.querySelector(".txp_tooltip");return a.tooltipPosLimit=45/a.player.container.clientWidth/2*100+.5,a.isMobile&&a.el.appendChild(a.scrubber),a.el.addEventListener("touchstart",a.onMouseDown),a.el.addEventListener("mousedown",a.onMouseDown),a.isMobile||(a.setTooltipOnHover(),a.el.addEventListener("mouseover",(function(){i.emit(CTRL_EVENTS$2.HOVER_PROGRESS)}))),a.listenReqInfoEnd(),a}return __extends$1(t,e),Object.defineProperty(t.prototype,"offsetLeft",{get:function(){return this.el.getBoundingClientRect().left},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferedTime",{get:function(){var e=this,t=this.player.videoBuffered,o=t.length;if(1===o)return t[0].end;var r=0;return t.forEach((function(i,n){var a=i.start,s=i.end,l=e.player.playtime;if(l>=a&&l<=s)if(o>n+1)for(var c=n+1;c<o;c++){var p=t[c].start-t[c-1].end;if(!(0<=p&&p<=.2)){r=t[c-1].end;break}r=t[c].end}else r=i.end})),r},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.el.removeEventListener("touchstart",this.onMouseDown),this.el.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("touchmove",this.onMouseMove),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("touchend",this.onMouseUp),document.removeEventListener("mouseup",this.onMouseUp),e.prototype.destroy.call(this)},t.prototype.setActive=function(e){this.isActive!==e&&(this.isActive=e,this.setEvts(!this.isActive),this.isActive?this.showEl():this.hideEl())},t.prototype.setTooltip=function(e){var t=this.tooltip,o=this.tooltipPosLimit;t.innerText=comTool.formatPlayTime(e*this.ctrlbar.duration);var r=Math.max(o,Math.min(100*e,100-o));t.style.left=r+"%"},t.prototype.updateBufferedBar=function(e){if(void 0===e&&(e=this.bufferedTime),0!==e){if(this.ctrlbar.duration&&"number"==typeof e){var t=Math.min(Math.round(100*e/this.ctrlbar.duration),100*this.maxPercent);t>=99&&(t=100),this.progressLoaded.style.width=t+"%"}}else this.progressLoaded.style.width="0"},t.prototype.updateProgress=function(e){if(!Number.isNaN(e)){var t=100*e;this.progressPlayed.style.width=t+"%",this.scrubber.style.left=t+"%"}},t.prototype.getPercentByClientX=function(e){var t=("touches"in e?e.touches[0]:e).clientX-this.offsetLeft;Math.abs(t-this.el.clientWidth)<=1&&(t=this.el.clientWidth);var o=t/this.el.clientWidth;return o=Math.max(0,Math.min(1,o))},t.prototype.onTimeUpdate=function(){if(!this.isMouseDown){var e=this.player.playtime/this.ctrlbar.duration;this.updateProgress(e),this.updateBufferedBar()}},t.prototype.onStateChange=function(e){var t=e.data;-1!==[exports.VIDEO_STATE.IDLE,exports.VIDEO_STATE.END].indexOf(t.new)&&(this.updateProgress(0),this.updateBufferedBar(0))},t.prototype.setTooltipOnHover=function(){var e=this;this.el.addEventListener("mouseover",(function(t){if(!(e.config.hideHoverTime||void 0===e.config.hideHoverTime&&e.shouldHideHoverTime)){var o=e.getPercentByClientX(t);e.setTooltip(o),e.showEl(e.tooltip),e.tooltip.style.display="flex"}})),this.el.addEventListener("mouseout",(function(){return e.hideEl(e.tooltip)})),this.el.addEventListener("mousemove",(function(t){var o=e.getPercentByClientX(t);e.setTooltip(o)}))},t.prototype.beforeSeek=function(){var e=this;this.pauseTimer=window.setTimeout((function(){return e.player.pause()}),300)},t.prototype.doSeek=function(e){var t=e*this.ctrlbar.duration;this.player.seek(t),this.pauseTimer&&(window.clearTimeout(this.pauseTimer),this.pauseTimer=null),this.player.state!==exports.VIDEO_STATE.PAUSE||this.player.config.remainPauseStateAfterSeek||this.player.play()},t.prototype.listenReqInfoEnd=function(){var e=this;this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,(function(t){var o,r,i,n=t.data,a=e.player.plugins,s=a["ui-preview"]||a["ui-preview-list"],l=(null===(o=n.parseData)||void 0===o?void 0:o.preview)>0;e.shouldHideHoverTime=!(!s||l||!(null===(i=null===(r=n.parseData)||void 0===r?void 0:r.previewList)||void 0===i?void 0:i.length))}))},t.sel=".txp_progress_bar_container",t.compName="Progress",t}(Component),TIME_UPDATE_GAP_MS=200,PLAY_BACK_STATE;!function(e){e.IDLE="idle",e.BACK_PLAYING="backPlaying",e.LIVE_PLAYING="livePlaying"}(PLAY_BACK_STATE||(PLAY_BACK_STATE={}));var LiveProgress=function(e){function t(t,o,r,i){var n=e.call(this,t,o,r)||this;return n.ctrlbar=r,n.timeupdateTimerID=0,n.playbackStateInner=PLAY_BACK_STATE.IDLE,n.maxBackDurationOverflow=!1,n.curBackDurationMS=0,n.liveStateTimeStr="",n.isSwitchBackOp=!1,n.seekIntervalId=0,n.playerApiForPlugins=null==i?void 0:i.api,n.addReturnLiveBtn(),n.addLiveTimeDisplay(),n.setActive(!1),n.addPlayerEvts(),n}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.destroy=function(){var t,o;(null===(t=this.liveTimeDisplayDom)||void 0===t?void 0:t.parentNode)&&(this.liveTimeDisplayDom.remove(),this.liveTimeDisplayDom=null),(null===(o=this.returnLiveBtn)||void 0===o?void 0:o.parentNode)&&(this.returnLiveBtn.remove(),this.returnLiveBtn=null),this.playerApiForPlugins=null,this.setTimeupdateTimer(!1),e.prototype.destroy.call(this)},t.prototype.setActive=function(t){e.prototype.setActive.call(this,t),this.liveTimeDisplayDom.style.display=t?"flex":"none",this.hideEl(this.returnLiveBtn)},t.prototype.setTooltip=function(e){var t=this.tooltip,o=this.tooltipPosLimit,r=Math.max(o,Math.min(100*e,100-o)),i=this.getTimeTip(e);t.style.left=r+"%",t.innerText=i},t.prototype.updateBufferedBar=function(e){},t.prototype.onTimeUpdate=function(){},t.prototype.onStateChange=function(){},t.prototype.beforeSeek=function(){},t.prototype.doSeek=function(e){this.seek(e)},t.prototype.addLiveTimeDisplay=function(){var e=this.ctrlbar.el.querySelector(".txp_left_controls");this.liveTimeDisplayDom=domTool.creatDom('<txpdiv class="txp_time_display txp_time_display_live" style="display: none;">\n      <txpdiv class="txp_live_badge" style="display: block">直播中</txpdiv>\n    </txpdiv>'),this.liveBadgeDom=this.liveTimeDisplayDom.querySelector(".txp_live_badge"),e.append(this.liveTimeDisplayDom)},t.prototype.addReturnLiveBtn=function(){var e=this,t=this.ctrlbar.el.querySelector(".txp_left_controls");this.returnLiveBtn=domTool.creatDom('<txpdiv class="txp_btn txp_btn_return txp_none">\n      <txpdiv class="txp_label">返回直播</txpdiv>\n    </txpdiv>'),t.append(this.returnLiveBtn),this.returnLiveBtn.addEventListener("click",(function(){e.seek(1)}))},t.prototype.updateLiveTime=function(e,t){void 0===t&&(t=""),domTool.text(this.liveBadgeDom,e+" "+t)},t.prototype.setPlayBackState=function(e){e?(domTool.addClass(this.liveBadgeDom,"txp_live_badge_back"),this.showEl(this.returnLiveBtn)):(domTool.removeClass(this.liveBadgeDom,"txp_live_badge_back"),this.hideEl(this.returnLiveBtn))},t.prototype.addPlayerEvts=function(){var e=this;this.player.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,(function(t){var o,r=t.data.data;if(r&&!r.error){var i=(r||{}).resData;e.clientStartTimeMS=Date.now(),e.playbackData=null===(o=i)||void 0===o?void 0:o.playback,e.playbackData?e.playbackState===PLAY_BACK_STATE.IDLE&&(e.setPlayBackEnabled(!0),e.player.loadParam.videoReqInfoParam.playbacktime>0?e.enterState(PLAY_BACK_STATE.BACK_PLAYING):e.enterState(PLAY_BACK_STATE.LIVE_PLAYING)):e.setPlayBackEnabled(!1)}})),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(){e.isSwitchBackOp?e.isSwitchBackOp=!1:e.enterState(PLAY_BACK_STATE.IDLE)})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(){e.isSwitchBackOp=!1}))},t.prototype.setPlayBackEnabled=function(e){this.setActive(e),this.setTimeupdateTimer(e)},t.prototype.enterState=function(e,t){var o=this;if(this.playbackData&&this.playbackState!==e){var r=this.playbackState;if(r===PLAY_BACK_STATE.IDLE&&e===PLAY_BACK_STATE.LIVE_PLAYING)this.playbackState=e;else if(r===PLAY_BACK_STATE.LIVE_PLAYING&&e===PLAY_BACK_STATE.BACK_PLAYING){var i=t.backDurationMS,n=this.calcBackAbsoluteTimeS(Date.now(),i);this.switchPlay(n,(function(){o.curBackDurationMS=i,o.playbackState=e}),(function(e){o.playbackState=PLAY_BACK_STATE.LIVE_PLAYING;var t=e.code,r=e.message,i=e.data;if(null==t?void 0:t.startsWith(exports.ErrorCode.GETINFO_LIVE_SERVER_CODE_PREFIX))o.emitPlayerEvts("playbackFailed",__assign$1({code:t,message:r},i));else{var n=o.player.plugins.tips;"function"==typeof(null==n?void 0:n.show)&&n.show("回看出错，请稍后再试试...")}}))}else r===PLAY_BACK_STATE.BACK_PLAYING&&e===PLAY_BACK_STATE.LIVE_PLAYING?this.switchPlay(0,(function(){o.playbackState=e})):e===PLAY_BACK_STATE.IDLE&&(this.playbackState=e)}},Object.defineProperty(t.prototype,"playbackState",{get:function(){return this.playbackStateInner},set:function(e){this.playbackStateInner=e,this.onPlaybackStateChange(e),this.emitPlayerEvts("playbackStateChange",{state:this.playbackState})},enumerable:!1,configurable:!0}),t.prototype.onPlaybackStateChange=function(e){switch(e){case PLAY_BACK_STATE.LIVE_PLAYING:this.exitBackPlaying();break;case PLAY_BACK_STATE.BACK_PLAYING:this.enterBackPlaying();break;case PLAY_BACK_STATE.IDLE:this.exitBackPlaying(),this.setPlayBackEnabled(!1)}},t.prototype.emitPlayerEvts=function(e){for(var t,o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];(t=this.player).emit.apply(t,__spreadArray$1([e],o,!1))},t.prototype.switchPlay=function(e,t,o){var r;this.isSwitchBackOp=!0,(null===(r=this.playerApiForPlugins)||void 0===r?void 0:r.replayInCurFlowNode)&&this.playerApiForPlugins.replayInCurFlowNode(this.player.vid,{videoReqInfoParam:{playbacktime:e}}).then((function(){null==t||t()})).catch((function(e){null==o||o(e)}))},t.prototype.seekInBackState=function(e){var t,o=e.backDurationMS,r=this.calcBackAbsoluteTimeS(Date.now(),o),i=this.player.currentVideoInfo.loadingUrl,n=urlTool.updateUrlParam(i,"wsStreamTimeABS",""+r);this.curBackDurationMS=o,this.isSwitchBackOp=!0,(null===(t=this.playerApiForPlugins)||void 0===t?void 0:t.replayInCurFlowNode)&&this.playerApiForPlugins.replayInCurFlowNode({url:n})},t.prototype.enterBackPlaying=function(){this.setPlayBackState(!0),this.updateLiveTime("回看中")},t.prototype.exitBackPlaying=function(){this.updateProgress(1),this.setPlayBackState(!1),this.curBackDurationMS=0,this.player.loadParam.videoReqInfoParam.playbacktime=0,this.updateLiveTime("直播中")},t.prototype.setTimeupdateTimer=function(e){e?0===this.timeupdateTimerID&&(this.timeupdateTimerID=window.setInterval(this.onTimeupdate.bind(this),TIME_UPDATE_GAP_MS)):this.timeupdateTimerID>0&&(window.clearInterval(this.timeupdateTimerID),this.timeupdateTimerID=0)},t.prototype.calcMaxBackDurationS=function(e){var t=this.playbackData.playbacktime;if(this.maxBackDurationOverflow)return t;var o=this.calcStreamAbsoluteDurationMS(e)/1e3;return o<t?(this.maxBackDurationOverflow=!1,o):(this.maxBackDurationOverflow=!0,t)},t.prototype.calcAbsoluteTimeMS=function(e){return 1e3*this.playbackData.svrtick+(e-this.clientStartTimeMS)},t.prototype.calcStreamAbsoluteDurationMS=function(e){return this.calcAbsoluteTimeMS(e)-1e3*this.playbackData.playbackstart},t.prototype.calcBackAbsoluteTimeS=function(e,t){return Math.round((this.calcAbsoluteTimeMS(e)-t)/1e3)},t.prototype.onTimeupdate=function(){if(!this.isMouseDown&&this.player.state===exports.VIDEO_STATE.PLAYING){var e="",t="",o=Date.now(),r=this.calcStreamAbsoluteDurationMS(o);if(this.playbackState===PLAY_BACK_STATE.BACK_PLAYING){var i=this.calcMaxBackDurationS(o),n=(r-this.curBackDurationMS)/1e3,a=this.calcBackAbsoluteTimeS(o,this.curBackDurationMS);if(this.player.loadParam.videoReqInfoParam.playbacktime=a,t="回看中",e=""+comTool.formatPlayTime(n),!this.maxBackDurationOverflow){var s=(i-this.curBackDurationMS/1e3)/i;this.updateProgress(s)}}else t="直播中",e=""+comTool.formatPlayTime(r/1e3);this.liveStateTimeStr!==e&&(this.liveStateTimeStr=e,this.updateLiveTime(t,e))}},t.prototype.calcPercent2BackTimeS=function(e){return(1-e)*this.calcMaxBackDurationS(Date.now())},t.prototype.getTimeTip=function(e){var t=this.calcPercent2BackTimeS(e);return"回退"+comTool.formatPlayTime(t)},t.prototype.seek=function(e){var t=this;if(!(this.seekIntervalId>0)){if(this.seekIntervalId=window.setTimeout((function(){t.seekIntervalId=0}),500),1!==e){var o=1e3*this.calcPercent2BackTimeS(e);this.playbackState===PLAY_BACK_STATE.LIVE_PLAYING?this.enterState(PLAY_BACK_STATE.BACK_PLAYING,{backDurationMS:o}):this.playbackState===PLAY_BACK_STATE.BACK_PLAYING&&this.seekInBackState({backDurationMS:o})}else this.enterState(PLAY_BACK_STATE.LIVE_PLAYING)}},t}(Progress),LoopStatus;!function(e){e.Loop="true",e.NotLoop="false"}(LoopStatus||(LoopStatus={}));var LocalLoopConfigKey="thumbplayer-h5-loop",Loop=function(e){function t(o,r){var i=e.call(this,o,t.sel,r)||this;return i.tip=i.el.querySelector(".txp_tooltip"),i.setupDOMEvents(),i.initLoopConfig(),i}return __extends$1(t,e),t.isEnabled=function(e){var t=e.enableLoop,o=e.isMobile;return t&&!o},Object.defineProperty(t.prototype,"isLoopMode",{get:function(){return this.el.dataset.status===LoopStatus.Loop},set:function(e){this.player.config.loop=e,this.el.dataset.status=String(e),this.tip.innerText=e?"关闭循环播放":"打开循环播放"},enumerable:!1,configurable:!0}),t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener(this.CLICK_EVENT_NAME,(function(){e.isLoopMode=!e.isLoopMode,lsTool.setData(LocalLoopConfigKey,e.isLoopMode?LoopStatus.Loop:LoopStatus.NotLoop)}))},t.prototype.initLoopConfig=function(){var e=this.player.config.loop;if(void 0===e){var t=lsTool.getData(LocalLoopConfigKey);t&&(this.isLoopMode=t===LoopStatus.Loop)}else this.isLoopMode=!!e},t.compName="Loop",t.sel=".txp_left_controls .txp_btn_loop",t}(Component),NextBtn=function(e){function t(o,r,i){var n,a=e.call(this,o,t.sel,r)||this;a.ctrlbar=i;var s=r.showNextBtnUIOnly;return s?a.el.classList.remove(Component.disabledClassName):(a.onVideoNodeChange=a.onVideoNodeChange.bind(a),a.eventMap=((n={})[exports.PLAY_EVENT.VIDEONODE_CHANGE]=a.onVideoNodeChange,n[exports.PLAY_EVENT.LIST_CHANGE]=a.onVideoNodeChange,n),a.setEvts()),a.el.addEventListener(a.CLICK_EVENT_NAME,(function(){if(a.player.setStateKv("ctrlbar:"+t.compName+":"+a.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION}),a.ctrlbar.emit(CTRL_EVENTS$2.CLICK_NEXTBTN),!s){var e=a.player.currentVideoInfoIdx;-1===e||e>=a.player.totalVideoInfoCount-1||a.player.playNext()}})),a}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile,o=e.disableNextBtn,r=e.showNextBtnUIOnly;return!(t||o&&!r)},t.prototype.onVideoNodeChange=function(){var e=this.player.currentVideoInfoIdx;-1!==e&&e+1<this.player.totalVideoInfoCount?this.el.classList.remove(Component.disabledClassName):this.el.classList.add(Component.disabledClassName)},t.sel=".txp_left_controls .txp_btn_next",t.compName="NextBtn",t}(Component),PictureInPicture=function(e){function t(o,r,i){var n=e.call(this,o,t.sel,r)||this;return n.ctrlbar=i,n.isPiP=!1,n.onEnterPiP=function(){n.isPiP=!0,n.setDOMStatus(!1)},n.onLeavePiP=function(){n.isPiP=!1,n.setDOMStatus(!0)},void 0===HTMLVideoElement.prototype.requestPictureInPicture?(n.el.classList.add(Component.hideClassName),n):(n.setupDOMEvents(),n.setupPlayerEvents(),n.tooltip=n.el.querySelector(".txp_tooltip"),n)}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.enterPicInPic=function(){var e=this.player.currentVideoElement;e&&(e.requestPictureInPicture(),this.setDOMStatus(!1))},t.prototype.leavePicInPic=function(){var e,t;try{null===(t=null===(e=document.exitPictureInPicture())||void 0===e?void 0:e.catch)||void 0===t||t.call(e,(function(){}))}catch(e){}this.setDOMStatus(!0)},t.prototype.destroy=function(){this.setupVideoListener(!1),this.leavePicInPic(),e.prototype.destroy.call(this)},t.prototype.setupDOMEvents=function(){var e=this;this.el.addEventListener("click",(function(){e.isPiP?(e.leavePicInPic(),e.isPiP=!1):(e.enterPicInPic(),e.isPiP=!0),e.ctrlbar.emit(CTRL_EVENTS$2.CLICK_PIPBTN,e.isPiP)}))},t.prototype.setupPlayerEvents=function(){var e=this;this.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){if(t.data.isFirst){var o=e.player.currentVideoElement;o instanceof HTMLVideoElement&&o.requestPictureInPicture?(e.el.classList.remove(Component.hideClassName),e.setVideoPip()):(e.leavePicInPic(),e.el.classList.add(Component.hideClassName))}})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(t){t.data.code===exports.ErrorCode.SUC&&"smooth"!==e.player.config.setLevelMode&&e.setVideoPip()}))},t.prototype.setVideoPip=function(){this.isPiP&&this.enterPicInPic(),this.setupVideoListener(!1),this.setupVideoListener(!0)},t.prototype.setupVideoListener=function(e){void 0===e&&(e=!0);var t=this.player.currentVideoElement;if(t){var o=e?t.addEventListener:t.removeEventListener;o.call(t,"enterpictureinpicture",this.onEnterPiP),o.call(t,"leavepictureinpicture",this.onLeavePiP)}},t.prototype.setDOMStatus=function(e){this.el&&(this.tooltip.innerText=e?"画中画":"退出画中画",this.el.dataset.status=String(!e))},t.sel=".txp_right_controls .txp_btn_pip",t.compName="PictureInPicture",t}(Component);function showTips(e,t){var o=e.plugins.tips;"function"==typeof(null==o?void 0:o.show)&&o.show(t)}function hideTips(e){var t=e.plugins.tips;"function"==typeof(null==t?void 0:t.hide)&&t.hide()}function getIsInAd(e){var t=e,o=t.flowManager,r=t.videoNode;return!(!getAdPlugin(e.config.instanceId)||!r||r===o.currentFlowNode)}var PlayBtn=function(e){function t(o,r,i){var n,a=e.call(this,o,t.sel,r)||this;return a.ctrlbar=i,a.onPlaySessionStart=function(){a.setPlayStatus(PlayBtnStatus$1.PLAY),a.tooltip.innerText="播放"},a.onPlaySessionEnd=function(){a.setPlayStatus(a.isLive?PlayBtnStatus$1.PLAY:PlayBtnStatus$1.REPLAY),a.tooltip.innerText="播放"},a.eventMap=((n={})[exports.PLAY_EVENT.STATE_CHANGE]=a.onPlayerStateChange.bind(a),n[exports.H5_PLAY_EVENT.PLAY_SESSION_START]=a.onPlaySessionStart,n[exports.H5_PLAY_EVENT.PLAY_SESSION_END]=a.onPlaySessionEnd,n),a.setPlayStatus(PlayBtnStatus$1.PLAY),a.setEvts(),a.tooltip=a.el.querySelector(".txp_tooltip"),a.addEventListener(),a}return __extends$1(t,e),t.prototype.setPlayStatus=function(e){this.el.dataset.status=e,this.el.className="txp_btn txp_btn_play play_btn_"+e},t.prototype.addEventListener=function(){var e=this,o=this.player;this.el.addEventListener("click",(function(){if(o.setStateKv("ctrlbar:"+t.compName+":"+e.CLICK_EVENT_NAME,{type:exports.LOG_TYPE.USER_ACTION}),!e.el.classList.contains(Component.disabledClassName))switch(e.ctrlbar.emit(CTRL_EVENTS$2.CLICK_PLAYBTN,e.el.dataset),e.el.dataset.status){case PlayBtnStatus$1.PAUSE:o.pause(exports.H5_PAUSE_TYPE.USER_CLICK);break;case PlayBtnStatus$1.STOP:o.stop();break;case PlayBtnStatus$1.PLAY:if(!e.isLive)return onBtnClickPlay(o,e.ctrlbar);e.replay();break;case PlayBtnStatus$1.REPLAY:e.ctrlbar.emit(CTRL_EVENTS$2.CLICK_REPLAY),e.replay()}}))},t.prototype.replay=function(){var e=this.player;e.vid&&e.videoReqInfoPlugin?e.triggerAutoplay().then((function(){return e.replay()})):e.replay()},t.prototype.onVodPlaying=function(){var e=this.tooltip;this.setPlayStatus(PlayBtnStatus$1.PAUSE),e.innerText="暂停"},t.prototype.onLivePlaying=function(){var e=this,t=this.tooltip,o=function(){e.setPlayStatus(PlayBtnStatus$1.STOP),t.innerText="停止"};getIsInAd(this.player)?this.player.once(exports.H5_PLAY_EVENT.AD_END,o):o()},t.prototype.onPlayerStateChange=function(e){var t=e.data.new,o=this.tooltip;switch(t){case exports.VIDEO_STATE.PLAYING:this.isLive?this.onLivePlaying():this.onVodPlaying();break;case exports.VIDEO_STATE.PAUSE:case exports.VIDEO_STATE.CANPLAY:this.setPlayStatus(PlayBtnStatus$1.PLAY),o.innerText="播放"}},t.sel=".txp_left_controls .txp_btn_play",t.compName="PlayBtn",t}(Component),PlayratePopup=function(e){function t(o,r,i){var n=e.call(this,o,__assign$1(__assign$1({},r),{selector:t.popupSelector,modSelector:t.modSelector}),i)||this;return n.popupName="playrate",n.onSelect=function(e){var t=n,o=t.player;t.ctrlbar.emit(CTRL_EVENTS$2.SET_PLAYRATE,e);var r=Number(e.value);o.playbackRate!==r&&(o.playbackRate=r,n.selected=r,showTips(n.player,"正在<em>"+r+"</em>倍速度播放"))},n.onPlayRestart=function(){n.el.classList.toggle(Component.hideClassName,!n.player.supportPlaybackRate)},n.popupOptions=[{label:"0.5X",value:.5},{label:"0.75X",value:.75},{label:"1.0X",value:1,btnLabel:"倍速"},{label:"1.25X",value:1.25},{label:"1.5X",value:1.5},{label:"1.75X",value:1.75},{label:"2.0X",value:2}],n.selected=1,n.bindEvts(!0),n}return __extends$1(t,e),t.isEnabled=function(e){var t=e.isMobile,o=e.enablePlayrate;return!t||t&&o},t.prototype.destroy=function(){this.bindEvts(!1),e.prototype.destroy.call(this)},t.prototype.bindEvts=function(e){(e?this.player.on.bind(this.player):this.player.off.bind(this.player))(exports.PLAY_EVENT.RESTART,this.onPlayRestart)},t.compName="PlayratePopup",t.popupSelector=".txp_right_controls .txp_btn_playrate",t.modSelector=".mod_overlay.playrate",t}(Popup),TimeArea=function(e){function t(o,r,i){var n,a=e.call(this,o,t.sel,r)||this;a.ctrlbar=i,a.clickCount=0,a.clickTimer=0,a.onMouseup=function(){a.isMouseDown=!1},a.onMousemove=function(e){var t=e.data;a.timeCur.innerText=comTool.formatPlayTime(t*a.ctrlbar.duration)},a.onMousedown=function(e){var t=e.data;a.isMouseDown=!0,a.timeCur.innerText=comTool.formatPlayTime(t*a.ctrlbar.duration)};var s=CTRL_EVENTS$2.MOUSE_DOWN,l=CTRL_EVENTS$2.MOUSE_MOVE,c=CTRL_EVENTS$2.MOUSE_UP;return a.eventMap=((n={})[exports.PLAY_EVENT.DURATION_CHANGE]=a.onDurationChange.bind(a),n[exports.PLAY_EVENT.TIME_UPDATE]=a.onTimeUpdate.bind(a),n[exports.PLAY_EVENT.STATE_CHANGE]=a.onPlayerStateChange.bind(a),n),a.setEvts(),i.on(s,a.onMousedown),i.on(l,a.onMousemove),i.on(c,a.onMouseup),a.timeCur=a.el.querySelector(".txp_time_current"),a.timeDur=a.el.querySelector(".txp_time_duration"),r.disableTestEvent||a.bindClickOnMobile(),a}return __extends$1(t,e),t.prototype.bindClickOnMobile=function(){var e=this;if(this.isMobile){this.el.addEventListener("click",(function(){e.clickCount+=1,e.clickCount>=5&&(e.clickCount=0,e.ctrlbar.emit(CTRL_EVENTS$2.TEST_EVENT)),e.clickTimer&&clearTimeout(e.clickTimer),e.clickTimer=window.setTimeout((function(){e.clickCount=0}),300)}))}},t.prototype.onPlayerStateChange=function(e){e.data.new===exports.VIDEO_STATE.IDLE&&(this.timeCur.innerText="00:00")},t.prototype.onDurationChange=function(){var e=this.ctrlbar.duration;this.timeDur.innerText=comTool.formatPlayTime(e),this.el.classList.toggle("reach_hour",e>=3600)},t.prototype.onTimeUpdate=function(){if(!this.isMouseDown){var e=comTool.formatPlayTime(this.player.playtime);this.timeCur.innerText!==e&&(this.timeCur.innerText=e)}},t.sel=".txp_left_controls .txp_time_display",t.compName="TimeArea",t}(Component),VolumeStatus;!function(e){e.Mute="mute",e.Normal="normal"}(VolumeStatus||(VolumeStatus={}));var LOCAL_KEY={VOLUME:"thumbplayer-h5-volume",MUTED:"thumbplayer-h5-volume:muted"},MutedStatus;!function(e){e.muted="true",e.unmuted="false"}(MutedStatus||(MutedStatus={}));var initDragVolume=-1,Volume=function(e){function t(o,r,i){var n,a=e.call(this,o,t.sel,r)||this;return a.ctrlbar=i,a.lastVolume=.5,a.dragVolume=initDragVolume,a.onVideoPlaying=function(e){e.data.isFirst&&(a.isInLiveAd()||a.player.muted&&a.setUi(0))},a.onVolumeChange=function(){if(!a.isInLiveAd()){var e=a.player.volume;a.player.muted&&(e=0),a.setUi(e)}},a.onAdVolumeChange=function(e){var t=e.data;getIsInAd(a.player)&&a.setUi(t.volume)},a.isMobile||(a.eventMap=((n={})[exports.H5_PLAY_EVENT.VIDEO_VOLUME_CHANGE]=a.onVolumeChange,n[exports.H5_PLAY_EVENT.AD_VOLUME_CHANGE]=a.onAdVolumeChange,n[exports.H5_PLAY_EVENT.VIDEO_PLAYING]=a.onVideoPlaying,n),a.setEvts(),a.popup=a.el.querySelector(".txp_popup_volume"),a.volumeSvg=a.el.querySelector(".txp_icon_volume"),a.volumeValue=a.el.querySelector(".txp_volume_range_current"),a.volumeRange=a.el.querySelector(".txp_volume_range"),a.volumeText=a.el.querySelector(".txp_volume_text"),a.initDOMEvents(),a.config.disableCacheVolume||a.setVolumeByCache()),a}return __extends$1(t,e),t.isEnabled=function(e){return!e.isMobile},t.prototype.setVolumeByCache=function(){var e=Number(lsTool.getData(LOCAL_KEY.VOLUME)),t=lsTool.getData(LOCAL_KEY.MUTED);(Number.isNaN(e)||e>1)&&(e=1,lsTool.setData(LOCAL_KEY.VOLUME,"1")),e&&(this.lastVolume=e),t===MutedStatus.muted&&(e=0),this.setVolume(e),this.setUi()},t.prototype.setUi=function(e){void 0===e&&(e=this.getCurrentNodeVolume()),this.el.dataset.status=0===e?VolumeStatus.Mute:VolumeStatus.Normal,this.volumeValue.style.height=100*e+"%",this.volumeText.innerText=String(Math.round(100*e))},t.prototype.getCurrentNodeVolume=function(){var e,t,o=this.player;return getIsInAd(o)&&null!==(t=null===(e=getAdPlugin(o.config.instanceId))||void 0===e?void 0:e.getAdVolume())&&void 0!==t?t:o.volume},t.prototype.isInLiveAd=function(){return this.isLive&&getIsInAd(this.player)},t.prototype.setPercent=function(e,t){var o=e.clientY;this.clientY=this.volumeRange.getBoundingClientRect().top,this.clientHeight=this.volumeRange.clientHeight;var r=(o-this.clientY)/this.clientHeight;r=Math.floor(100*(1-r));var i=(r=Math.max(Math.min(r,100),0))/100;this.player.volume!==i&&(this.ctrlbar.emit(CTRL_EVENTS$2.SET_VOLUME,i),this.dragVolume=r),this.setVolume(i),this.setUi(),t&&(lsTool.setData(LOCAL_KEY.VOLUME,i),lsTool.setData(LOCAL_KEY.MUTED,!1))},t.prototype.setVolume=function(e){var t;this.isInLiveAd()?null===(t=getAdPlugin(this.player.config.instanceId))||void 0===t||t.setAdVolume(e):this.player.volume=e},t.prototype.initDOMEvents=function(){this.setupBtnMouseEvents(),this.setupVolumeClick(),this.setupVolumeRangeMouseEvents()},t.prototype.showVolumeTips=function(){var e=this;if(this.dragVolume!==initDragVolume){this.clearTipsTimer();this.volumeTipsTimer=window.setTimeout((function(){showTips(e.player,"当前音量: <em>"+e.dragVolume.toFixed(0)+"</em>")}),500)}},t.prototype.clearTipsTimer=function(){this.volumeTipsTimer&&(window.clearTimeout(this.volumeTipsTimer),this.volumeTipsTimer=0)},t.prototype.setupBtnMouseEvents=function(){var e=this;this.el.addEventListener("mouseenter",(function(){e.showEl(e.popup),e.dragVolume=initDragVolume,e.clearTipsTimer()})),this.el.addEventListener("mouseleave",(function(){e.isMouseDown||(e.hideEl(e.popup),e.showVolumeTips())}))},t.prototype.setupVolumeRangeMouseEvents=function(){var e=this,t=this.volumeRange,o=this.player;t.addEventListener("mousedown",(function(){e.isMouseDown=!0})),t.addEventListener("mousemove",(function(t){e.isMouseDown&&e.setPercent(t)})),o.container.addEventListener("mousemove",(function(t){e.isMouseDown&&e.setPercent(t)})),t.addEventListener("mouseup",(function(t){e.isMouseDown=!1,e.setPercent(t,!0)})),o.container.addEventListener("mouseup",(function(t){e.isMouseDown&&(e.isMouseDown=!1,e.setPercent(t,!0),e.hideEl(e.popup),e.showVolumeTips())}))},t.prototype.setupVolumeClick=function(){var e=this;this.volumeSvg.addEventListener(this.CLICK_EVENT_NAME,(function(){e.el.dataset.status===VolumeStatus.Mute?(e.el.dataset.status=VolumeStatus.Normal,e.setVolume(e.lastVolume),lsTool.setData(LOCAL_KEY.MUTED,MutedStatus.unmuted),lsTool.setData(LOCAL_KEY.VOLUME,e.lastVolume)):(e.lastVolume=e.getCurrentNodeVolume(),e.el.dataset.status=VolumeStatus.Mute,e.setVolume(0),lsTool.setData(LOCAL_KEY.MUTED,MutedStatus.muted)),e.player.played&&-1===[exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE].indexOf(e.player.state)||e.setUi()}))},t.compName="Volume",t.sel=".txp_btn_volume",t}(Component),THUMBPLAYER_PREFIX="thumbplayer",svgSpriteClassName="txp_svg_sprite",ctrlBarClassName="txp_controls",svgSpriteSelector="."+THUMBPLAYER_PREFIX+"."+svgSpriteClassName,ctrlBarSelector="."+THUMBPLAYER_PREFIX+"."+ctrlBarClassName,pcViewBox="0 0 28 28",svgSprite='\n<svg class="'+THUMBPLAYER_PREFIX+" "+svgSpriteClassName+'" display="none" xmlns="http://www.w3.org/2000/svg">\n    <symbol id="txp_svg_play" viewBox="'+pcViewBox+'">\n        <path d="M6.308 6.057S6 6.857 6 13.964c0 7.108.308 7.978.308 7.978 0 .788.827 1.299 1.526.943 0 0 1.603-.25 8.057-3.493 6.455-3.244 7.534-4.45 7.534-4.45.767-.39.767-1.493 0-1.884 0 0-1.768-1.617-7.531-4.553-5.7-2.904-8.06-3.39-8.06-3.39a1.051 1.051 0 0 0-1.526.942" fill-rule="evenodd"/>\n    </symbol>\n    <symbol id="txp_svg_replay" viewBox="'+pcViewBox+'">\n        <path d="M14 4a9.994 9.994 0 0 1 8.5 4.731V6a1 1 0 0 1 2 0v5a1 1 0 0 1-.883.993L23.5 12h-5a1 1 0 0 1 0-2h2.43a8 8 0 1 0 .816 6.01 1 1 0 0 1 1.936.5A10.003 10.003 0 0 1 14 24C8.477 24 4 19.523 4 14S8.477 4 14 4Z" fill-rule="evenodd"/>\n    </symbol>\n    <symbol id="txp_svg_pause" viewBox="'+pcViewBox+'">\n        <path d="M9 5a1.5 1.5 0 0 1 1.5 1.5v15A1.5 1.5 0 0 1 9 23h-.5A1.5 1.5 0 0 1 7 21.5v-15A1.5 1.5 0 0 1 8.5 5H9Zm10.5 0A1.5 1.5 0 0 1 21 6.5v15a1.5 1.5 0 0 1-1.5 1.5H19a1.5 1.5 0 0 1-1.5-1.5v-15A1.5 1.5 0 0 1 19 5h.5Z" fill-rule="evenodd"/>\n    </symbol>\n    <symbol id="txp_svg_stop" viewBox="'+pcViewBox+'">\n      <rect x="5" y="5" width="18" height="18" rx="4" fill-rule="evenodd"/>\n    </symbol>\n\n    <symbol id="txp_svg_fake" viewBox="'+pcViewBox+'">\n        <rect fill="none" stroke-width="1.75" transform="translate(0 3.5)" x="5.25" y="3.5" width="17.5" height="14" rx="2.042"/>\n    </symbol>\n\n    <symbol id="txp_svg_loop_off" viewBox="'+pcViewBox+'">\n        <g fill-rule="evenodd"><path d="M16.859 14.22c2.738 0 4.958 2.164 4.958 4.834 0 2.67-2.22 4.834-4.958 4.834-2.739 0-4.959-2.164-4.959-4.834 0-2.67 2.22-4.835 4.959-4.835Zm0 .966c-2.19 0-3.967 1.732-3.967 3.868s1.776 3.867 3.967 3.867c2.19 0 3.967-1.731 3.967-3.867s-1.776-3.868-3.967-3.868Zm-1.206 2.02.069.056 2.975 2.9a.475.475 0 0 1 0 .684.506.506 0 0 1-.633.056l-.068-.056-2.975-2.9a.475.475 0 0 1 0-.684.506.506 0 0 1 .632-.056ZM12.591 4.9a.69.69 0 0 1 .456.171l3.812 3.346H11.9v-.001H8.925c-1.584 0-2.88 1.208-2.97 2.731l-.005.17v3.868c0 1.545 1.239 2.808 2.8 2.896l.175.005.992-.001v1.934h-.992c-2.664 0-4.838-2.048-4.953-4.619l-.005-.215v-3.868c0-2.597 2.101-4.717 4.737-4.83l.221-.004H11.9v-.892c0-.382.31-.691.691-.691Zm7.243 1.68c2.19.433 3.856 2.274 3.961 4.512l.006.225v3.868c0 .432-.058.85-.167 1.248l-1.817-2.215v-2.9c0-1.263-.827-2.338-1.982-2.736V6.581Z" fill-rule="nonzero"/></g>\n    </symbol>\n    <symbol id="txp_svg_loop" viewBox="'+pcViewBox+'">\n        <g fill-rule="evenodd"><path d="M9 8.877a3 3 0 0 0-2.995 2.824L6 11.877v4a3 3 0 0 0 2.824 2.995l.176.005a1 1 0 1 1 0 2 5 5 0 0 1-4.995-4.783L4 15.877v-4a5 5 0 0 1 4.783-4.995L9 6.877h3V5.5a.5.5 0 0 1 .834-.372L17 8.878H9Zm11 10a3 3 0 0 0 2.995-2.823l.005-.177v-4a3 3 0 0 0-2.824-2.995L20 8.877a1 1 0 0 1 0-2 5 5 0 0 1 4.995 4.783l.005.217v4a5 5 0 0 1-4.783 4.996l-.217.004h-3v1.378a.5.5 0 0 1-.834.371L12 18.877h8Z" fill-rule="nonzero"/></g>\n    </symbol>\n\n    <symbol id="txp_svg_next" viewBox="'+pcViewBox+'">\n        <path d="M21.5 7A1.5 1.5 0 0 1 23 8.5v11a1.5 1.5 0 0 1-3 0v-11A1.5 1.5 0 0 1 21.5 7Zm-16.261.822a.817.817 0 0 1 1.186-.732s1.835.378 6.266 2.636c4.481 2.282 5.855 3.54 5.855 3.54a.825.825 0 0 1 0 1.467s-.839.936-5.857 3.46c-5.017 2.522-6.264 2.715-6.264 2.715a.817.817 0 0 1-1.186-.732S5 19.498 5 13.97v-.326c.01-5.226.239-5.823.239-5.823Z" fill-rule="evenodd"/>\n    </symbol>\n\n    <symbol id="txp_svg_fullscreen" viewBox="'+pcViewBox+'">   \n        <path d="M7.438 17.063v2.625c0 .483.391.875.875.875h2.624m0-13.125H8.312a.875.875 0 0 0-.875.875v2.624h0m13.126 6.126v2.625a.875.875 0 0 1-.875.875h-2.625 0m0-13.125h2.625c.483 0 .875.391.875.874v2.625h0" stroke-width="2.188" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"/>\n    </symbol>\n    <symbol id="txp_svg_fullscreen_true" viewBox="'+pcViewBox+'">\n        <g stroke-width="2.188" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M10.938 20.563v-2.625a.875.875 0 0 0-.875-.875H7.438h0M7.438 10.938h2.625a.875.875 0 0 0 .874-.876V7.438h0M17.063 20.562v-2.625c0-.483.391-.875.875-.875h2.625M20.563 10.938h-2.625a.875.875 0 0 1-.875-.876V7.438h0"/></g>\n    </symbol>\n\n    <symbol id="txp_svg_volume_mute" viewBox="'+pcViewBox+'">\n        <g stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M8.75 10.041H5.749c-.828 0-1.499.671-1.499 1.499v4.92c0 .828.671 1.499 1.499 1.499H8.75l4.143 4.143a.502.502 0 0 0 .857-.355V6.253a.502.502 0 0 0-.857-.355L8.75 10.041ZM17.5 11l6 6M23.5 11l-6 6"/></g>\n    </symbol>\n    <symbol id="txp_svg_volume" viewBox="'+pcViewBox+'">\n        <g stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"><path d="M8.75 10.041H5.749c-.828 0-1.499.671-1.499 1.499v4.92c0 .828.671 1.499 1.499 1.499H8.75l4.143 4.143a.502.502 0 0 0 .857-.355V6.253a.502.502 0 0 0-.857-.355L8.75 10.041ZM20.786 7a9.717 9.717 0 0 1 2.964 7 9.717 9.717 0 0 1-2.964 7M17.75 9.477c1.235 1.154 2 2.753 2 4.522 0 1.746-.747 3.328-1.955 4.478"/></g>\n    </symbol>\n\n    <symbol id="txp_svg_pip" viewBox="'+pcViewBox+'">\n        <path d="M23.625 15.75c.966 0 1.75.784 1.75 1.75v4.375a1.75 1.75 0 0 1-1.75 1.75H17.5a1.75 1.75 0 0 1-1.75-1.75V17.5c0-.966.784-1.75 1.75-1.75h6.125ZM21 5.25a2.625 2.625 0 0 1 2.62 2.47l.005.155v5.25a.875.875 0 0 1-1.744.102l-.006-.102v-5.25a.875.875 0 0 0-.773-.87L21 7H7a.875.875 0 0 0-.87.773l-.005.102V19.25c0 .449.338.819.773.87l.102.005h6.125a.875.875 0 0 1 .102 1.744l-.102.006H7a2.625 2.625 0 0 1-2.62-2.47l-.005-.155V7.875a2.625 2.625 0 0 1 2.47-2.62L7 5.25h14Z" stroke-width=".5" fill-rule="evenodd"/>\n    </symbol>\n\n    <symbol id="txp_air_play" viewBox="0 0 1024 1024">\n        <path d="M547.413333 573.866667a42.666667 42.666667 0 0 0-70.826666 0l-170.666667 256a42.666667 42.666667 0 0 0 0 42.666666A42.666667 42.666667 0 0 0 341.333333 896h341.333334a42.666667 42.666667 0 0 0 37.546666-22.613333 42.666667 42.666667 0 0 0-2.133333-42.666667zM421.12 810.666667L512 674.133333l90.88 136.533334zM810.666667 128H213.333333a128 128 0 0 0-128 128v384a128 128 0 0 0 128 128h36.266667a42.666667 42.666667 0 1 0 0-85.333333H213.333333a42.666667 42.666667 0 0 1-42.666666-42.666667V256a42.666667 42.666667 0 0 1 42.666666-42.666667h597.333334a42.666667 42.666667 0 0 1 42.666666 42.666667v384a42.666667 42.666667 0 0 1-42.666666 42.666667h-36.266667a42.666667 42.666667 0 0 0 0 85.333333H810.666667a128 128 0 0 0 128-128V256a128 128 0 0 0-128-128z"/>\n    </symbol>\n</svg>\n',h5SvgSprite='\n<svg class="'+THUMBPLAYER_PREFIX+" "+svgSpriteClassName+'" display="none" xmlns="http://www.w3.org/2000/svg">\n\t<symbol id="txp_svg_play" viewBox="0 0 56 56">\n\t\t<path d="M14.569 13.867s-.563 1.42-.563 14.059.563 14.188.563 14.188a1.925 1.925 0 0 0 2.8 1.677s2.938-.442 14.763-6.211 13.8-7.914 13.8-7.914a1.859 1.859 0 0 0 0-3.352s-3.24-2.875-13.8-8.095c-10.444-5.165-14.767-6.029-14.767-6.029a1.924 1.924 0 0 0-2.796 1.677z" style="fill:#fff" />\n\t</symbol>\n    <symbol id="txp_svg_replay" viewBox="0 0 32 32">\n      <path d="M18 30a13.956 13.956 0 0 1-9.9-4.1l2.121-2.121A11 11 0 1 0 7 16h4.006L5.5 22 0 16h4a14 14 0 1 1 14 14z">\n      </path>\n    </symbol>\n    <symbol id="txp_svg_pause" viewBox="0 0 56 56">\n      <path d="M39 49a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4zm-22 0a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4z">\n      </path>\n    </symbol>\n    <symbol id="txp_svg_stop" viewBox="0 0 32 32">\n      <path d="M24 26H12c-1.1 0-2-0.9-2-2V12c0-1.1 0.9-2 2-2h12c1.1 0 2 0.9 2 2v12C26 25.1 25.1 26 24 26z"></path>\n    </symbol>\n\n\t<symbol id="txp_svg_fullscreen" viewBox="0 0 48 48">\n\t\t<path d="M9.5 37h10a1.5 1.5 0 0 1 0 3h-10a1.5 1.5 0 0 1 0-3zm0-10a1.5 1.5 0 0 1 1.5 1.5v10a1.5 1.5 0 0 1-3 0v-10A1.5 1.5 0 0 1 9.5 27zM8.43 37.353L19.353 26.43a1.545 1.545 0 1 1 2.185 2.184L10.614 39.538a1.545 1.545 0 1 1-2.184-2.185zM28.5 8h10a1.5 1.5 0 0 1 0 3h-10a1.5 1.5 0 0 1 0-3zm10 0A1.5 1.5 0 0 1 40 9.5v10a1.5 1.5 0 0 1-3 0v-10A1.5 1.5 0 0 1 38.5 8zM26.43 19.354L37.353 8.43a1.545 1.545 0 0 1 2.185 2.184L28.614 21.538a1.545 1.545 0 0 1-2.184-2.184z"/>\n\t</symbol>\n\t<symbol id="txp_svg_fullscreen_true" viewBox="0 0 48 48">\n\t\t<path d="M39.538 10.615L31.153 19H37.5a1.5 1.5 0 0 1 0 3h-10a1.5 1.5 0 0 1-1.386-.937 1.52 1.52 0 0 1-.114-.735V10.5a1.5 1.5 0 0 1 3 0v6.283l8.353-8.353a1.545 1.545 0 1 1 2.185 2.185zM20.5 39a1.5 1.5 0 0 1-1.5-1.5v-6.347l-8.386 8.385a1.545 1.545 0 1 1-2.184-2.184L16.783 29H10.5a1.5 1.5 0 0 1 0-3h9.828a1.518 1.518 0 0 1 .733.113A1.5 1.5 0 0 1 22 27.5v10a1.5 1.5 0 0 1-1.5 1.5z"/>\n\t</symbol>\n\t<symbol id="txp_svg_pause" viewBox="0 0 56 56">\n\t\t<path d="M39 49a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4zm-22 0a4 4 0 0 1-4-4V11a4 4 0 0 1 4-4 4 4 0 0 1 4 4v34a4 4 0 0 1-4 4z"/>\n\t</symbol>\n\t<symbol id="txp_svg_replay" viewBox="0 0 32 32">\n\t\t<path d="M18 30a13.956 13.956 0 0 1-9.9-4.1l2.121-2.121A11 11 0 1 0 7 16h4.006L5.5 22 0 16h4a14 14 0 1 1 14 14z"/>\n\t</symbol>\n\t<symbol id="txp_svg_next" viewBox="0 0 60 60">\n\t\t<path d="M47.13825,15.0141429 C45.3628929,15.0141429 43.9239643,16.4530714 43.9239643,18.2284286 L43.9239643,41.7998571 C43.9239643,43.5752143 45.3628929,45.0141429 47.13825,45.0141429 C48.9136071,45.0141429 50.3525357,43.5752143 50.3525357,41.7998571 L50.3525357,18.2284286 C50.3525357,16.4530714 48.9136071,15.0141429 47.13825,15.0141429 M39.7389643,28.4327143 C39.7389643,28.4327143 36.7936071,25.737 27.1946786,20.8437857 C17.6986071,16.002 13.7686071,15.192 13.7686071,15.192 C12.6050357,14.5995 11.2261071,15.4502143 11.2261071,16.7637857 C11.2261071,16.7637857 10.7139643,18.0955714 10.7139643,29.9455714 C10.7139643,41.7945 11.2261071,43.2462857 11.2261071,43.2462857 C11.2261071,44.5598571 12.6050357,45.4116429 13.7686071,44.8180714 C13.7686071,44.8180714 16.4396786,44.4034286 27.1893214,38.9948571 C37.9411071,33.5852143 39.7389643,31.5762857 39.7389643,31.5762857 C41.0171786,30.9248571 41.0171786,29.0852143 39.7389643,28.4327143" id="Fill-1"></path>\n\t</symbol>\n</svg>\n',getDomText=function(e){return'\n<div class="'+gradientClassName$1.slice(1)+'"></div>\n<div class="'+getRootClassName$1(e).slice(1)+'">\n    <div class="'+THUMBPLAYER_PREFIX+" "+ctrlBarClassName+'">\n        <div class="txp_left_controls">\n            <div class="txp_none txp_btn txp_btn_play" data-status="play" aria-label="播放/暂停">\n                <svg class="txp_icon txp_icon_play" viewBox="'+pcViewBox+'">\n                    <use class="txp_svg_symbol txp_svg_play" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_play"></use>\n                    <use class="txp_svg_symbol txp_svg_pause" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_pause"></use>\n                    <use class="txp_svg_symbol txp_svg_stop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_stop"></use>\n                    <use class="txp_svg_symbol txp_svg_replay" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_replay"></use>\n                </svg>\n                <div class="txp_tooltip">播放</div>\n            </div>\n            <div class="txp_none txp_btn txp_btn_next txp_disabled" aria-label="下一个">\n                <svg class="txp_icon txp_icon_next" viewBox="'+pcViewBox+'">\n                    <use class="txp_svg_symbol txp_svg_next" xlink:href="#txp_svg_next"></use>\n                </svg>\n                <div class="txp_tooltip">下一个</div>\n            </div>\n            <div class="txp_btn txp_btn_loop txp_none" data-status="false" aria-label="循环播放">   \n                <svg data-role="txp-ui-control-loop-play-btn" class="txp_icon txp_icon_loop" viewBox="'+pcViewBox+'">\n                    <use class="txp_svg_symbol txp_svg_loop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_loop"></use>\n                    <use class="txp_svg_symbol txp_svg_loop_off" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_loop_off"></use>\n                </svg>\n                <div class="txp_tooltip">打开循环播放</div> \n            </div>\n\n            <div class="txp_btn txp_btn_volume txp_none" data-status="normal" aria-label="音量">     \n                <svg class="txp_icon txp_icon_volume" viewBox="'+pcViewBox+'">         \n                    <use class="txp_svg_symbol txp_svg_volume" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_volume"></use> \n                    <use class="txp_svg_symbol txp_svg_volume_mute" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_volume_mute"></use>     \n                </svg>      \n                <div class="txp_popup txp_popup_volume txp_none">\n                    <div class="txp_popup_content">             \n                        <div class="txp_volume_text">100</div>     \n                        <div class="txp_volume_range">                 \n                            <div class="txp_volume_range_current" style="height: 100%;">                     \n                                <div class="txp_volume_handle"></div>                 \n                            </div>             \n                        </div>\n                    </div>\n                </div>\n            </div>  \n\n            <div class="txp_none txp_time_display">\n                <div class="txp_time_current">00:00</div>\n                <div class="txp_time_separator">/</div>\n                <div class="txp_time_duration">00:00</div>\n            </div>\n        </div>\n\n        <div class="txp_none txp_progress_bar_container">\n            <div class="txp_progress_list">\n                <div class="txp_progress_load" style="width: 0;"></div>\n                <div class="txp_progress_play" style="width: 0;">\n                </div>\n                <div class="txp_btn_scrubber" style="left: 0">\n                    <div class="txp_scrubber_indicator"></div>\n                </div>\n            </div>\n            <div class="txp_tooltip txp_none"></div>\n            \x3c!-- 进度条标记打点 --\x3e\n            <div class="txp_hotpoint"></div> \n        </div>\n\n        <div class="txp_center_controls"></div>\n\n        <div class="txp_right_controls">\n            <div class="txp_btn txp_btn_definition txp_none" aria-label="清晰度">\n                <div class="txp_label">清晰度</div>\n                <div class="txp_popup txp_popup_definition txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n\n            <div class="txp_btn txp_btn_playrate txp_none" aria-label="倍速">\n                <div class="txp_label">倍速</div>\n                <div class="txp_popup txp_popup_playrate txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n\n            <div class="txp_btn txp_btn_language txp_none" aria-label="语言">\n                <div class="txp_label">语言</div>\n                <div class="txp_popup txp_popup_language txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n\n            <div class="txp_btn txp_btn_audio_track txp_none" aria-label="多音轨">\n                <div class="txp_label">多音轨</div>\n                <div class="txp_popup txp_popup_audio_track txp_none">\n                    <div class="txp_popup_content"></div>\n                </div>\n            </div>\n            \n            <div class="txp_btn plugin_ctrl_airplay_btn txp_air_play txp_none" aria-label="AirPlay">\n                <svg class="txp_icon txp_icon_airplay" viewBox="0 0 1024 1024">\n                    <use class="txp_svg_symbol" xlink:href="#txp_air_play"></use>\n                </svg>\n                <div class="txp_tooltip">AirPlay</div> \n            </div>\n\n            <div class="txp_btn txp_btn_pip txp_none" data-status="false" aria-label="画中画">   \n                <svg class="txp_icon txp_icon_pip" viewBox="'+pcViewBox+'">     \n                    <use class="txp_svg_symbol txp_svg_pip" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_pip"></use>   \n                </svg>  \n                <div class="txp_tooltip">画中画</div> \n            </div>\n\n            <div class="txp_btn txp_btn_fake txp_none" data-status="false" aria-label="网页全屏">   \n                <svg class="txp_icon txp_icon_fake" viewBox="'+pcViewBox+'">     \n                    <use class="txp_svg_symbol txp_svg_fake" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fake"></use>   \n                    <use class="txp_svg_symbol txp_svg_fake_true" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fake"></use>  \n                </svg>  \n                <div class="txp_tooltip">网页全屏</div> \n            </div>\n\n            <div class="txp_btn txp_btn_fullscreen txp_none" data-status="false" aria-label="系统全屏">\n                <svg class="txp_icon txp_icon_fullscreen" viewBox="'+pcViewBox+'">     \n                    <use class="txp_svg_symbol txp_svg_fullscreen" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fullscreen"></use>     \n                    <use class="txp_svg_symbol txp_svg_fullscreen_true" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#txp_svg_fullscreen_true"></use>   \n                </svg>\n                <div class="txp_tooltip">全屏</div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="'+shadowClassName$1.slice(1)+'"></div>\n'},h5CtrlRightDomText='\n<button class="txp_btn txp_btn_playrate txp_none" aria-label="倍速">\n    <div class="txp_label">倍速</div>\n</button>\n<button class="txp_btn txp_btn_definition txp_none" data-status="false" aria-label="清晰度">\n    <div class="txp_label">清晰度</div>\n</button>\n<button class="txp_btn txp_btn_fullscreen txp_none" data-status="false" aria-label="全屏">\n    <svg class="txp_icon txp_icon_fullscreen" viewBox="0 0 24 24">\n        <use class="txp_svg_fullscreen" xlink:href="#txp_svg_fullscreen"></use>     \n        <use class="txp_svg_fullscreen_true" xlink:href="#txp_svg_fullscreen_true"></use>   \n    </svg>\n</button>\n<button class="txp_btn txp_btn_fullscreen txp_none txp_btn_fake" data-status="false" aria-label="伪全屏">\n    <svg class="txp_icon txp_icon_fullscreen" viewBox="0 0 24 24">\n        <use class="txp_svg_fullscreen" xlink:href="#txp_svg_fullscreen"></use>     \n        <use class="txp_svg_fullscreen_true" xlink:href="#txp_svg_fullscreen_true"></use>   \n    </svg>\n</button>\n',h5OverlayText='<div class="plugin_ctrl_mod_overlay_wrapper">\n<div class="mod_overlay definition txp_none">\n    <div class="mod_speed_select">\n        <div class="title">画质</div>\n        <ul class="select_list"></ul>\n    </div>\n</div>\n<div class="mod_overlay language txp_none">\n    <div class="mod_speed_select">\n        <div class="title">语言</div>\n        <ul class="select_list"></ul>\n    </div>\n</div>\n<div class="mod_overlay playrate txp_none">\n    <div class="mod_speed_select">\n        <div class="title">播放速度</div>\n        <ul class="select_list"></ul>\n    </div>\n</div>\n</div>\n',DEFAULT_AUTO_HIDE_DELAY=3e3,CtrlShow=function(e){function t(t,o,r){var i,n=e.call(this,t,getRootClassName$1(o.isMobile),o)||this;n.ctrlbar=r,n.isMouseHoverControl=!1,n.isMouseDown=!1,n.shadowClickDisabled=!1,n.onShadowClick=function(e){if(e.target===n.shadow&&(n.clearClickTimer(),!n.shadowClickDisabled)){n.clickTimer=window.setTimeout((function(){var e=n.player;e.state===exports.VIDEO_STATE.PLAYING?e.pause(exports.H5_PAUSE_TYPE.USER_CLICK):onBtnClickPlay(e,n.ctrlbar)}),300)}},n.clearClickTimer=function(){n.clickTimer&&(clearTimeout(n.clickTimer),n.clickTimer=null)},n.clearHideTimer=function(){n.hideTid&&(clearTimeout(n.hideTid),n.hideTid=null)},n.clearTouchTimer=function(){n.touchTid&&(clearTimeout(n.touchTid),n.touchTid=null)},n.hideDelay=o.autoHideDelay||DEFAULT_AUTO_HIDE_DELAY,n.show=n.show.bind(n),n.hide=n.hide.bind(n),n.onFullscreenChange=n.onFullscreenChange.bind(n),n.eventMap=((i={})[exports.PLAY_EVENT.STATE_CHANGE]=n.onPlayerStateChange.bind(n),i[exports.PLAY_EVENT.VIDEONODE_START_PLAY]=n.onStartPlay.bind(n),i),n.setEvts(),n.control=t.container.querySelector(ctrlBarSelector),n.shadow=t.container.querySelector(shadowClassName$1),n.gradientBottom=t.container.querySelector(gradientClassName$1),r.on(CTRL_EVENTS$2.FULLSCREEN_CHANGE,n.onFullscreenChange),r.on(CTRL_EVENTS$2.FAKE_FULLSCREEN_CHANGE,n.onFullscreenChange);var a=o.showCtrlShadow;return void 0===a||a||(n.shadow.remove(),n.shadow=null),n.addEventListener(),n.isMobile&&n.toggleControlOnClick(),n}return __extends$1(t,e),Object.defineProperty(t.prototype,"isShow",{get:function(){return!this.el.classList.contains(Component.hideClassName)},enumerable:!1,configurable:!0}),t.prototype.show=function(){this.autoHide(),this.isShow||(this.showEl(),this.showEl(this.gradientBottom),this.ctrlbar.emit(CTRL_EVENTS$2.SHOW))},t.prototype.hide=function(e){this.isShow&&(e||!this.isMouseHoverControl&&this.player.state!==exports.VIDEO_STATE.PAUSE)&&(this.hideEl(),this.hideEl(this.gradientBottom),this.ctrlbar.emit(CTRL_EVENTS$2.HIDE))},t.prototype.autohide=function(){this.autoHide()},t.prototype.autoHide=function(){this.clearHideTimer(),this.hideDelay!==1/0&&(this.hideTid=window.setTimeout(this.hide,this.hideDelay))},t.prototype.destroy=function(){this.clearHideTimer(),this.clearClickTimer(),this.clearTouchTimer(),e.prototype.destroy.call(this)},t.prototype.toggleShadowClickDisabled=function(e){this.shadowClickDisabled=e},t.prototype.addEventListener=function(){var e=this,t=this,o=t.ctrlbar,r=t.player,i=t.shadow,n=r.container;this.isMobile?(o.on(CTRL_EVENTS$2.TOGGLE_OVERLAY,(function(t){var o=t.data;e.isMouseHoverControl=o,o||e.autoHide()})),o.on(CTRL_EVENTS$2.MOUSE_DOWN,(function(){return e.isMouseHoverControl=!0})),o.on(CTRL_EVENTS$2.MOUSE_UP,(function(){e.autoHide(),e.isMouseHoverControl=!1}))):(this.control.addEventListener("mouseenter",(function(){return e.isMouseHoverControl=!0})),this.control.addEventListener("mouseleave",(function(){return e.isMouseHoverControl=!1})),o.on(CTRL_EVENTS$2.MOUSE_DOWN,(function(){return e.isMouseDown=!0})),o.on(CTRL_EVENTS$2.MOUSE_UP,(function(){return e.isMouseDown=!1})),n.addEventListener("mouseenter",this.show),n.addEventListener("mousemove",this.show),n.addEventListener("mouseleave",(function(){e.isMouseDown||e.hide()})),!this.isLive&&i&&(i.addEventListener("click",this.onShadowClick),i.addEventListener("dblclick",this.clearClickTimer)))},t.prototype.toggleControlOnClick=function(){var e,t=this;null===(e=this.shadow)||void 0===e||e.addEventListener("click",(function(){t.isShow?t.hide():t.show()}))},t.prototype.onFullscreenChange=function(){this.isMouseHoverControl=!1,this.hide()},t.prototype.onPlayerStateChange=function(e){var t=e.data.new;-1!==[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.END,exports.VIDEO_STATE.IDLE].indexOf(t)?this.show():t===exports.VIDEO_STATE.PLAYING&&this.autoHide()},t.prototype.onStartPlay=function(){this.autoHide()},t.compName="CtrlShow",t}(Component),HotKeyCode;!function(e){e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.Space=" ",e.Escape="Escape",e.LEFT_SQUARE_BRACKET="[",e.LEFT_SQUARE_BRACKET_CN="【",e.RIGHT_SQUARE_BRACKET="]",e.RIGHT_SQUARE_BRACKET_CN="】"}(HotKeyCode||(HotKeyCode={}));var defaultSeekGap=5,defaultBackwardGap=2,defaultActivePressTime=.5,defaultBackwardTimeout=500,liveHotKeys=[HotKeyCode.ArrowUp,HotKeyCode.ArrowDown,HotKeyCode.Escape],volumeGap=.05,HotKeys=function(){function e(e,t,o){var r,i=this;this.player=e,this.config=t,this.comps=o,this.isDisabled=!1,this.spyKeyUpOnBody=function(e){i.isEvtKeyInConfig(e)&&i.spyKeyUp(e)},this.spyKeyDownOnBody=function(e){i.isEvtKeyInConfig(e)&&i.spyKeyDown(e)},this.fastBackwardHandler=function(){var e=i.player,t=e.duration;i.backwardPlaytime=e.playtime;var o=function(){i.backwardPlaytime=Math.max(0,i.backwardPlaytime-defaultBackwardGap),i.comps.progress.updateProgress(i.backwardPlaytime/t),e.seek(i.backwardPlaytime),showTips(e,"快退至 "+comTool.formatPlayTime(i.backwardPlaytime))};i.backwardTimer=setInterval(o,defaultBackwardTimeout),o()},this.fastForwardHandler=function(){var e=i.config.pressFastForwardRate,t=void 0===e?3:e,o=i.comps.playRate,r=(o||{}).selected;if(r&&!(t<=r)){var n={label:t+"X",value:t};i.player.play(),i.lastPlaybackRate=o.selected,i.player.playbackRate=t,showTips(i.player,"正在 <em>"+n.value+"</em> 倍播放中"),setTimeout((function(){o.setCurrent(n)}),0)}},this.spyKeyUp=this.spyKeyUp.bind(this),this.spyKeyDown=this.spyKeyDown.bind(this);var n=e.container;uaTool.mobile||(n.tabIndex=-1),n.addEventListener("keyup",this.spyKeyUp),n.addEventListener("keydown",this.spyKeyDown),(null===(r=this.config.keysListenedOnBody)||void 0===r?void 0:r.length)&&(document.body.addEventListener("keyup",this.spyKeyUpOnBody),document.body.addEventListener("keydown",this.spyKeyDownOnBody))}return e.prototype.destroy=function(){var e;if(this.player){var t=this.player.container;this.cancelPressState(),t.removeEventListener("keyup",this.spyKeyUp),t.removeEventListener("keydown",this.spyKeyDown),(null===(e=this.config.keysListenedOnBody)||void 0===e?void 0:e.length)&&(document.body.removeEventListener("keyup",this.spyKeyUpOnBody),document.body.removeEventListener("keydown",this.spyKeyDownOnBody)),this.player=null}},e.prototype.isEvtKeyInConfig=function(e){return this.config.keysListenedOnBody.includes(e.key)&&e.target===document.body},e.prototype.prevent=function(e){var t,o;null===(t=e.preventDefault)||void 0===t||t.call(e),null===(o=e.stopPropagation)||void 0===o||o.call(e)},e.prototype.spyKeyUp=function(e){var t;if(!e.shiftKey&&!this.isDisabled){var o=e.key,r=this.player,i=r.state,n=this.config.seekGap,a=void 0===n?defaultSeekGap:n;if(this.pressKey)o===this.pressKey&&this.cancelPressState();else if(!(r.config.type===exports.PLAY_MODE.LIVE)||liveHotKeys.includes(o))switch(o){case HotKeyCode.ArrowLeft:r.setStateKv("ctrlbar:hotkey:"+o,{type:exports.LOG_TYPE.USER_ACTION}),r.seek(r.playtime-a),this.prevent(e),this.showSeekLeftTips();break;case HotKeyCode.ArrowRight:r.setStateKv("ctrlbar:hotkey:"+o,{type:exports.LOG_TYPE.USER_ACTION}),r.seek(r.playtime+a),this.prevent(e),this.showSeekRightTips();break;case HotKeyCode.Space:r.setStateKv("ctrlbar:hotkey:space",{type:exports.LOG_TYPE.USER_ACTION}),i===exports.VIDEO_STATE.PLAYING||i===exports.VIDEO_STATE.BUFFERING?r.pause(exports.H5_PAUSE_TYPE.USER_CLICK):r.play(),this.prevent(e);break;case HotKeyCode.Escape:(null===(t=this.comps.fakeFullscreen)||void 0===t?void 0:t.isFullScreen)&&(this.comps.fakeFullscreen.requestFullScreen("exit"),this.prevent(e));break;case HotKeyCode.LEFT_SQUARE_BRACKET:case HotKeyCode.LEFT_SQUARE_BRACKET_CN:this.setNextPlayBackRate(!0),this.prevent(e);break;case HotKeyCode.RIGHT_SQUARE_BRACKET:case HotKeyCode.RIGHT_SQUARE_BRACKET_CN:this.setNextPlayBackRate(!1),this.prevent(e)}}},e.prototype.setNextPlayBackRate=function(e){void 0===e&&(e=!1);var t=this.comps.playRate,o=t.popupOptions,r=t.selected,i=o.findIndex((function(e){return e.value===r}));if(-1!==i&&!(e&&0===i||!e&&i===o.length-1)){var n=Number(o[e?i-1:i+1].value);this.player.playbackRate=n,showTips(this.player,"正在 <em>"+n+"</em> 倍速播放中")}},e.prototype.enterPressMode=function(e){var t=this;if(!this.pressKey){var o=this.config,r=o.pressFastBackwardGap,i=void 0===r?defaultActivePressTime:r,n=o.pressFastForwardGap,a=e?void 0===n?defaultActivePressTime:n:i,s=e?this.fastForwardHandler:this.fastBackwardHandler;a&&(clearTimeout(this.pressTimer),this.pressTimer=setTimeout((function(){var e=t.player.state;[exports.VIDEO_STATE.PAUSE,exports.VIDEO_STATE.PLAYING].includes(e)&&s()}),1e3*a))}},e.prototype.cancelPressState=function(){var e=this.comps.playRate;e&&this.lastPlaybackRate&&(e.selected=this.lastPlaybackRate,this.player.playbackRate=this.lastPlaybackRate),hideTips(this.player),this.lastPlaybackRate=NaN,this.pressKey=null,this.backwardPlaytime=NaN,this.pressKey=null,clearTimeout(this.backwardTimer),clearTimeout(this.pressTimer)},e.prototype.spyKeyDown=function(e){if(e.shiftKey||this.isDisabled||this.pressKey)this.prevent(e);else{var t=e.key,o=e.repeat,r=this.player;if(!(r.config.type===exports.PLAY_MODE.LIVE)||liveHotKeys.includes(t))switch(t){case HotKeyCode.ArrowUp:r.volume=this.volumeToFixedNumber(r.volume+volumeGap),this.prevent(e),this.showVolumeTips();break;case HotKeyCode.ArrowDown:r.volume=this.volumeToFixedNumber(r.volume-volumeGap),this.prevent(e),this.showVolumeTips();break;case HotKeyCode.Space:this.prevent(e);break;case HotKeyCode.ArrowLeft:case HotKeyCode.ArrowRight:this.prevent(e),o&&(this.enterPressMode(t===HotKeyCode.ArrowRight),this.pressKey=t)}}},e.prototype.volumeToFixedNumber=function(e){var t=Math.max(Math.min(e,1),0);return t=Number(t.toFixed(2)),lsTool.setData(LOCAL_KEY.VOLUME,t),t},e.prototype.showSeekLeftTips=function(){if(this.player.state!==exports.VIDEO_STATE.IDLE){var e=this.config.seekGap,t=void 0===e?defaultSeekGap:e,o=Math.max(0,this.player.playtime-t);showTips(this.player,"快退至 "+comTool.formatPlayTime(o))}},e.prototype.showSeekRightTips=function(){if(this.player.state!==exports.VIDEO_STATE.IDLE){var e=this.player,t=e.playtime,o=e.duration,r=this.config.seekGap,i=void 0===r?defaultSeekGap:r,n=Math.min(t+i,o);showTips(this.player,"快进至 "+comTool.formatPlayTime(n))}},e.prototype.showVolumeTips=function(){var e;(null===(e=this.comps.volume)||void 0===e?void 0:e.popup.classList.contains(Component.hideClassName))&&showTips(this.player,"当前音量: <em>"+(100*this.player.volume).toFixed(0)+"</em>")},e.compName="HotKeys",e}(),componentMap={PlayBtn:PlayBtn,NextBtn:NextBtn,TimeArea:TimeArea,Progress:Progress,Fullscreen:Fullscreen,FakeFullscreen:FakeFullscreen,Volume:Volume,CtrlShow:CtrlShow,HotPoint:HotPoint,Loop:Loop,PictureInPicture:PictureInPicture,LiveProgress:LiveProgress,CenterBtn:CenterBtn,DefinitionPopup:DefinitionPopup,PlayratePopup:PlayratePopup,LanguagePopup:LanguagePopup,AudioTrackPopup:AudioTrackPopup},CtrlbarPlugin=function(e){function t(t,o,r){var i,n,a,s,l=e.call(this,t,o,r)||this;l.instances={},l.isInRequest=!1,l.hasCustomPlayBackRate=!1,l.config=__assign$1(__assign$1({},t.config.ctrlConfig),o);var c=uaTool.mobile;return null!==(i=(a=l.config).isMobile)&&void 0!==i||(a.isMobile=c),null!==(n=(s=l.config).showCenterPlayBtn)&&void 0!==n||(s.showCenterPlayBtn=c),l.setMaxListeners(20),l.insertDom(),l.createSubComponents(r),l.setupResizeEvent(),l.setPluginEvts(!0),adaptMobileAdPlugin(l,t),l.config.isMobile&&l.hide(!0),l.config.uiDuration&&(l.duration=l.config.uiDuration),l}return __extends$1(t,e),Object.defineProperty(t.prototype,"duration",{get:function(){var e;return null!==(e=this.uiDuration)&&void 0!==e?e:this.player.duration},set:function(e){isNaN(e)&&void 0!==e||(this.uiDuration=e,this.instances[TimeArea.compName]&&(this.instances[TimeArea.compName].timeDur.innerText=comTool.formatPlayTime(e)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"audio",{get:function(){var e;return null===(e=this.instances[AudioTrackPopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[AudioTrackPopup.compName]&&(this.instances[AudioTrackPopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"audioOpts",{get:function(){var e;return null===(e=this.instances[AudioTrackPopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[AudioTrackPopup.compName]&&(this.instances[AudioTrackPopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){var e;return null===(e=this.instances[DefinitionPopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[DefinitionPopup.compName]&&(this.instances[DefinitionPopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"levelOpts",{get:function(){var e;return null===(e=this.instances[DefinitionPopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[DefinitionPopup.compName]&&(this.instances[DefinitionPopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lang",{get:function(){var e;return null===(e=this.instances[LanguagePopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[LanguagePopup.compName]&&(this.instances[LanguagePopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"langOpts",{get:function(){var e;return null===(e=this.instances[LanguagePopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[LanguagePopup.compName]&&(this.instances[LanguagePopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playrate",{get:function(){var e;return null===(e=this.instances[PlayratePopup.compName])||void 0===e?void 0:e.selected},set:function(e){this.instances[PlayratePopup.compName]&&(this.instances[PlayratePopup.compName].selected=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playrateOpts",{get:function(){var e;return null===(e=this.instances[PlayratePopup.compName])||void 0===e?void 0:e.popupOptions},set:function(e){this.instances[PlayratePopup.compName]&&(this.instances[PlayratePopup.compName].popupOptions=e)},enumerable:!1,configurable:!0}),t.prototype.getIsHotKeysDisabled=function(){return this.hotKeys.isDisabled},t.prototype.prependElementToLevels=function(e){var t,o,r;null===(r=null===(o=null===(t=this.instances)||void 0===t?void 0:t[DefinitionPopup.compName])||void 0===o?void 0:o.popup)||void 0===r||r.firstElementChild.insertAdjacentElement("afterbegin",e)},t.prototype.show=function(e){void 0===e&&(e=!1),this.el.classList.remove(Component.hideClassName),this.instances.CtrlShow.gradientBottom.classList.remove(Component.hideClassName),e&&(this.el.style.display="",this.instances.CtrlShow.gradientBottom.style.display=""),this.emit(CTRL_EVENTS$2.SHOW)},t.prototype.hide=function(e){void 0===e&&(e=!1),this.el.classList.add(Component.hideClassName),this.instances.CtrlShow.gradientBottom.classList.add(Component.hideClassName),e&&(this.el.style.display="none",this.instances.CtrlShow.gradientBottom.style.display="none"),this.emit(CTRL_EVENTS$2.HIDE)},t.prototype.setHotKeysDisable=function(e){void 0===e&&(e=!0),this.hotKeys&&(this.hotKeys.isDisabled=!!e)},t.prototype.setCompDisable=function(e,t){var o=this;void 0===t&&(t=!0),(Array.isArray(e)?e:[e]).forEach((function(e){var r,i;"CtrlShow"!==e?null===(i=null===(r=o.instances[e])||void 0===r?void 0:r.el)||void 0===i||i.classList.toggle(Component.disabledClassName,t):o.instances.CtrlShow.toggleShadowClickDisabled(t)}))},t.prototype.setCompVisable=function(e,t){var o=this;void 0===t&&(t=!0),(Array.isArray(e)?e:[e]).forEach((function(e){var r,i;null===(i=null===(r=o.instances[e])||void 0===r?void 0:r.el)||void 0===i||i.classList.toggle(Component.hideClassName,!t)}))},t.prototype.removeComponent=function(e){var t,o;null===(o=null===(t=this.instances[e])||void 0===t?void 0:t.el)||void 0===o||o.remove()},t.prototype.destroy=function(){var t,o;this.setPluginEvts(!1),this.callAllComponents("destroy"),(null===(t=this.el)||void 0===t?void 0:t.parentNode)&&this.el.remove(),this.el=null,null===(o=this.hotKeys)||void 0===o||o.destroy(),e.prototype.destroy.call(this)},t.prototype.hookVideoCanplay=function(){this.config.isMobile&&this.show(!0)},t.prototype.hookAdReqInfoStart=function(){this.isInRequest=!0},t.prototype.hookAdReqInfoEnd=function(){this.isInRequest=!1},t.prototype.hookVideoReqInfoStart=function(){this.isInRequest=!0},t.prototype.hookVideoReqInfoEnd=function(){this.isInRequest=!1},t.prototype.hookVideoRateChange=function(e){var t,o=e.rate;if(!(null===(t=this.playrateOpts)||void 0===t?void 0:t.find((function(e){return Number(e.value)===o})))){var r=__spreadArray$1([],this.playrateOpts||[],!0);if(this.hotKeys.pressKey)return;return this.hasCustomPlayBackRate&&(r=this.deleteCustomPlaybackRate(r)),this.playrateOpts=__spreadArray$1([this.getCustomPlaybackRate(o)],r,!0),this.hasCustomPlayBackRate=!0,void(this.playrate=o)}this.hasCustomPlayBackRate&&(this.hasCustomPlayBackRate=!1,this.playrateOpts=this.deleteCustomPlaybackRate(this.playrateOpts)),this.playrate=o},t.prototype.hookVideoPlaying=function(e){var t;e.isFirst&&(null===(t=this.instances.CtrlShow.shadow)||void 0===t||t.classList.remove(Component.hideClassName))},t.prototype.hookPlaySessionEnd=function(e){this.callAllComponents("hookPlaySessionEnd",e)},t.prototype.onFlowNodeStart=function(e){this.callAllComponents("hookFlowNodeStart",e)},t.prototype.callAllComponents=function(e){for(var t=this,o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];Object.keys(this.instances).forEach((function(r){var i;try{"function"==typeof t.instances[r][e]&&(i=t.instances[r])[e].apply(i,o)}catch(t){console.error("ctrlbar "+e+" err: ",t)}}))},t.prototype.setPluginEvts=function(e){var t=this;this.pluginMsgEvtMap||(this.pluginMsgEvtMap={FLOW_NODE_START:this.onFlowNodeStart.bind(this)});var o=e?this.msg.on:this.msg.off;Object.keys(this.pluginMsgEvtMap).forEach((function(e){o.call(t.msg,e,t.pluginMsgEvtMap[e])}))},t.prototype.getCustomPlaybackRate=function(e){return{value:e,label:"自定义（"+e+"x）",btnLabel:e+"x",payload:{customOpt:!0}}},t.prototype.deleteCustomPlaybackRate=function(e){return e.filter((function(e){var t;return!0!==(null===(t=e.payload)||void 0===t?void 0:t.customOpt)}))},t.prototype.insertDom=function(){var e=this.player.container,o=this.config.isMobile;e.classList.add(containerClassName$1),e.insertAdjacentHTML("beforeend",getDomText(o));var r=o?css_248z$5:css_248z$1$1;domTool.insertStyle(r,t.styleDataTag);var i=getRootClassName$1(o);this.el=e.querySelector(i),document.querySelector(svgSpriteSelector)||document.body.insertAdjacentHTML("afterbegin",o?h5SvgSprite:svgSprite),o&&(this.el.innerHTML=this.el.querySelector(ctrlBarSelector).innerHTML,e.querySelector(i+" .txp_right_controls").innerHTML=h5CtrlRightDomText,e.insertAdjacentHTML("beforeend",h5OverlayText))},t.prototype.createSubComponents=function(e){if(this.initComps(e),!this.config.disableHotKey){var t=this.instances,o=t.Volume,r=t.FakeFullscreen,i=t.PlayratePopup,n=t.Progress;this.hotKeys=new HotKeys(this.player,this.config,{volume:o,fakeFullscreen:r,playRate:i,progress:n})}},t.prototype.initComps=function(e){var t,o=this,r=this.config,i=r.isMobile,n=r.comps,a=r.removeComps,s="live"===(null===(t=this.player.config)||void 0===t?void 0:t.type),l=s?[PlayBtn,Fullscreen,FakeFullscreen,LiveProgress,Volume,CenterBtn,AirPlayBtn,CtrlShow,DefinitionPopup]:[PlayBtn,TimeArea,Progress,Fullscreen,HotPoint,Loop,NextBtn,FakeFullscreen,Volume,PictureInPicture,CenterBtn,AirPlayBtn,CtrlShow,DefinitionPopup,LanguagePopup,PlayratePopup,AudioTrackPopup],c=[];(null==n?void 0:n.length)?-1===(c=n.map((function(e){return componentMap[e]}))).indexOf(CtrlShow)&&c.push(CtrlShow):c=(c=c.concat(l)).filter((function(e){var t=!!a&&-1!==a.indexOf(e.compName),o=e.isEnabled(r);return!t&&o})),this.log("readyCompClasses="+c.map((function(e){return e.compName}))),c.forEach((function(t){o.instances[t.compName]=new t(o.player,r,o,e)})),s&&i&&(this.el.style.justifyContent="space-between")},t.prototype.setupResizeEvent=function(){var e=this,t=function(t){var o=t.data;e.player.container.classList.toggle(largeSizeClassName$1,o),e.emit(CTRL_EVENTS$2.RESIZE,{size:o?CTRL_SIZE$1.LARGE:CTRL_SIZE$1.NORMAL})};this.on(CTRL_EVENTS$2.FULLSCREEN_CHANGE,(function(o){var r;!o.data&&(null===(r=e.instances.FakeFullscreen)||void 0===r?void 0:r.isFullScreen)||t(o)})),this.on(CTRL_EVENTS$2.FAKE_FULLSCREEN_CHANGE,(function(o){var r,i=o.data;document.body.classList.toggle(bodyOverflowClassName$1,i),!i&&(null===(r=e.instances.Fullscreen)||void 0===r?void 0:r.isFullScreen)||t(o)})),uaTool.mobile&&this.player.container.addEventListener("touchmove",(function(t){var o;(null===(o=e.instances.FakeFullscreen)||void 0===o?void 0:o.isFullScreen)&&t.preventDefault()}))},t.pluginName=CtrlbarPluginName$2,t.styleDataTag="thumb-ctrlbar-style",t}(Plugin);function styleInject$4(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(CtrlbarPlugin.pluginName,CtrlbarPlugin);var css_248z$4='@charset "UTF-8";.txp_console{position:absolute;top:0;left:0;width:100%;height:100%;z-index:10;font-size:11px;color:#fff;pointer-events:none}.txp_console.txp_none,.txp_console .txp_none{display:none}.txp_console .txp_console_header .txp_copy_text,.txp_console .txp_console_header .txp_log_upload{cursor:pointer;background-color:#444;margin:2px;padding:2px 4px;border-radius:2px;-webkit-transition:all .5s;transition:all .5s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.txp_console .txp_console_header .txp_copy_text:hover,.txp_console .txp_console_header .txp_log_upload:hover{-webkit-filter:contrast(1.5) brightness(.8);filter:contrast(1.5) brightness(.8)}.txp_console .txp_console_header .txp_copy_text:active,.txp_console .txp_console_header .txp_log_upload:active{-webkit-filter:unset;filter:unset}.txp_console .txp_console_header .txp_btn_close{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:relative;border:none;background:0 0;font-family:inherit;cursor:pointer;outline:0 none;font-size:1em;color:#fff}.txp_console .txp_console_inner{position:absolute;margin:10px 0 0 10px;padding:8px 5px;background-color:rgba(28,28,28,.8);pointer-events:auto;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;border-radius:4px}.txp_console .txp_console_inner .txp_line_container{overflow-y:auto;margin-top:8px}.txp_console .txp_console_inner .txp_console_header{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 8px}.txp_console .txp_console_inner .txp_console_header .txp_console_header_title{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:12px;font-weight:900}.txp_console .txp_console_inner .txp_console_header .txp_log_upload{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-right:4px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.txp_console .txp_console_inner .txp_console_header .txp_log_upload .log_upload_text:after{content:"上传日志"}@-webkit-keyframes loading{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes loading{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.txp_console .txp_console_inner .txp_console_header .txp_log_upload .reporting-icon{display:none;-webkit-animation:loading 1s infinite;animation:loading 1s infinite}.txp_console .txp_console_inner .txp_console_header .txp_log_upload[data-reporting=true]{cursor:not-allowed}.txp_console .txp_console_inner .txp_console_header .txp_log_upload[data-reporting=true] .log_upload_text:after{background-color:#444;content:"上传中..."}.txp_console .txp_console_inner .txp_console_header .txp_log_upload[data-reporting=true] .reporting-icon{display:inline-block}.txp_console .txp_console_inner .txp_console_header .txp_log_upload.txp_none{display:none}.txp_console .txp_console_inner .txp_line{display:-webkit-box;display:-ms-flexbox;display:flex;line-height:1.6}.txp_console .txp_console_inner .txp_line .txp_compact_label,.txp_console .txp_console_inner .txp_line .txp_label{display:inline-block;-ms-flex-negative:0;flex-shrink:0;width:7em;padding-right:6px;text-align:right}.txp_console .txp_console_inner .txp_line .txp_compact_label:after,.txp_console .txp_console_inner .txp_line .txp_label:after{content:":"}.txp_console .txp_console_inner .txp_line .txp_compact_label{display:none}.txp_console .txp_console_inner .txp_line .txp_value{display:inline-block;text-align:left;vertical-align:text-top;width:30em}.txp_console.fullscreen .txp_console_inner{margin:0;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.txp_console.fullscreen .txp_console_inner .txp_line{display:none}.txp_console.fullscreen .txp_console_inner .txp_line.line-compact{display:-webkit-box;display:-ms-flexbox;display:flex}.txp_console.fullscreen .txp_console_inner .txp_line.line-compact .txp_compact_label,.txp_console.fullscreen .txp_console_inner .txp_line.line-compact .txp_label{display:none;width:4em}.txp_console.fullscreen .txp_console_inner .txp_line.line-compact .txp_compact_label{display:block}.txp_info_icon{position:absolute;top:8px;right:8px;z-index:4;width:24px;height:24px;fill:#fff;opacity:.5;border-radius:5px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all .3s;transition:all .3s}.txp_info_icon:hover{opacity:1}.txp_info_icon.small{width:16px;height:16px}.txp_info_icon.txp_none{display:none!important}';styleInject$4(css_248z$4);var REPORTING_SVG_ICON$1='<svg class="reporting-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"\nxmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" fill="#fff">\n<path\n  d="M784 902.4c9.6 19.2 6.4 41.6-12.8 54.4-19.2 9.6-41.6 3.2-51.2-12.8-9.6-19.2-6.4-41.6 12.8-54.4 16-12.8 38.4-8 51.2 12.8z m-233.6 81.6c0 22.4-16 38.4-38.4 38.4s-38.4-16-38.4-38.4V960c0-22.4 19.2-38.4 41.6-38.4 19.2 0 35.2 16 38.4 38.4v25.6h-3.2z m-240-43.2c-9.6 19.2-35.2 25.6-54.4 16-19.2-9.6-25.6-35.2-16-51.2l28.8-51.2c9.6-19.2 35.2-25.6 54.4-16s25.6 35.2 12.8 54.4l-25.6 48zM121.6 784c-19.2 9.6-41.6 3.2-54.4-16-9.6-19.2-6.4-41.6 12.8-54.4l76.8-44.8c19.2-9.6 41.6-3.2 54.4 16 9.6 19.2 3.2 41.6-16 54.4L121.6 784zM38.4 552c-22.4 0-38.4-16-38.4-38.4s16-38.4 38.4-38.4H160c22.4 0 38.4 19.2 38.4 38.4 0 22.4-16 38.4-38.4 38.4H38.4z m44.8-241.6c-19.2-9.6-25.6-35.2-16-51.2 9.6-19.2 35.2-25.6 54.4-16L256 320c19.2 9.6 25.6 35.2 16 54.4s-35.2 25.6-54.4 16l-134.4-80z m160-185.6l92.8 160c9.6 19.2 35.2 25.6 54.4 12.8s25.6-35.2 12.8-54.4l-92.8-160c-12.8-19.2-35.2-22.4-54.4-12.8-16 12.8-22.4 33.6-12.8 54.4z m230.4-84.8c0-22.4 16-38.4 38.4-38.4s38.4 19.2 38.4 38.4V224c0 22.4-19.2 38.4-38.4 38.4-22.4 0-38.4-19.2-38.4-38.4V40z m240 43.2c9.6-19.2 35.2-25.6 54.4-16 19.2 9.6 25.6 35.2 16 51.2l-92.8 160c-9.6 19.2-35.2 25.6-54.4 16-19.2-9.6-25.6-35.2-12.8-54.4l89.6-156.8z m188.8 160l-160 92.8c-19.2 9.6-25.6 35.2-16 54.4 12.8 19.2 35.2 25.6 54.4 12.8l160-92.8c19.2-9.6 25.6-35.2 12.8-54.4-9.6-16-32-25.6-51.2-12.8z m83.2 228.8c22.4 0 38.4 16 38.4 38.4s-16 38.4-38.4 38.4H800c-22.4 0-38.4-19.2-38.4-38.4 0-22.4 19.2-38.4 38.4-38.4h185.6z"\n  />\n</svg>',INFO_SVG_DOM_STR$1='<div class="txp_info_icon txp_none">\n  <svg\n  viewBox="0 0 1024 1024"\n  version="1.1"\n  xmlns="http://www.w3.org/2000/svg"\n  >\n  <path\n    d="M512 958.016C266.08 958.016 65.984 757.952 65.984 512 65.984 266.08 266.08 65.984 512 65.984c245.952 0 446.016 200.064 446.016 446.016C958.016 757.952 757.952 958.016 512 958.016zM512 129.984C301.344 129.984 129.984 301.344 129.984 512c0 210.624 171.36 382.016 382.016 382.016 210.624 0 382.016-171.36 382.016-382.016C894.016 301.344 722.624 129.984 512 129.984z"\n  ></path>\n  <path\n    d="M512 304m-48 0a1.5 1.5 0 1 0 96 0 1.5 1.5 0 1 0-96 0Z"\n  ></path>\n  <path\n    d="M512 768c-17.664 0-32-14.304-32-32l0-288c0-17.664 14.336-32 32-32s32 14.336 32 32l0 288C544 753.696 529.664 768 512 768z"\n  ></path>\n  </svg>\n</div>\n',InfoPanelPluginName$1="info-panel",InfoPanelEvents$1={CLICK_UPLOAD:"contextmenu:click-upload"},DEFAULT_SHOW_QUERY$1="show_info_panel";function copyToClipBoard(e){return canUseClipboardAPI()?copyAsync(e):copySynchronized(e)}function copySynchronized(e){var t=document.createElement("input");t.setAttribute("style","position: absolute; clip: rect(0 0 0 0); opacity: 0;"),t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy",!0),t.remove()}function copyAsync(e){return navigator.clipboard.writeText(e)}function canUseClipboardAPI(){var e;return"function"==typeof(null===(e=navigator.clipboard)||void 0===e?void 0:e.writeText)&&!uaTool.browser.x5&&!uaTool.browser.mqqbrowser}function getHtml(e){return'<div class="txp_console txp_none" style="z-index: 100">\n    <div class="txp_console_inner">\n      <div class="txp_console_header">\n      <span class="txp_console_header_title">播放信息</span>\n      <span class="txp_copy_text">复制</span>\n      <span class="txp_log_action txp_log_upload">\n        <span class="log_upload_text"></span>\n        '+REPORTING_SVG_ICON$1+'\n      </span>\n      <button class="txp_btn_close" title="关闭">[X]</button>\n      </div>\n    <div class="txp_line_container">\n      '+e.map((function(e){var t=e.key,o=e.title,r=void 0===o?"":o,i=e.style,n=void 0===i?"":i,a=e.label,s=e.value,l=e.compactLabel;return'<div class="txp_line '+(l?"line-compact":"")+'" data-key="'+t+'" title="'+(r||"")+'" style="'+(n||"")+'">\n            <div class="txp_label">'+a+"</div>\n            "+(l?'<div class="txp_compact_label">'+l+"</div>":"")+'\n            <div class="txp_value">'+s+"</div>\n          </div>"})).join("")+"\n    </div>\n    </div>\n  </div>"}var InfoPanelPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;i.inited=!0,i._itemDomMap={},i._showing=!1,i.isReporting=!1,i.curInfoMap={};var n=i.player.config.infoPanelConfig,a=void 0===n?{defaultInfo:!1,disableDefaultKey:[]}:n;return i.config=__assign$1(__assign$1({},a),o),i.renderInfoIcon(),i.createInfoItems(),i.renderInfoItems(),i.addInfoItemEvts(),i.addUIEvts(),i}return __extends$1(t,e),t.prototype.start=function(e){},t.prototype.getItemDom=function(e){return this._el?this._itemDomMap[e]:null},t.prototype.show=function(){this.updateInfoItems(),this.isMiniPanel()?this._el.classList.add("fullscreen"):this._el.classList.remove("fullscreen"),this._showing=!0,this._el.classList.remove("txp_none")},t.prototype.hide=function(){this._showing=!1,this._el.classList.add("txp_none")},t.prototype.toggle=function(){if(this._showing)return this.hide();this.show()},t.prototype.showIcon=function(){this.isMiniPanel()?this._infoIcon.classList.add("small"):this._infoIcon.classList.remove("small"),this._infoIcon.classList.remove("txp_none")},t.prototype.hideIcon=function(){this._infoIcon.classList.add("txp_none")},t.prototype.trigger=function(){this._showing?this.hide():this.show()},Object.defineProperty(t.prototype,"showing",{get:function(){return this._showing},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){clearTimeout(this.copyBtnClearTimer),this._itemDomMap=null,this._el=null,this.infoItems=null,e.prototype.destroy.call(this)},t.prototype.hookPlaySessionStart=function(){var e=this.config.showOnQuery,t=void 0===e?DEFAULT_SHOW_QUERY$1:e;urlTool.getUrlParamByKey(location.href,t)&&this.show()},t.prototype.hookVideoPause=function(){var e=this.config.showInfoIconOnPause;(void 0===e||e)&&this.showIcon()},t.prototype.hookVideoPlaying=function(){var e=this.config.showInfoIconOnPause;(void 0===e||e)&&this.hideIcon()},t.prototype.renderInfoIcon=function(){var e=this,t=this.player.container;t.insertAdjacentHTML("beforeend",INFO_SVG_DOM_STR$1),this._infoIcon=t.querySelector(".txp_info_icon"),this._infoIcon.addEventListener("click",(function(){e.toggle()}))},t.prototype.renderInfoItems=function(){var e=this,t=this.infoItems,o=this.player.container,r=getHtml(t);o.insertAdjacentHTML("beforeend",r),this._el=o.querySelector(".txp_console"),this._closeBtn=this._el.querySelector(".txp_btn_close"),this._uploadBtn=this._el.querySelector(".txp_log_upload"),this._copyBtn=this._el.querySelector(".txp_copy_text"),this.player.offlineLog||this._uploadBtn.classList.add(txpHideClass),t.forEach((function(t){var o={el:null,value:null};o.el=e._el.querySelector('[data-key="'+t.key+'"]'),o.value=o.el.querySelector(".txp_value"),e._itemDomMap[t.key]=o}))},t.prototype.addUIEvts=function(){var e=this;this._closeBtn.addEventListener("click",(function(){return e.hide()})),this._uploadBtn.addEventListener("click",(function(t){return __awaiter$1(e,void 0,void 0,(function(){var e,o,r,i;return __generator$1(this,(function(n){switch(n.label){case 0:if(t.stopPropagation(),this.isReporting)return[2];this.isReporting=!0,this._uploadBtn.dataset.reporting="true",n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,null===(o=this.player.offlineLog)||void 0===o?void 0:o.report(!0,"info-panel:click")];case 2:return e=n.sent(),null===(r=this.player.plugins.tips)||void 0===r||r.show((null==e?void 0:e.status)?"日志上报成功":"日志上报失败 "+((null==e?void 0:e.msg)||"")),[3,5];case 3:return n.sent(),null===(i=this.player.plugins.tips)||void 0===i||i.show("日志上报失败 "+(null==e?void 0:e.msg)),[3,5];case 4:return this.isReporting=!1,this._uploadBtn.dataset.reporting="false",[7];case 5:return[2]}}))}))})),this._copyBtn.addEventListener("click",(function(t){return __awaiter$1(e,void 0,void 0,(function(){var e,o,r=this;return __generator$1(this,(function(i){switch(i.label){case 0:e=3e3,t.stopPropagation(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,copyToClipBoard(JSON.stringify(this.curInfoMap))];case 2:return i.sent(),this._copyBtn.textContent="已复制",[3,4];case 3:return o=i.sent(),this._copyBtn.textContent="复制失败",this.log(o),[3,4];case 4:return clearTimeout(this.copyBtnClearTimer),this.copyBtnClearTimer=setTimeout((function(){r._copyBtn.textContent="复制"}),e),[2]}}))}))})),isMobile&&this._el.addEventListener("click",(function(){return e.hide()}))},t.prototype.createInfoItems=function(){var e,t=this;if(this.config.defaultInfo){var o=((e={})[COMMON_DATA_KEY.vid]=this.createVidInfoItem,e[COMMON_DATA_KEY.flowid]=this.createFlowidInfoItem,e[COMMON_DATA_KEY.guid]=this.createGuidInfoItem,e[COMMON_DATA_KEY.curcore]=this.createKernelNameInfoItem,e.cdnInfo=this.createCdnInfoItem,e.playerSize=this.createResolutionInfoItem,e.keyFrame=this.createKeyFrameInfoItem,e.bufferRange=this.createBufferRangeInfoItem,e.net=this.createNetInfoItem,e.videoSize=this.createVideoSizeInfoItem,e.codecs=this.createCodecsInfoItem,e.debug=this.createDebugInfoItem,e),r=this.config.disableDefaultKey,i=void 0===r?[]:r,n=Object.keys(o).filter((function(e){return!i.includes(e)}));this.infoItems=n.map((function(e){return o[e].apply(t,[e])}))}else this.infoItems=[]},t.prototype.createNetInfoItem=function(e){var t=this,o=function(){var o=t.player.currentVideoInfo;if(null==o?void 0:o.performance){var r=o.performance,i=r.speed,n=void 0===i?0:i,a=r.p2pStats,s=void 0===a?"":a;t.setItemTextByKey(e,n+" KB/s "+s)}};return{key:e,updater:o,label:"网络活动",compactLabel:"net",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:o}]}},t.prototype.createVidInfoItem=function(e){var t=this,o=function(){var o=t.player,r=o.getCommonKv(COMMON_DATA_KEY.vid),i=o.getCommonKv(COMMON_DATA_KEY.platform),n=t.getItemDom(e);if(r||i){var a="-";r&&(a=o.config.type===exports.PLAY_MODE.LIVE?r+"-"+(o.getCommonKv(COMMON_DATA_KEY.livepid)||0)||"-":r||"-"),a+=" / "+(i||"-"),n.el.classList.remove(txpHideClass),t.setItemTextByKey(e,a)}else n.el.classList.add(txpHideClass)};return{key:e,updater:o,label:"视频ID",compactLabel:"VID",value:"-",listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){e.data.key===COMMON_DATA_KEY.vid&&o()}}]}},t.prototype.createKernelNameInfoItem=function(e){var t=this,o=function(){var o,r,i,n,a,s=null!==(i=urlTool.getFileExtension(null===(r=null===(o=t.player)||void 0===o?void 0:o.currentVideoInfo)||void 0===r?void 0:r.loadingUrl))&&void 0!==i?i:"-",l=null!==(n=t.player.getCommonKv(COMMON_DATA_KEY.curcore))&&void 0!==n?n:"-",c=null!==(a=t.player.getCommonKv(COMMON_DATA_KEY.curcorever))&&void 0!==a?a:VERSION$3,p=t.player.getCommonKv(COMMON_DATA_KEY.p2pver),d=p?"-p2p-"+p:"";t.setItemTextByKey(e,s+"/"+l+" ("+c+d+")")};return{key:e,label:"播放内核",compactLabel:"Kernel",value:"-",updater:o,listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){[COMMON_DATA_KEY.curcorever,COMMON_DATA_KEY.curcore,COMMON_DATA_KEY.p2pver].indexOf(e.data.key)>-1&&o()}}]}},t.prototype.createResolutionInfoItem=function(e){var t=this;return{key:e,label:"显示器信息",compactLabel:"Res",value:"-",updater:function(){var o,r,i=t.player,n=i.container,a=i.getCommonKv,s=n.clientWidth+"*"+n.clientHeight,l=a(COMMON_DATA_KEY.resolution),c=null!==(r=null===(o=window.screen)||void 0===o?void 0:o.isExtended)&&void 0!==r&&r;t.setItemTextByKey(e,s+" / "+l+" (ext:"+c+")")}}},t.prototype.createVideoSizeInfoItem=function(e){var t=this,o=function(){var o,r,i=null!==(r=null===(o=t.player)||void 0===o?void 0:o.currentVideoInfo)&&void 0!==r?r:{},n=i.videoHeight,a=void 0===n?0:n,s=i.videoWidth,l=void 0===s?0:s;t.setItemTextByKey(e,l+"*"+a)};return{key:e,updater:o,label:"视频分辨率",value:"-",listeners:[{event:exports.PLAY_EVENT.METADATA_CHANGE,cb:o},{event:exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,cb:o}]}},t.prototype.createCodecsInfoItem=function(e){var t=this,o=function(){var o=t.getItemDom(e),r=t.player.currentVideoInfo;if(r){o.el.classList.remove(txpHideClass);var i=r.codecs,n=void 0===i?{video:"",audio:""}:i,a=n.video,s=n.audio,l=a&&s?a+" / "+s:"",c="("+(t.player.getCommonKv(COMMON_DATA_KEY.codec)||"-")+")";t.setItemTextByKey(e,(l+" "+c).trim())}else o.el.classList.add(txpHideClass)};return{key:e,updater:o,label:"编码",compactLabel:"Codec",value:"-",listeners:[{event:exports.PLAY_EVENT.METADATA_CHANGE,cb:o}]}},t.prototype.createFlowidInfoItem=function(e){var t=this,o=function(){t.setItemTextByKey(e,t.player.getCommonKv(COMMON_DATA_KEY.flowid))};return{key:e,label:"播放流水",compactLabel:"Flowid",value:"-",updater:o,listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){e.data.key===COMMON_DATA_KEY.flowid&&o()}}]}},t.prototype.createGuidInfoItem=function(e){var t=this;return{key:e,label:"GUID",compactLabel:"GUID",value:"-",updater:function(){t.setItemTextByKey(e,t.player.getCommonKv(COMMON_DATA_KEY.guid))}}},t.prototype.createKeyFrameInfoItem=function(e){var t=this;return{key:e,label:"帧数",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:function(){var o,r,i=(null===(r=null===(o=t.player)||void 0===o?void 0:o.currentVideoInfo)||void 0===r?void 0:r.qualityInfo)||{},n=i.totalVideoFrames,a=void 0===n?0:n,s=i.droppedVideoFrames,l=void 0===s?0:s,c=l/a*100;t.setItemTextByKey(e,l+"/"+a+"; "+(isNaN(c)?0:c.toFixed(2))+"%")}}]}},t.prototype.createCdnInfoItem=function(e){var t=this,o=function(){var o,r=t.getItemDom(e);t.player.getCommonKv(COMMON_DATA_KEY.vid)?(r.el.classList.remove(txpHideClass),t.setItemTextByKey(e,urlTool.getDomainOfURL((null===(o=t.player.currentVideoInfo)||void 0===o?void 0:o.loadingUrl)||""))):r.el.classList.add(txpHideClass)};return{key:e,label:"视频CDN",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_LOAD_START,cb:o},{event:exports.PLAY_EVENT.RETRY_BACKURL,cb:o},{event:exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,cb:o}]}},t.prototype.createBufferRangeInfoItem=function(e){var t=this,o=function(){var o,r=t.player,i=r.videoBuffered,n=r.playtime,a=(null===(o=i.find((function(e){return e.start<=n&&e.end>=n})))||void 0===o?void 0:o.end)-n;t.setItemTextByKey(e,isNaN(a)?"-":a.toFixed(2)+"s")};return{key:e,updater:o,label:"缓冲健康度",value:"-",listeners:[{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:o}]}},t.prototype.createDebugInfoItem=function(e){var t=this,o="",r=[],i=function(){var i,n,a,s,l,c,p=t.player.getCommonKv(COMMON_DATA_KEY.sessionRetryBackUrlCount)||0,d=t.player.getCommonKv(COMMON_DATA_KEY.sessionRetryPlayCount)||0,u=p||d?"r:"+[p,d].join("/"):"",A=t.player.getCommonKv(COMMON_DATA_KEY.sessionBufferCount)||0,_=A?"b:"+A:"",E=t.player.videoBuffered.map((function(e){return e.start.toFixed(3)+"-"+e.end.toFixed(3)})).join(","),g=E?"br:"+E:"",f="t:"+t.player.playtime.toFixed(2),h="pg:"+ +!!(null===(s=null===(a=null===(n=null===(i=t.player.corePlayer)||void 0===i?void 0:i.getHls)||void 0===n?void 0:n.call(i))||void 0===a?void 0:a.config)||void 0===s?void 0:s.progressive),v="s:"+r.join("->"),m=o?"a:"+o:"",y=null===(c=null===(l=t.player.currentVideoInfo)||void 0===l?void 0:l.performance)||void 0===c?void 0:c.latency,T=y?"lc:"+(y/1e3).toFixed(2):"",C=t.player.getCommonKv(COMMON_DATA_KEY.drm),I=C?"enc:"+C:"";t.setItemTextByKey(e,[u,_,g,f,h,v,m,T,I].filter(Boolean).join(" "))};return{key:e,label:"mystery",compactLabel:"mystery",value:"-",listeners:[{dispatcher:this.msg,event:exports.PLAY_EVENT_EXT.DATASET_UPDATE,cb:function(e){-1!==[COMMON_DATA_KEY.sessionRetryBackUrlCount,COMMON_DATA_KEY.sessionRetryPlayCount,COMMON_DATA_KEY.sessionBufferCount,COMMON_DATA_KEY.drm].indexOf(e.data.key)&&i()}},{event:exports.PLAY_EVENT.STATE_CHANGE,cb:function(){var e=t.player.state,o=e.charAt(0)+e.charAt(e.length-1);r.push(o),r=r.slice(-5),i()}},{event:exports.H5_PLAY_EVENT.VIDEO_LOAD_PROGRESS,cb:i},{event:exports.H5_PLAY_EVENT.VIDEO_AUTOPLAY_BLOCKED,cb:function(){o="vb"}},{event:exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,cb:i},{event:exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED,cb:function(){o="ab"}}]}},t.prototype.setItemTextByKey=function(e,t){var o=this.getItemDom(e);this.curInfoMap[e]=t,o&&(o.value.innerText=null!=t?t:"-")},t.prototype.addInfoItemEvts=function(){var e=this;this.infoItems.forEach((function(t){var o;null===(o=t.listeners)||void 0===o||o.forEach((function(t){(t.dispatcher||e.player).on(t.event,t.cb)}))}))},t.prototype.updateInfoItems=function(){this.infoItems.forEach((function(e){var t;null===(t=e.updater)||void 0===t||t.call(e)}))},t.prototype.isMiniPanel=function(){var e=this.config.smallSizeThreshold,t=void 0===e?400:e;return this.player.container.clientWidth<t},t.pluginName=InfoPanelPluginName$1,t.Events=InfoPanelEvents$1,t}(Plugin);function styleInject$3(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(InfoPanelPlugin.pluginName,InfoPanelPlugin);var css_248z$3=".txp_poster_img{position:absolute;left:0;top:0;width:100%;height:100%;z-index:2;-o-object-fit:contain;object-fit:contain}.txp_poster_img.txp_none{display:none}";styleInject$3(css_248z$3);var PosterPluginName$1="poster",hideClass$2="txp_none";function findPoster(e){var t=e.vid,o=e.vidFirstPic,r=void 0!==o&&o,i=e.idx,n=void 0===i?2:i;e.fmt;var a=["496","360","228"];if(r)return"//puui.qpic.cn/vpic_cover/"+t+"/"+t+"_first.jpg/640x360";var s="0";return uaTool.mobile&&a[n]&&(s=a[n]),"//puui.qpic.cn/vpic_cover/"+t+"/"+t+"_hz.jpg/"+s}var PosterPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;return i.config=__assign$1(__assign$1({},t.config.poster||{}),o),i.el=i.init(),i.tryShow(),i}return __extends$1(t,e),t.prototype.destroy=function(){var t;e.prototype.destroy.call(this),null===(t=this.el)||void 0===t||t.remove()},t.prototype.show=function(e){this.el&&(e&&(this.el.src=e),this.el.classList.remove(hideClass$2))},t.prototype.showByVid=function(e){var t=e.vid,o=e.vidFirstPic,r=void 0!==o&&o,i=e.h5Defn,n=void 0===i?2:i,a=e.pcFmt;if(t){var s=findPoster({vid:t,vidFirstPic:r,idx:n,fmt:void 0===a?"png":a});this.show(s)}},t.prototype.hide=function(){this.el&&this.el.classList.add(hideClass$2)},t.prototype.hookAdPlaying=function(){this.hide()},t.prototype.hookVideoPlaying=function(e){e.isFirst&&this.hide()},t.prototype.hookVideoEnd=function(e){e.endState!==exports.END_STATE.NORMAL||this.player.config.loop||this.tryShow()},t.prototype.init=function(){var e=this.player.container,t=document.createElement("img");return t.classList.add("txp_poster_img",hideClass$2),e.prepend(t),t},t.prototype.tryShow=function(){var e,t;(null===(e=this.config)||void 0===e?void 0:e.vid)?this.showByVid(this.config):(null===(t=this.config)||void 0===t?void 0:t.src)&&this.show(this.config.src)},t.pluginName=PosterPluginName$1,t}(Plugin);function styleInject$2(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(PosterPlugin.pluginName,PosterPlugin);var css_248z$2='.txp_alert_info{position:absolute;left:10px;bottom:67px;padding:2px 8px;line-height:24px;font-size:13px;text-align:left;color:#fff;background:rgba(0,0,0,.6);-webkit-transition:bottom .15s ease;transition:bottom .15s ease;z-index:2}.txp_alert_info.txp_none{display:none}.txp_alert_info.ctrl_resize{bottom:107px}.txp_alert_info.ctrl_hide{bottom:20px}.txp_alert_info .txp_btn{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:relative;border:none;background:0 0;font-family:inherit;cursor:pointer;outline:0 none;font-size:1em}.txp_alert_info .txp_btn.txp_btn_close{position:relative;display:inline-block;margin-left:3px;width:14px;height:24px;vertical-align:top;color:#fff;cursor:pointer}.txp_alert_info .txp_btn.txp_btn_close:hover{color:#ff6429}.txp_alert_info .txp_btn.txp_btn_close:hover:before{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAxMiI+PHBhdGggZmlsbD0iI0ZGNzgwMCIgZD0iTTEwLjUgMTBsLS41LjUtNC00LTQgNC0uNS0uNSA0LTQtNC00IC41LS41IDQgNCA0LTQgLjUuNS00IDQgNCA0eiIvPjwvc3ZnPg==) 50% no-repeat}.txp_alert_info .txp_btn.txp_btn_close:before{content:"";position:absolute;left:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:12px;height:12px;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAxMiI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEwLjUgMTBsLS41LjUtNC00LTQgNC0uNS0uNSA0LTQtNC00IC41LS41IDQgNCA0LTQgLjUuNS00IDQgNCA0eiIvPjwvc3ZnPg==) 50% no-repeat;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0;padding:0;text-indent:0}.txp_alert_info .txp_btn.txp_none{display:none}.txp_alert_info .txp_alert_content a,.txp_alert_info .txp_alert_content em{padding:0 1px;color:#ff6429;font-style:normal;font-weight:400}.txp_alert_info .txp_alert_content .txp_alert_text{display:inline}.txp_alert_info .txp_none{display:none}',HOTPOINT_EVENTS;styleInject$2(css_248z$2),function(e){e.HOT_MOUSE_OVER="ctrl:hotpoint-mouseover",e.HOT_MOUSE_MOVE="ctrl:hotpoint-mousemove",e.HOT_MOUSE_OUT="ctrl:hotpoint-mouseout"}(HOTPOINT_EVENTS||(HOTPOINT_EVENTS={}));var CtrlbarPluginName$1="ctrlbar",CTRL_EVENTS$1=__assign$1(__assign$1({FULLSCREEN_CHANGE:"windowFullscreenChange",FULLSCREEN_ERROR:"fullscreenError",FAKE_FULLSCREEN_CHANGE:"browserFullscreenChange",CLICK_PIPBTN:"ctrl:click-pipbtn",CLICK_NEXTBTN:"ctrl:click-nextbtn",CLICK_PLAYBTN:"ctrl:click-playbtn",CLICK_REPLAY:"ctrl:click-replay",SET_LANGUAGE:"ctrl:set-language",SET_LEVEL:"ctrl:set-level",SET_AUDIO:"ctrl:set-audio",SET_PLAYRATE:"ctrl:set-playrate",SET_VOLUME:"ctrl:set-volume",TOGGLE_OVERLAY:"ctrl:toggle-overlay",MOUSE_DONW:"ctrl:progress-mousedown",MOUSE_DOWN:"ctrl:progress-mousedown",MOUSE_MOVE:"ctrl:progress-mousemove",MOUSE_UP:"ctrl:progress-mouseup",SHOW:"ctrl:show",HIDE:"ctrl:hide"},HOTPOINT_EVENTS),{TEST_EVENT:"ctrl:inner-test-event",RESIZE:"ctrl:resize",SHOW_LEVELS:"ctrl:show-levels",HOVER_PROGRESS:"ctrl:hover-progress"}),CTRL_SIZE,PlayBtnStatus;!function(e){e.LARGE="large",e.NORMAL="normal"}(CTRL_SIZE||(CTRL_SIZE={})),function(e){e.PAUSE="pause",e.PLAY="play",e.REPLAY="replay",e.STOP="stop"}(PlayBtnStatus||(PlayBtnStatus={}));var defaultShowTime$1=3,classNameOnCtrlHide$1="ctrl_hide",classNameOnCtrlResize$1="ctrl_resize",TipsPluginName$1="tips",TipsPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;return i.hide=function(){i.el.removeEventListener("click",i.clickTips),i.showOptions=null,i.el.classList.add(txpHideClass),i.emit(TipsEvents.Hide)},i.clickTips=function(e){var t;if(i.showOptions){var o=null===(t=e.target)||void 0===t?void 0:t.dataset.callback;o&&"function"==typeof i.showOptions[o]&&i.showOptions[o]()}},i.prepareDOM(),i.initDOMVars(),!1!==o.followCtrlbar&&i.followCtrlbar(),i}return __extends$1(t,e),t.prototype.destroy=function(){this.hide(),e.prototype.destroy.call(this)},t.prototype.show=function(e){var t,o=!1,r=defaultShowTime$1;"string"==typeof e||"number"==typeof e?t=String(e):(t=e.text,o=!!e.showClose,r=e.time||defaultShowTime$1,this.showOptions=e),this.$text.innerHTML=t,this.$close.classList.toggle(txpHideClass,!o),this.el.addEventListener("click",this.clickTips),this.el.classList.remove(txpHideClass),clearTimeout(this.timeoutId),-1!==r&&(this.timeoutId=window.setTimeout(this.hide,1e3*r)),this.emit(TipsEvents.Show)},t.prototype.prepareDOM=function(){var e=this.player.container,t=document.createElement("div");t.className="txp_alert_info "+txpHideClass,t.innerHTML='<div class="txp_alert_content">\n      <div class="txp_alert_text"></div>\n      <button class="txp_btn txp_btn_close" title="关闭"></button>\n    </div>',e.insertAdjacentElement("beforeend",t),this.el=t},t.prototype.initDOMVars=function(){this.$text=this.el.querySelector(".txp_alert_content .txp_alert_text"),this.$close=this.el.querySelector(".txp_btn_close"),this.$close.addEventListener("click",this.hide),isMobile&&(this.el.style.bottom="40px")},t.prototype.followCtrlbar=function(){var e=this;this.msg.on("pluginsetup:"+CtrlbarPluginName$1,(function(){var t=e.player.plugins[CtrlbarPluginName$1];t.on(CTRL_EVENTS$1.SHOW,(function(){e.el.classList.remove(classNameOnCtrlHide$1)})),t.on(CTRL_EVENTS$1.HIDE,(function(){e.el.classList.add(classNameOnCtrlHide$1)})),t.on(CTRL_EVENTS$1.RESIZE,(function(t){var o=t.data;e.el.classList.toggle(classNameOnCtrlResize$1,o.size===CTRL_SIZE.LARGE)}))}))},t.pluginName=TipsPluginName$1,t}(Plugin),TipsEvents;!function(e){e.Show="show",e.Hide="hide"}(TipsEvents||(TipsEvents={})),H5Player.registerPlugin(TipsPlugin.pluginName,TipsPlugin);var UIContextMenuPluginName$1="context-menu";function styleInject$1(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}var css_248z$1="@-webkit-keyframes txp_overlay_play{0%{-webkit-transform:scale(.5);transform:scale(.5);opacity:1}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}@keyframes txp_overlay_play{0%{-webkit-transform:scale(.5);transform:scale(.5);opacity:1}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.txp_contextmenu{background:rgba(30,30,32,.9);position:fixed;width:234px;z-index:9999;padding:10px 0;color:#bbb;overflow:hidden;font-size:12px}.txp_contextmenu.txp_none,.txp_contextmenu .txp_none{display:none}.txp_contextmenu .txp_clipboard{top:0;left:100%;position:absolute;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.txp_contextmenu .txp_menuitem{padding-left:20px;height:34px;line-height:34px;cursor:pointer;max-width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.txp_contextmenu .txp_menuitem:hover{background-color:#26262b}.txp_overlay_link{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;visibility:hidden;font-size:14px}.txp_overlay_link.txp_show{display:-webkit-box;display:-ms-flexbox;display:flex;visibility:visible;-webkit-animation:txp_overlay_play 1s ease-out both;animation:txp_overlay_play 1s ease-out both;pointer-events:none}.txp_overlay_link .txp_icon_link{background:rgba(30,30,32,.9);width:60px;height:60px;border-radius:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.txp_overlay_link .txp_icon_link .txp_icon{position:relative;width:36px;height:36px;fill:#fff}";styleInject$1(css_248z$1);var UIContextMenuPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;return i.menuConfig=[],i.show=function(){i.$el.classList.remove(txpHideClass)},i.hide=function(){i.$el.classList.add(txpHideClass)},i.config=__assign$1(__assign$1({},t.config.contextMenuConfig),o),i.start(i.config.menus,{hideVInfo:i.config.hideVInfo}),i}return __extends$1(t,e),t.prototype.start=function(e,t){if(e&&!(e.length<=0))if(!0!==(null==t?void 0:t.hideVInfo)&&e.unshift({role:"openvinfo",label:"视频信息"}),this.menuConfig=e,this.$el)this.$el.innerHTML="\n      "+e.map((function(e){return'<div class="txp_menuitem" data-role="'+(e.role||"")+'">'+e.label+"</div>"})).join("")+'\n      <textarea class="txp_clipboard" style="position: absolute; left: 100%; top: 0;"></textarea>\n      ';else{var o='\n    <div class="txp_contextmenu '+txpHideClass+'" style="overflow:hidden">\n      '+e.map((function(e){return'<div class="txp_menuitem" data-role="'+(e.role||"")+'">'+e.label+"</div>"})).join("")+'\n      <textarea class="txp_clipboard" style="position: absolute; left: 100%; top: 0;"></textarea>\n    </div>\n    <div class="txp_overlay_link '+txpHideClass+'">\n        <div class="txp_icon_link">\n            <svg class="txp_icon" viewBox="0 0 36 36" >\n              <path d="M26.5 26h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c2.5 0 4.5-2 4.5-4.5S29 14 26.5 14h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c4.1 0 7.5 3.4 7.5 7.5S30.6 26 26.5 26zM12 18.5c0-.8.7-1.5 1.5-1.5h9c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-9c-.8 0-1.5-.7-1.5-1.5zm2.5-4.5h-5C7 14 5 16 5 18.5S7 23 9.5 23h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-5C5.4 26 2 22.6 2 18.5S5.4 11 9.5 11h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5z"></path>\n            </svg>\n        </div>\n    </div>\n    ',r=this.player.container;r.insertAdjacentHTML("beforeend",o),this.$el=r.querySelector(".txp_contextmenu"),this.$link=r.querySelector(".txp_overlay_link"),this.bindDOMEvent()}},t.prototype.showSuccess=function(){var e,t;if(!isMobile&&!(null===(e=this.config)||void 0===e?void 0:e.disableSuccessTip)&&!(null===(t=this.config)||void 0===t?void 0:t.disableSuccussTip)){var o=this.$link,r="txp_show";o.classList.remove(txpHideClass),o.classList.add(r),clearTimeout(this.sucTid),this.sucTid=setTimeout((function(){o.classList.add(txpHideClass),o.classList.remove(r)}),1e3)}},t.prototype.destroy=function(){[this.$el,this.$link].forEach((function(e){return(null==e?void 0:e.parentNode)&&e.remove()})),e.prototype.destroy.call(this)},t.prototype.bindDOMEvent=function(){var e=this,t=this.player.container;t.addEventListener("contextmenu",(function(t){if(!e.player.isPlayingAd){e.show();var o=e.player.container.getBoundingClientRect(),r=o.left,i=o.top,n=o.width,a=o.height,s=t.clientX,l=t.clientY,c=e.$el,p=n+r-c.clientWidth,d=a+i-c.clientHeight,u=Math.min(p,s),A=Math.min(d,l);e.$el.style.left=u+"px",e.$el.style.top=A+"px",t.preventDefault()}})),t.addEventListener("click",this.hide),this.$el.addEventListener("click",(function(t){var o,r,i=t.target;e.showSuccess();var n=null===(o=e.menuConfig)||void 0===o?void 0:o.find((function(e){return e.role===i.dataset.role}));"function"==typeof(null==n?void 0:n.callback)&&n.callback(e),"openvinfo"===i.dataset.role&&(null===(r=e.player.plugins["info-panel"])||void 0===r||r.trigger()),e.emit("clickContextMenu",i.dataset)}))},t.pluginName=UIContextMenuPluginName$1,t}(Plugin);H5Player.registerPlugin(UIContextMenuPlugin.pluginName,UIContextMenuPlugin);var WaterMarkCoverClassName$1="thumbplayer-watermark-cover",WatermarkPluginName$1="ui-watermark",MaxRequestRetry$1=3,RequestTimeout$1=5e3,WatermarkError;function requestActionWatermark(e,t){return __awaiter$1(this,void 0,void 0,(function(){var o,r;return __generator$1(this,(function(i){switch(i.label){case 0:if(!e)return[2,Promise.reject(o)];r=0,i.label=1;case 1:if(!(r<MaxRequestRetry$1))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,netTool.jsonp(e,{timeout:RequestTimeout$1})];case 3:return[2,parseActionWatermark(i.sent(),t)];case 4:return i.sent(),o=WatermarkError.ActionWatermarkRequestFailed,[3,5];case 5:return r++,[3,1];case 6:return[2,Promise.reject(o)]}}))}))}function parseActionWatermark(e,t){for(var o={},r={},i=e.start,n=e.duration,a=e.repeat,s=e.rw,l=0===a?Math.ceil(t/n):a,c=function(t){var a=i+t*n;e.scenes.forEach((function(e){var i=e.wi,n=e.in,l=e.out,c=e.start,p=e.end;i.forEach((function(e){r[e.id]=__assign$1(__assign$1({},e),{action:!0,rw:s}),o[e.id]||(o[e.id]=[]),t>=c&&(t<=p||0===t)&&o[e.id].push({start:(a+n)/1e3,end:(a+l)/1e3})}))}))},p=0;p<l;p++)c(p);return{schedules:o,watermarks:r}}!function(e){e.ActionWatermarkRequestFailed="001"}(WatermarkError||(WatermarkError={}));var str='<txpdiv data-role="txp-ui-watermark-mod" class="txp-watermark">\n</txpdiv>',Watermark=function(){function e(e,t,o){void 0===o&&(o=!1);var r=t.cfg,i=t.css;this.el=this.createImageNode(i),this.el.onload=r.onload,this.el.onerror=r.onerror,this.el.src=r.url,this.el.dataset.id=""+r.id,e.appendChild(this.el),o?this.show():this.hide()}return e.prototype.destroy=function(){var e;(null===(e=this.el)||void 0===e?void 0:e.parentNode)&&this.el.remove(),this.el=null},e.prototype.show=function(){this.el&&(this.el.style.display="block")},e.prototype.hide=function(){this.el&&(this.el.style.display="none")},e.prototype.draw=function(e){var t=e.left,o=e.top,r=e.width,i=e.height,n=e.position,a=e.opacity;this.el&&(this.el.style.left=t,this.el.style.top=o,this.el.style.width=r,this.el.style.height=i,this.el.style.opacity=a,this.el.style.position=n)},e.prototype.createImageNode=function(e){var t=e.left,o=e.top,r=e.width,i=e.height,n=e.position,a=e.opacity,s=new Image;return s.style.left=t,s.style.top=o,s.style.width=r,s.style.height=i,s.style.position=n,s.style.opacity=a,s.style.zIndex="1",s},e}(),WatermarkPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;i.watermarks={},i.timeTable={},i.onResize=function(){Object.values(i.watermarks).forEach((function(e){var t=e[0],o=e[1],r=i.computeCss(o);t.draw(r)}))},i.onTimeChange=function(e){var t=e.data.videoInfo.playtime;Object.entries(i.timeTable).forEach((function(e){var o=e[0],r=e[1],n=i.watermarks[o][0];n&&(r.some((function(e){var o=e.start,r=e.end;return t>o&&t<(void 0===r?1/0:r)}))?n.show():n.hide())}))},i.computeCss=function(e){var t=e.x,o=e.y,r=e.h,n=e.w,a=e.a,s=e.rw,l=void 0===s?0:s,c=i.player,p=c.container,d=c.videoSize,u=d.width,A=d.height;u<=0&&(u=p.clientWidth),A<=0&&(A=p.clientHeight);var _=l>0?Math.min(A,u)/l:1,E=t*_,g=o*_,f=r*_,h=n*_,v=Math.min(p.clientWidth/u,p.clientHeight/A),m=u*v,y=A*v,T=Math.max((p.clientWidth-m)/2,0),C=Math.max((p.clientHeight-y)/2,0),I=h*v,P=f*v,N=T+m-I-E*v,S=C+g*v,x={x:T,y:C,w:m,h:y},D={x:N,y:S,w:I,h:P},O={left:N+"px",top:S+"px",width:I+"px",height:P+"px",position:"absolute",display:"block",opacity:""+a/100};return i.isInScreen(x,D)||(O.display="none"),O},i.config=__assign$1(__assign$1({},i.player.config.watermarkConfig||{}),o),i.prepareDom(),window.addEventListener("resize",i.onResize),i.player.on(exports.PLAY_EVENT.TIME_UPDATE,i.onTimeChange);var n=i.config.defaultText;return n&&i.watermarkThis(n),i.initMutationObserver(),i.setupPlayerEvents(),i.listenFakeFullscreen(),i}return __extends$1(t,e),t.prototype.add=function(e,t){void 0===t&&(t=!1);var o=e.url,r=e.id;if(!this.watermarks[r]){var i={css:this.computeCss(e),cfg:{id:r,url:o,onerror:function(){this.remove()}}},n=new Watermark(this.$watermarkContainer,i,t);return this.watermarks[r]=[n,e],n}},t.prototype.watermarkThis=function(e,t){this.coverWatermarkParam=null;var o=this.player.container;o.querySelectorAll("."+WaterMarkCoverClassName$1).forEach((function(e){return e.remove()}));var r=t||{},i=r.strokeOpacity,n=void 0===i?.3:i,a=r.opacity,s=void 0===a?.3:a,l=document.createElement("div");return l.classList.add(WaterMarkCoverClassName$1),l.style.position="absolute",l.style.width="100%",l.style.height="100%",l.style.backgroundSize="30%",l.style.userSelect="none",l.style.zIndex="1",l.style.backgroundImage="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' height='200px' width='200px'><text stroke='black' stroke-width='1' stroke-opacity='"+n+"' transform='translate(20, 120) rotate(-30)' fill='rgb(222, 222, 222)' font-size='22' opacity='"+s+"'>"+e+'</text></svg>")',o.appendChild(l),this.coverWatermarkParam=[e,t],l},t.prototype.remove=function(e){var t,o=(null!==(t=this.watermarks[e])&&void 0!==t?t:[])[0];o&&(o.destroy(),delete this.watermarks[e],delete this.timeTable[e])},t.prototype.clear=function(){Object.values(this.watermarks).forEach((function(e){return e[0].destroy()})),this.watermarks={},this.timeTable={}},t.prototype.get=function(e){return this.watermarks[e]},t.prototype.schedule=function(e,t,o){this.timeTable[e]?this.timeTable[e].push({start:t,end:o}):this.timeTable[e]=[{start:t,end:o}]},t.prototype.unschedule=function(e){var t;delete this.timeTable[e];var o=(null!==(t=this.watermarks[e])&&void 0!==t?t:[])[0];null==o||o.hide()},t.prototype.destroy=function(){var t,o;e.prototype.destroy.call(this),window.removeEventListener("resize",this.onResize),this.mutationObserver.disconnect(),this.mutationObserver=null,(null===(t=this.$watermarkContainer)||void 0===t?void 0:t.parentNode)&&(null===(o=this.$watermarkContainer)||void 0===o||o.remove())},t.prototype.hookPlaySessionStart=function(){this.clear()},t.prototype.hookPlaySessionEnd=function(){},t.prototype.initMutationObserver=function(){var e=this;this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver((function(t){e.checkIsCoverWatermarkRemoved()})),this.mutationObserver.observe(this.player.container,{childList:!0,subtree:!0,attributes:!0})},t.prototype.checkIsCoverWatermarkRemoved=function(){if(this.coverWatermarkParam){var e=this.player.container.querySelector("."+WaterMarkCoverClassName$1);(null==e?void 0:e.offsetParent)||this.watermarkThis.apply(this,this.coverWatermarkParam)}},t.prototype.setupPlayerEvents=function(){var e=this;this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,(function(t){var o=t.data;e.watermarkLoadingDefer=new Promise((function(t){return __awaiter$1(e,void 0,void 0,(function(){var e,r,i,n,a,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(!(e=o.parseData))return[2];r=e.watermarkList,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,requestActionWatermark(null===(s=r)||void 0===s?void 0:s.action,1e3*e.duration)];case 2:return a=l.sent(),i=Object.keys(a.watermarks).map((function(e){return a.watermarks[e]})),n=a.schedules,[3,4];case 3:return l.sent(),[3,4];case 4:return i||(i=e.watermarkList.wi),t([i,n]),[2]}}))}))}))})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,(function(t){var o=t.data;return __awaiter$1(e,void 0,void 0,(function(){var e,t,r;return __generator$1(this,(function(i){switch(i.label){case 0:return o.isFirst?this.watermarkLoadingDefer?(t=(e=this.addPendingData).apply,r=[this],[4,this.watermarkLoadingDefer]):[3,2]:[2];case 1:t.apply(e,r.concat([i.sent()])),i.label=2;case 2:return[2]}}))}))})),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(t){var o=t.data;return __awaiter$1(e,void 0,void 0,(function(){var e,t,r;return __generator$1(this,(function(i){switch(i.label){case 0:return o.code!==exports.ErrorCode.SUC?[2]:(this.clear(),this.watermarkLoadingDefer?(t=(e=this.addPendingData).apply,r=[this],[4,this.watermarkLoadingDefer]):[3,2]);case 1:t.apply(e,r.concat([i.sent()])),i.label=2;case 2:return[2]}}))}))}))},t.prototype.addPendingData=function(e,t){var o=this;e&&e.forEach((function(e){return o.add(e,!e.action)})),t&&Object.keys(t).forEach((function(e){return t[e].forEach((function(t){return o.schedule(e,t.start,t.end)}))})),this.watermarkLoadingDefer=null},t.prototype.prepareDom=function(){var e=this.player.container;e.insertAdjacentHTML("beforeend",str),this.$watermarkContainer=e.querySelector('[data-role="txp-ui-watermark-mod"]')},t.prototype.isInScreen=function(e,t){var o=e.x,r=e.y,i=e.w,n=e.h,a=t.x,s=t.y,l=t.w,c=t.h;return!(a<o)&&(!(s<r)&&(!(a>o+i-l)&&s<=r+n-c))},t.prototype.listenFakeFullscreen=function(){var e=this;this.msg.on("pluginsetup:ctrlbar",(function(){e.player.plugins.ctrlbar.on("browserFullscreenChange",e.onResize)}))},t.pluginName=WatermarkPluginName$1,t}(Plugin),DRM_REQUEST_VALUE$1,DRM_CODE_FROM_VINFO$1;H5Player.registerPlugin(WatermarkPlugin.pluginName,WatermarkPlugin),function(e){e[e.NONE=0]="NONE",e[e.FAIRPLAY=16]="FAIRPLAY",e[e.WIDEVINE=32]="WIDEVINE",e[e.CHACHA20=8]="CHACHA20"}(DRM_REQUEST_VALUE$1||(DRM_REQUEST_VALUE$1={})),function(e){e[e.NONE=0]="NONE",e[e.FAIRPLAY=4]="FAIRPLAY",e[e.WIDEVINE=5]="WIDEVINE",e[e.CHACHA20=3]="CHACHA20"}(DRM_CODE_FROM_VINFO$1||(DRM_CODE_FROM_VINFO$1={}));var localDRMCache=DRM_REQUEST_VALUE$1.NONE,LOGIN_METHOD$1,COOKIE_NAME$1;function getRequestParamForDRM(e){return __awaiter$1(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(r){switch(r.label){case 0:return void 0!==e?[2,e]:localDRMCache?[2,localDRMCache]:(t=DRM_REQUEST_VALUE$1.NONE,uaTool.mobile?[2,t]:(window.WebAssembly&&(t|=DRM_REQUEST_VALUE$1.CHACHA20),(o=uaTool.browser.chrome&&comTool.compareVersion(uaTool.browser.version,"89.0")>0)?[4,videoTool.supportWidevine()]:[3,2]));case 1:o=r.sent(),r.label=2;case 2:return o?(t|=DRM_REQUEST_VALUE$1.WIDEVINE,localDRMCache=t):uaTool.browser.safari&&videoTool.supportFairplay()&&(t|=DRM_REQUEST_VALUE$1.FAIRPLAY,localDRMCache=t),[2,t]}}))}))}!function(e){e.QQ="qq",e.WX="wx"}(LOGIN_METHOD$1||(LOGIN_METHOD$1={})),function(e){e.MAIN_LOGIN="main_login",e.GUID="video_guid",e.OPENID="openid",e.APPID="appid",e.VUSERID="vuserid",e.ACCESS_TOKEN="access_token",e.VUSESSION="vusession"}(COOKIE_NAME$1||(COOKIE_NAME$1={}));var VQQ_COOKIE_PREFIX="vqq_";function getUserCookies(e){var t,o,r,i,n,a,s,l=cookieTool.get(COOKIE_NAME$1.MAIN_LOGIN);if(!l)return{};var c=l===LOGIN_METHOD$1.QQ,p=((t={})[COOKIE_NAME$1.ACCESS_TOKEN]=null!==(o=getCookieWithPrefix(COOKIE_NAME$1.ACCESS_TOKEN,c))&&void 0!==o?o:"",t[COOKIE_NAME$1.APPID]=null!==(r=getCookieWithPrefix(COOKIE_NAME$1.APPID,c))&&void 0!==r?r:"",t[COOKIE_NAME$1.VUSESSION]=null!==(i=getCookieWithPrefix(COOKIE_NAME$1.VUSESSION,c))&&void 0!==i?i:"",t[COOKIE_NAME$1.OPENID]=null!==(n=getCookieWithPrefix(COOKIE_NAME$1.OPENID,c))&&void 0!==n?n:"",t[COOKIE_NAME$1.VUSERID]=null!==(a=getCookieWithPrefix(COOKIE_NAME$1.VUSERID,c))&&void 0!==a?a:"",t[COOKIE_NAME$1.GUID]=null!==(s=cookieTool.get(COOKIE_NAME$1.GUID))&&void 0!==s?s:"",t[COOKIE_NAME$1.MAIN_LOGIN]=l,t);return validateCookie(p)?e?Object.keys(e).reduce((function(t,o){return t[e[o]]=p[o],t}),{}):p:{}}function getCookieWithPrefix(e,t){return void 0===t&&(t=!1),cookieTool.get(t?""+VQQ_COOKIE_PREFIX+e:e)}function validateCookie(e){return!!e[COOKIE_NAME$1.MAIN_LOGIN]&&!!(e[COOKIE_NAME$1.MAIN_LOGIN]!==LOGIN_METHOD$1.QQ||e[COOKIE_NAME$1.VUSERID]&&e[COOKIE_NAME$1.ACCESS_TOKEN])}function getRequestParamForPaidFormat(e){var t={spsfrhdr:0,spvideo:0,spaudio:0,defnpayver:0};return e.indexOf(exports.PAID_FORMAT.FHD)>-1&&(t.defnpayver|=1),e.indexOf(exports.PAID_FORMAT.UHD)>-1&&(t.defnpayver|=2),videoTool.supportHevc()&&videoTool.isHDRSupported()===HDR_CAPABILITY.SUPPORTED&&(e.indexOf(exports.PAID_FORMAT.HDR10)>-1&&(t.spvideo|=4,t.defnpayver|=4),e.indexOf(exports.PAID_FORMAT.SFR_HDR)>-1&&(t.spvideo|=4,t.spaudio|=64,t.spsfrhdr=100,t.defnpayver|=4),uaTool.browser.safari&&!uaTool.mobile&&e.indexOf(exports.PAID_FORMAT.DOLBY)>-1&&videoTool.isDolbyAtomsSupported()&&videoTool.isDolbyVisionSupported()&&(t.spaudio|=4,t.spvideo|=16,t.defnpayver|=4)),t}function commonSelectKernel(e){var t=e.codec,o=e.dltype,r=e.drm,i=void 0;return t===CODEC.H265?videoTool.supportHevc()?1===o?i=exports.KERNEL_NAME.ORIGIN:3!==o&&8!==o||(i=exports.KERNEL_NAME.HLS_JS):i=exports.KERNEL_NAME.WASM:1===o?i=exports.KERNEL_NAME.ORIGIN:8===o&&(i=exports.KERNEL_NAME.HLS_JS),r===DRM_CODE_FROM_VINFO$1.WIDEVINE?i=exports.KERNEL_NAME.HLS_JS:r===DRM_CODE_FROM_VINFO$1.FAIRPLAY?i=exports.KERNEL_NAME.ORIGIN:r===DRM_CODE_FROM_VINFO$1.CHACHA20&&t===CODEC.H264&&(i=exports.KERNEL_NAME.HLS_JS),i}exports.PAID_FORMAT=void 0,function(e){e.FHD="fhd",e.UHD="uhd",e.DOLBY="dolby",e.HDR10="hdr10",e.SFR_HDR="sfr_hdr"}(exports.PAID_FORMAT||(exports.PAID_FORMAT={}));var DEFAULT_GETINFO_CONFIG$2={path:"",retryCount:3,zbtype:0,test:0,timeout:6e3},_a$3,STREAM_TYPE$1,ZB_TYPE;!function(e){e[e.AUTO=0]="AUTO",e[e.FLV=1]="FLV",e[e.HLS=2]="HLS"}(STREAM_TYPE$1||(STREAM_TYPE$1={})),function(e){e[e.XUEYUAN=4]="XUEYUAN",e[e.CHRISTMAS=5]="CHRISTMAS",e[e.VERIFY=50]="VERIFY",e[e.SPORTS=100]="SPORTS",e[e.MARK=200]="MARK"}(ZB_TYPE||(ZB_TYPE={}));var ZB_CGI_MAP=(_a$3={0:["//infozb6.video.qq.com/?","//bkinfozb6.video.qq.com/?"]},_a$3[ZB_TYPE.XUEYUAN]="//innerzb.video.qq.com/?",_a$3[ZB_TYPE.VERIFY]="//auth.zb.qq.com/?",_a$3[ZB_TYPE.MARK]="//infozb.pcg.com:8080/?",_a$3),ZB_CGI_TEST$1="//test.zb.video.qq.com",LIVE_GET_INFO_DATA_KEYS$1;!function(e){e.playtime="live-getinfo:playtime",e.livesid="live-getinfo:livesid",e.isuserpay="live-getinfo:isuserpay",e.cpay="live-getinfo:cpay",e.restpreviewcnt="live-getinfo:resetpreviewcnt"}(LIVE_GET_INFO_DATA_KEYS$1||(LIVE_GET_INFO_DATA_KEYS$1={}));var playErrDataMap=new Map([["videoPlayError",{name:"setErrorView",params:{msg:"对不起，获取视频信息错误~"}}],["areaLimit",{name:"setErrorView",params:{msg:"对不起，您所在区域无法观看此视频~"}}],["bandWidthLimit",{name:"setErrorView",params:{msg:"暂时无法观看此视频，请您稍后再试~"}}],["msgInterrupt",{name:"setErrorView",params:{msg:"对不起，视频信息中断了~"}}],["msgInterrupt",{name:"setErrorView",params:{msg:"对不起，视频信息中断了~"}}],["videoNotBegin",{name:"setErrorView",params:{hideRefresh:!0,hideCode:!0,msg:"本次直播未开始，敬请关注！"}}],["videoIsOver",{name:"setErrorView",params:{isOver:!0,hideRefresh:!0,hideCode:!0,msg:"本次直播已结束，敬请关注！"}}],["numOfPeopleLimit",{name:"setQueueFullView"}],["mustLogin",{name:"setErrorView",params:{msg:"缺乏用户登录信息"}}],["isNotInPlayList",{name:"setErrorView",params:{msg:"登录用户不在白名单"}}],["getLoginInfoFailed",{name:"setErrorView",params:{msg:"获取登录信息失败，请您尝试重新登录~"}}],["showPayTip",{name:"showPayTips",params:{cmd:1}}],["copyrightLimit",{name:"setErrorView",params:{msg:"由于版权方要求，此内容暂不支持播放"}}],["universalTip",{name:"setErrorView",params:{msg:"播放错误，请稍后再试~"}}],["videoCannotFind",{name:"setErrorView",params:{msg:"当前没有正在直播的节目~"}}],["notSptDrm",{name:"setErrorView",params:{msg:"为保护版权，本内容已加密，此浏览器暂不支持观看"}}]]);function getSpHttps$2(){return"https:"===location.protocol?1:0}function getTimeStampStr$2(e){var t=e||10,o=(+new Date).toString();return o.length>t?o.substring(0,t):("00000000000"+o).slice(-1*t)}var DEFAULT_REQ_PARAMS$2={cmd:2,cnlid:"",pla:0,stream:STREAM_TYPE$1.HLS,system:0,appVer:"1.0.0.0",encryptVer:"",qq:0,device:"PC",guid:"",flowid:"",defn:"",host:location.host,livepid:"",logintype:1,vip_status:1,livequeue:1,fntick:"",tm:"",sdtfrom:"10201",platform:"10201",cKey:"",queueStatus:0,sphttps:getSpHttps$2(),vkey:"",user:"",playbacktime:0,auth_from:"",auth_ext:"",logintoken:"",forcedefn:"",defauto:1},JsonpRequestor$1=function(){function e(e){this._jsonpPrefix=e}return e.prototype.start=function(e,t,o){var r=o.timeout,i=void 0===r?DEFAULT_GETINFO_CONFIG$2.timeout:r;return netTool.jsonp(e,{query:t,timeout:i,charset:"utf-8",name:""+this._jsonpPrefix+Math.floor(1e6*Math.random())})},e}();function isNormalCode(e){return-1!==[0,10,11,13].indexOf(e)}function isRetryCode(e){return-1!==[9,23,24,26,27,28,32,44,47,50,52,56,57,62,-80004,-80003].indexOf(e)}function getPayActionData$1(e){return 1!==e.ispay||1===e.iretdetailcode?1===e.iretdetailcode?{name:"execVIPRight",params:{msg:"本直播需付费观看",type:"backplay",refer:113}}:{downgradeLevel:!0,name:"unlock1080p",params:{msg:"此清晰度需要付费观看",type:"flash.live.1080p"}}:{name:"showPayTips",params:{msg:"本直播需付费观看",cmd:3}}}function getErrorData$1(e){var t={};t[1]=playErrDataMap.get("videoPlayError"),t[2]=playErrDataMap.get("areaLimit"),t[3]=playErrDataMap.get("areaLimit"),t[4]=playErrDataMap.get("bandWidthLimit"),t[5]=playErrDataMap.get("areaLimit"),t[6]=playErrDataMap.get("msgInterrupt"),t[7]=playErrDataMap.get("videoNotBegin"),t[8]=playErrDataMap.get("videoIsOver"),t[9]=playErrDataMap.get("numOfPeopleLimit"),t[16]=playErrDataMap.get("mustLogin"),t[18]=playErrDataMap.get("isNotInPlayList");var o=getPayActionData$1(e);t[25]=o,t[28]=playErrDataMap.get("getLoginInfoFailed"),t[30]=o,t[31]=o,t[32]=playErrDataMap.get("getLoginInfoFailed"),t[45]=playErrDataMap.get("showPayTip"),t[51]=playErrDataMap.get("videoCannotFind"),t[67]=playErrDataMap.get("copyrightLimit"),t[97]=playErrDataMap.get("notSptDrm");var r=e.iretcode,i=t[String(r)];return i=i||playErrDataMap.get("universalTip")}function parseCodecInfo$2(e){var t=CODEC.H264;return 2===(null==e?void 0:e.vcode)&&(t=CODEC.H265),t}function selectKernel$2(e){var t=(e||{}).drmtype;return commonSelectKernel({codec:parseCodecInfo$2(e),dltype:3,drm:t})}var checkResponseMiddleWare$2=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r;return __generator$1(this,(function(i){switch(i.label){case 0:return void 0===(o=e.resData.iretcode)?(e.throw(exports.ErrorCode.GETINFO_PARSE,exports.ErrorMsg.GETINFO_PARSE,getErrorData$1(e.resData)),[2]):isNormalCode(o)?[4,t()]:(r=""+exports.ErrorCode.GETINFO_LIVE_SERVER_CODE_PREFIX+("000"+o).slice(-3),e.throw(r,exports.ErrorMsg.GETINFO_CODE,getErrorData$1(e.resData)),[2]);case 1:return i.sent(),[2]}}))}))},parseResponseMiddleWare$2=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i;return __generator$1(this,(function(n){switch(n.label){case 0:return o=e.resData,r=o.formats instanceof Array?o.formats:[],e.parseData={preview:+o.playtime,urls:[{url:o.playurl}].concat(o.backurl_list),definitionList:r.map((function(e){return{id:e.id,name:e.fn,cname:e.fnname,sname:e.defnname,resolution:e.defnrate,sl:e.fn===o.defn?1:0,lmt:e.vip||0}})),watermarkList:{wi:o.brandpos?[o.brandpos]:[]}},null===(i=e.parseData.definitionList)||void 0===i||i.reverse(),e.logger.log("parse ",e.parseData),[4,t()];case 1:return n.sent(),[2]}}))}))},Qvsec$1={};function updateCkey$2(e,t){var o=e.cnlid,r=e.platform,i=e.sdtfrom,n=(new Date).getDay(),a="7."+(0===n?7:n),s=(null==t?void 0:t.svrtick)>0?(""+1e3*(null==t?void 0:t.svrtick)).substring(0,10):getTimeStampStr$2(),l=Qvsec$1.$xx(r,o,i,1,s,a);return e.tm=s,e.fntick=s,e.cKey=l,e.encryptVer=a,e}Qvsec$1.ha=function(e){for(var t=[],o=0;o<64;)t[o]=0|4294967296*Math.abs(Math.sin(++o));function r(e,t){return((e>>1)+(t>>1)<<1)+(1&e)+(1&t)}return function(e){for(var o,i,n,a,s=[],l=unescape(encodeURI(e)),c=l.length,p=[o=1732584193,i=-271733879,~o,~i],d=0;d<=c;)s[d>>2]|=(l.charCodeAt(d)||128)<<d++%4*8;for(s[e=16*(c+8>>6)+14]=8*c,d=0;d<e;d+=16){for(c=p,a=0;a<64;)c=[n=c[3],r(o=c[1],(n=r(r(c[0],[o&(i=c[2])|~o&n,n&o|~n&i,o^i^n,i^(o|~n)][c=a>>4]),r(t[a],s[[a,5*a+1,3*a+5,7*a][c]%16+d])))<<(c=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*c+a++%4])|n>>>32-c),o,i];for(a=4;a;)p[--a]=r(p[a],c[a])}for(e="";a<32;)e+=(p[a>>3]>>4*(1^7&a++)&15).toString(16);return e}}(),Qvsec$1.stringToHex=function(e){for(var t="",o=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),r=0;r<e.length;r++)t+=o[e.charCodeAt(r)>>4]+o[15&e.charCodeAt(r)];return t},Qvsec$1.hexToString=function(e){for(var t="",o="0x"==e.substr(0,2)?2:0;o<e.length;o+=2)t+=String.fromCharCode(parseInt(e.substr(o,2),16));return t},Qvsec$1._Seed="#$#@#*ad",Qvsec$1.tempcalc=function(e,t){for(var o="",r=0;r<e.length;r++)o+=String.fromCharCode(e.charCodeAt(r)^t.charCodeAt(r%4));return o},Qvsec$1.u1=function(e,t){for(var o="",r=t;r<e.length;r+=2)o+=e.charAt(r);return o},Qvsec$1._urlStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Qvsec$1.urlenc=function(e,t,o){for(var r,i,n,a,s,l,c,p="",d=0;d<e.length;)r=e.charCodeAt(d++),i=e.charCodeAt(d++),n=e.charCodeAt(d++),15==d&&(p+="A",p+=t,p+=o),a=r>>2,s=(3&r)<<4|i>>4,l=(15&i)<<2|n>>6,c=63&n,isNaN(i)?l=c=64:isNaN(n)&&(c=64),p=p+Qvsec$1._urlStr.charAt(a)+Qvsec$1._urlStr.charAt(s)+Qvsec$1._urlStr.charAt(l)+Qvsec$1._urlStr.charAt(c);return p},Qvsec$1.$xx=function(e,t,o,r,i,n){var a="123456";if(n.length<3)return"err";if("7."!=n.substr(0,2))return"err";var s=n.substr(2);"1"==s&&(a="06fc1464"),"2"==s&&(a="4244ce1b"),"3"==s&&(a="77de31c5"),"4"==s&&(a="e0149fa2"),"5"==s&&(a="60394ced"),"6"==s&&(a="2da639f0"),"7"==s&&(a="c2f0cf9f");i=i||parseInt(+new Date/1e3),r=(""+r).charAt(0);return Qvsec$1.ha(a+t+i+"*#06#"+e)};var prepareRequestMiddleWare$1=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i;return __generator$1(this,(function(n){switch(n.label){case 0:return o=e.reqParams,e.reqParams.queueStatus=(null===(i=e.resData)||void 0===i?void 0:i.queue_status)||0,updateCkey$2(o,e.resData),[4,getRequestParamForDRM(o.livedrm)];case 1:return r=n.sent(),o.livedrm=r,o.playbackdrm=r,e.logger.log("request params is:",jsonTool.safelyStringify(e.reqParams)),[4,t()];case 2:return n.sent(),[2]}}))}))};function getRequestUrl$2(e,t){var o=e.test,r=e.path,i=e.zbtype;if(o)return ZB_CGI_TEST$1;var n=r||ZB_CGI_MAP[void 0===i?0:i];return"string"==typeof n?n:n[t%n.length]}var sendRequestMiddleWare$2=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l,c,p;return __generator$1(this,(function(d){switch(d.label){case 0:e.logger.log("doRequest start..."),o=e.requestor,r=e.reqParams,i=e.config,n=i.retryCount,s=0,d.label=1;case 1:if(!(s<n+1))return[3,7];e.logger.log("retry... count is: ",s),d.label=2;case 2:return d.trys.push([2,4,,5]),a=null,e.reqPath=getRequestUrl$2(i,s),l=e,[4,o.start(e.reqPath,r,i)];case 3:return l.resData=d.sent(),[3,5];case 4:return c=d.sent(),e.resData=null,e.logger.log("the "+s+" retry err:",c),"jsonp timeout"===(null==c?void 0:c.message)&&(a={code:exports.ErrorCode.GETINFO_TIMEOUT,message:exports.ErrorMsg.GETINFO_TIMEOUT}),[3,5];case 5:if(e.endTime=+new Date,e.alreadyRetryCount=s,e.resData){if(isNormalCode(p=e.resData.iretcode)||!isRetryCode(p))return[3,7];updateCkey$2(r,e.resData)}d.label=6;case 6:return s++,[3,1];case 7:return e.endTime=+new Date,e.resData?(e.logger.log("sendRequest over... ret is: ",jsonTool.safelyStringify(e.resData)),[4,t()]):(e.throw((null==a?void 0:a.code)||exports.ErrorCode.GETINFO_NET,(null==a?void 0:a.message)||exports.ErrorMsg.GETINFO_NET),[2]);case 8:return d.sent(),[2]}}))}))},setPlayerDataMiddleWare$2=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n;return __generator$1(this,(function(a){switch(a.label){case 0:return o=e.player,r=e.resData,i=e.parseData,o.setCommonKv(((n={preview:i.preview,drm:r.drmtype})[COMMON_DATA_KEY.cdnid]=r.cdn_name,n[LIVE_GET_INFO_DATA_KEYS$1.isuserpay]=r.isuserpay,n[LIVE_GET_INFO_DATA_KEYS$1.livesid]=r.livesid,n[LIVE_GET_INFO_DATA_KEYS$1.playtime]=r.playtime,n[LIVE_GET_INFO_DATA_KEYS$1.cpay]=r.ispay,n[LIVE_GET_INFO_DATA_KEYS$1.restpreviewcnt]=r.restpreviewcnt,n)),[4,t()];case 1:return a.sent(),[2]}}))}))};function compose$2(e){return function(t,o){var r=-1;return function i(n){if(n<=r)return Promise.reject(new Error("next() called multiple times"));r=n;var a=e[n];n===e.length&&(a=o);if(!a)return Promise.resolve(null);try{return Promise.resolve(a(t,i.bind(null,n+1)))}catch(e){return Promise.reject(e)}}(0)}}var GetInfoLive=function(e){function t(t,o,r){var i,n=e.call(this,t,o,r)||this;return n._abort=!1,n._seq=0,n._config=__assign$1(__assign$1(__assign$1({},DEFAULT_GETINFO_CONFIG$2),(null===(i=t.config)||void 0===i?void 0:i.getinfoLiveConfig)||{}),o),n.logger=new Logger(t.config.instanceId,"GetInfoLive"),n}return __extends$1(t,e),t.prototype.request=function(e,t){var o=this,r=e,i=__assign$1(__assign$1(__assign$1({},DEFAULT_REQ_PARAMS$2),{appVer:this.player.getCommonKv(COMMON_DATA_KEY.appVer),platform:this.player.getCommonKv(COMMON_DATA_KEY.platform),sdtfrom:this.player.getCommonKv(COMMON_DATA_KEY.sdtfrom),flowid:this.player.getCommonKv(COMMON_DATA_KEY.flowid),guid:this.player.getCommonKv(COMMON_DATA_KEY.guid),livepid:this.player.getCommonKv(COMMON_DATA_KEY.livepid),cnlid:r}),t);this._abort=!1,this._seq+=1;var n={player:this.player,startTime:+new Date,endTime:0,alreadyRetryCount:0,config:this._config,reqParams:i,reqPath:void 0,resData:void 0,requestor:new JsonpRequestor$1("livegetinfo_callback_"),parseData:void 0,error:void 0,throw:function(e,t,o){var r=new Error("getinfo err");throw r.code=e,r.message=t,r.data=o,r},seq:this._seq,urlConfig:null,logger:this.logger},a=["cnlid","platform","sdtfrom","guid"].find((function(e){return!i[e]}));if(a)return n.error={code:exports.ErrorCode.GETINFO_INNER,message:"缺少必要播放参数 ("+a+") "},Promise.resolve(this.formatOutputData(n));var s=this._config.prepareRequestMiddleWare||prepareRequestMiddleWare$1,l=this._config.sendRequestMiddleWare||sendRequestMiddleWare$2,c=this._config.checkResponseMiddleWare||checkResponseMiddleWare$2,p=this._config.parseResponseMiddleWare||parseResponseMiddleWare$2;this._middlewares=[s,l,c,p,setPlayerDataMiddleWare$2];var d=compose$2(this._middlewares),u=new Promise((function(){}));return d(n).then((function(){return o._abort||o._seq!==n.seq?u:(o.logger.log("getinfo 成功: ",n),o.formatOutputData(n))})).catch((function(e){if(o._abort||o._seq!==n.seq)return u;var t=e.code,r=e.message;return t||(o.logger.warn("getinfo 内部错误: ",e),t=exports.ErrorCode.GETINFO_INNER,r=exports.ErrorMsg.GETINFO_INNER+", err ("+e+")"),n.error={code:t,message:r,data:e.data},o.formatOutputData(n)}))},t.prototype.abort=function(){this._abort=!0},t.prototype.destroy=function(){this.abort(),this._middlewares=null,e.prototype.destroy.call(this)},t.prototype.formatOutputData=function(e){var t,o,r=e.resData,i=e.parseData,n=__assign$1({},e);["requestor","player","throw"].forEach((function(e){delete n[e]}));var a=void 0,s=this.player.getCommonKv(COMMON_DATA_KEY.drm),l=parseCodecInfo$2(r),c=selectKernel$2(r);if(r&&i){var p=null==i?void 0:i.urls.map((function(e){return e.url})),d=p[0],u=p.slice(1),A=(null===(t=null==r?void 0:r.drmckc)||void 0===t?void 0:t.split("|"))||[],_=A[0],E=A[1];a={url:d,backupUrls:u,drmConfig:_?this.prepareDRMConfig({drmType:s,licenseUrl:_,certificateUrl:E}):null,chachaParam:s===DRM_TYPE.CHACHA?{cnlid:null===(o=e.reqParams.cnlid)||void 0===o?void 0:o.substring(0,e.reqParams.cnlid.length-2),baseKey:null==r?void 0:r.deckey,randoms:null==r?void 0:r.randoms}:null,p2pConfig:this.prepareP2PConfig({keyId:r.livesid,useP2P:!!r.hlsp2p,downloadMode:0}),drmType:s,vcodec:l}}return this.player.setCommonKv(COMMON_DATA_KEY.codec,l),__assign$1(__assign$1({},n),{kernelName:c,urlConfig:a})},t.prototype.prepareDRMConfig=function(e){var t,o,r=e.drmType,i=e.licenseUrl,n=e.certificateUrl,a=this.player.getCommonKv,s=((t={})[DRM_TYPE.FAIR_PLAY]=KeySystems.FairPlayWebKit,t[DRM_TYPE.WIDEVINE]=KeySystems.Widevine,t),l={licenseUrl:i,certificate:{},keySystem:s[r],licenseRequestSetup:function(e){if(r===DRM_TYPE.FAIR_PLAY){e.responseType="text";var t={guid:a(COMMON_DATA_KEY.guid)},o=Object.keys(t).map((function(e){return e+"="+t[e]})).join("&");return e.body=e.body+"&"+o,e}return e},licenseResponseSetup:function(e){return r===DRM_TYPE.FAIR_PLAY?stringTool.base64ToUint8Array(e):e}};return r===DRM_TYPE.FAIR_PLAY&&(l.certificate=((o={})[s[r]]=n,o)),l},t.prototype.prepareP2PConfig=function(e){return __assign$1({flowId:this.player.getCommonKv(COMMON_DATA_KEY.flowid),playerInfo:this.getPlayerInfo()},e)},t.prototype.getPlayerInfo=function(){var e={platform:this.player.getCommonKv(COMMON_DATA_KEY.platform)||"",osVer:this.player.getCommonKv(COMMON_DATA_KEY.osver)||"",broVer:this.player.getCommonKv(COMMON_DATA_KEY.ua)||"",playerVer:this.player.getCommonKv(COMMON_DATA_KEY.playerver)||"",guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)||"",qq:"",wx:"",vip:!1},t=this.player.getCommonKv(COMMON_DATA_KEY.hc_main_login);return"qq"===t?e.qq=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid):"wx"===t&&(e.wx=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid)),e},t.pluginName="__thumbplayer-video-request",t}(Plugin),PATH={COMMON:["//h5vv6.video.qq.com/getvinfo","//bkh5vv.video.qq.com/getvinfo","//av.video.qq.com/getvinfo"],TEST:"//testvv.video.qq.com/geth5info?"},CKEY_VRE,VOD_GET_INFO_DATA_KEYS;!function(e){e.CKEY_8="8.1",e.CKEY_9="9.1"}(CKEY_VRE||(CKEY_VRE={})),function(e){e.videoType="vod-getinfo:videoType",e.videoCharged="vod-getinfo:videoCharged",e.userPayType="vod-getinfo:userPayType",e.vipToken="vod-getinfo:vipToken",e.ckey="vod-getinfo:ckey",e.ckeyVersion="vod-getinfo:ckeyVersion",e.cginame="vod-getinfo:cginame",e.vurl="vod-getinfo:vurl"}(VOD_GET_INFO_DATA_KEYS||(VOD_GET_INFO_DATA_KEYS={}));var URL_EXPIRE_TIME=72e5,VideoType={1:"H264",2:"H265",3:"HDR10",4:"DolbyVision",5:"None(Audio Only)",6:"SDR+",7:"SDR",8:"T265",9:"IMax",10:"SFR_HDR(60FPS)",11:"SFR4X_HDR(120FPS)",12:"SFR3X_HDR(90FPS)",13:"AVS3",14:"AV1",15:"TIE_V2",16:"SFR_TIE_V2(60FPS)",17:"SFR3X_TIE_V2(90FPS)",18:"SFR4X_TIE_V2(120FPS)",19:"CUVA-HDR",20:"VVC(O266)",21:"O264",26:"VAV1"},DEFAULT_GETINFO_CONFIG$1={path:"",retryCount:3,test:0,timeout:6e3,ckeyVer:CKEY_VRE.CKEY_8};function getRefer(){var e="";try{e=removeUrlParams(document.location.href),isInIframe()&&(e=removeUrlParams(document.referrer||""))}catch(e){}return e}function removeUrlParams(e){if("string"==typeof e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname}}function getEhost(){var e="";try{e=location.href.replace(location.search,""),isInIframe()&&(e=removeUrlParams(top.location.href||""))}catch(e){}return e}function isTencentVideoSite(){return"v.qq.com"===location.hostname||"film.qq.com"===location.hostname}function isInIframe(){try{return window.self!==window.top}catch(e){return!0}}function getSpHttps$1(){return"https:"===location.protocol?1:0}function getTimeStampStr$1(e){var t=e||10,o=(+new Date).toString();return o.length>t?o.substring(0,t):("00000000000"+o).slice(-1*t)}function constructM3U8(e,t,o){return o.replace(t,e)}var DEFAULT_REQ_PARAMS$1={charge:0,otype:"json",defnpayver:isTencentVideoSite()?1:0,spau:1,spaudio:1,spwm:1,sphls:uaTool.mobile?1:2,host:location.host,refer:getRefer(),ehost:getEhost(),sphttps:getSpHttps$1(),encryptVer:"",cKey:"",clip:4,guid:"",flowid:"",platform:"",sdtfrom:"",appVer:"1.0.0.0",unid:"",auth_from:"",auth_ext:"",vid:"",defn:"",fhdswitch:0,dtype:3,spsrt:2,tm:"",lang_code:0,logintoken:""},JsonpRequestor=function(){function e(e){this._jsonpPrefix=e}return e.prototype.start=function(e,t,o){var r=o.timeout,i=void 0===r?DEFAULT_GETINFO_CONFIG$1.timeout:r;return netTool.jsonp(e,{query:t,timeout:i,charset:"utf-8",name:""+this._jsonpPrefix+Math.floor(1e6*Math.random())})},e}(),checkResponseMiddleWare$1=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l,c,p;return __generator$1(this,(function(d){switch(d.label){case 0:return o=e.resData,r=e.player,i=void 0===o.em?0:+o.em,n=+o.exem,a=((null===(p=o.vl)||void 0===p?void 0:p.vi)||[])[0],r.setCommonKv(((l={})[COMMON_DATA_KEY.uip]=o.ip,l[COMMON_DATA_KEY.hh_ip]=o.ip,l[VOD_GET_INFO_DATA_KEYS.vipToken]=getTokenValue(o.report||"","vip_token"),l)),a&&r.setCommonKv(((c={})[VOD_GET_INFO_DATA_KEYS.videoCharged]=a.ch,c[VOD_GET_INFO_DATA_KEYS.userPayType]=computePayType(a.st,a.ch),c[VOD_GET_INFO_DATA_KEYS.videoType]=a.videotype,c)),0===i&&a&&(8!==a.st&&(isNaN(n)||0===n)||0!=+o.preview||(i=83)),0!==i?(s=""+exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX+("000"+i).slice(-3)+(isNaN(n)?"":"."+n),e.throw(s,exports.ErrorMsg.GETINFO_CODE),[2]):"o"===o.s&&a?[4,t()]:(e.throw(exports.ErrorCode.GETINFO_PARSE,exports.ErrorMsg.GETINFO_PARSE),[2]);case 1:return d.sent(),[2]}}))}))};function computePayType(e,t){var o=0;return 8===e?o=1:2===e&&(t>0?o=2:0===t&&(o=0)),o}function getTokenValue(e,t){var o=(e.split("$").map((function(e){return e.split("=")})).find((function(e){return e[0]===t}))||[])[1];return+(void 0===o?"0":o)}function getHlsUrls(e){return e.vl.vi[0].ul.ui.map((function(e){var t;return e.url&&(null===(t=e.hls)||void 0===t?void 0:t.pt)?{url:e.url+e.hls.pt,vt:e.vt}:{url:e.url,vt:e.vt}}))}function getM3U8Proxy(e){var t,o,r=e.play;return[{url:null!==(o=null===(t=r.masterurl)||void 0===t?void 0:t[0])&&void 0!==o?o:"keyid://"+r.keyid+".m3u8",vt:e.vl.vi[0].ul.ui[0].vt}]}function getMp4Url(e,t,o,r,i,n){for(var a,s,l=[],c=e.ui.length,p=0;p<c;p++)s={url:"",vt:0},(a=e.ui[p]).url&&(a.url&&-1===a.url.indexOf(t+".flv")&&-1===a.url.indexOf(t+".mp4")?s.url=a.url+o:s.url=a.url,a.vt&&(s.vt=parseInt(a.vt,10)),-1===s.url.indexOf("sdtfrom")&&(s.url.indexOf("?")>-1?s.url+="&sdtfrom="+i:s.url+="?sdtfrom="+i,s.url+="&guid="+n+"&vkey="+r),l.push(s));return l}function getUrls(e,t,o){var r,i,n,a,s,l,c,p;if(!((null===(n=null===(i=null===(r=e.vl)||void 0===r?void 0:r.vi[0].ul)||void 0===i?void 0:i.ui)||void 0===n?void 0:n.length)>0))return[];var d=e.dltype,u=(null===(a=e.vl)||void 0===a?void 0:a.vi)[0],A=u.fn,_=u.fvkey;if(3===d||8===d){if(e.play)return getM3U8Proxy(e);var E=getHlsUrls(e);if(8===d){var g=e.vl.vi[0].ul.m3u8,f=g&&!(g.indexOf("#EXTINF:")>0||g.indexOf("EXT-X-TARGETDURATION:")>0),h=E[0].url,v={};f?E.forEach((function(e){v[e.url]=constructM3U8(e.url,h,g)})):v[h]=g,E.m3u8=v}return E}if(1===d){var m=(null===(l=null===(s=u.cl)||void 0===s?void 0:s.ci)||void 0===l?void 0:l.length)||0,y=u.fvkey&&u.fn&&(null===(p=null===(c=u.ul)||void 0===c?void 0:c.ui)||void 0===p?void 0:p.length)>0;if(m<=0&&y)return getMp4Url(u.ul,u.lnk,A,_,t,o)}return[]}function getDrm(e){var t,o=((null===(t=null==e?void 0:e.fl)||void 0===t?void 0:t.fi)||[]).find((function(e){return 1==+e.sl}));return o?+o.drm:0}function getPreview(e){var t,o=(null===(t=e.vl)||void 0===t?void 0:t.vi)[0],r=+e.em,i=+e.exem,n=+e.preview;return isNaN(r)||0!==r||0===n?0:i>0||8==+o.st?n:0}function parseCodecInfo$1(e){var t,o,r,i=CODEC.H264,n=((null===(t=null==e?void 0:e.vl)||void 0===t?void 0:t.vi)||[])[0],a=null===(r=null===(o=null==e?void 0:e.fl)||void 0===o?void 0:o.fi)||void 0===r?void 0:r.find((function(e){return 1===e.sl})),s=null==a?void 0:a.video;n&&(1===n.hevc&&(i=CODEC.H265));return{vtype:VideoType[s],codec:i}}function selectKernel$1(e){var t,o,r=(e||{}).dltype,i=null===(o=null===(t=null==e?void 0:e.fl)||void 0===t?void 0:t.fi)||void 0===o?void 0:o.find((function(e){return 1===e.sl}));return commonSelectKernel({codec:parseCodecInfo$1(e).codec,dltype:r,drm:null==i?void 0:i.drm})}var parseResponseMiddleWare$1=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l,c,p,d,u,A,_,E;return __generator$1(this,(function(g){switch(g.label){case 0:return o=e.resData,r=e.reqParams,i=(null===(d=o.vl)||void 0===d?void 0:d.vi)[0],n=i.td,a=i.ti,s=i.vh,l=i.vw,c=i.br,p=i.fs,e.parseData={preview:getPreview(o),vitem:i,duration:n,title:a,byteRate:c,videoHeight:s,videoWidth:l,fileSize:p,urls:getUrls(o,r.sdtfrom,r.guid),definitionList:null===(u=o.fl)||void 0===u?void 0:u.fi,subtitleList:null===(A=o.sfl)||void 0===A?void 0:A.fi,watermarkList:i.wl,previewList:i.pl?null===(_=i.pl[0])||void 0===_?void 0:_.pd:[]},null===(E=e.parseData.definitionList)||void 0===E||E.reverse(),e.logger.log("parse ",e.parseData),[4,t()];case 1:return g.sent(),[2]}}))}))},_thumbplayerCkeyWasmFactory=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,o,r;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){o=e,r=t}));var i,n,a,s={};for(i in t)t.hasOwnProperty(i)&&(s[i]=t[i]);n="object"==typeof window,a="function"==typeof importScripts;var l,c="";(n||a)&&(a?c=self.location.href:"undefined"!=typeof document&&document.currentScript&&(c=document.currentScript.src),_scriptDir&&(c=_scriptDir),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"",a&&(l=function(e){try{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}catch(t){if(e=L(e))return e;throw t}}));var p,d=t.printErr||console.warn.bind(console);for(i in s)s.hasOwnProperty(i)&&(t[i]=s[i]);s=null,t.wasmBinary&&(p=t.wasmBinary),t.noExitRuntime;var u=!1;function A(e){var o=t["_"+e];return o||N("Assertion failed: Cannot call unknown function "+e+", make sure it is exported"),o}function _(e,t,o,r){var i={string:function(e){var t=0;if(null!=e&&0!==e){var o=1+(e.length<<2);g(e,t=k(o),o)}return t},array:function(e){var t=k(e.length);return f.set(e,t),t}},n=A(e),a=[];if(e=0,r)for(var s=0;s<r.length;s++){var l=i[o[s]];l?(0===e&&(e=V()),a[s]=l(r[s])):a[s]=r[s]}return o=function(e){if("string"===t)if(e){for(var o=h,r=e+NaN,i=e;o[i]&&!(i>=r);)++i;if(16<i-e&&o.subarray&&E)e=E.decode(o.subarray(e,i));else{for(r="";e<i;){var n=o[e++];if(128&n){var a=63&o[e++];if(192==(224&n))r+=String.fromCharCode((31&n)<<6|a);else{var s=63&o[e++];65536>(n=224==(240&n)?(15&n)<<12|a<<6|s:(7&n)<<18|a<<12|s<<6|63&o[e++])?r+=String.fromCharCode(n):(n-=65536,r+=String.fromCharCode(55296|n>>10,56320|1023&n))}}else r+=String.fromCharCode(n)}e=r}}else e="";else e="boolean"===t?!!e:e;return e}(o=n.apply(null,a)),0!==e&&B(e),o}var E="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function g(e,t,o){var r=h;if(0<o){o=t+o-1;for(var i=0;i<e.length;++i){var n=e.charCodeAt(i);if(55296<=n&&57343>=n&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++i)),127>=n){if(t>=o)break;r[t++]=n}else{if(2047>=n){if(t+1>=o)break;r[t++]=192|n>>6}else{if(65535>=n){if(t+2>=o)break;r[t++]=224|n>>12}else{if(t+3>=o)break;r[t++]=240|n>>18,r[t++]=128|n>>12&63}r[t++]=128|n>>6&63}r[t++]=128|63&n}}r[t]=0}}var f,h,v,m=[],y=[],T=[];function C(){var e=t.preRun.shift();m.unshift(e)}var I=0,P=null;function N(e){throw t.onAbort&&t.onAbort(e),d(e),u=!0,e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info."),r(e),e}t.preloadedImages={},t.preloadedAudios={};var S="data:application/octet-stream;base64,",x="data:application/octet-stream;base64,AGFzbQEAAAABcBFgAX8Bf2ACf38AYAN/f38AYAF/AGACf38Bf2AAAGADf39+AGAAAX9gA39/fgF/YAZ/f35/fn8Bf2AEf35/fwF/YAR/f39/AGAIf39/f39/f38AYAR/f39+AGACf34AYAN/f38Bf2AGf39/f39/AX8CGQQBYQFhAAUBYQFiAA8BYQFjAAABYQFkAAcDOTgAAQMAAQAAAgALAAECAQECBgQCAwADAQYABQMCAAAADAEAAAABAQECBQ0CAQ4AAAADBxAJCgQIBAQFAXABBgYFBgEBgAKAAgYJAX8BQbCVwAILByEIAWUCAAFmAB0BZwEAAWgANgFpADUBagA0AWsAMwFsACEJCwEAQQELBTs6OTg3CpW1AThkAQF/IwBBEGsiASAANgIMIAEgASgCDC0AADYCCCABIAEoAgggASgCDC0AAUEIdHI2AgggASABKAIIIAEoAgwtAAJBEHRyNgIIIAEgASgCCCABKAIMLQADQRh0cjYCCCABKAIIC3IBAX8jAEEQayICIAA2AgwgAiABNgIIIAIoAgwgAigCCDoAACACIAIoAghBCHY2AgggAigCDCACKAIIOgABIAIgAigCCEEIdjYCCCACKAIMIAIoAgg6AAIgAiACKAIIQQh2NgIIIAIoAgwgAigCCDoAAwsaAQF/IAAQDgRAIAAQJyEBIAAQJhogARAXCwszAQF/IwBBEGsiASQAIAEgADYCDCMAQRBrIgAgASgCDDYCDCAAKAIMIQAgAUEQaiQAIAALagEBfyMAQSBrIgIkACACIAA2AhwgAiABNgIYIAIoAhwiACACQRBqIAJBCGoQHyAAIAIoAhgCfyACKAIYIQEjAEEQayIAJAAgACABNgIMIAAoAgwQICEBIABBEGokACABCxArIAJBIGokAAuuAQEEfyMAQRBrIgQkACAEIAA2AgwgBCgCDCEBIwBBEGsiACQAIAAgATYCDCAAKAIMIQIjAEEQayIBJAAgASACNgIMAn8gASgCDCIDEA5BAXEEQCADEDIMAQsjAEEQayICJAAgAiADNgIMIAIoAgwQBxAHIQMgAkEQaiQAIAMLIQIgAUEQaiQAIAIhASMAQRBrIgIgATYCDCACKAIMIQEgAEEQaiQAIARBEGokACABCyYBAX8jAEEQayIBJAAgASAANgIMIAEoAgwQHCEAIAFBEGokACAAC4UBAQF/IwBBEGsiAyQAIAMgADYCDCADIAE2AgggAyACNgIEIAMoAgQoAgBBBGpBgAhJBEAgAygCDCADKAIEKAIAaiADKAIIIgBBCHRBgID8B3EgAEEYdHIgAEEIdkGA/gNxIABBGHZycjYCACADKAIEIgAgACgCAEEEajYCAAsgA0EQaiQAC08BAn9BlAooAgAiASAAQQNqQXxxIgJqIQACQCACQQAgACABTRsNACAAPwBBEHRLBEAgABACRQ0BC0GUCiAANgIAIAEPC0G4EUEwNgIAQX8LrwEBAX8jAEEQayIEJAAgBCAANgIMIAQgATYCCCAEIAI2AgQgBCADNgIAIAQoAgQgBCgCACgCAEECampBgAhJBEAgBCgCDCAEKAIAKAIAaiAEKAIEQf//A3EiAEEIdCAAQQh2cjsBACAEKAIAIgAgACgCAEECajYCACAEKAIMIAQoAgAoAgBqIAQoAgggBCgCBBAWIAQoAgAiACAEKAIEIAAoAgBqNgIACyAEQRBqJAALMAEBfyMAQRBrIgEkACABIAA2AgwgASgCDBAHLQALQYABcUEARyEAIAFBEGokACAAC4gBAQJ/IwBBEGsiAyQAIwBBEGsiAiADQQhqNgIMIAIoAgwaIwBBEGsiAiAANgIEIAIoAgQaAkAgARAORQRAIAEQByEBIAAQByIAIAEoAgg2AgggACABKQIANwIADAELIAACfyABEDIhACMAQRBrIgIgADYCDCACKAIMCyABEDEQKwsgA0EQaiQACw8AIAIEQCAAIAEgAhAWCwtcAQF/IwBBEGsiAiAANgIMIAIgATYCCCACIAIoAgw2AgQgAkEANgIAA0AgAigCACACKAIIT0UEQCACKAIEIQAgAiACKAIAIgFBAWo2AgAgACABakEAOgAADAELCwvWAgEBfwJAIAFFDQAgACABaiICQQFrQQA6AAAgAEEAOgAAIAFBA0kNACACQQJrQQA6AAAgAEEAOgABIAJBA2tBADoAACAAQQA6AAIgAUEHSQ0AIAJBBGtBADoAACAAQQA6AAMgAUEJSQ0AIABBACAAa0EDcSICaiIAQQA2AgAgACABIAJrQXxxIgJqIgFBBGtBADYCACACQQlJDQAgAEEANgIIIABBADYCBCABQQhrQQA2AgAgAUEMa0EANgIAIAJBGUkNACAAQQA2AhggAEEANgIUIABBADYCECAAQQA2AgwgAUEQa0EANgIAIAFBFGtBADYCACABQRhrQQA2AgAgAUEca0EANgIAIAIgAEEEcUEYciICayIBQSBJDQAgACACaiEAA0AgAEIANwMYIABCADcDECAAQgA3AwggAEIANwMAIABBIGohACABQSBrIgFBH0sNAAsLC3cBA38jAEEQayIFJAACQCACIAAQJSIEIAAQHCIDa00EQCACRQ0BIAAQGCIEIANqIAEgAhAQIAAgAiADaiIAECQgBUEAOgAPIAAgBGogBS0ADzoAAAwBCyAAIAQgAiADaiAEayADIANBACACIAEQIwsgBUEQaiQAC0UBAX8jAEEQayIDJAAgAyAANgIMIAMgATYCCCADIAI3AwAgAygCDCADKAIIIAMpAwBBhAooAgAoAgQRCAAaIANBEGokAAuDAQEBfyMAQSBrIgIgADYCHCACIAE2AhggAkGDATYCFCACQQA2AhAgAkEANgIMA0AgAigCDCACKAIYT0UEQCACKAIQIAIoAhRsIQAgAiACKAIcIgFBAWo2AhwgAiABLQAAIABqNgIQIAIgAigCDEEBajYCDAwBCwsgAigCEEH/////B3EL/wMBAn8gAkGABE8EQCAAIAEgAhABGg8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCAAQQNxRQRAIAAhAgwBCyACQQFIBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICQQNxRQ0BIAIgA0kNAAsLAkAgA0F8cSIAQcAASQ0AIAIgAEFAaiIESw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBE0NAAsLIAAgAk0NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIABJDQALDAELIANBBEkEQCAAIQIMAQsgACADQQRrIgRLBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsLpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQdARKAIASQ0BIAAgAWohACADQdQRKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEHoEWpGGiACIAMoAgwiAUYEQEHAEUHAESgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRB8BNqIgQoAgBGBEAgBCABNgIAIAENAUHEEUHEESgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBByBEgADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVB2BEoAgBGBEBB2BEgAzYCAEHMEUHMESgCACAAaiIANgIAIAMgAEEBcjYCBCADQdQRKAIARw0DQcgRQQA2AgBB1BFBADYCAA8LIAVB1BEoAgBGBEBB1BEgAzYCAEHIEUHIESgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RB6BFqRhogAiAFKAIMIgFGBEBBwBFBwBEoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJB0BEoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEHwE2oiBCgCAEYEQCAEIAE2AgAgAQ0BQcQRQcQRKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQdQRKAIARw0BQcgRIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RB6BFqIQACf0HAESgCACICQQEgAXQiAXFFBEBBwBEgASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QfATaiEBAkACQAJAQcQRKAIAIgRBASACdCIHcUUEQEHEESAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtB4BFB4BEoAgBBAWsiAEF/IAAbNgIACwsSACAAEA4EQCAAECcPCyAAEAcLLwEBfyMAQRBrIgEkACABIAA2AgwgASgCDCIAIAFBCGogARAfIAAQHiABQRBqJAALCwAgABAHIAE2AgQL+AgBAX8jAEGAAWsiAyQAIAMgADYCfCADIAE2AnggAyACNwNwIANBAEGAgIAIIAMoAnwtAFAbNgJsIAMgAygCfCgCADYCaCADIAMoAnwoAgQ2AmQgAyADKAJ8KAIINgJgIAMgAygCfCgCDDYCXCADIAMoAnwoAhA2AlggAyADKAJkQQVsNgJUIAMgAygCYEEFbDYCUCADIAMoAlxBBWw2AkwgAyADKAJYQQVsNgJIIAMgAygCfCgCFDYCRCADIAMoAnwoAhg2AkAgAyADKAJ8KAIcNgI8IAMgAygCfCgCIDYCOCADIAMoAnwoAiQ2AjQDQCADKQNwQhBURQRAIAMgAygCeBAEQf///x9xIAMoAkRqNgJEIAMgAygCeEEDahAEQQJ2Qf///x9xIAMoAkBqNgJAIAMgAygCeEEGahAEQQR2Qf///x9xIAMoAjxqNgI8IAMgAygCeEEJahAEQQZ2IAMoAjhqNgI4IAMgAygCeEEMahAEQQh2IAMoAmxyIAMoAjRqNgI0IAMgAygCRK0gAygCaK1+IAMoAkCtIAMoAkitfnwgAygCPK0gAygCTK1+fCADKAI4rSADKAJQrX58IAMoAjStIAMoAlStfnw3AyggAyADKAJErSADKAJkrX4gAygCQK0gAygCaK1+fCADKAI8rSADKAJIrX58IAMoAjitIAMoAkytfnwgAygCNK0gAygCUK1+fDcDICADIAMoAkStIAMoAmCtfiADKAJArSADKAJkrX58IAMoAjytIAMoAmitfnwgAygCOK0gAygCSK1+fCADKAI0rSADKAJMrX58NwMYIAMgAygCRK0gAygCXK1+IAMoAkCtIAMoAmCtfnwgAygCPK0gAygCZK1+fCADKAI4rSADKAJorX58IAMoAjStIAMoAkitfnw3AxAgAyADKAJErSADKAJYrX4gAygCQK0gAygCXK1+fCADKAI8rSADKAJgrX58IAMoAjitIAMoAmStfnwgAygCNK0gAygCaK1+fDcDCCADIAMpAyhCGog+AgQgAyADKQMop0H///8fcTYCRCADIAMpAyAgAygCBK18NwMgIAMgAykDIEIaiD4CBCADIAMpAyCnQf///x9xNgJAIAMgAykDGCADKAIErXw3AxggAyADKQMYQhqIPgIEIAMgAykDGKdB////H3E2AjwgAyADKQMQIAMoAgStfDcDECADIAMpAxBCGog+AgQgAyADKQMQp0H///8fcTYCOCADIAMpAwggAygCBK18NwMIIAMgAykDCEIaiD4CBCADIAMpAwinQf///x9xNgI0IAMgAygCRCADKAIEQQVsajYCRCADIAMoAkRBGnY2AgQgAyADKAJEQf///x9xNgJEIAMgAygCBCADKAJAajYCQCADIAMoAnhBEGo2AnggAyADKQNwQhB9NwNwDAELCyADKAJ8IAMoAkQ2AhQgAygCfCADKAJANgIYIAMoAnwgAygCPDYCHCADKAJ8IAMoAjg2AiAgAygCfCADKAI0NgIkIANBgAFqJAALXAECfyMAQRBrIgIkACACIAA2AgwCfyACKAIMIgEQDkEBcQRAIAEQMQwBCyMAQRBrIgAkACAAIAE2AgwgACgCDBAHLQALIQEgAEEQaiQAIAELIQAgAkEQaiQAIAALAwABC18BAX8jAEEQayIBJAAgASAANgIMIAEgASgCDBAHNgIIIAFBADYCBANAIAEoAgRBA09FBEAgASgCCCABKAIEQQJ0akEANgIAIAEgASgCBEEBajYCBAwBCwsgAUEQaiQAC5gBAQF/IwBBIGsiAyQAIAMgADYCHCADIAE2AhggAyACNgIUIAMoAhwhASMAQRBrIgAgAygCGDYCDCAAKAIMGiMAQRBrIgAgATYCBCAAKAIEGiMAQRBrIgAgAygCFDYCDCAAKAIMGiMAQRBrIgAkACAAIAE2AgQjAEEQayIBIAAoAgQ2AgwgASgCDBogAEEQaiQAIANBIGokAAt/AQN/IAAhAQJAIABBA3EEQANAIAEtAABFDQIgAUEBaiIBQQNxDQALCwNAIAEiAkEEaiEBIAIoAgAiA0F/cyADQYGChAhrcUGAgYKEeHFFDQALIANB/wFxRQRAIAIgAGsPCwNAIAItAAEhAyACQQFqIgEhAiADDQALCyABIABrC5YtAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBBwBEoAgAiBUEQIABBC2pBeHEgAEELSRsiCEEDdiICdiIBQQNxBEAgAUF/c0EBcSACaiIDQQN0IgFB8BFqKAIAIgRBCGohAAJAIAQoAggiAiABQegRaiIBRgRAQcARIAVBfiADd3E2AgAMAQsgAiABNgIMIAEgAjYCCAsgBCADQQN0IgFBA3I2AgQgASAEaiIBIAEoAgRBAXI2AgQMDQsgCEHIESgCACIKTQ0BIAEEQAJAQQIgAnQiAEEAIABrciABIAJ0cSIAQQAgAGtxQQFrIgAgAEEMdkEQcSICdiIBQQV2QQhxIgAgAnIgASAAdiIBQQJ2QQRxIgByIAEgAHYiAUEBdkECcSIAciABIAB2IgFBAXZBAXEiAHIgASAAdmoiA0EDdCIAQfARaigCACIEKAIIIgEgAEHoEWoiAEYEQEHAESAFQX4gA3dxIgU2AgAMAQsgASAANgIMIAAgATYCCAsgBEEIaiEAIAQgCEEDcjYCBCAEIAhqIgIgA0EDdCIBIAhrIgNBAXI2AgQgASAEaiADNgIAIAoEQCAKQQN2IgFBA3RB6BFqIQdB1BEoAgAhBAJ/IAVBASABdCIBcUUEQEHAESABIAVyNgIAIAcMAQsgBygCCAshASAHIAQ2AgggASAENgIMIAQgBzYCDCAEIAE2AggLQdQRIAI2AgBByBEgAzYCAAwNC0HEESgCACIGRQ0BIAZBACAGa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEHwE2ooAgAiASgCBEF4cSAIayEDIAEhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAIayICIAMgAiADSSICGyEDIAAgASACGyEBIAAhAgwBCwsgASAIaiIJIAFNDQIgASgCGCELIAEgASgCDCIERwRAIAEoAggiAEHQESgCAEkaIAAgBDYCDCAEIAA2AggMDAsgAUEUaiICKAIAIgBFBEAgASgCECIARQ0EIAFBEGohAgsDQCACIQcgACIEQRRqIgIoAgAiAA0AIARBEGohAiAEKAIQIgANAAsgB0EANgIADAsLQX8hCCAAQb9/Sw0AIABBC2oiAEF4cSEIQcQRKAIAIglFDQBBHyEFQQAgCGshAwJAAkACQAJ/IAhB////B00EQCAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGohBQsgBUECdEHwE2ooAgAiAkULBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBAiAFdCIAQQAgAGtyIAlxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QfATaigCACEACyAARQ0BCwNAIAAoAgRBeHEgCGsiASADSSECIAEgAyACGyEDIAAgBCACGyEEIAAoAhAiAQR/IAEFIAAoAhQLIgANAAsLIARFDQAgA0HIESgCACAIa08NACAEIAhqIgYgBE0NASAEKAIYIQUgBCAEKAIMIgFHBEAgBCgCCCIAQdARKAIASRogACABNgIMIAEgADYCCAwKCyAEQRRqIgIoAgAiAEUEQCAEKAIQIgBFDQQgBEEQaiECCwNAIAIhByAAIgFBFGoiAigCACIADQAgAUEQaiECIAEoAhAiAA0ACyAHQQA2AgAMCQsgCEHIESgCACICTQRAQdQRKAIAIQMCQCACIAhrIgFBEE8EQEHIESABNgIAQdQRIAMgCGoiADYCACAAIAFBAXI2AgQgAiADaiABNgIAIAMgCEEDcjYCBAwBC0HUEUEANgIAQcgRQQA2AgAgAyACQQNyNgIEIAIgA2oiACAAKAIEQQFyNgIECyADQQhqIQAMCwsgCEHMESgCACIGSQRAQcwRIAYgCGsiATYCAEHYEUHYESgCACICIAhqIgA2AgAgACABQQFyNgIEIAIgCEEDcjYCBCACQQhqIQAMCwtBACEAIAhBL2oiCQJ/QZgVKAIABEBBoBUoAgAMAQtBpBVCfzcCAEGcFUKAoICAgIAENwIAQZgVIAxBDGpBcHFB2KrVqgVzNgIAQawVQQA2AgBB/BRBADYCAEGAIAsiAWoiBUEAIAFrIgdxIgIgCE0NCkH4FCgCACIEBEBB8BQoAgAiAyACaiIBIANNDQsgASAESw0LC0H8FC0AAEEEcQ0FAkACQEHYESgCACIDBEBBgBUhAANAIAMgACgCACIBTwRAIAEgACgCBGogA0sNAwsgACgCCCIADQALC0EAEAwiAUF/Rg0GIAIhBUGcFSgCACIDQQFrIgAgAXEEQCACIAFrIAAgAWpBACADa3FqIQULIAUgCE0NBiAFQf7///8HSw0GQfgUKAIAIgQEQEHwFCgCACIDIAVqIgAgA00NByAAIARLDQcLIAUQDCIAIAFHDQEMCAsgBSAGayAHcSIFQf7///8HSw0FIAUQDCIBIAAoAgAgACgCBGpGDQQgASEACwJAIABBf0YNACAIQTBqIAVNDQBBoBUoAgAiASAJIAVrakEAIAFrcSIBQf7///8HSwRAIAAhAQwICyABEAxBf0cEQCABIAVqIQUgACEBDAgLQQAgBWsQDBoMBQsgACIBQX9HDQYMBAsAC0EAIQQMBwtBACEBDAULIAFBf0cNAgtB/BRB/BQoAgBBBHI2AgALIAJB/v///wdLDQEgAhAMIQFBABAMIQAgAUF/Rg0BIABBf0YNASAAIAFNDQEgACABayIFIAhBKGpNDQELQfAUQfAUKAIAIAVqIgA2AgBB9BQoAgAgAEkEQEH0FCAANgIACwJAAkACQEHYESgCACIHBEBBgBUhAANAIAEgACgCACIDIAAoAgQiAmpGDQIgACgCCCIADQALDAILQdARKAIAIgBBACAAIAFNG0UEQEHQESABNgIAC0EAIQBBhBUgBTYCAEGAFSABNgIAQeARQX82AgBB5BFBmBUoAgA2AgBBjBVBADYCAANAIABBA3QiA0HwEWogA0HoEWoiAjYCACADQfQRaiACNgIAIABBAWoiAEEgRw0AC0HMESAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBB2BEgACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRB3BFBqBUoAgA2AgAMAgsgAC0ADEEIcQ0AIAMgB0sNACABIAdNDQAgACACIAVqNgIEQdgRIAdBeCAHa0EHcUEAIAdBCGpBB3EbIgBqIgI2AgBBzBFBzBEoAgAgBWoiASAAayIANgIAIAIgAEEBcjYCBCABIAdqQSg2AgRB3BFBqBUoAgA2AgAMAQtB0BEoAgAgAUsEQEHQESABNgIACyABIAVqIQJBgBUhAAJAAkACQAJAAkACQANAIAIgACgCAEcEQCAAKAIIIgANAQwCCwsgAC0ADEEIcUUNAQtBgBUhAANAIAcgACgCACICTwRAIAIgACgCBGoiBCAHSw0DCyAAKAIIIQAMAAsACyAAIAE2AgAgACAAKAIEIAVqNgIEIAFBeCABa0EHcUEAIAFBCGpBB3EbaiIJIAhBA3I2AgQgAkF4IAJrQQdxQQAgAkEIakEHcRtqIgUgCCAJaiIGayECIAUgB0YEQEHYESAGNgIAQcwRQcwRKAIAIAJqIgA2AgAgBiAAQQFyNgIEDAMLIAVB1BEoAgBGBEBB1BEgBjYCAEHIEUHIESgCACACaiIANgIAIAYgAEEBcjYCBCAAIAZqIAA2AgAMAwsgBSgCBCIAQQNxQQFGBEAgAEF4cSEHAkAgAEH/AU0EQCAFKAIIIgMgAEEDdiIAQQN0QegRakYaIAMgBSgCDCIBRgRAQcARQcARKAIAQX4gAHdxNgIADAILIAMgATYCDCABIAM2AggMAQsgBSgCGCEIAkAgBSAFKAIMIgFHBEAgBSgCCCIAIAE2AgwgASAANgIIDAELAkAgBUEUaiIAKAIAIgMNACAFQRBqIgAoAgAiAw0AQQAhAQwBCwNAIAAhBCADIgFBFGoiACgCACIDDQAgAUEQaiEAIAEoAhAiAw0ACyAEQQA2AgALIAhFDQACQCAFIAUoAhwiA0ECdEHwE2oiACgCAEYEQCAAIAE2AgAgAQ0BQcQRQcQRKAIAQX4gA3dxNgIADAILIAhBEEEUIAgoAhAgBUYbaiABNgIAIAFFDQELIAEgCDYCGCAFKAIQIgAEQCABIAA2AhAgACABNgIYCyAFKAIUIgBFDQAgASAANgIUIAAgATYCGAsgBSAHaiEFIAIgB2ohAgsgBSAFKAIEQX5xNgIEIAYgAkEBcjYCBCACIAZqIAI2AgAgAkH/AU0EQCACQQN2IgBBA3RB6BFqIQICf0HAESgCACIBQQEgAHQiAHFFBEBBwBEgACABcjYCACACDAELIAIoAggLIQAgAiAGNgIIIAAgBjYCDCAGIAI2AgwgBiAANgIIDAMLQR8hACACQf///wdNBEAgAkEIdiIAIABBgP4/akEQdkEIcSIDdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIANyIAByayIAQQF0IAIgAEEVanZBAXFyQRxqIQALIAYgADYCHCAGQgA3AhAgAEECdEHwE2ohBAJAQcQRKAIAIgNBASAAdCIBcUUEQEHEESABIANyNgIAIAQgBjYCACAGIAQ2AhgMAQsgAkEAQRkgAEEBdmsgAEEfRht0IQAgBCgCACEBA0AgASIDKAIEQXhxIAJGDQMgAEEddiEBIABBAXQhACADIAFBBHFqIgQoAhAiAQ0ACyAEIAY2AhAgBiADNgIYCyAGIAY2AgwgBiAGNgIIDAILQcwRIAVBKGsiA0F4IAFrQQdxQQAgAUEIakEHcRsiAGsiAjYCAEHYESAAIAFqIgA2AgAgACACQQFyNgIEIAEgA2pBKDYCBEHcEUGoFSgCADYCACAHIARBJyAEa0EHcUEAIARBJ2tBB3EbakEvayIAIAAgB0EQakkbIgJBGzYCBCACQYgVKQIANwIQIAJBgBUpAgA3AghBiBUgAkEIajYCAEGEFSAFNgIAQYAVIAE2AgBBjBVBADYCACACQRhqIQADQCAAQQc2AgQgAEEIaiEBIABBBGohACABIARJDQALIAIgB0YNAyACIAIoAgRBfnE2AgQgByACIAdrIgRBAXI2AgQgAiAENgIAIARB/wFNBEAgBEEDdiIAQQN0QegRaiECAn9BwBEoAgAiAUEBIAB0IgBxRQRAQcARIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBzYCCCAAIAc2AgwgByACNgIMIAcgADYCCAwEC0EfIQAgB0IANwIQIARB////B00EQCAEQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgBCAAQRVqdkEBcXJBHGohAAsgByAANgIcIABBAnRB8BNqIQMCQEHEESgCACICQQEgAHQiAXFFBEBBxBEgASACcjYCACADIAc2AgAgByADNgIYDAELIARBAEEZIABBAXZrIABBH0YbdCEAIAMoAgAhAQNAIAEiAigCBEF4cSAERg0EIABBHXYhASAAQQF0IQAgAiABQQRxaiIDKAIQIgENAAsgAyAHNgIQIAcgAjYCGAsgByAHNgIMIAcgBzYCCAwDCyADKAIIIgAgBjYCDCADIAY2AgggBkEANgIYIAYgAzYCDCAGIAA2AggLIAlBCGohAAwFCyACKAIIIgAgBzYCDCACIAc2AgggB0EANgIYIAcgAjYCDCAHIAA2AggLQcwRKAIAIgAgCE0NAEHMESAAIAhrIgE2AgBB2BFB2BEoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAMLQbgRQTA2AgBBACEADAILAkAgBUUNAAJAIAQoAhwiAkECdEHwE2oiACgCACAERgRAIAAgATYCACABDQFBxBEgCUF+IAJ3cSIJNgIADAILIAVBEEEUIAUoAhAgBEYbaiABNgIAIAFFDQELIAEgBTYCGCAEKAIQIgAEQCABIAA2AhAgACABNgIYCyAEKAIUIgBFDQAgASAANgIUIAAgATYCGAsCQCADQQ9NBEAgBCADIAhqIgBBA3I2AgQgACAEaiIAIAAoAgRBAXI2AgQMAQsgBCAIQQNyNgIEIAYgA0EBcjYCBCADIAZqIAM2AgAgA0H/AU0EQCADQQN2IgBBA3RB6BFqIQICf0HAESgCACIBQQEgAHQiAHFFBEBBwBEgACABcjYCACACDAELIAIoAggLIQAgAiAGNgIIIAAgBjYCDCAGIAI2AgwgBiAANgIIDAELQR8hACADQf///wdNBEAgA0EIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAMgAEEVanZBAXFyQRxqIQALIAYgADYCHCAGQgA3AhAgAEECdEHwE2ohAgJAAkAgCUEBIAB0IgFxRQRAQcQRIAEgCXI2AgAgAiAGNgIAIAYgAjYCGAwBCyADQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQgDQCAIIgEoAgRBeHEgA0YNAiAAQR12IQIgAEEBdCEAIAEgAkEEcWoiAigCECIIDQALIAIgBjYCECAGIAE2AhgLIAYgBjYCDCAGIAY2AggMAQsgASgCCCIAIAY2AgwgASAGNgIIIAZBADYCGCAGIAE2AgwgBiAANgIICyAEQQhqIQAMAQsCQCALRQ0AAkAgASgCHCICQQJ0QfATaiIAKAIAIAFGBEAgACAENgIAIAQNAUHEESAGQX4gAndxNgIADAILIAtBEEEUIAsoAhAgAUYbaiAENgIAIARFDQELIAQgCzYCGCABKAIQIgAEQCAEIAA2AhAgACAENgIYCyABKAIUIgBFDQAgBCAANgIUIAAgBDYCGAsCQCADQQ9NBEAgASADIAhqIgBBA3I2AgQgACABaiIAIAAoAgRBAXI2AgQMAQsgASAIQQNyNgIEIAkgA0EBcjYCBCADIAlqIAM2AgAgCgRAIApBA3YiAEEDdEHoEWohBEHUESgCACECAn9BASAAdCIAIAVxRQRAQcARIAAgBXI2AgAgBAwBCyAEKAIICyEAIAQgAjYCCCAAIAI2AgwgAiAENgIMIAIgADYCCAtB1BEgCTYCAEHIESADNgIACyABQQhqIQALIAxBEGokACAACzIBAX8gAEEBIAAbIQACQANAIAAQISIBDQFBvBEoAgAiAQRAIAERBQAMAQsLEAAACyABC6oCAQV/IwBBEGsiCCQAIAIgAUF/c0ERa00EQCAAEBghCQJ/IAFB5////wdJBEAgCCABQQF0NgIIIAggASACajYCDAJ/IwBBEGsiAiQAIAhBDGoiCigCACAIQQhqIgsoAgBJIQwgAkEQaiQAIAsgCiAMGygCACICQQtPCwR/IAJBEGpBcHEiAiACQQFrIgIgAkELRhsFQQoLDAELQW4LQQFqIgoQIiECIAQEQCACIAkgBBAQCyAGBEAgAiAEaiAHIAYQEAsgAyAEIAVqayIDBEAgAiAEaiAGaiAEIAlqIAVqIAMQEAsgAUEKRwRAIAkQFwsgACACECkgACAKECggACAEIAZqIANqIgAQGiAIQQA6AAcgACACaiAILQAHOgAAIAhBEGokAA8LECwACxYAIAAQDgRAIAAgARAaDwsgACABECoLGQEBf0EKIQEgABAOBH8gABAmQQFrBUEKCwsQACAAEAcoAghB/////wdxCwkAIAAQBygCAAsSACAAEAcgAUGAgICAeHI2AggLCwAgABAHIAE2AgALCwAgABAHIAE6AAsLkAEBA38jAEEQayIEJAAgAkFvTQRAAkAgAkEKTQRAIAAgAhAqIAAQByEDDAELIAAgAkELTwR/IAJBEGpBcHEiAyADQQFrIgMgA0ELRhsFQQoLQQFqIgUQIiIDECkgACAFECggACACEBoLIAMgASACEBAgBEEAOgAPIAIgA2ogBC0ADzoAACAEQRBqJAAPCxAsAAsFABAAAAuOHQEBfyMAQfABayIEJAAgBCAANgLsASAEIAE2AugBIAQgAjYC5AEgBCADNwPYASAEQQA2AlQgBCkD2AFQRQRAIAQpA9gBQsD/////B1YEQBAAAAsgBCAEKALsASgCADYClAEgBCAEKALsASgCBDYCkAEgBCAEKALsASgCCDYCjAEgBCAEKALsASgCDDYCiAEgBCAEKALsASgCEDYChAEgBCAEKALsASgCFDYCgAEgBCAEKALsASgCGDYCfCAEIAQoAuwBKAIcNgJ4IAQgBCgC7AEoAiA2AnQgBCAEKALsASgCJDYCcCAEIAQoAuwBKAIoNgJsIAQgBCgC7AEoAiw2AmggBCAEKALsASgCMDYCZCAEIAQoAuwBKAI0NgJgIAQgBCgC7AEoAjg2AlwgBCAEKALsASgCPDYCWANAIAQpA9gBQsAAVARAIARBEGoiAEIANwMAIABCADcDOCAAQgA3AzAgAEIANwMoIABCADcDICAAQgA3AxggAEIANwMQIABCADcDCCAEQQA2AgwDQCAEKQPYASAEKAIMrVhFBEAgBCgCDCAEQRBqaiAEKALoASAEKAIMai0AADoAACAEIAQoAgxBAWo2AgwMAQsLIAQgBEEQajYC6AEgBCAEKALkATYCVCAEIARBEGo2AuQBCyAEIAQoApQBNgLUASAEIAQoApABNgLQASAEIAQoAowBNgLMASAEIAQoAogBNgLIASAEIAQoAoQBNgLEASAEIAQoAoABNgLAASAEIAQoAnw2ArwBIAQgBCgCeDYCuAEgBCAEKAJ0NgK0ASAEIAQoAnA2ArABIAQgBCgCbDYCrAEgBCAEKAJoNgKoASAEIAQoAmQ2AqQBIAQgBCgCYDYCoAEgBCAEKAJcNgKcASAEIAQoAlg2ApgBIARBFDYCDANAIAQoAgwEQCAEIAQoAtQBIAQoAsQBajYC1AEgBCAEKAKkASAEKALUAXNBEHQgBCgCpAEgBCgC1AFzQRB2cjYCpAEgBCAEKAK0ASAEKAKkAWo2ArQBIAQgBCgCxAEgBCgCtAFzQQx0IAQoAsQBIAQoArQBc0EUdnI2AsQBIAQgBCgC1AEgBCgCxAFqNgLUASAEIAQoAqQBIAQoAtQBc0EIdCAEKAKkASAEKALUAXNBGHZyNgKkASAEIAQoArQBIAQoAqQBajYCtAEgBCAEKALEASAEKAK0AXNBB3QgBCgCxAEgBCgCtAFzQRl2cjYCxAEgBCAEKALQASAEKALAAWo2AtABIAQgBCgCoAEgBCgC0AFzQRB0IAQoAqABIAQoAtABc0EQdnI2AqABIAQgBCgCsAEgBCgCoAFqNgKwASAEIAQoAsABIAQoArABc0EMdCAEKALAASAEKAKwAXNBFHZyNgLAASAEIAQoAtABIAQoAsABajYC0AEgBCAEKAKgASAEKALQAXNBCHQgBCgCoAEgBCgC0AFzQRh2cjYCoAEgBCAEKAKwASAEKAKgAWo2ArABIAQgBCgCwAEgBCgCsAFzQQd0IAQoAsABIAQoArABc0EZdnI2AsABIAQgBCgCzAEgBCgCvAFqNgLMASAEIAQoApwBIAQoAswBc0EQdCAEKAKcASAEKALMAXNBEHZyNgKcASAEIAQoAqwBIAQoApwBajYCrAEgBCAEKAK8ASAEKAKsAXNBDHQgBCgCvAEgBCgCrAFzQRR2cjYCvAEgBCAEKALMASAEKAK8AWo2AswBIAQgBCgCnAEgBCgCzAFzQQh0IAQoApwBIAQoAswBc0EYdnI2ApwBIAQgBCgCrAEgBCgCnAFqNgKsASAEIAQoArwBIAQoAqwBc0EHdCAEKAK8ASAEKAKsAXNBGXZyNgK8ASAEIAQoAsgBIAQoArgBajYCyAEgBCAEKAKYASAEKALIAXNBEHQgBCgCmAEgBCgCyAFzQRB2cjYCmAEgBCAEKAKoASAEKAKYAWo2AqgBIAQgBCgCuAEgBCgCqAFzQQx0IAQoArgBIAQoAqgBc0EUdnI2ArgBIAQgBCgCyAEgBCgCuAFqNgLIASAEIAQoApgBIAQoAsgBc0EIdCAEKAKYASAEKALIAXNBGHZyNgKYASAEIAQoAqgBIAQoApgBajYCqAEgBCAEKAK4ASAEKAKoAXNBB3QgBCgCuAEgBCgCqAFzQRl2cjYCuAEgBCAEKALUASAEKALAAWo2AtQBIAQgBCgCmAEgBCgC1AFzQRB0IAQoApgBIAQoAtQBc0EQdnI2ApgBIAQgBCgCrAEgBCgCmAFqNgKsASAEIAQoAsABIAQoAqwBc0EMdCAEKALAASAEKAKsAXNBFHZyNgLAASAEIAQoAtQBIAQoAsABajYC1AEgBCAEKAKYASAEKALUAXNBCHQgBCgCmAEgBCgC1AFzQRh2cjYCmAEgBCAEKAKsASAEKAKYAWo2AqwBIAQgBCgCwAEgBCgCrAFzQQd0IAQoAsABIAQoAqwBc0EZdnI2AsABIAQgBCgC0AEgBCgCvAFqNgLQASAEIAQoAqQBIAQoAtABc0EQdCAEKAKkASAEKALQAXNBEHZyNgKkASAEIAQoAqgBIAQoAqQBajYCqAEgBCAEKAK8ASAEKAKoAXNBDHQgBCgCvAEgBCgCqAFzQRR2cjYCvAEgBCAEKALQASAEKAK8AWo2AtABIAQgBCgCpAEgBCgC0AFzQQh0IAQoAqQBIAQoAtABc0EYdnI2AqQBIAQgBCgCqAEgBCgCpAFqNgKoASAEIAQoArwBIAQoAqgBc0EHdCAEKAK8ASAEKAKoAXNBGXZyNgK8ASAEIAQoAswBIAQoArgBajYCzAEgBCAEKAKgASAEKALMAXNBEHQgBCgCoAEgBCgCzAFzQRB2cjYCoAEgBCAEKAK0ASAEKAKgAWo2ArQBIAQgBCgCuAEgBCgCtAFzQQx0IAQoArgBIAQoArQBc0EUdnI2ArgBIAQgBCgCzAEgBCgCuAFqNgLMASAEIAQoAqABIAQoAswBc0EIdCAEKAKgASAEKALMAXNBGHZyNgKgASAEIAQoArQBIAQoAqABajYCtAEgBCAEKAK4ASAEKAK0AXNBB3QgBCgCuAEgBCgCtAFzQRl2cjYCuAEgBCAEKALIASAEKALEAWo2AsgBIAQgBCgCnAEgBCgCyAFzQRB0IAQoApwBIAQoAsgBc0EQdnI2ApwBIAQgBCgCsAEgBCgCnAFqNgKwASAEIAQoAsQBIAQoArABc0EMdCAEKALEASAEKAKwAXNBFHZyNgLEASAEIAQoAsgBIAQoAsQBajYCyAEgBCAEKAKcASAEKALIAXNBCHQgBCgCnAEgBCgCyAFzQRh2cjYCnAEgBCAEKAKwASAEKAKcAWo2ArABIAQgBCgCxAEgBCgCsAFzQQd0IAQoAsQBIAQoArABc0EZdnI2AsQBIAQgBCgCDEECazYCDAwBCwsgBCAEKALUASAEKAKUAWo2AtQBIAQgBCgC0AEgBCgCkAFqNgLQASAEIAQoAswBIAQoAowBajYCzAEgBCAEKALIASAEKAKIAWo2AsgBIAQgBCgCxAEgBCgChAFqNgLEASAEIAQoAsABIAQoAoABajYCwAEgBCAEKAK8ASAEKAJ8ajYCvAEgBCAEKAK4ASAEKAJ4ajYCuAEgBCAEKAK0ASAEKAJ0ajYCtAEgBCAEKAKwASAEKAJwajYCsAEgBCAEKAKsASAEKAJsajYCrAEgBCAEKAKoASAEKAJoajYCqAEgBCAEKAKkASAEKAJkajYCpAEgBCAEKAKgASAEKAJgajYCoAEgBCAEKAKcASAEKAJcajYCnAEgBCAEKAKYASAEKAJYajYCmAEgBCAEKALUASAEKALoARAEczYC1AEgBCAEKALQASAEKALoAUEEahAEczYC0AEgBCAEKALMASAEKALoAUEIahAEczYCzAEgBCAEKALIASAEKALoAUEMahAEczYCyAEgBCAEKALEASAEKALoAUEQahAEczYCxAEgBCAEKALAASAEKALoAUEUahAEczYCwAEgBCAEKAK8ASAEKALoAUEYahAEczYCvAEgBCAEKAK4ASAEKALoAUEcahAEczYCuAEgBCAEKAK0ASAEKALoAUEgahAEczYCtAEgBCAEKAKwASAEKALoAUEkahAEczYCsAEgBCAEKAKsASAEKALoAUEoahAEczYCrAEgBCAEKAKoASAEKALoAUEsahAEczYCqAEgBCAEKAKkASAEKALoAUEwahAEczYCpAEgBCAEKAKgASAEKALoAUE0ahAEczYCoAEgBCAEKAKcASAEKALoAUE4ahAEczYCnAEgBCAEKAKYASAEKALoAUE8ahAEczYCmAEgBCAEKAJkQQFqNgJkIAQoAmRFBEAgBCAEKAJgQQFqNgJgCyAEKALkASAEKALUARAFIAQoAuQBQQRqIAQoAtABEAUgBCgC5AFBCGogBCgCzAEQBSAEKALkAUEMaiAEKALIARAFIAQoAuQBQRBqIAQoAsQBEAUgBCgC5AFBFGogBCgCwAEQBSAEKALkAUEYaiAEKAK8ARAFIAQoAuQBQRxqIAQoArgBEAUgBCgC5AFBIGogBCgCtAEQBSAEKALkAUEkaiAEKAKwARAFIAQoAuQBQShqIAQoAqwBEAUgBCgC5AFBLGogBCgCqAEQBSAEKALkAUEwaiAEKAKkARAFIAQoAuQBQTRqIAQoAqABEAUgBCgC5AFBOGogBCgCnAEQBSAEKALkAUE8aiAEKAKYARAFIAQpA9gBQsAAWARAIAQpA9gBQsAAVARAIARBADYCDANAIAQoAgwgBCkD2AGnT0UEQCAEKAJUIAQoAgxqIAQoAuQBIAQoAgxqLQAAOgAAIAQgBCgCDEEBajYCDAwBCwsLIAQoAuwBIAQoAmQ2AjAgBCgC7AEgBCgCYDYCNAUgBCAEKQPYAUJAfDcD2AEgBCAEKALkAUFAazYC5AEgBCAEKALoAUFAazYC6AEMAQsLCyAEQfABaiQAC5EBAQF/IwBBEGsiAyQAIAMgADYCDCADIAE2AgggAyACNgIEIAMoAgQEfyADKAIEEAQFQQALIQAgAygCDCAANgIwIAMoAgQEfyADKAIEQQRqEAQFQQALIQAgAygCDCAANgI0IAMoAggQBCEAIAMoAgwgADYCOCADKAIIQQRqEAQhACADKAIMIAA2AjwgA0EQaiQAC4cCAQF/IwBBEGsiAiQAIAIgADYCDCACIAE2AgggAigCDEHl8MGLBjYCACACKAIMQe7IgZkDNgIEIAIoAgxBstqIywc2AgggAigCDEH0yoHZBjYCDCACKAIIEAQhACACKAIMIAA2AhAgAigCCEEEahAEIQAgAigCDCAANgIUIAIoAghBCGoQBCEAIAIoAgwgADYCGCACKAIIQQxqEAQhACACKAIMIAA2AhwgAigCCEEQahAEIQAgAigCDCAANgIgIAIoAghBFGoQBCEAIAIoAgwgADYCJCACKAIIQRhqEAQhACACKAIMIAA2AiggAigCCEEcahAEIQAgAigCDCAANgIsIAJBEGokAAvaAQEBfyMAQRBrIgIgADYCDCACIAE3AwAgAigCDCACKQMAPAAAIAIgAikDAEIIiDcDACACKAIMIAIpAwA8AAEgAiACKQMAQgiINwMAIAIoAgwgAikDADwAAiACIAIpAwBCCIg3AwAgAigCDCACKQMAPAADIAIgAikDAEIIiDcDACACKAIMIAIpAwA8AAQgAiACKQMAQgiINwMAIAIoAgwgAikDADwABSACIAIpAwBCCIg3AwAgAigCDCACKQMAPAAGIAIgAikDAEIIiDcDACACKAIMIAIpAwA8AAcLKQEBfyMAQRBrIgEkACABIAA2AgwgASgCDBAHKAIEIQAgAUEQaiQAIAALKQEBfyMAQRBrIgEkACABIAA2AgwgASgCDBAHKAIAIQAgAUEQaiQAIAALEAAjACAAa0FwcSIAJAAgAAsGACAAJAALBAAjAAvKHwIGfwJ+IwBBkAJrIgYkACAGIAA2AogCIAYgATYChAIgBiACNgKAAiAGIAM2AvwBIAYgBDYC+AEgBiAFNgL0ASAGEAM2AvABAkAgBigC8AFFBEAgBkGhCTYCjAIMAQsgBkHgAWogBigC8AEQCCAGKALwARAXIAZB0AFqIAZB4AFqEA8gBkHAAWogBigChAIQCCAGQbABaiAGKAKAAhAIIAZBoAFqIAYoAvwBEAggBkGQAWogBigC+AEQCCAGQfAAaiAGQdABahAPIAYoAogCIQkgBkHgAGogBkHAAWoQDyAGQdAAaiAGQbABahAPIAYoAvQBIQogBkFAa0GkCRAIIAZBMGpBpAkQCCAGQSBqIAZBoAFqEA8gBkEQakGkCRAIIAYgBkGQAWoQDyAGQfAAaiEAIAZB4ABqIQEgBkHQAGohAyAGQTBqIQQgBkEgaiEHIAZBEGohCCMAQcAbayICJAAgAiAGQYABaiIFNgK8GyACIAk2ArgbIAJBADYCtBsgAiAKNgKwGyACQQA2AqwbIAJBADYCqBsgAkGYG2oQGSACQYAINgKUGyACQeX7lvYANgKQGyACQYAbakGFCBAIIAJB8BpqQYUIEAggAkHwEmpBgAgQEiACQfAKakGACBASIAIgBkFAayIJEAkgCRAKEBU2AuwKIAIgAkGAG2oQCSACQYAbahAKEBU2AugKIAIgAkHwGmoQCSACQfAaahAKEBU2AuQKAkAgAigCqBtBCkoEQCAFQYsIEAggAkEBNgLgCgwBCyACQQI2AtwKIAJB8BJqIAIoArQbIAJB3ApqEAsgAkHwEmogAigCkBsgAkHcCmoQCyACQfASaiACKAK4GyACQdwKahALIAJB8BJqIAIoAuwKIAJB3ApqEAsgAkHwEmogAigCsBsgAkHcCmoQCyACQfASaiAEEAkgBBAKIAJB3ApqEA0gAkHwEmogBxAJIAcQCiACQdwKahANIAJB8BJqIAEQCSABEAogAkHcCmoQDSACQfASaiADEAkgAxAKIAJB3ApqEA0gAkHwEmogABAJIAAQCiACQdwKahANIAJB8BJqIAIoAuQKIAJB3ApqEAsgAkHwEmogAigC6AogAkHcCmoQCyACQQA2AtgKIAJBADYC1AoDQCACKALUCiACKAKoG0gEQCACKAKsGyACKALUCkECdGooAgBBf0cEQCACIAIoAtgKQQEgAigC1Ap0cjYC2AoLIAIgAigC1ApBAWo2AtQKDAELCyACQfASaiACKALYCiACQdwKahALIAJBADYC0AoDQCACKALQCiACKAKoG0gEQCACKAKsGyACKALQCkECdGooAgBBf0cEQCACQfASaiACKAKsGyACKALQCkECdGooAgAgAkHcCmoQCwsgAiACKALQCkEBajYC0AoMAQsLIAJB8BJqIAgQCSAIEAogAkHcCmoQDSACQfASaiAGEAkgBhAKIAJB3ApqEA0gAiACKALcCkECa0H//wNxIgBBCHQgAEEIdnI7AfASIAIgAkHwEmogAigC3AoQFTYCzAogAkGgCmoiAEIANwMAIABCADcDGCAAQgA3AxAgAEIANwMIIAIoAtwKQYAISwRAIAVBjggQCCACQQE2AuAKDAELIAJBQGtBsAkQEiACQZgKakGVCCkAADcAACACQfAJaiIAQbYIKQAANwAYIABBrggpAAA3ABAgAEGmCCkAADcACCAAQZ4IKQAANwAAIAIoAtwKrSEMIwBB0ABrIgEkACABIAJBQGs2AkwgASACQThqNgJIIAEgAkHwEmo2AkQgASAMNwM4IAFBvwg2AjQgAUIQNwMoIAFBADYCJCABIAJBmApqNgIgIAEgAkHwCWo2AhwgAUIANwMQIAEpAzhCb1YEQBAAAAsgASgCTCEDIAEoAkwgASkDOKdqIQQgASgCRCEHIAEpAzghDCABKAI0IQggASkDKCENIAEoAiQhCSABKAIgIQogASgCHCELIwBBkANrIgAkACAAIAM2AowDIAAgBDYCiAMgAEEANgKEAyAAIAc2AoADIAAgDDcD+AIgACAINgL0AiAAIA03A+gCIAAgCTYC5AIgACAKNgLgAiAAIAs2AtwCIAAoAuACIQQgACgC3AIhByMAQSBrIgMkACADIABBEGo2AhwgA0LAADcDECADIAQ2AgwgAyAHNgIIIAMoAhwgAykDECADKAIMIAMoAghBkAooAgAoAgARCgAaIANBIGokACMAQRBrIgMkACADIABB0ABqNgIMIAMgAEEQajYCCCADKAIMIAMoAghBhAooAgAoAgARBAAaIANBEGokACAAQRBqQcAAEBEgAEHQAGogACgC9AIgACkD6AIQFCAAQQhqIAApA+gCEDAgAEHQAGogAEEIakIIEBQgACgCjAMhBCAAKAKAAyEHIAApA/gCIQwgACgC4AIhCCAAKALcAiEJIwBBMGsiAyQAIAMgBDYCLCADIAc2AiggAyAMNwMgIAMgCDYCHCADQgE3AxAgAyAJNgIMIAMoAiwgAygCKCADKQMgIAMoAhwgAykDECADKAIMQZAKKAIAKAIEEQkAGiADQTBqJAAgAEHQAGogACgCjAMgACkD+AIQFCAAQQhqIAApA/gCEDAgAEHQAGogAEEIakIIEBQgACgCiAMhBCMAQRBrIgMkACADIABB0ABqNgIMIAMgBDYCCCADKAIMIAMoAghBhAooAgAoAggRBAAaIANBEGokACAAQdAAakGAAhARIAAoAoQDBEAgACgChANCEDcDAAsgAEGQA2okACABQQA2AgwgASgCSARAIAEoAgxFBEAgASABKQM4QhB8NwMQCyABKAJIIAEpAxA3AwALIAEoAgwaIAFB0ABqJAAgAkIIIAIpAzhCB4N9PgI0IAJBADYCMANAIAIoAjAgAigCNEkEQCACKQM4pyACQUBraiACKAI0OgAAIAIgAikDOEIBfDcDOCACIAIoAjBBAWo2AjAMAQsLIAIpAzhQBEAgBUHQCBAIIAJBATYC4AoMAQsgAkEANgArIAJBADoALyACQQA2ACYgAkEAOgAqQbARIAIoArAbQQFrrTcDACACQQA2AiADQCACKAIgQQRIBEBBsBFBsBEpAwBCrf7V5NSF/ajYAH5CAXwiDDcDACACIAxCIYinQf8BcDoAHyACKAIgIAJBJmpqIAIoApQbIAIoAiBqLAAAIAItAB9zOgAAIAIoAiAgAkEramogAi0AHzoAACACIAIoAiBBAWo2AiAMAQsLIAJBEGoQGSACQRBqIAJBK2pBBBATIAJBEGogAkEmakEEEBMgAkEQaiACQUBrIAIpAzinEBMgAiACKALMCiIAQQh0QYCA/AdxIABBGHRyIABBCHZBgP4DcSAAQRh2cnI2AgwgAkEQaiACQQxqQQQQEyACQRBqEAkhASACQRBqEAohAyMAQTBrIgAgATYCLCAAIAM2AiggACACQfASajYCJCAAQYAINgIgAkAgACgCKEEASA0AIAAoAiBBAEgNACAAIAAoAiw2AhwgACAAKAIoQQNtNgIYIAAgACgCKCAAKAIYQQNsSjoAFyAAIAAoAiggACgCGEEDbEECakY6ABYgACAAKAIYIAAtABdBAXFqQQJ0NgIQAkAgACgCHARAIAAoAhAgACgCIEwNAQsgACgCJEEAOgAADAELIABBADYCDANAIAAoAgwgACgCGEgEQCAAKAIkIAAoAgxBAnRqIAAoAhwgACgCDEEDbGotAABBAnYtAOAIOgAAIAAoAiQgACgCDEECdEEBamogACgCHCAAKAIMQQNsai0AAEEDcUEEdCAAKAIcIAAoAgxBA2xBAWpqLQAAQQR2ci0A4Ag6AAAgACgCJCAAKAIMQQJ0QQJqaiAAKAIcIAAoAgxBA2xBAWpqLQAAQQJ0IAAoAhwgACgCDEEDbEECamotAABBBnZyQT9xLQDgCDoAACAAKAIkIAAoAgxBAnRBA2pqIAAoAhwgACgCDEEDbEECamotAABBP3EtAOAIOgAAIAAgACgCDEEBajYCDAwBCwsgAC0AF0EBcQRAIAAoAiQgACgCDEECdGogACgCHCAAKAIMQQNsai0AAEECdi0A4Ag6AAACQCAALQAWQQFxBEAgACgCJCAAKAIMQQJ0QQFqaiAAKAIcIAAoAgxBA2xqLQAAQQNxQQR0IAAoAhwgACgCDEEDbEEBamotAABBBHZyLQDgCDoAACAAKAIkIAAoAgxBAnRBAmpqIAAoAhwgACgCDEEDbEEBamotAABBAnRBP3EtAOAIOgAADAELIAAoAiQgACgCDEECdEEBamogACgCHCAAKAIMQQNsai0AAEEDcUEEdC0A4Ag6AAAgACAAKAIQQQFrNgIQCyAAIAAoAhBBAWs2AhALIAAoAiQgACgCEGpBADoAAAsgAhAZIAJB8BJqIQMgAkHwEmoQICEBIwBBEGsiByQAAkAgASACECUiAE0EQCACEBgiCSEEIAEiAARAAkAgAyAERg0AIAMgACAEaiIKa0EAIABBAXRrTQRAIAQgAyAAEBYMAQsgAyAEc0EDcSEIAkACQCADIARLBEAgCA0CIARBA3FFDQEDQCAARQ0EIAQgAy0AADoAACADQQFqIQMgAEEBayEAIARBAWoiBEEDcQ0ACwwBCwJAIAgNACAKQQNxBEADQCAARQ0FIAQgAEEBayIAaiIIIAAgA2otAAA6AAAgCEEDcQ0ACwsgAEEDTQ0AA0AgBCAAQQRrIgBqIAAgA2ooAgA2AgAgAEEDSw0ACwsgAEUNAgNAIAQgAEEBayIAaiAAIANqLQAAOgAAIAANAAsMAgsgAEEDTQ0AA0AgBCADKAIANgIAIANBBGohAyAEQQRqIQQgAEEEayIAQQNLDQALCyAARQ0AA0AgBCADLQAAOgAAIARBAWohBCADQQFqIQMgAEEBayIADQALCwsgB0EAOgAPIAEgCWogBy0ADzoAACACIAEQJAwBCyACIAAgASAAayACEBwiAEEAIAAgASADECMLIAdBEGokACMAQRBrIgAkACAAIAU2AgwgACACNgIIIAAoAgwiAQJ+IwBBEGsiAyAAKAIINgIMIAMoAgwiAykCAAs3AgAgASADKAIINgIIIAAoAggQHiAAQRBqJAAgAkEBNgLgCiACEAYgAkEQahAGCyACQfAaahAGIAJBgBtqEAYgAkGYG2oQBiACQcAbaiQAIAYQBiAGQRBqEAYgBkEgahAGIAZBMGoQBiAGQUBrEAYgBkHQAGoQBiAGQeAAahAGIAZB8ABqEAYgBiAGQYABahAJNgKMAiAGQYABahAGIAZBkAFqEAYgBkGgAWoQBiAGQbABahAGIAZBwAFqEAYgBkHQAWoQBiAGQeABahAGCyAGKAKMAiEAIAZBkAJqJAAgAAvKAQEBfyMAQYABayIGJAAgBiAANgJ4IAYgATYCdCAGIAI3A2ggBiADNgJkIAYgBDcDWCAGIAU2AlQCQCAGKQNoUARADAELIAYgBikDWEIgiD4CBCAGIAYpA1g+AgAgBkEIaiAGKAIAEAUgBkEMaiAGKAIEEAUgBkEQaiAGKAJUEC8gBkEQaiAGKAJkIAZBCGoQLiAGQRBqIAYoAnQgBigCeCAGKQNoEC0gBkEQakHAABARCyAGQQA2AnwgBigCfCEAIAZBgAFqJAAgAAuXAQEBfyMAQeAAayIEJAAgBCAANgJYIAQgATcDUCAEIAI2AkwgBCADNgJIAkAgBCkDUFAEQAwBCyAEQQhqIAQoAkgQLyAEQQhqIAQoAkxBABAuIAQoAlggBCkDUKcQEiAEQQhqIAQoAlggBCgCWCAEKQNQEC0gBEEIakHAABARCyAEQQA2AlwgBCgCXCEAIARB4ABqJAAgAAvVCQICfwF+IwBBEGsiAiQAIAIgADYCDCACIAE2AgggAigCDCEBIAIoAgghAyMAQdAAayIAJAAgACABNgJMIAAgAzYCSCAAKAJMKQM4QgBSBEAgACAAKAJMKQM4NwMAIAAoAkxBQGshASAAIAApAwAiBEIBfDcDACAEpyABakEBOgAAA0AgACkDAEIQVARAIAApAwCnIAAoAkxBQGtqQQA6AAAgACAAKQMAQgF8NwMADAELCyAAKAJMQQE6AFAgACgCTCAAKAJMQUBrQhAQGwsgACAAKAJMKAIUNgJEIAAgACgCTCgCGDYCQCAAIAAoAkwoAhw2AjwgACAAKAJMKAIgNgI4IAAgACgCTCgCJDYCNCAAIAAoAkBBGnY2AjAgACAAKAJAQf///x9xNgJAIAAgACgCMCAAKAI8ajYCPCAAIAAoAjxBGnY2AjAgACAAKAI8Qf///x9xNgI8IAAgACgCMCAAKAI4ajYCOCAAIAAoAjhBGnY2AjAgACAAKAI4Qf///x9xNgI4IAAgACgCMCAAKAI0ajYCNCAAIAAoAjRBGnY2AjAgACAAKAI0Qf///x9xNgI0IAAgACgCRCAAKAIwQQVsajYCRCAAIAAoAkRBGnY2AjAgACAAKAJEQf///x9xNgJEIAAgACgCMCAAKAJAajYCQCAAIAAoAkRBBWo2AiwgACAAKAIsQRp2NgIwIAAgACgCLEH///8fcTYCLCAAIAAoAkAgACgCMGo2AiggACAAKAIoQRp2NgIwIAAgACgCKEH///8fcTYCKCAAIAAoAjwgACgCMGo2AiQgACAAKAIkQRp2NgIwIAAgACgCJEH///8fcTYCJCAAIAAoAjggACgCMGo2AiAgACAAKAIgQRp2NgIwIAAgACgCIEH///8fcTYCICAAIAAoAjQgACgCMGpBgICAIGs2AhwgACAAKAIcQR92QQFrNgIMIAAgACgCDCAAKAIscTYCLCAAIAAoAgwgACgCKHE2AiggACAAKAIMIAAoAiRxNgIkIAAgACgCDCAAKAIgcTYCICAAIAAoAgwgACgCHHE2AhwgACAAKAIMQX9zNgIMIAAgACgCLCAAKAJEIAAoAgxxcjYCRCAAIAAoAiggACgCQCAAKAIMcXI2AkAgACAAKAIkIAAoAjwgACgCDHFyNgI8IAAgACgCICAAKAI4IAAoAgxxcjYCOCAAIAAoAhwgACgCNCAAKAIMcXI2AjQgACAAKAJEIAAoAkBBGnRyNgJEIAAgACgCPEEUdCAAKAJAQQZ2cjYCQCAAIAAoAjhBDnQgACgCPEEMdnI2AjwgACAAKAI0QQh0IAAoAjhBEnZyNgI4IAAgACgCRK0gACgCTCgCKK18NwMQIAAgACkDED4CRCAAIAAoAkCtIAAoAkwoAiytfCAAKQMQQiCIfDcDECAAIAApAxA+AkAgACAAKAI8rSAAKAJMKAIwrXwgACkDEEIgiHw3AxAgACAAKQMQPgI8IAAgACgCOK0gACgCTCgCNK18IAApAxBCIIh8NwMQIAAgACkDED4COCAAKAJIIAAoAkQQBSAAKAJIQQRqIAAoAkAQBSAAKAJIQQhqIAAoAjwQBSAAKAJIQQxqIAAoAjgQBSAAKAJMQdgAEBEgAEHQAGokACACQRBqJABBAAuFBAECfyMAQRBrIgMkACADIAA2AgwgAyABNgIIIAMgAjcDACADKAIMIQEgAygCCCEEIAMpAwAhAiMAQTBrIgAkACAAIAE2AiwgACAENgIoIAAgAjcDIAJAIAAoAiwpAzhCAFIEQCAAQhAgACgCLCkDOH03AxAgACkDECAAKQMgVgRAIAAgACkDIDcDEAsgAEIANwMYA0AgACkDGCAAKQMQVARAIAAoAiwpAzggACkDGHynIAAoAixBQGtqIAAoAiggACkDGKdqLQAAOgAAIAAgACkDGEIBfDcDGAwBCwsgACAAKQMgIAApAxB9NwMgIAAgACgCKCAAKQMQp2o2AiggACgCLCIBIAApAxAgASkDOHw3AzggACgCLCkDOEIQVA0BIAAoAiwgACgCLEFAa0IQEBsgACgCLEIANwM4CyAAKQMgQhBaBEAgACAAKQMgQnCDNwMIIAAoAiwgACgCKCAAKQMIEBsgACAAKAIoIAApAwinajYCKCAAIAApAyAgACkDCH03AyALIAApAyBQDQAgAEIANwMYA0AgACkDGCAAKQMgVARAIAAoAiwpAzggACkDGHynIAAoAixBQGtqIAAoAiggACkDGKdqLQAAOgAAIAAgACkDGEIBfDcDGAwBCwsgACgCLCIBIAApAyAgASkDOHw3AzgLIABBMGokACADQRBqJABBAAuCAwECfyMAQRBrIgIkACACIAA2AgwgAiABNgIIIAIoAgwhASACKAIIIQMjAEEQayIAJAAgACABNgIMIAAgAzYCCCAAKAIIEARB////H3EhASAAKAIMIAE2AgAgACgCCEEDahAEQQJ2QYP+/x9xIQEgACgCDCABNgIEIAAoAghBBmoQBEEEdkH/gf8fcSEBIAAoAgwgATYCCCAAKAIIQQlqEARBBnZB///AH3EhASAAKAIMIAE2AgwgACgCCEEMahAEQQh2Qf//P3EhASAAKAIMIAE2AhAgACgCDEEANgIUIAAoAgxBADYCGCAAKAIMQQA2AhwgACgCDEEANgIgIAAoAgxBADYCJCAAKAIIQRBqEAQhASAAKAIMIAE2AiggACgCCEEUahAEIQEgACgCDCABNgIsIAAoAghBGGoQBCEBIAAoAgwgATYCMCAAKAIIQRxqEAQhASAAKAIMIAE2AjQgACgCDEIANwM4IAAoAgxBADoAUCAAQRBqJAAgAkEQaiQAQQALC5oCAwBBgAgLUvJfTBoANG51bGwALTEAbGVuZXJyADhbO9vHjBtXAADrT+Ic05XnuxTuKB+RT4EzANhcQ63ef1cbfGq6zlKfAKn94gdxx4Wm29kgXlY+wS0ALTIAQeAIC5UBQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlfLQAtMQAAYmFzaWNfc3RyaW5nAGFsbG9jYXRvcjxUPjo6YWxsb2NhdGUoc2l6ZV90IG4pICduJyBleGNlZWRzIG1heGltdW0gc3VwcG9ydGVkIHNpemUAQfgJCx8BAAAAAgAAAAMAAAD4BAAABAAAAAUAAAAIBQAAsApQ";if(!x.startsWith(S)){var D=x;x=t.locateFile?t.locateFile(D,c):c+D}function O(){var e=x;try{if(e==x&&p)return new Uint8Array(p);var t=L(e);if(t)return t;if(l)return l(e);throw"both async and sync fetching of the wasm failed"}catch(e){N(e)}}function b(e){for(;0<e.length;){var o=e.shift();if("function"==typeof o)o(t);else{var r=o.o;"number"==typeof r?void 0===o.m?v.get(r)():v.get(r)(o.m):r(void 0===o.m?null:o.m)}}}var R="function"==typeof atob?atob:function(e){var t="",o=0;e=e.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++)),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++)),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(o++));r=r<<2|i>>4,i=(15&i)<<4|n>>2;var s=(3&n)<<6|a;t+=String.fromCharCode(r),64!==n&&(t+=String.fromCharCode(i)),64!==a&&(t+=String.fromCharCode(s))}while(o<e.length);return t};function L(e){if(e.startsWith(S)){try{var t=R(e.slice(S.length)),o=new Uint8Array(t.length);for(e=0;e<t.length;++e)o[e]=t.charCodeAt(e)}catch(e){throw Error("Converting base64 string to bytes failed.")}return o}}var w={a:function(){N()},b:function(e,t,o){h.copyWithin(e,t,t+o)},c:function(){N("OOM")},d:function(){function e(e){return e?48<e.length?e.substr(0,48):e:""}var t=function(){var t=document.URL,o=window.navigator.userAgent.toLowerCase(),r="";0<document.referrer.length&&(r=document.referrer);try{0==r.length&&0<window.opener.location.href.length&&(r=window.opener.location.href)}catch(e){}var i=window.navigator.appCodeName,n=window.navigator.appName,a=window.navigator.platform;return t=e(t),r=e(r),t+"|"+(o=e(o))+"|"+r+"|"+i+"|"+n+"|"+a}(),o=function(e){for(var t=0,o=0;o<e.length;++o){var r=e.charCodeAt(o);55296<=r&&57343>=r&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++o)),127>=r?++t:t=2047>=r?t+2:65535>=r?t+3:t+4}return t}(t)+1,r=K(o);return g(t,r,o+1),r}};!function(){function e(e){t.asm=e.exports,e=t.asm.e.buffer,t.HEAP8=f=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=new Int32Array(e),t.HEAPU8=h=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e),v=t.asm.g,y.unshift(t.asm.f),I--,t.monitorRunDependencies&&t.monitorRunDependencies(I),0==I&&P&&(e=P,P=null,e())}function o(t){e(t.instance)}function i(e){return(p||!n&&!a||"function"!=typeof fetch?Promise.resolve().then((function(){return O()})):fetch(x,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+x+"'";return e.arrayBuffer()})).catch((function(){return O()}))).then((function(e){return WebAssembly.instantiate(e,s)})).then(e,(function(e){d("failed to asynchronously prepare wasm: "+e),N(e)}))}var s={a:w};if(I++,t.monitorRunDependencies&&t.monitorRunDependencies(I),t.instantiateWasm)try{return t.instantiateWasm(s,e)}catch(e){return d("Module.instantiateWasm callback failed with error: "+e),!1}(p||"function"!=typeof WebAssembly.instantiateStreaming||x.startsWith(S)||"function"!=typeof fetch?i(o):fetch(x,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,s).then(o,(function(e){return d("wasm streaming compile failed: "+e),d("falling back to ArrayBuffer instantiation"),i(o)}))}))).catch(r)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.f).apply(null,arguments)},t._getckey=function(){return(t._getckey=t.asm.h).apply(null,arguments)};var M,V=t.stackSave=function(){return(V=t.stackSave=t.asm.i).apply(null,arguments)},B=t.stackRestore=function(){return(B=t.stackRestore=t.asm.j).apply(null,arguments)},k=t.stackAlloc=function(){return(k=t.stackAlloc=t.asm.k).apply(null,arguments)},K=t._malloc=function(){return(K=t._malloc=t.asm.l).apply(null,arguments)};function Y(){function e(){if(!M&&(M=!0,t.calledRun=!0,!u)){if(b(y),o(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();T.unshift(e)}b(T)}}if(!(0<I)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)C();b(m),0<I||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}if(t.ccall=_,t.cwrap=function(e,t,o,r){var i=(o=o||[]).every((function(e){return"number"===e}));return"string"!==t&&i&&!r?A(e):function(){return _(e,t,o,arguments)}},P=function e(){M||Y(),M||(P=e)},t.run=Y,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return Y(),e.ready}),_scriptDir,getckey=function(){var e,t,o,r,i,n=-8290,a=-496,s=s||function(e,t){var o={},r=o.a={},i=function(){},a=r.b={c:function(e){for(var t="",o=0;o<"ॅूॅक़".length;o++)t+=String.fromCharCode(2348^"ॅूॅक़".charCodeAt(o));i.prototype=this;var r=new i;return e&&r.d(e),r.hasOwnProperty(t)||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.c();return e.init.apply(e,arguments),e},init:function(){},d:function(e){for(var t="",o=0;o<";͙ͥ;͸ͣͤͭ".length;o++)t+=String.fromCharCode(778^";͙ͥ;͸ͣͤͭ".charCodeAt(o));for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r]);e.hasOwnProperty(t)&&(this.toString=e.toString)},e:function(){return this.init.prototype.c(this)}},s=r.f=a.c({init:function(e,t){e=this.g=e||[],this.h=null!=t?t:(-2630+n+10924)*e.length},toString:function(e){return(e||c).i(this)},concat:function(e){var t=this.g,o=e.g,r=this.h;if(e=e.h,this.j(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(o[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<o.length)for(i=0;i<e;i+=4)t[r+i>>>2]=o[i>>>2];else t.push.apply(t,o);return this.h+=e,this},j:function(){var t=this.g,o=this.h;t[o>>>2]&=4294967295<<32-o%4*8,t.length=e.ceil(o/4)},e:function(){var e=a.e.call(this);return e.g=this.g.slice(0),e},random:function(t){for(var o=[],r=0;r<t;r+=4)o.push(4294967296*e.random()|0);return new s.init(o,t)}}),l=o.k={},c=l.l={i:function(e){for(var t="",o=0;o<"".length;o++)t+=String.fromCharCode(368^"".charCodeAt(o));var r=e.g;e=e.h;for(var i=[],n=0;n<e;n++){var a=r[n>>>2]>>>24-n%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join(t)},parse:function(e){for(var t=e.length,o=[],r=0;r<t;r+=2)o[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(o,t/2)}},p=l.m={i:function(e){for(var t="",o=0;o<"".length;o++)t+=String.fromCharCode(2238^"".charCodeAt(o));var r=e.g;e=e.h;for(var i=[],n=0;n<e;n++)i.push(String.fromCharCode(r[n>>>2]>>>24-n%4*8&255));return i.join(t)},parse:function(e){for(var t=e.length,o=[],r=0;r<t;r++)o[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(o,t)}},d=l.n={i:function(e){for(var t="",o=0,r="ØôùóúçøðñµÀÁÓ¸­µñôáô";o<r.length;o++)t+=String.fromCharCode(149^r.charCodeAt(o));try{return decodeURIComponent(escape(p.i(e)))}catch(e){throw Error(t)}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},u=r.o=a.c({p:function(){this.q=new s.init,this.r=0},s:function(e){for(var t="",o=0;o<"ྦྷྠྦ྽ྺླ".length;o++)t+=String.fromCharCode(4052^"ྦྷྠྦ྽ྺླ".charCodeAt(o));t==typeof e&&(e=d.parse(e)),this.q.concat(e),this.r+=e.h},t:function(t){var o=this.q,r=o.g,i=o.h,n=this.u,a=i/(4*n);if(t=(a=t?e.ceil(a):e.max((0|a)-this.v,0))*n,i=e.min(4*t,i),t){for(var l=0;l<t;l+=n)this.w(r,l);l=r.splice(0,t),o.h-=i}return new s.init(l,i)},e:function(){var e=a.e.call(this);return e.q=this.q.e(),e},v:0});r.x=u.c({y:a.c(),init:function(e){this.y=this.y.c(e),this.p()},p:function(){u.p.call(this),this.z()},A:function(e){return this.s(e),this.t(),this},B:function(e){return e&&this.s(e),this.C()},u:16,D:function(e){return function(t,o){return new e.init(o).B(t)}},F:function(e){return function(t,o){return new A.HMAC.init(e,o).B(t)}}});var A=o.G={};return o}(Math);function l(e){return c.call(this,2,e)}function c(e){for(var t="",o=0;o<"ऊ".length;o++)t+=String.fromCharCode(2422^"ऊ".charCodeAt(o));for(var r="",i=0;i<"ޭ".length;i++)r+=String.fromCharCode(2001^"ޭ".charCodeAt(i));for(var p="",d=0;d<"Ҡ".length;d++)p+=String.fromCharCode(1244^"Ҡ".charCodeAt(d));for(var u="",A=0;A<"ഇ".length;A++)u+=String.fromCharCode(3451^"ഇ".charCodeAt(A));for(var _="",E=0;E<"׿".length;E++)_+=String.fromCharCode(1411^"׿".charCodeAt(E));for(var g="",f=0;f<"ࢨ".length;f++)g+=String.fromCharCode(2260^"ࢨ".charCodeAt(f));for(var h="",v=0;v<"ଶ".length;v++)h+=String.fromCharCode(2890^"ଶ".charCodeAt(v));for(var m="",y=0;y<"ƨƢǶƦǶƧǵǱƧƤ".length;y++)m+=String.fromCharCode(453^"ƨƢǶƦǶƧǵǱƧƤ".charCodeAt(y));for(var T="",C=0;C<"੸".length;C++)T+=String.fromCharCode(2564^"੸".charCodeAt(C));for(var I="",P=0;P<"ࡌ".length;P++)I+=String.fromCharCode(2096^"ࡌ".charCodeAt(P));for(var N="",S=0;S<"ٶ".length;S++)N+=String.fromCharCode(1546^"ٶ".charCodeAt(S));for(var x="",D=0;D<"ઈ".length;D++)x+=String.fromCharCode(2804^"ઈ".charCodeAt(D));for(var O="",b=0;b<"ȧ".length;b++)O+=String.fromCharCode(603^"ȧ".charCodeAt(b));for(var R="",L=0;L<"о".length;L++)R+=String.fromCharCode(1090^"о".charCodeAt(L));for(var w="",M=0;M<"ߡ".length;M++)w+=String.fromCharCode(1949^"ߡ".charCodeAt(M));for(var V="",B=0;B<"̅".length;B++)V+=String.fromCharCode(889^"̅".charCodeAt(B));for(var k="",K=0;K<"".length;K++)k+=String.fromCharCode(3568^"".charCodeAt(K));for(var Y="",F=0;F<"".length;F++)Y+=String.fromCharCode(777^"".charCodeAt(F));for(var Q="",U=0;U<"".length;U++)Q+=String.fromCharCode(2613^"".charCodeAt(U));for(var H="",$=0;$<"´¹²¯".length;$++)H+=String.fromCharCode(214^"´¹²¯".charCodeAt($));for(var G="",q=0;q<"ۘە۞ۃ".length;q++)G+=String.fromCharCode(1722^"ۘە۞ۃ".charCodeAt(q));for(var j="",W=0;W<"٨٩٨٣".length;W++)j+=String.fromCharCode(1542^"٨٩٨٣".charCodeAt(W));for(var z="",X=0;X<"ÁÌ".length;X++)z+=String.fromCharCode(168^"ÁÌ".charCodeAt(X));for(var J="",Z=0;Z<"ۆۋ۔".length;Z++)J+=String.fromCharCode(1698^"ۆۋ۔".charCodeAt(Z));for(var ee="",te=0,oe="ଶଋ୑୞ଈ଍଍୑୙ଶ";te<oe.length;te++)ee+=String.fromCharCode(2921^oe.charCodeAt(te));for(var re="",ie=0;ie<"יׇ׀׊ׁי".length;ie++)re+=String.fromCharCode(1454^"יׇ׀׊ׁי".charCodeAt(ie));switch(e){case 0:var ne=[];window[re]===window?ne.push(0):ne.push(1);try{var ae=ee+Math.floor(1e7*Math.random()),se=document.createElement(J);se.setAttribute(z,ae),se.style.La=j,(document.body||document.getElementsByTagName(G)[0]).appendChild(se),document.getElementById(ae)?ne.push(0):ne.push(1),(document.body||document.getElementsByTagName(H)[0]).removeChild(se)}catch(e){ne.push(1)}return ne.join(Q);case 1:var le=arguments[1],ce=new s.a.f.init([1332468387,-1641050960,2136896045,-1629555948],16),pe=new s.a.f.init([22039283,1457920463,776125350,-1941999367],16);return s.Ga.$(le,ce,{ra:pe,ba:s.ba.la,qa:s.na.ma}).xa.toString().toUpperCase();case 2:return(fe=arguments[1])?fe.length>48?fe.substr(0,48):fe:Y;case 3:var de=window.document.URL,ue=window.navigator.userAgent.toLowerCase(),Ae=k;window.document.referrer.length>0&&(Ae=window.document.referrer);try{0==Ae.length&&opener.location.href.length>0&&(Ae=opener.location.href)}catch(e){}var _e=window.navigator.appCodeName,Ee=window.navigator.appName,ge=window.navigator.platform;return de=l(de),Ae=l(Ae),de+V+(ue=l(ue))+w+Ae+R+_e+O+Ee+x+ge;case 4:var fe=arguments[1],he=0;if(0==fe.length)return he;for(n=0;n<fe.length;n++){var ve=fe.charCodeAt(n);he=(he=(he<<5)-he+ve)&he}return he;case 5:var me=N+arguments[a+n+8787]+I+arguments[2]+T+m+h+arguments[3]+g+arguments[4]+_+arguments[5]+u+function(){return c.call(this,3)}()+p+function(){return c.call(this,0)}()+r;return function(e){return c.call(this,1,e)}(t+(he=function(e){return c.call(this,4,e)}(me))+me)}}return function(){for(var e="",t=0,o="±²³´µ¶·¸¹º»¼½¾¿ ¡¢£¤¥¦§¨©ªàáâãäåæçèéûÿí";t<o.length;t++)e+=String.fromCharCode(208^o.charCodeAt(t));var r=s,i=r.a.f;r.k.H={i:function(e){for(var t="",o=0;o<"".length;o++)t+=String.fromCharCode(4077^"".charCodeAt(o));var r=e.g,i=e.h,n=this.I;e.j(),e=[];for(var a=0;a<i;a+=3)for(var s=(r[a>>>2]>>>24-a%4*8&255)<<16|(r[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|r[a+2>>>2]>>>24-(a+2)%4*8&255,l=0;4>l&&a+.75*l<i;l++)e.push(n.charAt(s>>>6*(3-l)&63));if(r=n.charAt(64))for(;e.length%4;)e.push(r);return e.join(t)},parse:function(e){var t=e.length,o=this.I;(r=o.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],n=0,a=0;a<t;a++)if(a%4){var s=o.indexOf(e.charAt(a-1))<<a%4*2,l=o.indexOf(e.charAt(a))>>>6-a%4*2;r[n>>>2]|=(s|l)<<24-n%4*8,n++}return i.create(r,n)},I:e}}(),function(e){function t(e,t,o,r,i,n,a){return u.call(this,0,e,t,o,r,i,n,a)}function o(e,t,o,r,i,n,a){return u.call(this,1,e,t,o,r,i,n,a)}function r(e,t,o,r,i,n,a){return u.call(this,2,e,t,o,r,i,n,a)}function i(e,t,o,r,i,n,a){return u.call(this,3,e,t,o,r,i,n,a)}for(var n=s,a=(c=n.a).f,l=c.x,c=n.G,p=[],d=0;64>d;d++)p[d]=4294967296*e.abs(e.sin(d+1))|0;function u(e){switch(e){case 0:var t=arguments[1],o=arguments[2],r=arguments[3],i=arguments[4],n=arguments[5],a=arguments[6];return((t=t+(o&r|~o&i)+n+arguments[7])<<a|t>>>32-a)+o;case 1:return((t=(t=arguments[1])+((o=arguments[2])&(i=arguments[4])|(r=arguments[3])&~i)+(n=arguments[5])+arguments[7])<<(a=arguments[6])|t>>>32-a)+o;case 2:return((t=(t=arguments[1])+((o=arguments[2])^(r=arguments[3])^(i=arguments[4]))+(n=arguments[5])+arguments[7])<<(a=arguments[6])|t>>>32-a)+o;case 3:return((t=(t=arguments[1])+((r=arguments[3])^((o=arguments[2])|~(i=arguments[4])))+(n=arguments[5])+arguments[7])<<(a=arguments[6])|t>>>32-a)+o}}c=c.J=l.c({z:function(){this.K=new a.init([1732584193,4023233417,2562383102,271733878])},w:function(e,n){for(var a=0;16>a;a++){var s=e[d=n+a];e[d]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this.K.g;var l,c,d=e[n+0],u=(s=e[n+1],e[n+2]),A=e[n+3],_=e[n+4],E=e[n+5],g=e[n+6],f=e[n+7],h=e[n+8],v=e[n+9],m=e[n+10],y=e[n+11],T=e[n+12],C=e[n+13],I=e[n+14],P=e[n+15],N=a[0],S=i(S=i(S=i(S=i(S=r(S=r(S=r(S=r(S=o(S=o(S=o(S=o(S=t(S=t(S=t(S=t(S=a[1],c=t(c=a[2],l=t(l=a[3],N=t(N,S,c,l,d,7,p[0]),S,c,s,12,p[1]),N,S,u,17,p[2]),l,N,A,22,p[3]),c=t(c,l=t(l,N=t(N,S,c,l,_,7,p[4]),S,c,E,12,p[5]),N,S,g,17,p[6]),l,N,f,22,p[7]),c=t(c,l=t(l,N=t(N,S,c,l,h,7,p[8]),S,c,v,12,p[9]),N,S,m,17,p[10]),l,N,y,22,p[11]),c=t(c,l=t(l,N=t(N,S,c,l,T,7,p[12]),S,c,C,12,p[13]),N,S,I,17,p[14]),l,N,P,22,p[15]),c=o(c,l=o(l,N=o(N,S,c,l,s,5,p[16]),S,c,g,9,p[17]),N,S,y,14,p[18]),l,N,d,20,p[19]),c=o(c,l=o(l,N=o(N,S,c,l,E,5,p[20]),S,c,m,9,p[21]),N,S,P,14,p[22]),l,N,_,20,p[23]),c=o(c,l=o(l,N=o(N,S,c,l,v,5,p[24]),S,c,I,9,p[25]),N,S,A,14,p[26]),l,N,h,20,p[27]),c=o(c,l=o(l,N=o(N,S,c,l,C,5,p[28]),S,c,u,9,p[29]),N,S,f,14,p[30]),l,N,T,20,p[31]),c=r(c,l=r(l,N=r(N,S,c,l,E,4,p[32]),S,c,h,11,p[33]),N,S,y,16,p[34]),l,N,I,23,p[35]),c=r(c,l=r(l,N=r(N,S,c,l,s,4,p[36]),S,c,_,11,p[37]),N,S,f,16,p[38]),l,N,m,23,p[39]),c=r(c,l=r(l,N=r(N,S,c,l,C,4,p[40]),S,c,d,11,p[41]),N,S,A,16,p[42]),l,N,g,23,p[43]),c=r(c,l=r(l,N=r(N,S,c,l,v,4,p[44]),S,c,T,11,p[45]),N,S,P,16,p[46]),l,N,u,23,p[47]),c=i(c,l=i(l,N=i(N,S,c,l,d,6,p[48]),S,c,f,10,p[49]),N,S,I,15,p[50]),l,N,E,21,p[51]),c=i(c,l=i(l,N=i(N,S,c,l,T,6,p[52]),S,c,A,10,p[53]),N,S,m,15,p[54]),l,N,s,21,p[55]),c=i(c,l=i(l,N=i(N,S,c,l,h,6,p[56]),S,c,P,10,p[57]),N,S,g,15,p[58]),l,N,C,21,p[59]),c=i(c,l=i(l,N=i(N,S,c,l,_,6,p[60]),S,c,y,10,p[61]),N,S,u,15,p[62]),l,N,v,21,p[63]);a[0]=a[0]+N|0,a[1]=a[1]+S|0,a[2]=a[2]+c|0,a[3]=a[3]+l|0},C:function(){var t=this.q,o=t.g,r=8*this.r,i=8*t.h;o[i>>>5]|=128<<24-i%32;var n=e.floor(r/4294967296);for(o[15+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),o[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.h=4*(o.length+1),this.t(),o=(t=this.K).g,r=0;4>r;r++)i=o[r],o[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},e:function(){var e=l.e.call(this);return e.K=this.K.e(),e}}),n.J=l.D(c),n.L=l.F(c)}(Math),o=(e=(t=s).a).b,r=e.f,i=(e=t.G).M=o.c({y:o.c({N:4,O:e.J,P:1}),init:function(e){this.y=this.y.c(e)},Q:function(e,t){for(var o=(s=this.y).O.create(),i=r.create(),n=i.g,a=s.N,s=s.P;n.length<a;){l&&o.A(l);var l=o.A(e).B(t);o.p();for(var c=1;c<s;c++)l=o.B(l),o.p();i.concat(l)}return i.h=4*a,i}}),t.M=function(e,t,o){return i.create(o).Q(e,t)},s.a.R||function(e){var t=(_=s).a,o=t.b,r=t.f,i=t.o,n=_.k.H,a=_.G.M,l=t.R=i.c({y:o.c(),S:function(e,t){return this.create(this.T,e,t)},U:function(e,t){return this.create(this.V,e,t)},init:function(e,t,o){this.y=this.y.c(o),this.W=e,this.X=t,this.p()},p:function(){i.p.call(this),this.z()},Y:function(e){return this.s(e),this.t()},B:function(e){return e&&this.s(e),this.C()},N:4,Z:4,T:1,V:2,D:function(e){return{$:function(t,o,r){for(var i="",n=0;n<"ǠǧǡǺǽǴ".length;n++)i+=String.fromCharCode(403^"ǠǧǡǺǽǴ".charCodeAt(n));return(i==typeof o?E:A).$(e,t,o,r)},_:function(t,o,r){for(var i="",n=0;n<"ࣘࣟࣙࣂࣅ࣌".length;n++)i+=String.fromCharCode(2219^"ࣘࣟࣙࣂࣅ࣌".charCodeAt(n));return(i==typeof o?E:A)._(e,t,o,r)}}}});t.aa=l.c({C:function(){return this.t(!0)},u:1});var c=_.ba={},p=function(e,t,o){var r=this.ca;r?this.ca=void 0:r=this.da;for(var i=0;i<o;i++)e[t+i]^=r[i]},d=(t.ea=o.c({S:function(e,t){return this.fa.create(e,t)},U:function(e,t){return this.ga.create(e,t)},init:function(e,t){this.ha=e,this.ca=t}})).c();d.fa=d.c({ia:function(e,t){var o=this.ha,r=o.u;p.call(this,e,t,r),o.ja(e,t),this.da=e.slice(t,t+r)}}),d.ga=d.c({ia:function(e,t){var o=this.ha,r=o.u,i=e.slice(t,t+r);o.ka(e,t),p.call(this,e,t,r),this.da=i}}),c=c.la=d,d=(_.na={}).ma={na:function(e,t){for(var o,i=(o=(o=4*t)-e.h%o)<<24|o<<16|o<<8|o,n=[],a=0;a<o;a+=4)n.push(i);o=r.create(n,o),e.concat(o)},oa:function(e){e.h-=255&e.g[e.h-1>>>2]}},t.pa=l.c({y:l.y.c({ba:c,qa:d}),p:function(){l.p.call(this);var e=(t=this.y).ra,t=t.ba;if(this.W==this.T)var o=t.S;else o=t.U,this.v=1;this.sa=o.call(t,this,e&&e.g)},w:function(e,t){this.sa.ia(e,t)},C:function(){var e=this.y.qa;if(this.W==this.T){e.na(this.q,this.u);var t=this.t(!0)}else t=this.t(!0),e.oa(t);return t},u:4});var u=t.ta=o.c({init:function(e){this.d(e)},toString:function(e){return(e||this.ua).i(this)}}),A=(c=(_.wa={}).va={i:function(e){var t=e.xa;return((e=e.ya)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(n)},parse:function(e){var t=(e=n.parse(e)).g;if(1398893684==t[0]&&1701076831==t[1]){var o=r.create(t.slice(2,4));t.splice(0,4),e.h-=16}return u.create({xa:e,ya:o})}},t.za=o.c({y:o.c({wa:c}),$:function(e,t,o,r){r=this.y.c(r);var i=e.S(o,r);return t=i.B(t),i=i.y,u.create({xa:t,Aa:o,ra:i.ra,Ba:e,ba:i.ba,qa:i.qa,u:e.u,ua:r.wa})},_:function(e,t,o,r){return r=this.y.c(r),t=this.Ca(t,r.wa),e.U(o,r).B(t.xa)},Ca:function(e,t){for(var o="",r=0;r<"ࠕࠒࠔࠏࠈࠁ".length;r++)o+=String.fromCharCode(2150^"ࠕࠒࠔࠏࠈࠁ".charCodeAt(r));return o==typeof e?t.parse(e,this):e}})),_=(_.Da={}).va={Ea:function(e,t,o,i){return i||(i=r.random(8)),e=a.create({N:t+o}).Q(e,i),o=r.create(e.g.slice(t),4*o),e.h=4*t,u.create({Aa:e,ra:o,ya:i})}},E=t.Fa=A.c({y:A.y.c({Da:_}),$:function(e,t,o,r){return o=(r=this.y.c(r)).Da.Ea(o,e.N,e.Z),r.ra=o.ra,(e=A.$.call(this,e,t,o.Aa,r)).d(o),e},_:function(e,t,o,r){return r=this.y.c(r),t=this.Ca(t,r.wa),o=r.Da.Ea(o,e.N,e.Z,t.ya),r.ra=o.ra,A._.call(this,e,t,o.Aa,r)}})}(),function(){for(var e=s,t=e.a.pa,o=e.G,r=[],i=[],n=[],a=[],l=[],c=[],p=[],d=[],u=[],A=[],_=[],E=0;256>E;E++)_[E]=128>E?E<<1:E<<1^283;var g=0,f=0;for(E=0;256>E;E++){var h=(h=f^f<<1^f<<2^f<<3^f<<4)>>>8^255&h^99;r[g]=h,i[h]=g;var v=_[g],m=_[v],y=_[m],T=257*_[h]^16843008*h;n[g]=T<<24|T>>>8,a[g]=T<<16|T>>>16,l[g]=T<<8|T>>>24,c[g]=T,T=16843009*y^65537*m^257*v^16843008*g,p[h]=T<<24|T>>>8,d[h]=T<<16|T>>>16,u[h]=T<<8|T>>>24,A[h]=T,g?(g=v^_[_[_[y^v]]],f^=_[_[f]]):g=f=1}var C=[0,1,2,4,8,16,32,64,128,27,54];o=o.Ga=t.c({z:function(){for(var e=(o=this.X).g,t=o.h/4,o=4*((this.Ha=t+6)+1),i=this.Ia=[],n=0;n<o;n++)if(n<t)i[n]=e[n];else{var a=i[n-1];n%t?6<t&&4==n%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=C[n/t|0]<<24),i[n]=i[n-t]^a}for(e=this.Ja=[],t=0;t<o;t++)n=o-t,a=t%4?i[n]:i[n-4],e[t]=4>t||4>=n?a:p[r[a>>>24]]^d[r[a>>>16&255]]^u[r[a>>>8&255]]^A[r[255&a]]},ja:function(e,t){this.Ka(e,t,this.Ia,n,a,l,c,r)},ka:function(e,t){var o=e[t+1];e[t+1]=e[t+3],e[t+3]=o,this.Ka(e,t,this.Ja,p,d,u,A,i),o=e[t+1],e[t+1]=e[t+3],e[t+3]=o},Ka:function(e,t,o,r,i,n,a,s){for(var l=this.Ha,c=e[t]^o[0],p=e[t+1]^o[1],d=e[t+2]^o[2],u=e[t+3]^o[3],A=4,_=1;_<l;_++){var E=r[c>>>24]^i[p>>>16&255]^n[d>>>8&255]^a[255&u]^o[A++],g=r[p>>>24]^i[d>>>16&255]^n[u>>>8&255]^a[255&c]^o[A++],f=r[d>>>24]^i[u>>>16&255]^n[c>>>8&255]^a[255&p]^o[A++];u=r[u>>>24]^i[c>>>16&255]^n[p>>>8&255]^a[255&d]^o[A++],c=E,p=g,d=f}E=(s[c>>>24]<<24|s[p>>>16&255]<<16|s[d>>>8&255]<<8|s[255&u])^o[A++],g=(s[p>>>24]<<24|s[d>>>16&255]<<16|s[u>>>8&255]<<8|s[255&c])^o[A++],f=(s[d>>>24]<<24|s[u>>>16&255]<<16|s[c>>>8&255]<<8|s[255&p])^o[A++],u=(s[u>>>24]<<24|s[c>>>16&255]<<16|s[p>>>8&255]<<8|s[255&d])^o[A++],e[t]=E,e[t+1]=g,e[t+2]=f,e[t+3]=u},N:8}),e.Ga=t.D(o)}(),function(e,t,o,r,i){return c.call(this,5,e,t,o,r,i)}}(),getCkey9;function updateCkey$1(e,t){return __awaiter$1(this,void 0,void 0,(function(){var o,r,i,n,a,s,l,c,p;return __generator$1(this,(function(d){switch(d.label){case 0:return o=t.tm,r=t.vid,i=t.appVer,n=t.guid,a=t.platform,l=o||getTimeStampStr$1(),e!==CKEY_VRE.CKEY_9?[3,3]:getCkey9?[3,2]:[4,_thumbplayerCkeyWasmFactory(void 0)];case 1:p=d.sent(),getCkey9=p.cwrap("getckey","string",["int","string","string","string","string","int"]),d.label=2;case 2:return c=getCkey9(+a,i,r,"",n,+l),s=CKEY_VRE.CKEY_9,[3,4];case 3:c=getckey(r,l,i,n,a),s=CKEY_VRE.CKEY_8,d.label=4;case 4:return t.tm=l,t.cKey=c,t.encryptVer=s,[2,t]}}))}))}var prepareRequestMiddleWare=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l;return __generator$1(this,(function(c){switch(c.label){case 0:return o=e.reqParams,r=e.config,i=e.player,n=r.ckeyVer,[4,Promise.all([updateCkey$1(n,o),getRequestParamForDRM(o.drm)])];case 1:return a=c.sent(),s=a[1],o.drm=s,i.setCommonKv(((l={})[VOD_GET_INFO_DATA_KEYS.ckey]=o.cKey,l[VOD_GET_INFO_DATA_KEYS.ckeyVersion]=n,l)),e.logger.log("request params is:",jsonTool.safelyStringify(e.reqParams)),[4,t()];case 2:return c.sent(),[2]}}))}))};function getRequestUrl$1(e,t){var o=e.test,r=e.path;if(o)return PATH.TEST;var i=r||PATH.COMMON;return"string"==typeof i?i:i[t%i.length]}var sendRequestMiddleWare$1=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l,c,p,d,u,A,_,E;return __generator$1(this,(function(g){switch(g.label){case 0:e.logger.log("doRequest start..."),o=e.requestor,r=e.reqParams,i=e.config,a=(n=i).ckeyVer,s=n.retryCount,l=void 0===s?3:s,p=0,g.label=1;case 1:if(!(p<l+1))return[3,8];e.logger.log("retry... count is: ",p),g.label=2;case 2:return g.trys.push([2,5,,6]),c=null,e.reqPath=getRequestUrl$1(i,p),d=e,(u=e.resData)?[3,4]:[4,o.start(e.reqPath,r,i)];case 3:u=g.sent(),g.label=4;case 4:return d.resData=u,[3,6];case 5:return A=g.sent(),e.logger.log("the "+p+" retry err:",A),"jsonp timeout"===(null==A?void 0:A.message)&&(c={code:exports.ErrorCode.GETINFO_TIMEOUT,message:exports.ErrorMsg.GETINFO_TIMEOUT}),[3,6];case 6:if(e.alreadyRetryCount=p,e.resData)return[3,8];g.label=7;case 7:return p++,[3,1];case 8:return e.resData&&85==+e.resData.em&&-3==+e.resData.exem?(e.reqParams.tm=e.resData.curTime,[4,updateCkey$1(a,r)]):[3,13];case 9:g.sent(),g.label=10;case 10:return g.trys.push([10,12,,13]),e.logger.log("retry ckey... "),e.reqPath=getRequestUrl$1(i,0),_=e,[4,o.start(e.reqPath,r,i)];case 11:return _.resData=g.sent(),[3,13];case 12:return E=g.sent(),e.logger.log("retry ckey err:",E),[3,13];case 13:if(e.endTime=+new Date,!e.resData)return e.throw((null==c?void 0:c.code)||exports.ErrorCode.GETINFO_NET,(null==c?void 0:c.message)||exports.ErrorMsg.GETINFO_NET),[2];try{e.logger.log("sendRequest over... ret is: ",JSON.stringify(e.resData,(function(e,t){return"m3u8"===e?"":t})))}catch(e){}return[4,t()];case 14:return g.sent(),[2]}}))}))},setPlayerDataMiddleWare$1=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l,c,p,d,u,A,_;return __generator$1(this,(function(E){switch(E.label){case 0:return o=e.player,r=e.resData,i=e.parseData,o.setCommonKv(((n={})[COMMON_DATA_KEY.status]=null===(a=i.vitem)||void 0===a?void 0:a.vst,n[COMMON_DATA_KEY.type]=null===(s=i.vitem)||void 0===s?void 0:s.type,n.videoName=i.title,n.byteRate=i.byteRate,n[COMMON_DATA_KEY.duration]=i.duration,n.preview=i.preview,n.drm=getDrm(r),n[COMMON_DATA_KEY.p2p]=r.fp2p?1:0,n[COMMON_DATA_KEY.fmt]=null===(c=null===(l=i.definitionList)||void 0===l?void 0:l.find((function(e){return e.sl})))||void 0===c?void 0:c.id,n[COMMON_DATA_KEY.testid]=r.tstid,n[COMMON_DATA_KEY.cdnid]=null===(A=null===(u=null===(d=null===(p=i.vitem)||void 0===p?void 0:p.ul)||void 0===d?void 0:d.ui)||void 0===u?void 0:u[0])||void 0===A?void 0:A.vt,n[COMMON_DATA_KEY.rate]=i.byteRate,n[COMMON_DATA_KEY.dltype]=r.dltype,n[VOD_GET_INFO_DATA_KEYS.vurl]=null===(_=i.urls[0])||void 0===_?void 0:_.url,n)),[4,t()];case 1:return E.sent(),[2]}}))}))};function compose$1(e){return function(t,o){var r=-1;return function i(n){if(n<=r)return Promise.reject(new Error("next() called multiple times"));r=n;var a=e[n];n===e.length&&(a=o);if(!a)return Promise.resolve(null);try{return Promise.resolve(a(t,i.bind(null,n+1)))}catch(e){return Promise.reject(e)}}(0)}}var GetInfoVod=function(e){function t(t,o,r){var i,n=e.call(this,t,o,r)||this;return n._abort=!1,n._seq=0,n.cachedResult={},n._config=__assign$1(__assign$1(__assign$1({},DEFAULT_GETINFO_CONFIG$1),(null===(i=t.config)||void 0===i?void 0:i.getinfoConfig)||{}),o),n.logger=new Logger(t.config.instanceId,"GetInfoVod"),n}return __extends$1(t,e),t.prototype.getReqParams=function(e,t){var o=this,r=this.prepare(e,t);return compose$1([this._config.prepareRequestMiddleWare||prepareRequestMiddleWare])(r).then((function(){return o.onMiddlewareExecuteSuccess(r)})).catch((function(e){return o.onMiddlewareExecutionFail(r,e)}))},t.prototype.setVideoInfo=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return t?this.parseExternalVideoInfo(e,t):this.cachedResult[e]=void 0,[2]}))}))},t.prototype.parseExternalVideoInfo=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var o,r,i,n,a=this;return __generator$1(this,(function(s){return(o=this.prepare(e)).resData=t,r=this._config.sendRequestMiddleWare||sendRequestMiddleWare$1,i=this._config.checkResponseMiddleWare||checkResponseMiddleWare$1,n=this._config.parseResponseMiddleWare||parseResponseMiddleWare$1,this.cachedResult[e]=compose$1([r,i,n,setPlayerDataMiddleWare$1])(o).then((function(){return a.onMiddlewareExecuteSuccess(o)})).catch((function(e){return a.onMiddlewareExecutionFail(o,e)})),[2]}))}))},t.prototype.request=function(e,t,o){return __awaiter$1(this,void 0,void 0,(function(){var r,i,n,a,s,l,c,p,d=this;return __generator$1(this,(function(u){switch(u.label){case 0:return r=e,this._abort=!1,this.cachedResult[r]?[4,this.cachedResult[r]]:[3,2];case 1:return i=u.sent(),this.cachedResult[r]=void 0,[2,Promise.resolve(i)];case 2:return n=this.prepare(r,t),(a=this.validateReqParams(n.reqParams))?(n.error={code:exports.ErrorCode.GETINFO_INNER,message:"缺少必要播放参数 ("+a+") "},[2,Promise.resolve(this.formatOutputData(n))]):(s=this._config.prepareRequestMiddleWare||prepareRequestMiddleWare,l=this._config.sendRequestMiddleWare||sendRequestMiddleWare$1,c=this._config.checkResponseMiddleWare||checkResponseMiddleWare$1,p=this._config.parseResponseMiddleWare||parseResponseMiddleWare$1,[2,compose$1((null==o?void 0:o.length)>0?o:[s,l,c,p,setPlayerDataMiddleWare$1])(n).then((function(){return d.onMiddlewareExecuteSuccess(n)})).catch((function(e){return d.onMiddlewareExecutionFail(n,e)}))])}}))}))},t.prototype.abort=function(){this._abort=!0},t.prototype.destroy=function(){this.abort(),this.cachedResult=null,e.prototype.destroy.call(this)},t.prototype.validateReqParams=function(e){return["vid","platform","sdtfrom","flowid","guid"].find((function(t){return!e[t]}))},t.prototype.prepare=function(e,t){this._abort=!1,this._seq+=1;var o=this.createBaseContext();return Object.assign(o.reqParams,t,{vid:e}),o},t.prototype.onMiddlewareExecuteSuccess=function(e){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return this._abort||this._seq!==e.seq?(this.cachedResult[e.vid]=void 0,[2,new Promise((function(){}))]):(this.logger.log("getinfo 成功: ",e),[2,this.formatOutputData(e)])}))}))},t.prototype.onMiddlewareExecutionFail=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var o,r;return __generator$1(this,(function(i){return this._abort||this._seq!==e.seq?(this.cachedResult[e.vid]=void 0,[2,new Promise((function(){}))]):(o=t.code,r=t.message,o||(this.logger.warn("getinfo 内部错误: ",t),o=exports.ErrorCode.GETINFO_INNER,r=exports.ErrorMsg.GETINFO_INNER+", err ("+t+")"),e.error={code:o,message:r},[2,this.formatOutputData(e)])}))}))},t.prototype.collectBaseRequestParam=function(){return __assign$1(__assign$1({},DEFAULT_REQ_PARAMS$1),{appVer:this.player.getCommonKv(COMMON_DATA_KEY.appVer),platform:this.player.getCommonKv(COMMON_DATA_KEY.platform),sdtfrom:this.player.getCommonKv(COMMON_DATA_KEY.sdtfrom),flowid:this.player.getCommonKv(COMMON_DATA_KEY.flowid),guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)})},t.prototype.createBaseContext=function(){return{player:this.player,startTime:+new Date,endTime:0,alreadyRetryCount:0,config:this._config,reqParams:this.collectBaseRequestParam(),reqPath:void 0,resData:void 0,requestor:new JsonpRequestor("getinfo_callback_"),parseData:void 0,error:void 0,throw:function(e,t){var o=new Error("getinfo err");throw o.code=e,o.message=t,o},seq:this._seq,urlConfig:null,logger:this.logger}},t.prototype.formatOutputData=function(e){var t,o,r,i,n,a,s,l=e.reqParams,c=e.resData,p=e.parseData,d=__assign$1({},e);["requestor","player","throw"].forEach((function(e){delete d[e]}));var u=void 0,A=this.player.getCommonKv(COMMON_DATA_KEY.drm),_=parseCodecInfo$1(c),E=_.codec,g=_.vtype,f=selectKernel$1(c);if(c&&p){var h=null==p?void 0:p.urls.map((function(e){return e.url})),v=h[0],m=h.slice(1),y=(null===(o=null===(t=null==p?void 0:p.vitem)||void 0===t?void 0:t.ckc)||void 0===o?void 0:o.split("|"))||[],T=y[0],C=y[1],I=c.fp2p>=0&&(null===(n=null===(i=null===(r=c.vl)||void 0===r?void 0:r.vi)||void 0===i?void 0:i[0])||void 0===n?void 0:n.keyid),P=c.downloadmode;u={url:v,backupUrls:m,m3u8:null==p?void 0:p.urls.m3u8,p2pConfig:I?this.prepareP2PConfig({keyId:"hls."+I,useP2P:2===c.fp2p,downloadMode:P}):null,drmConfig:T?this.prepareDRMConfig({drmType:A,licenseUrl:T,certificateUrl:C}):null,chachaParam:A===DRM_TYPE.CHACHA?{linkvid:null===(a=null==p?void 0:p.vitem)||void 0===a?void 0:a.lnk,base:null===(s=null==p?void 0:p.vitem)||void 0===s?void 0:s.base,appVer:l.appVer,tm:null==c?void 0:c.tm,platform:l.platform}:null,drmType:A,kernelName:f,vcodec:E,expireTimeStamp:+new Date+URL_EXPIRE_TIME}}return this.player.setCommonKv(COMMON_DATA_KEY.codec,g||"unknown"),__assign$1(__assign$1({},d),{kernelName:f,urlConfig:u})},t.prototype.prepareDRMConfig=function(e){var t,o,r=e.drmType,i=e.licenseUrl,n=e.certificateUrl,a=this.player.getCommonKv,s=((t={})[DRM_TYPE.FAIR_PLAY]=KeySystems.FairPlayWebKit,t[DRM_TYPE.WIDEVINE]=KeySystems.Widevine,t),l={licenseUrl:i,certificate:{},keySystem:s[r],licenseRequestSetup:function(e){if(e.responseType="json",r===DRM_TYPE.FAIR_PLAY){var t={guid:a(COMMON_DATA_KEY.guid),fmt:a(COMMON_DATA_KEY.fmt)},o=Object.keys(t).map((function(e){return e+"="+t[e]})).join("&");return e.body=e.body+"&"+o,e}return e},licenseResponseSetup:function(e){var t=e.code,o=e.ckc,r=e.msg;if(0===t)return stringTool.base64ToUint8Array(o);throw{code:t,message:r}}};return r===DRM_TYPE.FAIR_PLAY&&(l.certificate=((o={})[s[r]]=n,o)),l},t.prototype.prepareP2PConfig=function(e){return __assign$1({flowId:this.player.getCommonKv(COMMON_DATA_KEY.flowid),playerInfo:this.getPlayerInfo()},e)},t.prototype.getPlayerInfo=function(){var e={platform:this.player.getCommonKv(COMMON_DATA_KEY.platform)||"",osVer:this.player.getCommonKv(COMMON_DATA_KEY.osver)||"",broVer:this.player.getCommonKv(COMMON_DATA_KEY.ua)||"",playerVer:this.player.getCommonKv(COMMON_DATA_KEY.playerver)||"",guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)||"",qq:"",wx:"",vip:!1},t=this.player.getCommonKv(COMMON_DATA_KEY.hc_main_login);return"qq"===t?e.qq=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid):"wx"===t&&(e.wx=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid)),e},t.pluginName="__thumbplayer-video-request",t}(Plugin),Poller=function(){function e(){var e=this;this.MAX_RETRY_TIMES=-1,this.markContext="last=0",this.pollInterval=3e4,this.reqData=null,this.timeout=5e3,this.loadInfo=function(){if(e.reqData){e.reqData.markContext=encodeURIComponent(e.markContext),e.reqData.tm=+new Date,e.reqData.vappid="31678259",e.reqData.vsecret="1e029a67beb2d7e7e7bb8321fb161a46fe76c7837beb2cee",e.reqData.otype="json",e.reqData.raw="1";var t={url:"https://zbaccess.video.qq.com/fcgi/live_poll?"+urlTool.object2string(e.reqData,"&")};return-1!==e.timeout&&(t.timeout=e.timeout),netTool.xhr(t).then(e.onCGIComplete).catch((function(t){throw e.onCGIError(t),t}))}},this.onCGIComplete=function(t){var o,r;e.clearTimer(),e.errorRetryTimes=0;try{r=JSON.parse(null==t?void 0:t.data).data}catch(t){e.onCGIError(t)}if(0===(null==r?void 0:r.errCode)){var i=Number(r.pollTimeOut);!isNaN(i)&&i>0&&(e.pollInterval=1e3*i),e.pollTimerID=window.setTimeout(e.loadInfo,e.pollInterval),null===(o=e.onCallback)||void 0===o||o.call(e,null,r),r.markContext&&(e.markContext=r.markContext)}else e.onCGIError(r)}}return e.prototype.start=function(e,t){return void 0===e&&(e={}),this.reqData=e,this.errorRetryTimes=0,this.onCallback=t,this.loadInfo()},e.prototype.dispose=function(){this.clearTimer(),this.reqData=null,this.onCallback=null},e.prototype.onCGIError=function(e){var t;this.clearTimer(),this.errorRetryTimes+=1,-1===this.MAX_RETRY_TIMES||this.errorRetryTimes<=this.MAX_RETRY_TIMES?this.pollTimerID=window.setTimeout(this.loadInfo,this.pollInterval):null===(t=this.onCallback)||void 0===t||t.call(this,e,null)},e.prototype.clearTimer=function(){this.pollTimerID>0&&(clearTimeout(this.pollTimerID),this.pollTimerID=0)},e}(),LIVE_STATUS;!function(e){e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.OVER=3]="OVER"}(LIVE_STATUS||(LIVE_STATUS={}));var LIVE_EVENTS={statusChange:"statusChange"},getUin=function(){var e=cookieTool.get("uin")||cookieTool.get("luin"),t=parseInt(e.replace(/^o0*/g,""),10);return isNaN(t)||t<=1e4?0:t},LivepollPlugin=function(e){function t(t,o){var r=e.call(this,t)||this;r.status=LIVE_STATUS.READY,r.poller=new Poller,r.destory=function(){return r.poller.dispose()},r.handlerLivePollData=function(e,t){if(!e&&t){var o=Number(t.liveStatus);o!==r.status&&(r.emit(LIVE_EVENTS.statusChange,{old:r.status,new:o,raw:t}),o===LIVE_STATUS.OVER&&(r.player.stop(),r.destory())),r.status=o}},r.config=__assign$1(__assign$1({},t.config.livepollConfig),o);var i=r.config,n=i.livepid,a=i.autolisten,s=void 0===a||a,l=i.timeout,c=void 0===l?5e3:l;return r.poller.timeout=c,n&&(r.livepid=n),s&&(t.addListener(exports.PLAY_EVENT.FIRST_PLAYING,(function(){return r.request()})),t.addListener(exports.PLAY_EVENT.STOPED,r.destory)),r}return __extends$1(t,e),t.prototype.request=function(e){if((null==e?void 0:e.livepid)&&(this.livepid=e.livepid),this.poller.dispose(),this.livepid)return this.poller.start({pollDataKey:encodeURIComponent("pid="+this.livepid),needMarkInfo:1,qqlog:getUin(),guid:this.player.getCommonKv("guid")},this.handlerLivePollData)},t.pluginName="live-poll",t}(Plugin);function styleInject(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}H5Player.registerPlugin(LivepollPlugin.pluginName,LivepollPlugin);var css_248z="@-webkit-keyframes txp_loading{0%{background-position:0 0}to{background-position:0 -600px}}@keyframes txp_loading{0%{background-position:0 0}to{background-position:0 -600px}}.txp_overlay_loading{position:absolute;left:0;top:0;width:100%;height:100%;z-index:5;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;pointer-events:none}.txp_overlay_loading.txp_none,.txp_overlay_loading .txp_none{display:none}.txp_overlay_loading .txp_icon_loading{display:block;width:54px;height:20px;margin:0 auto 10px;background:url(https://vm.gtimg.cn/tencentvideo/txp/style/img/loading.png) 0 0 no-repeat;background-size:54px 600px;-webkit-animation:txp_loading 1s steps(30) infinite;animation:txp_loading 1s steps(30) infinite}.txp_overlay_loading .txp_icon_loading.mobile{-webkit-transform:scale(.5);transform:scale(.5);margin:0 auto}";styleInject(css_248z);var hideClass$1="txp_none",htmlStr='<div class="txp_overlay_loading '+hideClass$1+'">\n<div class="txp_text" data-role="txp-ui-continue-play"></div>\n<div class="txp_icon_loading" data-role="txp-ui-loading"></div>\n</div>',UILoadingPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;return i.show=function(e){void 0===e&&(e=""),i.$continuePlay.innerHTML=e,i.$el.classList.remove(hideClass$1)},i.hide=function(){i.$el.classList.add(hideClass$1)},i.insertDOM(),t.on(exports.PLAY_EVENT.SET_LOADING,(function(e){var t=e.data.show;i.player.setStateKv("ui-loading:"+(t?"show":"hide"),{type:exports.LOG_TYPE.PLUGIN_ACTION}),t?i.show():i.hide()})),i}return __extends$1(t,e),t.prototype.prependElement=function(e){var t;null===(t=this.$el)||void 0===t||t.insertAdjacentElement("afterbegin",e)},t.prototype.insertDOM=function(){var e,t=this.player.container;t.insertAdjacentHTML("beforeend",htmlStr),this.$el=t.querySelector(".txp_overlay_loading"),this.$continuePlay=t.querySelector('[data-role="txp-ui-continue-play"]'),this.$loading=t.querySelector('[data-role="txp-ui-loading"]'),(null===(e=this.config)||void 0===e?void 0:e.useMobileStyle)&&this.$loading.classList.add("mobile")},t.pluginName="ui-loading",t}(Plugin),STREAM_TYPE;H5Player.registerPlugin(UILoadingPlugin.pluginName,UILoadingPlugin),function(e){e[e.AUTO=0]="AUTO",e[e.FLV=1]="FLV",e[e.HLS=2]="HLS",e[e.RTMP=4]="RTMP",e[e.DASH=8]="DASH",e[e.WEB_RTC=16]="WEB_RTC",e[e.T_RTC=32]="T_RTC"}(STREAM_TYPE||(STREAM_TYPE={}));var ZB_CGI_ARR=["https://infozb6.video.qq.com/cgi-bin/getliveinfo?","https://bkinfozb6.video.qq.com/cgi-bin/getliveinfo?"],ZB_CGI_TEST="https://test.zb.video.qq.com/cgi-bin/getliveinfo?",LIVE_GET_INFO_DATA_KEYS;!function(e){e.playtime="live-getinfo:playtime",e.livesid="live-getinfo:livesid",e.isuserpay="live-getinfo:isuserpay",e.cpay="live-getinfo:cpay",e.restpreviewcnt="live-getinfo:resetpreviewcnt"}(LIVE_GET_INFO_DATA_KEYS||(LIVE_GET_INFO_DATA_KEYS={}));var NECESSARY_REQ_PARAMS=["flowid","pid","chid","guid"],DEFAULT_GETINFO_CONFIG={retryCount:3,test:0,timeout:6e3};function getSpHttps(){return"https:"===location.protocol?1:0}function getTimeStampStr(e){var t=e||10,o=(+new Date).toString();return o.length>t?o.substring(0,t):("00000000000"+o).slice(-1*t)}var DEFAULT_REQ_PARAMS={flowid:"",cmd:2,roomid:0,anchorid:0,pid:"",chid:"",defn:"auto",ufps:"auto",playbacktime:0,ckey:"",appver:"1.0.0.0",encrypt_ver:"",uin:"",country_code:0,lang_code:0,guid:"",appid:0,platform:"",livedrm:0,playbackdrm:0,format_support:STREAM_TYPE.HLS,caplv:0,hevclv:0,net_type:0,bandwidth:0,sphttps:getSpHttps(),unicomtype:0,unicom:"",telcom:"",cmcc:"",toushe:0,from_platform:0,tm:"",scene:"",spaudio:0,spvideo:0,atmos:9,sdclive_info:"",cnlid:"",host:location.host,sdtfrom:""};function getPayActionData(e){return 1===e.iretdetailcode?{name:"execVIPRight",params:{msg:e.errmsg||"本直播需付费观看",type:"backplay",refer:113}}:{name:"showPayTips",params:{msg:e.errmsg||"本直播需付费观看",cmd:3}}}function getErrorData(e){var t=e.retcode,o=e.errmsg,r=void 0===o?"播放错误，请稍后再试~":o;switch(+t){case 5:case 16:case 18:case 51:case 52:case 67:case 97:default:return{name:"setErrorView",params:{msg:r}};case 7:return{name:"setErrorView",params:{msg:r,hideRefresh:!0,hideCode:!0}};case 8:return{name:"setErrorView",params:{msg:r,hideRefresh:!0,hideCode:!0,isOver:!0}};case 46:return{name:"showPayTips",params:{msg:r}};case 25:case 30:case 45:return getPayActionData(e)}}function parseUrls(e,t){if(!t)return[];var o=t.urls;return(void 0===o?[]:o).map((function(e){return{url:e}}))}function parseDefnList(e,t){return t?t.map((function(t){return{id:t.sid,name:t.defn,cname:t.defn_name+" "+t.defn_rate,sname:t.defn_name,resolution:t.defn_rate,sl:t.fn===e?1:0,lmt:t.vip||0}})):[]}function parseBrandLogo(e){return{wi:e?[e]:[]}}function parseCodecInfo(e){var t,o=CODEC.H264;return 2===(null===(t=null==e?void 0:e.codec_param)||void 0===t?void 0:t.vcode)&&(o=CODEC.H265),o}function selectKernel(e){var t,o=null===(t=null==e?void 0:e.crypt_param)||void 0===t?void 0:t.drmtype;return commonSelectKernel({codec:parseCodecInfo(e),dltype:3,drm:o})}var checkResponseMiddleWare=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r;return __generator$1(this,(function(i){switch(i.label){case 0:return void 0===(o=e.resData.retcode)?(e.throw(exports.ErrorCode.GETINFO_PARSE,exports.ErrorMsg.GETINFO_PARSE,getErrorData(e.resData)),[2]):0!==o?("70033",r="70033"+("000"+o).slice(-3),e.throw(r,exports.ErrorMsg.GETINFO_CODE,getErrorData(e.resData)),[2]):[4,t()];case 1:return i.sent(),[2]}}))}))},parseResponseMiddleWare=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l;return __generator$1(this,(function(c){switch(c.label){case 0:return o=e.resData,r=o.suggest_defn,i=o.format_list,n=o.play_list,a=o.preview_info,s=o.brandlogo,(l=null==n?void 0:n.find((function(e){return e.defn===r})))?(o.playback&&(o.playback.svrtick=o.svrtick),e.parseData={vitem:l,preview:a?+a.playtime:0,urls:parseUrls(r,l),definitionList:parseDefnList(r,i),watermarkList:parseBrandLogo(s)},e.logger.log("parse ",e.parseData),[4,t()]):(e.throw(exports.ErrorCode.GETINFO_PARSE,exports.ErrorMsg.GETINFO_PARSE),[2]);case 1:return c.sent(),[2]}}))}))},Qvsec={};function updateCkey(e,t){var o=e.chid,r=e.platform,i=e.sdtfrom,n=(new Date).getDay(),a="7."+(0===n?7:n),s=(null==t?void 0:t.svrtick)>0?(""+1e3*(null==t?void 0:t.svrtick)).substring(0,10):getTimeStampStr(),l=Qvsec.$xx(r,o,i,1,s,a);return e.tm=s,e.ckey=l,e.encrypt_ver=a,e}Qvsec.ha=function(e){for(var t=[],o=0;o<64;)t[o]=0|4294967296*Math.abs(Math.sin(++o));function r(e,t){return((e>>1)+(t>>1)<<1)+(1&e)+(1&t)}return function(e){for(var o,i,n,a,s=[],l=unescape(encodeURI(e)),c=l.length,p=[o=1732584193,i=-271733879,~o,~i],d=0;d<=c;)s[d>>2]|=(l.charCodeAt(d)||128)<<d++%4*8;for(s[e=16*(c+8>>6)+14]=8*c,d=0;d<e;d+=16){for(c=p,a=0;a<64;)c=[n=c[3],r(o=c[1],(n=r(r(c[0],[o&(i=c[2])|~o&n,n&o|~n&i,o^i^n,i^(o|~n)][c=a>>4]),r(t[a],s[[a,5*a+1,3*a+5,7*a][c]%16+d])))<<(c=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*c+a++%4])|n>>>32-c),o,i];for(a=4;a;)p[--a]=r(p[a],c[a])}for(e="";a<32;)e+=(p[a>>3]>>4*(1^7&a++)&15).toString(16);return e}}(),Qvsec.stringToHex=function(e){for(var t="",o=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),r=0;r<e.length;r++)t+=o[e.charCodeAt(r)>>4]+o[15&e.charCodeAt(r)];return t},Qvsec.hexToString=function(e){for(var t="",o="0x"==e.substr(0,2)?2:0;o<e.length;o+=2)t+=String.fromCharCode(parseInt(e.substr(o,2),16));return t},Qvsec._Seed="#$#@#*ad",Qvsec.tempcalc=function(e,t){for(var o="",r=0;r<e.length;r++)o+=String.fromCharCode(e.charCodeAt(r)^t.charCodeAt(r%4));return o},Qvsec.u1=function(e,t){for(var o="",r=t;r<e.length;r+=2)o+=e.charAt(r);return o},Qvsec._urlStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Qvsec.urlenc=function(e,t,o){for(var r,i,n,a,s,l,c,p="",d=0;d<e.length;)r=e.charCodeAt(d++),i=e.charCodeAt(d++),n=e.charCodeAt(d++),15==d&&(p+="A",p+=t,p+=o),a=r>>2,s=(3&r)<<4|i>>4,l=(15&i)<<2|n>>6,c=63&n,isNaN(i)?l=c=64:isNaN(n)&&(c=64),p=p+Qvsec._urlStr.charAt(a)+Qvsec._urlStr.charAt(s)+Qvsec._urlStr.charAt(l)+Qvsec._urlStr.charAt(c);return p},Qvsec.$xx=function(e,t,o,r,i,n){var a="123456";if(n.length<3)return"err";if("7."!=n.substr(0,2))return"err";var s=n.substr(2);"1"==s&&(a="06fc1464"),"2"==s&&(a="4244ce1b"),"3"==s&&(a="77de31c5"),"4"==s&&(a="e0149fa2"),"5"==s&&(a="60394ced"),"6"==s&&(a="2da639f0"),"7"==s&&(a="c2f0cf9f");i=i||parseInt(+new Date/1e3),r=(""+r).charAt(0);return Qvsec.ha(a+t+i+"*#06#"+e)};var perpareRequestMiddleWare=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){return __generator$1(this,(function(o){switch(o.label){case 0:return updateCkey(e.reqParams,e.resData),e.logger.log("request params is:",e.reqParams),[4,t()];case 1:return o.sent(),[2]}}))}))};function getRequestUrl(e,t){return e.test?ZB_CGI_TEST:ZB_CGI_ARR[t%ZB_CGI_ARR.length]}var sendRequestMiddleWare=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l,c,p,d;return __generator$1(this,(function(u){switch(u.label){case 0:e.logger.log("doRequest start..."),o=e.requestor,r=e.reqParams,i=e.config,n=i.retryCount,a=i.timeout,s=void 0===a?DEFAULT_GETINFO_CONFIG.timeout:a,c=0,u.label=1;case 1:if(!(c<n+1))return[3,7];e.logger.log("retry... count is: ",c),u.label=2;case 2:return u.trys.push([2,4,,5]),l=null,e.reqPath=getRequestUrl(i,c),[4,o.start(e.reqPath,r,s)];case 3:return p=u.sent(),e.resData=p.data,[3,5];case 4:return d=u.sent(),e.resData=void 0,e.logger.log("the "+c+" retry err:",d),"xhrTimeoutError"===(null==d?void 0:d.error)&&(l={code:exports.ErrorCode.GETINFO_TIMEOUT,message:exports.ErrorMsg.GETINFO_TIMEOUT}),[3,5];case 5:if(e.endTime=+new Date,e.alreadyRetryCount=c,e.resData){if(32!==e.resData.retcode)return[3,7];updateCkey(r,e.resData)}u.label=6;case 6:return c++,[3,1];case 7:return e.endTime=+new Date,e.resData?(e.logger.log("sendRequest over... ret is: ",e.resData),[4,t()]):(e.throw((null==l?void 0:l.code)||exports.ErrorCode.GETINFO_NET,(null==l?void 0:l.message)||exports.ErrorMsg.GETINFO_NET),[2]);case 8:return u.sent(),[2]}}))}))},setPlayerDataMiddleWare=function(e,t){return __awaiter$1(void 0,void 0,void 0,(function(){var o,r,i,n,a,s,l;return __generator$1(this,(function(c){switch(c.label){case 0:return o=e.player,r=e.resData,i=e.parseData,n=i.vitem,o.setCommonKv(((a={preview:i.preview})[COMMON_DATA_KEY.drm]=null===(s=n.crypt_param)||void 0===s?void 0:s.drmtype,a[LIVE_GET_INFO_DATA_KEYS.isuserpay]=r.isuserpay,a[LIVE_GET_INFO_DATA_KEYS.livesid]=n.sid,a[LIVE_GET_INFO_DATA_KEYS.playtime]=i.preview,a[LIVE_GET_INFO_DATA_KEYS.restpreviewcnt]=null===(l=r.preview_info)||void 0===l?void 0:l.restpreviewcnt,a)),[4,t()];case 1:return c.sent(),[2]}}))}))},XhrRequestor=function(){function e(){}return e.prototype.start=function(e,t,o){var r=""+e+urlTool.object2string(t,"&");return netTool.xhr({url:r,timeout:o,method:"GET",withCredentials:!0,responseType:"json"})},e}();function compose(e){return function(t,o){var r=-1;return function i(n){if(n<=r)return Promise.reject(new Error("next() called multiple times"));r=n;var a=e[n];n===e.length&&(a=o);if(!a)return Promise.resolve(null);try{return Promise.resolve(a(t,i.bind(null,n+1)))}catch(e){return Promise.reject(e)}}(0)}}var GetInfo=function(e){function t(t,o,r){var i,n=e.call(this,t,o,r)||this;return n._abort=!1,n._seq=0,n._config=__assign$1(__assign$1(__assign$1({},DEFAULT_GETINFO_CONFIG),(null===(i=t.config)||void 0===i?void 0:i.getinfoLiveConfig)||{}),o),n.logger=new Logger(t.config.instanceId,"UnifiedLiveGetInfo"),n}return __extends$1(t,e),t.prototype.request=function(e,t){var o=this,r=__assign$1(__assign$1({},DEFAULT_REQ_PARAMS),t),i=this.handlerIds(e,r);r=__assign$1(__assign$1({},r),i),this._abort=!1,this._seq+=1;var n={player:this.player,startTime:+new Date,endTime:0,alreadyRetryCount:0,config:this._config,reqParams:r,reqPath:void 0,resData:void 0,requestor:new XhrRequestor,parseData:void 0,error:void 0,throw:function(e,t,o){var r=new Error("getinfo err");throw r.code=e,r.message=t,r.data=o,r},seq:this._seq,urlConfig:null,logger:this.logger},a=NECESSARY_REQ_PARAMS.find((function(e){return!r[e]}));if(a)return n.error={code:exports.ErrorCode.GETINFO_INNER,message:"缺少必要播放参数 ("+a+")"},Promise.resolve(this.formatOutputData(n));var s=this._config.prepareRequestMiddleWare||perpareRequestMiddleWare,l=this._config.sendRequestMiddleWare||sendRequestMiddleWare,c=this._config.checkResponseMiddleWare||checkResponseMiddleWare,p=this._config.parseResponseMiddleWare||parseResponseMiddleWare;this._middlewares=[s,l,c,p,setPlayerDataMiddleWare];var d=compose(this._middlewares),u=new Promise((function(){}));return d(n).then((function(){return o._abort||o._seq!==n.seq?u:(o.logger.log("getinfo 成功: ",n),o.formatOutputData(n))})).catch((function(e){if(o._abort||o._seq!==n.seq)return u;var t=e.code,r=e.message;return t||(o.logger.warn("getinfo 内部错误: ",e),t=exports.ErrorCode.GETINFO_INNER,r=exports.ErrorMsg.GETINFO_INNER+", err ("+e+")"),n.error={code:t,message:r,data:e.data},o.formatOutputData(n)}))},t.prototype.abort=function(){this._abort=!0},t.prototype.destroy=function(){this.abort(),this._middlewares=null,e.prototype.destroy.call(this)},t.prototype.formatOutputData=function(e){var t,o=e.resData,r=e.parseData,i=__assign$1({},e);if(["requestor","player","throw"].forEach((function(e){delete i[e]})),!o||!r)return __assign$1({},i);var n=r.vitem,a=r.urls,s=n.crypt_param,l=this.player.getCommonKv(COMMON_DATA_KEY.drm),c=parseCodecInfo(n),p=selectKernel(n),d=a.map((function(e){return e.url})),u=d[0],A=d.slice(1),_=(null===(t=null==s?void 0:s.drmckc)||void 0===t?void 0:t.split("|"))||[],E=_[0],g=_[1],f={url:u,backupUrls:A,drmConfig:E?this.prepareDRMConfig({drmType:l,licenseUrl:E,certificateUrl:g}):null,chachaParam:l===DRM_TYPE.CHACHA?{cnlid:n.sid,baseKey:s.deckey,randoms:s.randoms}:null,p2pConfig:this.prepareP2PConfig({keyId:n.sid,useP2P:!!n.usep2p,downloadMode:0}),drmType:l,vcodec:c};return this.player.setCommonKv(COMMON_DATA_KEY.codec,c),__assign$1(__assign$1({},i),{kernelName:p,urlConfig:f})},t.prototype.handlerIds=function(e,t){var o,r=t.roomid;return o=r?{pid:t.livepid||"",chid:e,roomid:r}:{pid:t.livepid||"",chid:e},delete t.livepid,delete t.cnlid,o},t.prototype.prepareDRMConfig=function(e){var t,o,r=e.drmType,i=e.licenseUrl,n=e.certificateUrl,a=this.player.getCommonKv,s=((t={})[DRM_TYPE.FAIR_PLAY]=KeySystems.FairPlayWebKit,t[DRM_TYPE.WIDEVINE]=KeySystems.Widevine,t),l={licenseUrl:i,certificate:{},keySystem:s[r],licenseRequestSetup:function(e){if(r===DRM_TYPE.FAIR_PLAY){e.responseType="text";var t={guid:a(COMMON_DATA_KEY.guid)},o=Object.keys(t).map((function(e){return e+"="+t[e]})).join("&");return e.body=e.body+"&"+o,e}return e},licenseResponseSetup:function(e){return r===DRM_TYPE.FAIR_PLAY?stringTool.base64ToUint8Array(e):e}};return r===DRM_TYPE.FAIR_PLAY&&(l.certificate=((o={})[s[r]]=n,o)),l},t.prototype.prepareP2PConfig=function(e){return __assign$1({flowId:this.player.getCommonKv(COMMON_DATA_KEY.flowid),playerInfo:this.getPlayerInfo()},e)},t.prototype.getPlayerInfo=function(){var e={platform:this.player.getCommonKv(COMMON_DATA_KEY.platform)||"",osVer:this.player.getCommonKv(COMMON_DATA_KEY.osver)||"",broVer:this.player.getCommonKv(COMMON_DATA_KEY.ua)||"",playerVer:this.player.getCommonKv(COMMON_DATA_KEY.playerver)||"",guid:this.player.getCommonKv(COMMON_DATA_KEY.guid)||"",qq:"",wx:"",vip:!1},t=this.player.getCommonKv(COMMON_DATA_KEY.hc_main_login);return"qq"===t?e.qq=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid):"wx"===t&&(e.wx=this.player.getCommonKv(COMMON_DATA_KEY.hc_vuserid)),e},t.pluginName="__thumbplayer-video-request",t}(Plugin),extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}function __awaiter(e,t,o,r){return new(o||(o=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function s(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function __generator(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}function __spreadArray(e,t,o){if(o||2===arguments.length)for(var r,i=0,n=t.length;i<n;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var Controller=function(){function e(e,t){this.player=e,this.tvk=t}return e.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.tvk.logger).log.apply(e,__spreadArray(["[".concat(this.constructor.moduleName,"]")],t,!1))},e.prototype.warn=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.tvk.logger).warn.apply(e,__spreadArray(["[".concat(this.constructor.moduleName,"]")],t,!1))},e.prototype.error=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.tvk.logger).error.apply(e,__spreadArray(["[".concat(this.constructor.moduleName,"]")],t,!1))},e.moduleName="base-controller",e}(),AudioTrackController=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.audioTrackInfoFromServer=[],t.onGetInfoOver=function(e){var o=e.data,r=o.parseData,i=o.error,n=o.resData;if(!i&&r){var a=n.al;if(a){var s=r.vitem,l=[];a.ai.forEach((function(e){l.push({btnLabel:e.sname,label:e.name,value:NaN,payload:e.name})})),s.ai&&l.push({btnLabel:s.ai.sname,label:s.ai.name,value:-1,payload:s.ai.sname}),t.audioTrackInfoFromServer=l}else t.log("no audio track info found from getvinfo",n)}else t.log("no parsed info found from getvinfo",i,n)},t.onVideoSetLevelOver=function(e){e.data.code===exports.ErrorCode.SUC&&t.updateAudioTrackInfo()},t.onVideoCanPlay=function(){if(t.player.currentVideoInfo){var e=t.player.currentVideoInfo.currentAudioTrack,o=t.updateAudioTrackInfo();t.configureDataSet(o,e)}},t.updateAudioTrackInfo=function(){var e=t.player.currentVideoInfo.audioTracks;if(!e.length)return null;e.forEach((function(e){var o=t.audioTrackInfoFromServer.find((function(t){return t.payload===e.name}));o&&(o.value=e.id)}));var o=t.audioTrackInfoFromServer.filter((function(e){return!isNaN(e.value)}));return t.player.currentVideoInfo.audioTracks=o.map((function(e){return{name:e.payload,id:e.value}})),o},t.onAudioTrackSwitching=function(e){t.configureDataSet(null,e.data.id)},t.onAudioTrackSwitched=function(e){e.data.fail||t.configureDataSet(null,e.data.id)},t}return __extends(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return Promise.resolve(!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.setupPlayerEventListeners(),this.log("init success")},t.prototype.configureDataSet=function(e,t){e&&(this.log("setting audioTrack options to player",e),this.player.setCommonKv(COMMON_DATA_KEY.currentAudioTrackList,e)),"number"==typeof t&&(this.log("setting current audioTrack to player",t),this.player.setCommonKv(COMMON_DATA_KEY.currentAudioTrack,t))},t.prototype.setupPlayerEventListeners=function(){this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver),this.player.on(exports.PLAY_EVENT.SET_AUDIO_TRACK_START,this.onAudioTrackSwitching),this.player.on(exports.PLAY_EVENT.SET_AUDIO_TRACK_OVER,this.onAudioTrackSwitched),this.player.on(exports.H5_PLAY_EVENT.VIDEO_CANPLAY,this.onVideoCanPlay),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,this.onVideoSetLevelOver)},t.moduleName="audio-track-controller",t}(Controller),DRM_REQUEST_VALUE,DRM_CODE_FROM_VINFO,LOGIN_METHOD,COOKIE_NAME,PAID_FORMAT,_a$2;function builtDefinitionOption(e,t,o){var r={prefix:"",suffix:""};return(null==o?void 0:o.prefix)&&(r.prefix="function"==typeof o.prefix?o.prefix(e):void 0),(null==o?void 0:o.suffix)&&(r.suffix="function"==typeof o.suffix?o.suffix(e):void 0),t?builtRegularOption(e,!0,r):buildVodDefinitionOption(e,r)}function buildVodDefinitionOption(e,t){var o=e.name;return o===PAID_FORMAT.HDR10||o===PAID_FORMAT.SFR_HDR||o===PAID_FORMAT.DOLBY?builtSpecialOption(e,o,t):builtRegularOption(e,!1,t)}function builtSpecialOption(e,t,o){var r,i=e.name,n=e.resolution,a=e.cname,s=e.lmt,l=e.sname,c=formatDefnName$1(a,!1)[0],p=void 0===c?"":c,d=o.suffix||(s?vipIcon:void 0),u=o.prefix||constructIconContainer(SpecialResolutionPrefixIcons[t],{width:"30px"}),A=((r={})[PAID_FORMAT.DOLBY]=n,r[PAID_FORMAT.HDR10]=constructHDRBtnLabel(l.substring(0,2)),r[PAID_FORMAT.SFR_HDR]=n,r);return{label:constructDesktopOptionTemplate(p,u,d),btnLabel:A[t],value:i,payload:n}}function builtRegularOption(e,t,o){var r=e.cname,i=e.name,n=e.lmt,a=formatDefnName$1(r,t),s=a[0],l=void 0===s?"":s,c=a[1],p=void 0===c?"":c,d=o.suffix||(n?vipIcon:void 0);return{label:uaTool.mobile?constructMobileOptionTemplate(p,l):constructDesktopOptionTemplate("".concat(p," ").concat(l),o.prefix,d),btnLabel:p,value:i,payload:"".concat(p," ").concat(l)}}function constructDesktopOptionTemplate(e,t,o){var r=createFlexDiv({alignItems:"center"});t&&r.insertAdjacentHTML("afterbegin",t);var i=createFlexDiv();return i.innerHTML=e,r.appendChild(i),o&&r.insertAdjacentHTML("beforeend",o),r.outerHTML}function constructMobileOptionTemplate(e,t){return"<div>".concat(t,"<div><div>").concat(e,"</div>")}function constructHDRBtnLabel(e){var t=createFlexDiv({alignItems:"center",width:"100%"});t.textContent=e;var o=createFlexDiv({transform:"scale(0.8)"});return o.innerHTML=hdrOptionIcon,t.insertAdjacentElement("beforeend",o),t.outerHTML}function constructIconContainer(e,t){var o=document.createElement("div");return o.className="tp-defn-option-icon-container",t&&Object.entries(t).forEach((function(e){var t=e[0],r=e[1];o.style[t]=r})),o.innerHTML=e,o.outerHTML}function createFlexDiv(e){var t=document.createElement("div");return t.style.display="flex",e&&Object.keys(e).forEach((function(o){t.style[o]=e[o]})),t}function formatDefnName$1(e,t){if(void 0===t&&(t=!1),t)return formatLiveDefnName$1(e);if(!(null==e?void 0:e.length))return["",""];var o=e.match(/(.*);\((.*)\)/);return o&&o.length>=3?[o[1],o[2]]:["",e]}function formatLiveDefnName$1(e){if(!(null==e?void 0:e.length))return["",""];var t=e.split(" ");return[t[0],t[1]]}!function(e){e[e.NONE=0]="NONE",e[e.FAIRPLAY=16]="FAIRPLAY",e[e.WIDEVINE=32]="WIDEVINE",e[e.CHACHA20=8]="CHACHA20"}(DRM_REQUEST_VALUE||(DRM_REQUEST_VALUE={})),function(e){e[e.NONE=0]="NONE",e[e.FAIRPLAY=4]="FAIRPLAY",e[e.WIDEVINE=5]="WIDEVINE",e[e.CHACHA20=3]="CHACHA20"}(DRM_CODE_FROM_VINFO||(DRM_CODE_FROM_VINFO={})),DRM_REQUEST_VALUE.NONE,function(e){e.QQ="qq",e.WX="wx"}(LOGIN_METHOD||(LOGIN_METHOD={})),function(e){e.MAIN_LOGIN="main_login",e.GUID="video_guid",e.OPENID="openid",e.APPID="appid",e.VUSERID="vuserid",e.ACCESS_TOKEN="access_token",e.VUSESSION="vusession"}(COOKIE_NAME||(COOKIE_NAME={})),function(e){e.FHD="fhd",e.UHD="uhd",e.DOLBY="dolby",e.HDR10="hdr10",e.SFR_HDR="sfr_hdr"}(PAID_FORMAT||(PAID_FORMAT={}));var dolbyOptionIcon='<svg class="tp-dolby-prefix-icon" width="22" height="14" viewBox="0 0 22 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n <path fill-rule="evenodd" clip-rule="evenodd" d="M0.714233 1.14282C0.714233 0.590537 1.16195 0.142822 1.71423 0.142822H20.2857C20.8379 0.142822 21.2857 0.590537 21.2857 1.14282V12.8571C21.2857 13.4094 20.8379 13.8571 20.2857 13.8571H1.71423C1.16195 13.8571 0.714233 13.4094 0.714233 12.8571V1.14282ZM2.42852 1.85711H4.99995C7.84027 1.85711 10.1428 4.15965 10.1428 6.99997C10.1428 9.84028 7.84027 12.1428 4.99995 12.1428H2.42852V1.85711ZM16.9999 1.85711C14.1596 1.85711 11.8571 4.15965 11.8571 6.99997C11.8571 9.84028 14.1596 12.1428 16.9999 12.1428H19.5714V1.85711H16.9999Z" fill="currentColor"/>\n </svg>',hdrOptionIcon='<svg class="tp-hdr-prefix-icon" width="12" height="14" viewBox="0 0 12 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n <path d="M0 14.4449L0.02931 12.2882L8.90291 1.4655H0.271117V0H12L0 14.4449Z" fill="currentColor"/>\n <path d="M11.8315 15.7615H0.102661L11.7925 1.72937L11.7778 4.04974L3.19975 14.296H11.8315V15.7615Z" fill="currentColor"/>\n <path d="M11.9 12.0219H8.03349L11.9 7.40312V5.12915L4.9364 13.4874H11.9V12.0219Z" fill="currentColor"/>\n </svg>',vipIcon='<div style="margin-left: 6px; padding: 0 2px;transform: scale(0.8);border: 1px solid #fc3f4c;border-radius: 2px;color: #fc3f4c;font-size: 12px;letter-spacing: 1px;line-height: 14px;text-align: center;">VIP</div>',SpecialResolutionPrefixIcons=(_a$2={},_a$2[PAID_FORMAT.DOLBY]=dolbyOptionIcon,_a$2[PAID_FORMAT.HDR10]=hdrOptionIcon,_a$2[PAID_FORMAT.SFR_HDR]=hdrOptionIcon,_a$2),DefinitionController=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onGetInfoOver=function(e){var o,r=e.data,i=r.parseData,n=r.error;if(!n&&i){var a=i.definitionList;if(a){var s=[],l=(null===(o=a.find((function(e){return 1===e.sl})))||void 0===o?void 0:o.name)||null;a.forEach((function(e){s.push(builtDefinitionOption(e,t.player.config.type===exports.PLAY_MODE.LIVE,t.tvk.config.definitionOptionDecorator))})),t.configureDataSet(s,l)}else t.log("no definitionList found from getvinfo",a)}else t.log("no parsed info found from getvinfo",n,i)},t}return __extends(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return Promise.resolve(!0)},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.setupPlayerEventListeners(),this.log("init success")},t.prototype.configureDataSet=function(e,t){e&&(this.log("setting definition options to player",e),this.player.setCommonKv(COMMON_DATA_KEY.currentDefnList,e)),t&&(this.log("setting current definition to player",t),this.player.setCommonKv(COMMON_DATA_KEY.currentDefn,t))},t.prototype.setupPlayerEventListeners=function(){this.player.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.onGetInfoOver)},t.moduleName="definition-controller",t}(Controller),defaultTVKConfig={definitionController:DefinitionController,audioTrackController:AudioTrackController},TVK=function(){function e(e,t){this.controllers=[],this.config=this.prepareConfig(t),this.player=e,this.logger=new Logger(e.config.instanceId,"tvk"),this.initializeAllControllers()}return e.prototype.initializeAllControllers=function(){return __awaiter(this,void 0,void 0,(function(){var e,t=this;return __generator(this,(function(o){switch(o.label){case 0:return e=[this.config.definitionController,this.config.audioTrackController].map((function(e){return e?new e(t.player,t):null})).filter((function(e){return null!==e})),[4,Promise.all(e.map((function(e){return e.ready.then((function(o){return t.onControllerReady(e)})).catch((function(o){return t.onControllerFailed(e)}))})))];case 1:return[2,o.sent()]}}))}))},e.prototype.onControllerReady=function(e){this.logger.log("".concat(e.constructor.moduleName," ready")),e.init(),this.controllers.push(e)},e.prototype.onControllerFailed=function(e){this.logger.error("".concat(e.constructor.moduleName," failed"))},e.prototype.prepareConfig=function(e){var t=defaultTVKConfig;return Object.assign({},t,e)},e}();function enableTVK(e,t){return void 0===t&&(t={}),new TVK(e,t)}var webAdVersion="2.6.12",h5AdVersion="2.6.4",adGlobalName="CreativePlayerPlugin",adVersion=uaTool.mobile?h5AdVersion:webAdVersion,adScriptMaxLoadTime=1e4,skipAdDomainWhiteList=["e.news.qq.com"],isInDomainWhiteList=skipAdDomainWhiteList.includes(window.location.hostname),ErrorPagePluginName="error-page",ErrorPagePluginEvents={REPORT_LOG:"error-page:report-log"},defaultErrorText="出错啦",dataRoleMap={error:"txp-ui-error",errorMsg:"txp-ui-error-msg",errorHandler:"txp-ui-error-handler",errorRefresh:"txp-ui-error-refresh",errorCode:"txp-ui-error-code",background:"txp-ui-error-background",clientBtn:"txp-ui-error-client-btn",browserTip:"txp-ui-error-browser"},__assign=function(){return __assign=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)};exports.HOTPOINT_EVENTS=void 0,function(e){e.HOT_MOUSE_OVER="ctrl:hotpoint-mouseover",e.HOT_MOUSE_MOVE="ctrl:hotpoint-mousemove",e.HOT_MOUSE_OUT="ctrl:hotpoint-mouseout"}(exports.HOTPOINT_EVENTS||(exports.HOTPOINT_EVENTS={}));var CtrlbarPluginName="ctrlbar",CTRL_EVENTS=__assign(__assign({FULLSCREEN_CHANGE:"windowFullscreenChange",FULLSCREEN_ERROR:"fullscreenError",FAKE_FULLSCREEN_CHANGE:"browserFullscreenChange",CLICK_PIPBTN:"ctrl:click-pipbtn",CLICK_NEXTBTN:"ctrl:click-nextbtn",CLICK_PLAYBTN:"ctrl:click-playbtn",CLICK_REPLAY:"ctrl:click-replay",SET_LANGUAGE:"ctrl:set-language",SET_LEVEL:"ctrl:set-level",SET_AUDIO:"ctrl:set-audio",SET_PLAYRATE:"ctrl:set-playrate",SET_VOLUME:"ctrl:set-volume",TOGGLE_OVERLAY:"ctrl:toggle-overlay",MOUSE_DONW:"ctrl:progress-mousedown",MOUSE_DOWN:"ctrl:progress-mousedown",MOUSE_MOVE:"ctrl:progress-mousemove",MOUSE_UP:"ctrl:progress-mouseup",SHOW:"ctrl:show",HIDE:"ctrl:hide"},exports.HOTPOINT_EVENTS),{TEST_EVENT:"ctrl:inner-test-event",RESIZE:"ctrl:resize",SHOW_LEVELS:"ctrl:show-levels",HOVER_PROGRESS:"ctrl:hover-progress"}),pcRootClassName=".plugin_ctrl_txp_bottom",mobileRootClassName=".plugin_ctrl_mobile_txp_bottom",getRootClassName=function(e){return e?mobileRootClassName:pcRootClassName},shadowClassName=".plugin_ctrl_txp_shadow",gradientClassName=".plugin_ctrl_txp_gradient_bottom",containerClassName="_mod_thumbplayer_container_",largeSizeClassName="plugin_ctrl--large",bodyOverflowClassName="plugin_ctrl_fake_fullscreen";exports.CTRL_SIZE=void 0,function(e){e.LARGE="large",e.NORMAL="normal"}(exports.CTRL_SIZE||(exports.CTRL_SIZE={})),exports.PlayBtnStatus=void 0,function(e){e.PAUSE="pause",e.PLAY="play",e.REPLAY="replay",e.STOP="stop"}(exports.PlayBtnStatus||(exports.PlayBtnStatus={}));var REPORTING_SVG_ICON='<svg class="reporting-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"\nxmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" fill="#fff">\n<path\n  d="M784 902.4c9.6 19.2 6.4 41.6-12.8 54.4-19.2 9.6-41.6 3.2-51.2-12.8-9.6-19.2-6.4-41.6 12.8-54.4 16-12.8 38.4-8 51.2 12.8z m-233.6 81.6c0 22.4-16 38.4-38.4 38.4s-38.4-16-38.4-38.4V960c0-22.4 19.2-38.4 41.6-38.4 19.2 0 35.2 16 38.4 38.4v25.6h-3.2z m-240-43.2c-9.6 19.2-35.2 25.6-54.4 16-19.2-9.6-25.6-35.2-16-51.2l28.8-51.2c9.6-19.2 35.2-25.6 54.4-16s25.6 35.2 12.8 54.4l-25.6 48zM121.6 784c-19.2 9.6-41.6 3.2-54.4-16-9.6-19.2-6.4-41.6 12.8-54.4l76.8-44.8c19.2-9.6 41.6-3.2 54.4 16 9.6 19.2 3.2 41.6-16 54.4L121.6 784zM38.4 552c-22.4 0-38.4-16-38.4-38.4s16-38.4 38.4-38.4H160c22.4 0 38.4 19.2 38.4 38.4 0 22.4-16 38.4-38.4 38.4H38.4z m44.8-241.6c-19.2-9.6-25.6-35.2-16-51.2 9.6-19.2 35.2-25.6 54.4-16L256 320c19.2 9.6 25.6 35.2 16 54.4s-35.2 25.6-54.4 16l-134.4-80z m160-185.6l92.8 160c9.6 19.2 35.2 25.6 54.4 12.8s25.6-35.2 12.8-54.4l-92.8-160c-12.8-19.2-35.2-22.4-54.4-12.8-16 12.8-22.4 33.6-12.8 54.4z m230.4-84.8c0-22.4 16-38.4 38.4-38.4s38.4 19.2 38.4 38.4V224c0 22.4-19.2 38.4-38.4 38.4-22.4 0-38.4-19.2-38.4-38.4V40z m240 43.2c9.6-19.2 35.2-25.6 54.4-16 19.2 9.6 25.6 35.2 16 51.2l-92.8 160c-9.6 19.2-35.2 25.6-54.4 16-19.2-9.6-25.6-35.2-12.8-54.4l89.6-156.8z m188.8 160l-160 92.8c-19.2 9.6-25.6 35.2-16 54.4 12.8 19.2 35.2 25.6 54.4 12.8l160-92.8c19.2-9.6 25.6-35.2 12.8-54.4-9.6-16-32-25.6-51.2-12.8z m83.2 228.8c22.4 0 38.4 16 38.4 38.4s-16 38.4-38.4 38.4H800c-22.4 0-38.4-19.2-38.4-38.4 0-22.4 19.2-38.4 38.4-38.4h185.6z"\n  />\n</svg>',INFO_SVG_DOM_STR='<div class="txp_info_icon txp_none">\n  <svg\n  viewBox="0 0 1024 1024"\n  version="1.1"\n  xmlns="http://www.w3.org/2000/svg"\n  >\n  <path\n    d="M512 958.016C266.08 958.016 65.984 757.952 65.984 512 65.984 266.08 266.08 65.984 512 65.984c245.952 0 446.016 200.064 446.016 446.016C958.016 757.952 757.952 958.016 512 958.016zM512 129.984C301.344 129.984 129.984 301.344 129.984 512c0 210.624 171.36 382.016 382.016 382.016 210.624 0 382.016-171.36 382.016-382.016C894.016 301.344 722.624 129.984 512 129.984z"\n  ></path>\n  <path\n    d="M512 304m-48 0a1.5 1.5 0 1 0 96 0 1.5 1.5 0 1 0-96 0Z"\n  ></path>\n  <path\n    d="M512 768c-17.664 0-32-14.304-32-32l0-288c0-17.664 14.336-32 32-32s32 14.336 32 32l0 288C544 753.696 529.664 768 512 768z"\n  ></path>\n  </svg>\n</div>\n',InfoPanelPluginName="info-panel",InfoPanelEvents={CLICK_UPLOAD:"contextmenu:click-upload"},DEFAULT_SHOW_QUERY="show_info_panel",PosterPluginName="poster",hideClass="txp_none",defaultShowTime=3,classNameOnCtrlHide="ctrl_hide",classNameOnCtrlResize="ctrl_resize",TipsPluginName="tips",UIContextMenuPluginName="context-menu",WaterMarkCoverClassName="thumbplayer-watermark-cover",WatermarkPluginName="ui-watermark",MaxRequestRetry=3,RequestTimeout=5e3;exports.WatermarkError=void 0,function(e){e.ActionWatermarkRequestFailed="001"}(exports.WatermarkError||(exports.WatermarkError={}));var PLUGINS_URL="//vm.gtimg.cn/thumbplayer/plugins/thumbplayer-plugin-super-player-plugins/".concat("1.4.154","/index.min.js"),LAZY_PLUGINS=[TipsPluginName,ErrorPagePluginName,PosterPluginName,CtrlbarPluginName,InfoPanelPluginName,WatermarkPluginName,UIContextMenuPluginName],PLAY_CODEC={AUTO:0,H264:1,H265:2},HEVC_LV_VALUE,SUPER_END_STATE,SUPER_DATA_KEY;exports.HEVC_LV_VALUE=void 0,HEVC_LV_VALUE=exports.HEVC_LV_VALUE||(exports.HEVC_LV_VALUE={}),HEVC_LV_VALUE[HEVC_LV_VALUE.AUTO=void 0]="AUTO",HEVC_LV_VALUE[HEVC_LV_VALUE.NOT_SPT=0]="NOT_SPT",HEVC_LV_VALUE[HEVC_LV_VALUE.SD=11]="SD",HEVC_LV_VALUE[HEVC_LV_VALUE.HD=16]="HD",HEVC_LV_VALUE[HEVC_LV_VALUE.SHD=21]="SHD",HEVC_LV_VALUE[HEVC_LV_VALUE.FHD=26]="FHD",HEVC_LV_VALUE[HEVC_LV_VALUE.UHD=28]="UHD",HEVC_LV_VALUE[HEVC_LV_VALUE.UHD_ONLY=31]="UHD_ONLY",exports.SUPER_END_STATE=void 0,SUPER_END_STATE=exports.SUPER_END_STATE||(exports.SUPER_END_STATE={}),SUPER_END_STATE.PREVIEW="preview",exports.SUPER_DATA_KEY=void 0,SUPER_DATA_KEY=exports.SUPER_DATA_KEY||(exports.SUPER_DATA_KEY={}),SUPER_DATA_KEY.vodCGIUsed="super:cgiUsed",SUPER_DATA_KEY.getinfoAdInfo="getinfoAdInfo",SUPER_DATA_KEY.hlsAdRanges="hlsAdRanges";var LOCAL_STORAGE_KEY={ENV_CACHE:"__thumbplayer_env_cache",RENDER_STATS_INFO:"__thumbplayer_render_stats_info",DEGRADE_CODEC_EXPIRE_TIME:"__thumbplayer_degradecodec_expiretime"},ctrlbarPluginName=CtrlbarPluginName,contextMenuPluginName=UIContextMenuPluginName,SuperPlayerEnum=Object.freeze({__proto__:null,PLAY_CODEC:PLAY_CODEC,get HEVC_LV_VALUE(){return exports.HEVC_LV_VALUE},get SUPER_END_STATE(){return exports.SUPER_END_STATE},get SUPER_DATA_KEY(){return exports.SUPER_DATA_KEY},LOCAL_STORAGE_KEY:LOCAL_STORAGE_KEY,ctrlbarPluginName:ctrlbarPluginName,contextMenuPluginName:contextMenuPluginName,adGlobalName:adGlobalName,adVersion:adVersion,adScriptMaxLoadTime:adScriptMaxLoadTime,skipAdDomainWhiteList:skipAdDomainWhiteList,isInDomainWhiteList:isInDomainWhiteList,CTRL_EVENTS:CTRL_EVENTS,get CTRL_SIZE(){return exports.CTRL_SIZE},CtrlbarPluginName:CtrlbarPluginName,DEFAULT_SHOW_QUERY:DEFAULT_SHOW_QUERY,ErrorPagePluginEvents:ErrorPagePluginEvents,ErrorPagePluginName:ErrorPagePluginName,get HOTPOINT_EVENTS(){return exports.HOTPOINT_EVENTS},INFO_SVG_DOM_STR:INFO_SVG_DOM_STR,InfoPanelEvents:InfoPanelEvents,InfoPanelPluginName:InfoPanelPluginName,MaxRequestRetry:MaxRequestRetry,get PlayBtnStatus(){return exports.PlayBtnStatus},PosterPluginName:PosterPluginName,REPORTING_SVG_ICON:REPORTING_SVG_ICON,RequestTimeout:RequestTimeout,TipsPluginName:TipsPluginName,UIContextMenuPluginName:UIContextMenuPluginName,WaterMarkCoverClassName:WaterMarkCoverClassName,get WatermarkError(){return exports.WatermarkError},WatermarkPluginName:WatermarkPluginName,bodyOverflowClassName:bodyOverflowClassName,classNameOnCtrlHide:classNameOnCtrlHide,classNameOnCtrlResize:classNameOnCtrlResize,containerClassName:containerClassName,dataRoleMap:dataRoleMap,defaultErrorText:defaultErrorText,defaultShowTime:defaultShowTime,getRootClassName:getRootClassName,gradientClassName:gradientClassName,hideClass:hideClass,largeSizeClassName:largeSizeClassName,mobileRootClassName:mobileRootClassName,pcRootClassName:pcRootClassName,shadowClassName:shadowClassName,PLUGINS_URL:PLUGINS_URL,LAZY_PLUGINS:LAZY_PLUGINS}),SUPER_EVENTS;exports.SUPER_EVENTS=void 0,SUPER_EVENTS=exports.SUPER_EVENTS||(exports.SUPER_EVENTS={}),SUPER_EVENTS.DEGRADE_CODEC="degradeCodec",SUPER_EVENTS.PREVIEW_START="previewStart",SUPER_EVENTS.PREVIEW_END="previewEnd",SUPER_EVENTS.GET_VIDEO_MARK_ALL_OVER="getVideoMarkAllOver",SUPER_EVENTS.ENTER_HLS_AD="enterHlsAd",SUPER_EVENTS.EXIT_HLS_AD="exitHlsAd";var SuperPlayerEvt=Object.freeze({__proto__:null,get SUPER_EVENTS(){return exports.SUPER_EVENTS}}),coreExportKeys=["PLAY_EVENT","VIDEO_STATE","KERNEL_NAME","PLAY_MODE","END_STATE","EvtEmitter","kernelEvtBus","PAUSE_TYPE","commonTool","uaTool","Logger","cookieTool","lsTool","urlTool","domTool","netTool","videoTool","stringTool","VIDEO_CODEC","AUDIO_CODEC","CONTAINER_FORMAT"],h5ExportKeys=["H5_PLAY_EVENT","COMMON_DATA_KEY","DATA_EVENTS","DRM_TYPE","DRM_VALUE","H5_EXT_EVENT","AdPluginName","FullScreenMode","Plugin"],superPlayerExportKeys=["PLAY_CODEC","CTRL_EVENTS","SUPER_END_STATE","SUPER_EVENTS","ctrlbarPluginName","contextMenuPluginName"],UrlParamKey,_a$1,STATE;function bindExports(e){var t=__spreadArray$1(__spreadArray$1(__spreadArray$1([],coreExportKeys,!0),h5ExportKeys,!0),superPlayerExportKeys,!0);(t=t.filter((function(t){return void 0===e[t]}))).forEach((function(t){[ThumbPlayerH5$1,ThumbPlayerCore,SuperPlayerEnum,SuperPlayerEvt].forEach((function(o){(null==o?void 0:o[t])&&(e[t]=o[t])}))}))}function checkParams(e,t,o){if(t&&o)for(var r=[{checker:function(){return e===exports.PLAY_MODE.LIVE&&"load"===t},msg:"live mode does not support load()"},{checker:function(){return e===exports.PLAY_MODE.LIVE&&"play"===t&&o.vid},msg:"vid is not supported in live mode"},{checker:function(){return e===exports.PLAY_MODE.VOD&&o.cnlid},msg:"cnlid is not supported in vod mode"},{checker:function(){return o.vid&&!/^\w{11}$/.test(o.vid)},msg:"vid is illegal"}],i=0,n=r.length;i<n;i++)if(r[i].checker())throw new Error(r[i].msg)}function formatDefnName(e,t){if(void 0===t&&(t=!1),t)return formatLiveDefnName(e);var o=null==e?void 0:e.match(/(.*);\((.*)\)/);return(null==o?void 0:o.length)>=3?[o[1],o[2]]:[null!=e?e:"",""]}function formatLiveDefnName(e){var t=e.split(" ");return[t[0],t[1]]}function getIsOfficialScenes(){return[/^http(s?):\/\/v\.qq(\.com)\/x\/(cover|page)\//.test(location.href),uaTool.browser.qqlive].some((function(e){return e}))}function isOfficialDomain(){return/^http(s?):\/\/(.*)\.(qq|woa|oa)\.com/.test(location.href)}function getTxVideoPageURLByVid(e,t,o){if(!e)return"";t="0"!==t?"_".concat(t):"";var r=e.substr(0,1),i=e.substr(e.length-2,1),n=e.substr(e.length-1,1),a="".concat("//v.qq.com/page","/").concat(r,"/").concat(i,"/").concat(n,"/").concat(e).concat(t,".html");return o&&(a+="?start=".concat(o)),a}function getEnvVals(){var e="npm";try{e="cdn"}catch(e){}var t="";try{t="1.6.5"}catch(e){}var o="";try{o="1663819849185"}catch(e){}var r=!1;try{r="1"===process.env.__LOCAL_DEV__}catch(e){}return{CHANNEL:e,VERSION:t,BUILD_TIME:o,LOCAL_DEV:r}}function getDebugModeFromUrl(){return"1"===urlTool.getUrlParamByKey(location.href,UrlParamKey.debugSuper)}function getShouldUseDownloadKitFromUrl(){return urlTool.getUrlParamByKey(location.href,UrlParamKey.downloadKit)}function getLogLevelFromUrl(){var e=+urlTool.getUrlParamByKey(location.href,UrlParamKey.logLevel);return isNaN(e)?PLAYER_LOG_LEVEL.NONE:e}!function(e){e.debugSuper="__debugSuper",e.logLevel="__logLevel",e.downloadKit="__downloadKit"}(UrlParamKey||(UrlParamKey={})),function(e){e[e.enabled=0]="enabled",e[e.disabled=1]="disabled"}(STATE||(STATE={}));var AdType={MidRoll:"ZC",HlsAd:"PHLS",BeforePlay:exports.AD_TYPE.PRE,BeforePlayCodeName:"LD",AfterPlay:exports.AD_TYPE.POST,AfterPlayCodeName:"HT"},AD_INFO_OP_TYPE;!function(e){e[e.HLS_AD=2]="HLS_AD"}(AD_INFO_OP_TYPE||(AD_INFO_OP_TYPE={}));var midRollAdCGI={Formal:"//mark.l.qq.com/fcgi-bin/get_video_mark_all",Test:"//testmark.l.qq.com/fcgi-bin/get_video_mark_all"},videoMarkDebugParam="debugvideomark",isVideoMarkDebugEnv="1"===urlTool.getUrlParamByKey(location.href,videoMarkDebugParam),disabledCtrlBarComps=["playrate","definition","audiotrack","language","PlayBtn","NextBtn","Progress","CtrlShow","PictureInPicture"],disabledCtrlBarCompsWhenHlsAd=["playrate","definition","audiotrack","language","CtrlShow"],disabledCtrlBarCompsMap=(_a$1={},_a$1[AdType.AfterPlay]=disabledCtrlBarComps,_a$1[AdType.BeforePlay]=disabledCtrlBarComps,_a$1[AdType.MidRoll]=disabledCtrlBarComps,_a$1[AdType.HlsAd]=disabledCtrlBarCompsWhenHlsAd,_a$1),parseMidRollAdResponse=function(e){if(!e||0!=+e.errorno)return+e.errorno;var t=e.results[0],o=t.admark||{};return o.fields=t.fields||[],o};function parseGetinfoHlsAdRanges(e){var t,o=[];if(!(null==e?void 0:e.adpinfo))return o;var r=null;try{r=JSON.parse(e.adpinfo)}catch(e){}return null===(t=null==r?void 0:r.plugin_info)||void 0===t||t.forEach((function(e){+e.optype===AD_INFO_OP_TYPE.HLS_AD&&o.push({start:e.ad_offset_time,end:e.ad_offset_time+e.ad_dura})})),o}var AdLogic=function(){function e(e,t){var o=this;this.player=e,this.corePlayer=t,this.isHlsAdPlaying=!1,this.logger=new Logger(this.player.config.instanceId,"AdLogic"),this.setEvts(!0),this.player.pluginMsg.once("pluginsetup:".concat(AdPluginName),(function(){o.setAdPluginEvts(!0)}))}return e.prototype.destroy=function(){getAdPlugin(this.player.config.instanceId)&&this.setAdPluginEvts(!1),this.setEvts(!1),this.player=null,this.corePlayer=null},e.prototype.setEvts=function(e){var t,o,r=this;this.evtMap||(this.evtMap={player:(t={},t[exports.H5_PLAY_EVENT.AD_PLAYING]=this.onAdPlaying.bind(this),t[exports.H5_PLAY_EVENT.AD_END]=this.onAdEnd.bind(this),t[exports.H5_PLAY_EVENT.VIDEO_PLAYING]=this.onVideoPlaying.bind(this),t[exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED]=this.onAdAutoplayBlocked.bind(this),t[exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE]=this.onVideoTimeUpdate.bind(this),t[exports.H5_PLAY_EVENT.AD_PAUSE]=this.onAdPaused.bind(this),t),adPlugin:{enterCountdownCompleteEvt:this.onWillPlayMidRollAd.bind(this),enterCountdownEvt:this.onEnterMidRollAdCountdown.bind(this),resumeAd:this.onAdResume.bind(this)},msg:(o={},o[exports.PLAY_EVENT_EXT.GETINFO_OVER]=this.onVideoReqInfoEnd.bind(this),o)});var i=e?this.player.on:this.player.off;Object.keys(this.evtMap.player).forEach((function(e){i.apply(r.player,[e,r.evtMap.player[e]])}));var n=e?this.player.on:this.player.off;Object.keys(this.evtMap.msg).forEach((function(e){n.apply(r.player.pluginMsg,[e,r.evtMap.msg[e]])}))},e.prototype.setAdPluginEvts=function(e){var t=this,o=getAdPlugin(this.player.config.instanceId),r=e?o.on:o.off;Object.keys(this.evtMap.adPlugin).forEach((function(e){r.apply(o,[e,t.evtMap.adPlugin[e]])}))},e.prototype.onAdPlaying=function(e){var t,o,r,i,n=this;null===(r=((t={})[AdType.BeforePlay]=function(){return n.setCtrlBarState(STATE.disabled,AdType.BeforePlay)},t[AdType.MidRoll]=function(){return n.setCtrlBarState(STATE.disabled,AdType.MidRoll)},t[AdType.AfterPlay]=function(){return n.setCtrlBarState(STATE.disabled,AdType.AfterPlay)},t)[null===(o=e.data)||void 0===o?void 0:o.adType])||void 0===r||r.apply(this),null===(i=this.player.loadingPlugin)||void 0===i||i.hide()},e.prototype.onAdPaused=function(){var e=this.player.ctrlbarPlugin;e&&(e.show(!0),e.setCompDisable("PlayBtn",!1))},e.prototype.onAdResume=function(e){var t,o=e.data.adtype;[AdType.AfterPlayCodeName,AdType.MidRoll,AdType.BeforePlayCodeName].includes(o)&&(null===(t=this.player.ctrlbarPlugin)||void 0===t||t.setCompDisable("PlayBtn"))},e.prototype.onAdEnd=function(e){var t,o,r,i=this;null===(r=((t={})[AdType.BeforePlay]=function(){return i.setCtrlBarState(STATE.enabled,AdType.BeforePlay)},t[AdType.MidRoll]=function(){i.setCtrlBarState(STATE.enabled,AdType.MidRoll),i.player.play()},t[AdType.AfterPlay]=function(){return i.setCtrlBarState(STATE.enabled,AdType.AfterPlay)},t)[null===(o=e.data)||void 0===o?void 0:o.adType])||void 0===r||r.apply(this)},e.prototype.onVideoPlaying=function(e){e.data.isFirst&&getIsOfficialScenes()&&(uaTool.mobile||this.player.config.type!==exports.PLAY_MODE.VOD||this.requestMidRollAd())},e.prototype.onAdAutoplayBlocked=function(e){var t;if(e.data.adType===AdType.BeforePlay){null===(t=this.player.loadingPlugin)||void 0===t||t.hide();var o=this.player.ctrlbarPlugin;o&&(o.show(!0),o.setCompDisable("PlayBtn",!1),o.setCompDisable(["PictureInPicture","playrate"],!0))}},e.prototype.onWillPlayMidRollAd=function(){this.player.pause(),getAdPlugin(this.player.config.instanceId).playAd({adType:AdType.MidRoll})},e.prototype.onEnterMidRollAdCountdown=function(){this.setCtrlBarState(STATE.disabled,AdType.MidRoll)},e.prototype.prepareMidRollAdRequestParam=function(){var e=this.player.getCommonKv(COMMON_DATA_KEY.vid),t=getAdPlugin(this.player.config.instanceId).getAdParams({vid:e,coverId:this.player.getCommonKv(COMMON_DATA_KEY.cid),adType:AdType.MidRoll});t.adparam&&(t=t.adparam);var o=this.player.getCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo);(null==o?void 0:o.adsid)&&(t.session_id=o.adsid);var r={pr:1,otype:"json",idlist:e,strAdParam:urlTool.convertUrlParam(__assign$1(__assign$1({},t),{anchor:"1"})),vuid:cookieTool.get("vuserid")||cookieTool.get("vqq_vuserid")},i=this.player.getCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges);return(null==i?void 0:i.length)>0&&(r.adsegments=JSON.stringify({ad_segments:i.map((function(e){return{start_time:e.start,duration:e.end-e.start}}))})),r},e.prototype.requestMidRollAd=function(){return __awaiter$1(this,void 0,void 0,(function(){var e,t,o,r,i;return __generator$1(this,(function(n){switch(n.label){case 0:if(!(e=getAdPlugin(this.player.config.instanceId)))return[2];t=isVideoMarkDebugEnv?midRollAdCGI.Test:midRollAdCGI.Formal,o=this.prepareMidRollAdRequestParam(),r={},n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,netTool.jsonp(t,{name:"thumbplayer_mr_ad_callback",query:o})];case 2:return r=n.sent(),i=parseMidRollAdResponse(r),e.setAdInfo(i),[3,5];case 3:return n.sent(),[3,5];case 4:return this.player.emit(exports.SUPER_EVENTS.GET_VIDEO_MARK_ALL_OVER,r),[7];case 5:return[2]}}))}))},e.prototype.setCtrlBarState=function(e,t){var o=this.player.plugins[CtrlbarPluginName];if(o){var r=disabledCtrlBarCompsMap[t];o.setCompDisable(r,!!e),o.setHotKeysDisable(!!e)}},e.prototype.onVideoReqInfoEnd=function(e){var t=e.data,o=((null==t?void 0:t.parseData)||{}).vitem;if(!(null==t?void 0:t.error))if(o&&o.ad){var r=parseGetinfoHlsAdRanges(o.ad);this.player.setCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges,r),this.player.setCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo,o.ad),this.logger.log("hlsAdRanges from getinfo is ",r)}else this.player.setCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges,null)},e.prototype.onVideoTimeUpdate=function(e){var t=(e.data||{}).playtime;t<=0||this.checkWhetherEnterOrExitHlsAd(t)},e.prototype.checkWhetherEnterOrExitHlsAd=function(e){var t=this.player.getCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges);if(!t||t.length<=0)this.exitHlsAd();else{var o=t.find((function(t){return t.start<=e&&e<=t.end}));!this.isHlsAdPlaying&&o?this.enterHlsAd(e,o):this.isHlsAdPlaying&&!o&&this.exitHlsAd()}},e.prototype.enterHlsAd=function(e,t){this.isHlsAdPlaying||(this.logger.log("enter hlsAd, playtime=".concat(e,", range="),t),this.isHlsAdPlaying=!0,this.player.emit(exports.SUPER_EVENTS.ENTER_HLS_AD,{hlsAdRange:t}))},e.prototype.exitHlsAd=function(){this.isHlsAdPlaying&&(this.logger.log("exit hlsAd...."),this.isHlsAdPlaying=!1,this.player.emit(exports.SUPER_EVENTS.EXIT_HLS_AD))},e}(),PosterLogic=function(){function e(e){this.player=e,this.hasPostAdInPlaySession=!1,this.setEvts(!0),this.showDefaultPoster()}return e.prototype.destroy=function(){this.setEvts(!1),this.player=null},e.prototype.showDefaultPoster=function(){var e=this,t=this.player.config,o=t.videoId,r=t.type,i=t.lazyInitPlugins,n=t.videoInitConfig,a=o;if(n)if("string"==typeof n)a=n;else{var s=n.vid;s&&(a=s)}var l=function(){r===exports.PLAY_MODE.VOD&&a&&e.showPoster(a)};i?this.player.pluginMsg.once("pluginsetup:".concat(PosterPluginName),(function(){l()})):l()},e.prototype.showPoster=function(e){var t=this.player.config,o=t.poster,r=t.disablePoster,i=t.type,n=this.player.getPlugin(PosterPluginName);!r&&n&&((null==o?void 0:o.src)?n.show(o.src):i!==exports.PLAY_MODE.VOD?n.show("https://puui.qpic.cn/vupload/0/20171225_1514277750947.jpeg/0"):e&&"string"==typeof e&&n.showByVid(__assign$1(__assign$1({},o),{vid:e})))},e.prototype.setEvts=function(e){var t,o=this;this.evtMap||(this.evtMap=((t={})[exports.H5_PLAY_EVENT.AD_AUTOPLAY_BLOCKED]=this.onAdAutoplayBlocked.bind(this),t[exports.H5_PLAY_EVENT.AD_PLAYING]=this.onAdPlaying.bind(this),t[exports.H5_PLAY_EVENT.PLAY_SESSION_END]=this.onPlaySessionEnd.bind(this),t));var r=e?this.player.on:this.player.off;Object.keys(this.evtMap).forEach((function(e){r.apply(o.player,[e,o.evtMap[e]])}))},e.prototype.onAdAutoplayBlocked=function(e){e.data.adType===exports.AD_TYPE.PRE&&this.showPoster(this.player.vid)},e.prototype.onAdPlaying=function(e){e.data.adType===exports.AD_TYPE.POST&&(this.hasPostAdInPlaySession=!0)},e.prototype.waitSessionStart=function(){var e=this;return new Promise((function(t){var o=function(){return t(!0)};e.player.once(exports.H5_PLAY_EVENT.PLAY_SESSION_START,o),setTimeout((function(){var r;null===(r=e.player)||void 0===r||r.off(exports.H5_PLAY_EVENT.PLAY_SESSION_START,o),t(!1)}),SESSION_DURATION)}))},e.prototype.onPlaySessionEnd=function(e){var t=e.data;return __awaiter$1(this,void 0,void 0,(function(){var e,o;return __generator$1(this,(function(r){switch(r.label){case 0:return e=t.curFlowNodeName,o=t.endState,this.hasPostAdInPlaySession?(this.hasPostAdInPlaySession=!1,this.showPoster(this.player.vid),[2]):AD_FLOW_NODE_NAME_REG.test(e)&&o!==exports.END_STATE.NORMAL?[4,this.waitSessionStart()]:[3,2];case 1:!r.sent()&&this.showPoster(this.player.vid),r.label=2;case 2:return[2]}}))}))},e}(),AD_FLOW_NODE_NAME_REG=/AdFlowNode/i,SESSION_DURATION=400,PreviewLogic=function(){function e(e){var t=this;this.player=e,this.previewDuration=NO_PREVIEW_FLAG,this.isPreviewEnd=!1,this.lastHotKeysDisabled=!1,this.lastCtrlShowDisabled=!1,this.previewStartTimeOnLive=0,this.onVideoSessionStart=function(){t.ctrlPlugin&&t.isVod&&(t.ctrlPlugin.duration=void 0)},this.onVideoReqInfoEnd=function(e){var o=e.data,r=o.code,i=o.data;if(r===exports.ErrorCode.SUC){var n=(null==i?void 0:i.parseData)||{},a=n.preview,s=n.duration;Number.isNaN(a)||a<=0||(t.previewDuration=a,t.isVod?(t.showTips(),t.ctrlPlugin&&(t.player.ctrlbarPlugin.duration=uaTool.mobile?t.previewDuration:s,uaTool.mobile||t.setCtrlMaxPercent(a/s))):t.showTips(),t.player.emit(exports.SUPER_EVENTS.PREVIEW_START,{previewDuration:a}))}},this.onVideoPlaying=function(e){if(e.data.isFirst&&(t.previewStartTimeOnLive=+new Date),t.isPreviewEnd){if(t.isPreviewEnd=!1,!t.ctrlPlugin)return;t.restoreCtrlBarAction()}},this.onVideoTimeUpdate=function(e){var o=e.data.playtime;(t.isVod?t.checkPreviewOverOnVodMode(o):t.checkPreviewOverOnLiveMode())&&(t.isPreviewEnd=!0,t.player.emit(exports.SUPER_EVENTS.PREVIEW_END,{previewDuration:t.previewDuration}))},this.onPlaySessionEnd=function(){var e;t.previewDuration!==NO_PREVIEW_FLAG&&(null===(e=t.player.tipsPlugin)||void 0===e||e.hide()),t.previewDuration=NO_PREVIEW_FLAG,t.previewStartTimeOnLive=0,t.ctrlPlugin&&(t.setCtrlMaxPercent(1),t.restoreCtrlBarAction())},this.onVideoPause=function(){t.isPreviewEnd&&t.setCtrlPlayBtnStatus(exports.PlayBtnStatus.REPLAY)},this.setPreviewListener(!0)}return e.prototype.destroy=function(){this.setPreviewListener(!1),this.player=null},e.prototype.setPreviewListener=function(e){var t=e?this.player.on.bind(this.player):this.player.off.bind(this.player);t(exports.H5_PLAY_EVENT.PLAY_SESSION_START,this.onVideoSessionStart),t(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,this.onVideoReqInfoEnd),t(exports.H5_PLAY_EVENT.VIDEO_PLAYING,this.onVideoPlaying),t(exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,this.onVideoTimeUpdate),t(exports.H5_PLAY_EVENT.VIDEO_PAUSE,this.onVideoPause),t(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onPlaySessionEnd)},e.prototype.checkPreviewOverOnVodMode=function(e){var t=this;return!(this.previewDuration===NO_PREVIEW_FLAG||e<this.previewDuration||this.isPreviewEnd)&&(uaTool.mobile?setTimeout((function(){t.player.corePlayer.stop(exports.SUPER_END_STATE.PREVIEW)})):(this.player.pause(),this.disableCtrlAction()),!0)},e.prototype.checkPreviewOverOnLiveMode=function(){var e=this;return!(this.previewDuration===NO_PREVIEW_FLAG||this.previewStartTimeOnLive<=0||this.isPreviewEnd||+new Date-this.previewStartTimeOnLive<=1e3*this.previewDuration)&&(setTimeout((function(){e.player.corePlayer.stop(exports.SUPER_END_STATE.PREVIEW)})),!0)},e.prototype.setCtrlPlayBtnStatus=function(e){var t,o,r=null===(o=null===(t=this.ctrlPlugin)||void 0===t?void 0:t.instances)||void 0===o?void 0:o.PlayBtn;r&&(r.el.dataset.status=e)},e.prototype.setCtrlMaxPercent=function(e){var t,o;void 0===e&&(e=1);var r=null===(o=null===(t=this.ctrlPlugin)||void 0===t?void 0:t.instances)||void 0===o?void 0:o.Progress;r&&(r.maxPercent=e)},e.prototype.disableCtrlAction=function(){this.ctrlPlugin&&(this.lastHotKeysDisabled=this.ctrlPlugin.getIsHotKeysDisabled(),this.lastCtrlShowDisabled=this.ctrlShow.shadowClickDisabled,this.ctrlShow.shadowClickDisabled=!0,this.ctrlPlugin.setHotKeysDisable(!0))},e.prototype.restoreCtrlBarAction=function(){this.ctrlPlugin&&(this.ctrlPlugin.setHotKeysDisable(this.lastHotKeysDisabled),this.ctrlShow.shadowClickDisabled=this.lastCtrlShowDisabled)},e.prototype.showTips=function(){var e;if(!getIsOfficialScenes()){var t=comTool.formatPlayTime(this.previewDuration),o=getTxVideoPageURLByVid(this.player.vid,"0");null===(e=this.player.tipsPlugin)||void 0===e||e.show({text:"可试看 ".concat(t,'，去腾讯视频观看完整版 <a target="_blank;" href="').concat(o,'">立即前往</a>'),time:-1})}},Object.defineProperty(e.prototype,"isVod",{get:function(){return this.player.config.type===exports.PLAY_MODE.VOD},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ctrlShow",{get:function(){var e,t;return null===(t=null===(e=this.ctrlPlugin)||void 0===e?void 0:e.instances)||void 0===t?void 0:t.CtrlShow},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ctrlPlugin",{get:function(){return this.player.plugins[CtrlbarPluginName]},enumerable:!1,configurable:!0}),e}(),NO_PREVIEW_FLAG=0,PROXY_HTTP_PATH={COMMON:["//vd6.l.qq.com/proxyhttp","//vi.l.qq.com/proxyhttp"]},DEFAULT_CONFIG={retryCount:3},PROXY_HTTP_REQ_BUID;!function(e){e.onlyvinfo="onlyvinfo",e.onlyad="onlyad",e.vinfoad="vinfoad"}(PROXY_HTTP_REQ_BUID||(PROXY_HTTP_REQ_BUID={}));var PROXY_HTTP_CODE={NET:"70015001",TIMEOUT:"70015002",RES_CODE:"70015003"},FORMAT,RETRY_FLAG,DEGRADE_CODEC_REASON;!function(e){e.SD="sd",e.HD="hd",e.SHD="shd",e.FHD="fhd",e.UHD="uhd",e.DOLBY="dolby",e.HDR10="hdr10",e.SFR_HDR="sfr_hdr"}(FORMAT||(FORMAT={})),function(e){e.IGNORE="ignore",e.CONTINUE="continue",e.OUT_OF_TIMES="outOfTimes"}(RETRY_FLAG||(RETRY_FLAG={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.FRAME_DROP=1]="FRAME_DROP",e[e.WASM_RENDER=2]="WASM_RENDER",e[e.WASM_SPT_ERR=3]="WASM_SPT_ERR",e[e.ORG_SPT_ERR=4]="ORG_SPT_ERR"}(DEGRADE_CODEC_REASON||(DEGRADE_CODEC_REASON={}));var BaseCheck=function(){function e(e){this.checkEvt=null,this.retryTimes=0,this.retryTimesInSession=0,this.player=e,this.config=e.config,this.logger=new Logger(this.config.instanceId,"RetryChecker")}return e.prototype.destroy=function(){this.player=null,this.config=null},e.prototype.onSessionStart=function(){this.retryTimesInSession=0,this.retryTimes=0},e.prototype.onRetrySucc=function(){this.retryTimes=0},e.prototype.check=function(e){return null},e.prototype.getRetryContinueResult=function(e,t){var o=e.playtime,r=e.error,i=t||{},n=i.writeDegrade2LS,a=void 0!==n&&n,s=i.degradeReason,l=void 0===s?DEGRADE_CODEC_REASON.UNKNOWN:s,c={videoReqInfoParam:{},videoLoadParam:{startTime:o,kernelName:void 0}};return t&&this.canDegradeCodecDefn()&&(c.videoReqInfoParam.hevclv=exports.HEVC_LV_VALUE.NOT_SPT),this.logger.log("retry ".concat(RETRY_FLAG.CONTINUE," on ").concat(this.checkEvt,",\n    retryTimes=").concat(this.retryTimes,", retryTimesInSession=").concat(this.retryTimesInSession,",\n    playParam=").concat(jsonTool.safelyStringify(c),",\n    error=").concat(null==r?void 0:r.code)),{flag:RETRY_FLAG.CONTINUE,error:r,updatePlayParam:c,retryTimes:this.retryTimes,retryTimesInSession:this.retryTimesInSession,writeDegrade2LS:a,degradeReason:l}},e.prototype.canDegradeCodecDefn=function(e){return e||(e=this.player.getCommonKv(COMMON_DATA_KEY.currentDefn)),-1!==[FORMAT.SD,FORMAT.HD,FORMAT.SHD,FORMAT.FHD].indexOf(e)},e}(),CheckError=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkEvt=exports.PLAY_EVENT.ERROR,t}return __extends$1(t,e),t.prototype.check=function(e){var t=e.data.videoInfo.error;if(this.retryTimes>=this.config.maxRetryGetinfoTimes)return{flag:RETRY_FLAG.OUT_OF_TIMES,error:t,retryTimes:this.retryTimes,retryTimesInSession:this.retryTimesInSession};var o=this.player.config.type===exports.PLAY_MODE.LIVE?this.config.maxRetryGetinfoTimesInLiveSession:this.config.maxRetryGetinfoTimesInVodSession;return this.retryTimesInSession>=o?{flag:RETRY_FLAG.OUT_OF_TIMES,error:t,retryTimes:this.retryTimes,retryTimesInSession:this.retryTimesInSession}:this.checkWasmErrorCode(e)||this.checkOriginErrorCode(e)||this.checkNormalErrorCode(e)||{flag:RETRY_FLAG.IGNORE}},t.prototype.updateRetryTimes=function(){this.retryTimes+=1,this.retryTimesInSession+=1},t.prototype.checkNormalErrorCode=function(e){var t=e.data.videoInfo;return this.updateRetryTimes(),this.getRetryContinueResult(t)},t.prototype.checkWasmErrorCode=function(e){var t=e.data.videoInfo;return"70060003"===t.error.code?(this.updateRetryTimes(),this.getRetryContinueResult(t,{writeDegrade2LS:!1,degradeReason:DEGRADE_CODEC_REASON.WASM_SPT_ERR})):null},t.prototype.checkOriginErrorCode=function(e){var t=e.data.videoInfo,o=t.error;if(t.config&&t.config.vcodec!==CODEC.H264)return o.code===ERROR_CODE.MEDIA_ERR_DECODE||o.code===ERROR_CODE.MEDIA_ERR_SRC_NOT_SUPPORTED?(this.updateRetryTimes(),this.getRetryContinueResult(t,{writeDegrade2LS:!1,degradeReason:DEGRADE_CODEC_REASON.ORG_SPT_ERR})):null},t}(BaseCheck),CheckFrameDropRate=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkEvt=exports.PLAY_EVENT.TIME_UPDATE,t}return __extends$1(t,e),t.prototype.check=function(e){var t,o=e.data.videoInfo;if(!(this.config.enableDegradeOnLowPerformance&&this.player&&this.player.currentVideoInfo&&o.config.vcodec!==CODEC.H264&&this.player.kernelName!==exports.KERNEL_NAME.WASM&&this.canDegradeCodecDefn()))return{flag:RETRY_FLAG.IGNORE};if(this.retryTimesInSession>=1)return{flag:RETRY_FLAG.IGNORE};var r=(null===(t=this.player.currentVideoInfo)||void 0===t?void 0:t.qualityInfo)||{},i=r.totalVideoFrames,n=void 0===i?0:i,a=r.droppedVideoFrames;if(n>0){var s=(void 0===a?0:a)/n;if(s>=this.config.maxFrameDropRate)return this.logger.log("dropframe rate ".concat(s," is more than ").concat(this.config.maxFrameDropRate)),this.retryTimesInSession+=1,this.getRetryContinueResult(o,{writeDegrade2LS:!0,degradeReason:DEGRADE_CODEC_REASON.FRAME_DROP})}return{flag:RETRY_FLAG.IGNORE}},t}(BaseCheck),CheckRenderPerformace=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkEvt=exports.PLAY_EVENT.VIDEO_FRAME_RENDER,t.lowRenderFrameCount=0,t.lowRenderFrameTimeCostArr=[],t.renderTotalCount=0,t}return __extends$1(t,e),t.prototype.onSessionStart=function(){this.lowRenderFrameCount=0,this.renderTotalCount=0,e.prototype.onSessionStart.call(this)},t.prototype.check=function(e){var t=e.data.videoInfo,o=this.config.minRenderFrameRate<1&&this.config.minRenderFrameRate>0&&this.config.maxLowRenderFrameRate<1&&this.config.maxLowRenderFrameRate>0;if(!this.config.enableDegradeOnLowPerformance||!o||this.player.kernelName!==exports.KERNEL_NAME.WASM||!this.canDegradeCodecDefn())return{flag:RETRY_FLAG.IGNORE};var r=(this.player.currentVideoInfo||{}).videoFrameRate;if(!r||r<0)return{flag:RETRY_FLAG.IGNORE};if(this.retryTimesInSession>=1)return{flag:RETRY_FLAG.IGNORE};var i=1e3/r*this.config.minRenderFrameRate,n=e.data.renderCostTime;if(this.lowRenderFrameTimeCostArr.push(n),n<i&&this.lowRenderFrameCount++,this.renderTotalCount++,this.renderTotalCount>=1e3){var a=this.recordStats(),s=this.lowRenderFrameCount/this.renderTotalCount;if(this.renderTotalCount=0,this.lowRenderFrameCount=0,s>this.config.maxLowRenderFrameRate)return this.logger.log("low render frame rate ".concat(s," is more than ").concat(this.config.maxLowRenderFrameRate)),this.writeStats(a),this.retryTimesInSession+=1,this.getRetryContinueResult(t,{writeDegrade2LS:!0,degradeReason:DEGRADE_CODEC_REASON.WASM_RENDER})}return{flag:RETRY_FLAG.IGNORE}},t.prototype.recordStats=function(){var e={lowRenderFrameTimeCostArr:this.lowRenderFrameTimeCostArr.slice(-200),lowRenderFrameCount:this.lowRenderFrameCount,renderTotalCount:this.renderTotalCount,maxLowRenderFrameRate:this.config.maxLowRenderFrameRate,minRenderFrameRate:this.config.minRenderFrameRate};return this.lowRenderFrameTimeCostArr.length=0,e},t.prototype.writeStats=function(e){try{var t=JSON.stringify(e);lsTool.setData(LOCAL_STORAGE_KEY.RENDER_STATS_INFO,t)}catch(e){}},t}(BaseCheck),RetryLogic=function(){function e(e,t){var o,r=this;this.player=e,this.flowManager=t,this.retryCheckers=[],this.onPlaySessionStartHandler=function(){r.retryCheckers.forEach((function(e){return e.onSessionStart()}))},this.onVideoPlaying=function(e){e.data,r.retryCheckers.forEach((function(e){return e.onRetrySucc()}))},this.checkerEvtHandler=function(e){var t,o;if(r.player.vid&&"VideoFlowNode"===(null===(o=null===(t=r.flowManager)||void 0===t?void 0:t.currentFlowNode)||void 0===o?void 0:o.getName())){var i=e.type,n=r.retryCheckers.find((function(e){return e.checkEvt===i}));if(n){var a=n.check(e),s=a.flag,l=a.writeDegrade2LS,c=void 0!==l&&l,p=a.degradeReason,d=void 0===p?DEGRADE_CODEC_REASON.UNKNOWN:p;s!==RETRY_FLAG.IGNORE&&(c&&writeDegradeCodecToLocal(r.player.config.maxDegradeCodecExpireTime,d),s===RETRY_FLAG.CONTINUE?r.flowManager.currentFlowNode.retry(!1,a):s===RETRY_FLAG.OUT_OF_TIMES&&r.flowManager.currentFlowNode.retry(!0,a))}}},[CheckFrameDropRate,CheckRenderPerformace,CheckError].forEach((function(t){r.retryCheckers.push(new t(e))})),this.evtMap=((o={})[exports.H5_PLAY_EVENT.PLAY_SESSION_START]=this.onPlaySessionStartHandler,o[exports.H5_PLAY_EVENT.VIDEO_PLAYING]=this.onVideoPlaying,o),this.setCheckEvents(!0),this.setPlayerEvents(!0)}return e.prototype.destroy=function(){this.setCheckEvents(!1),this.setPlayerEvents(!1),this.retryCheckers.forEach((function(e){return e.destroy()})),this.player=null,this.flowManager=null,this.retryCheckers=null},e.prototype.setCheckEvents=function(e){var t=this;void 0===e&&(e=!0);var o=e?this.player.on:this.player.off;this.retryCheckers.map((function(e){return e.checkEvt})).forEach((function(e){o.call(t.player,e,t.checkerEvtHandler)}))},e.prototype.setPlayerEvents=function(e){var t=this,o=e?this.player.on:this.player.off;Object.keys(this.evtMap).forEach((function(e){o.call(t.player,e,t.evtMap[e])}))},e}();function writeDegradeCodecToLocal(e,t){var o=JSON.stringify({expireTime:Date.now()+e,degradeReason:t});lsTool.setData(LOCAL_STORAGE_KEY.DEGRADE_CODEC_EXPIRE_TIME,o)}function readDegradeCodecFromLocal(){var e=NaN,t=DEGRADE_CODEC_REASON.UNKNOWN;try{var o=lsTool.getData(LOCAL_STORAGE_KEY.DEGRADE_CODEC_EXPIRE_TIME),r=JSON.parse(o||"{}");e=+r.expireTime,t=r.degradeReason}catch(e){}return Number.isNaN(e)||Date.now()>=e?{needDegrade:!1}:{needDegrade:!0,degradeReason:t}}var DEFAULT_POLL_INTERVAL=6e5,PollDurationPlugin=function(e){function t(t,o,r){var i=e.call(this,t,__assign$1({defaultPollInterval:DEFAULT_POLL_INTERVAL},o),r)||this;return i.config=o,i.abort=!1,i.seq=0,i.needPoll=!1,i.requestPollDurationTimerID=0,i.pollDurationSucc=!1,i.logger=new Logger(i.player.config.instanceId,"PollDurationPlugin"),i}return __extends$1(t,e),t.prototype.destroy=function(){this.stopPoll(),e.prototype.destroy.call(this)},t.prototype.stopPoll=function(){this.requestPollDurationTimerID>0&&(window.clearTimeout(this.requestPollDurationTimerID),this.requestPollDurationTimerID=0),this.abort=!0},t.prototype.startPoll=function(){var e=this;this.requestPollDuration(this.player.vid,__assign$1(__assign$1({},this.player.loadParam.videoReqInfoParam),{flowid:this.player.getCommonKv(COMMON_DATA_KEY.flowid)})).then((function(t){e.requestPollDurationRsp(t)})).catch((function(t){e.requestPollDurationRsp()}))},t.prototype.hookVideoReqInfoEnd=function(e){var t,o;this.needPoll=1===(null===(o=null===(t=e.data.parseData)||void 0===t?void 0:t.vitem)||void 0===o?void 0:o.fvideo)},t.prototype.hookVideoPlaying=function(e){var t=this;if((e||{}).isFirst){var o=function(e){var o=t.player.plugins.tips;"function"==typeof(null==o?void 0:o.show)&&o.show(e)};this.pollDurationSucc?(this.pollDurationSucc=!1,o({text:"进度条抢救成功！",showClose:!0})):this.needPoll&&(o("恭喜解锁新功能，本视频稍后将为你扩充为完整版！"),this.startPoll())}},t.prototype.hookAdPlaying=function(e){},t.prototype.hookPlaySessionEnd=function(){this.stopPoll()},t.prototype.requestPollDuration=function(e,t){var o=this,r=__assign$1(__assign$1(__assign$1({},DEFAULT_REQ_PARAMS$1),t),{vid:e});this.abort=!1,this.seq+=1;var i={player:this.player,startTime:+new Date,endTime:0,alreadyRetryCount:0,reqParams:r,reqPath:void 0,resData:void 0,requestor:new JsonpRequestor("getpollvinfo_callback_"),parseData:void 0,error:void 0,config:{path:PATH.COMMON.map((function(e){return e.replace("getvinfo","pollvinfo")})),ckeyVer:CKEY_VRE.CKEY_9},throw:function(e,t){var o=new Error("getinfo err");throw o.code=e,o.message=t,o},seq:this.seq,urlConfig:null,logger:this.logger};this.middlewares=[prepareRequestMiddleWare,sendRequestMiddleWare$1];var n=compose$1(this.middlewares),a=new Promise((function(){}));return n(i).then((function(){return o.abort||o.seq!==i.seq?a:(o.logger.log("[poll-duration]请求成功: ",i.resData),i.resData)})).catch((function(e){if(o.abort||o.seq!==i.seq)return a;var t=e.code,r=e.message;return t||o.logger.error("[poll-duration]内部错误: ",e),i.error={code:t,message:r},null}))},t.prototype.requestPollDurationRsp=function(e){var t=this;if(e){var o=e||{},r=o.hasnlink,i=o.nextpint;if(1===r)return this.stopPoll(),this.pollDurationSucc=!0,void this.player.replay();if(!(+i>0))return void this.stopPoll();this.requestPollDurationTimerID=window.setTimeout((function(){t.startPoll()}),1e3*i)}else this.requestPollDurationTimerID=window.setTimeout((function(){t.startPoll()}),this.config.defaultPollInterval)},t.pluginName="poll-duration",t}(Plugin);H5Player.registerPlugin(PollDurationPlugin.pluginName,PollDurationPlugin);var getQQFromCookie=function(){var e=cookieTool.get("luin")||cookieTool.get("uin");return e&&(e=e.replace(/\D/g,"").replace(/^0+/,"")),e},getPtag=function(){var e,t=document.location.toString().toLowerCase();if(e=["ptag","adtag","pgv_ref"].find((function(e){return urlTool.getUrlParamByKey(t,e)})),e)return e;try{e=sessionStorage.getItem("ptag")}catch(e){}if(e)return e;var o=urlTool.getDomainOfURL(document.referrer);return["v.qq.com","film.qq.com","m.v.qq.com"].includes(o)||(e=o.replace(/\./g,"_")),e||(e=cookieTool.get("ptag"))},LoginType;function stringifyAndReplaceCommaInParams(e){return jsonTool.safelyStringify(e).replace(/,/g,"\\,")}function safelyConvertToNumber(e,t){return void 0===t&&(t=!1),isNaN(e)||!isFinite(e)?0:t?Math.round(+e):+e}!function(e){e[e.none=0]="none",e[e.wx=3]="wx",e[e.qq=1]="qq"}(LoginType||(LoginType={}));var whichBoss$1=function(){return uaTool.mobile?{id:MOBILE_ATTAID$1,token:MOBILE_ATTA_TOKEN$1}:{id:DESKTOP_ATTAID$1,token:DESKTOP_ATTA_TOKEN$1}},DESKTOP_ATTAID$1="zae00003007",DESKTOP_ATTA_TOKEN$1="2345779398",MOBILE_ATTAID$1="zbb00003101",MOBILE_ATTA_TOKEN$1="3917576196",DEFAULT_KEYS$1={iQQ:"",sid:COMMON_DATA_KEY.vid,pid:COMMON_DATA_KEY.livepid,playno:COMMON_DATA_KEY.flowid,guid:COMMON_DATA_KEY.guid,ctime:"",sdtfrom:COMMON_DATA_KEY.sdtfrom,sUrl:"",sRef:"",flashver:"",fplayerver:COMMON_DATA_KEY.playerver,P2PVer:"",vurl:"",tpay:"",cpay:"",ptag:"",adid:"",playtime:"",error_code:"",drm:COMMON_DATA_KEY.drmtype,rest_preview_cnt:"",hc_main_login:COMMON_DATA_KEY.hc_main_login,hc_openid:COMMON_DATA_KEY.hc_openid,hc_vuserid:COMMON_DATA_KEY.hc_vuserid,hc_appid:COMMON_DATA_KEY.hc_appid},LiveFlowReporterPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;i.FLOW_DATA_KEY="",i.REPORT_URL="//h.trace.qq.com/bosskv?",i.step5Timer=null,i.started=!1,i.setEvtHandler=function(){i.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,i.onStateChange)},i.onStateChange=function(e){var t,o=e.data,r=o.key,n=((t={})[exports.DATA_STATE.LOAD_END]=i.step6,t[exports.DATA_STATE.SET_LEVEL_START]=i.step8,t[exports.DATA_STATE.GET_INFO_END]=i.step4,t[exports.DATA_STATE.SESSION_END]=i.onEnd,t[exports.DATA_STATE.SESSION_START]=i.start,t);n[r]&&n[r](o)},i.start=function(){i.started=!0,i.step3()},i.step3=function(){i.report({step:"3",val:0,val1:0,val2:0}),i.step5Timer=setInterval((function(){i.step5()}),6e4)},i.step4=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,n=void 0===r?{}:r,a={val:o.ftime-n.ftime,val1:0,val2:0};i.reportedEvt.step4||(i.reportedEvt.step4=!0,i.report(__assign$1({step:"4"},a))),i.report(__assign$1({step:"1100"},a))},i.step5=function(){i.report({step:"5",val:6e4,val1:0,val2:0})},i.step6=function(e){var t=e.newVal,o=void 0===t?{}:t,r=e.startEvent,n=void 0===r?{}:r,a={step:"6",val:o.ftime-n.ftime,val1:i.reportedEvt.step7?1:0,val2:0};i.report(a)},i.step7=function(){i.report({step:"7",val:0,val1:0,val2:0})},i.step8=function(){i.report({step:"8",val:0,val1:0,val2:0})},i.onEnd=function(){i.step5Timer&&(clearInterval(i.step5Timer),i.step5Timer=null),i.reportedEvt={}};var n=t.config.liveFlowReporterConfig;return i.config=__assign$1({paramsKey:__assign$1(__assign$1({},DEFAULT_KEYS$1),(null==n?void 0:n.paramsKey)||{}),onBeforeReport:n.onBeforeReport,forceImage:n.forceImage},whichBoss$1()),i.setEvtHandler(),i}return __extends$1(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e,t=this.config.paramsKey,o=void 0===t?{}:t,r=this.player.getCommonKv;return{attaid:this.config.id,token:this.config.token,iQQ:r(o.iQQ)||getQQFromCookie(),sid:r(o.sid)||"",pid:r(o.pid)||"",playno:r(o.playno),guid:r(o.guid)||"",ctime:comTool.dateFormat(void 0,void 0),sdtfrom:r(o.sdtfrom)||"",sUrl:r(o.sUrl)||location.href,sRef:r(o.sRef)||document.referrer,flashver:r(o.flashver)||"",fplayerver:r(o.fplayerver)||"",P2PVer:r(o.P2PVer)||"",vurl:r(o.vurl)||(null===(e=this.player.currentVideoInfo)||void 0===e?void 0:e.loadingUrl),tpay:r(o.tpay)||0,cpay:r(o.cpay)||0,ptag:r(o.ptag)||"",adid:r(o.adid)||"",playtime:r(o.playtime)||0,error_code:r(o.error_code)||0,rest_preview_cnt:r(o.rest_preview_cnt)||-1,hc_main_login:r(o.hc_main_login)||"",hc_openid:r(o.hc_openid)||"",hc_vuserid:r(o.hc_vuserid)||"",hc_appid:r(o.hc_appid)||"",playertype:1,drm:r(o.drm)||0,kernel:this.player.kernelName}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.step5Timer&&(clearInterval(this.step5Timer),this.step5Timer=null)},t.prototype.reportAd=function(){this.step7()},t.prototype.report=function(t){this.started&&e.prototype.report.call(this,t)},t.pluginName="live-flow-reporter",t}(BaseReporter),LiveFlyReportKeyMapping={progid:"",playno:COMMON_DATA_KEY.flowid,guid:COMMON_DATA_KEY.guid,sip:"",iqq:"",hh_ua:COMMON_DATA_KEY.ua,cdn:"",sdtfrom:COMMON_DATA_KEY.sdtfrom,loadingtime:"",blocktime:"",blockcount:"",prdlength:"",platform:COMMON_DATA_KEY.platform,errorcode:"",dsip:"",durl:"",firstreport:"",sUrl:COMMON_DATA_KEY.url,sRef:COMMON_DATA_KEY.referrer,fplayerver:COMMON_DATA_KEY.playerver,livepid:COMMON_DATA_KEY.livepid,viewid:"",seq:"",cmd:"",fullecode:"",live_type:"",geturltime:"",playtime:"",ispay:"",isuserpay:"",switch:"",lookback:"",nettype:"",freetype:"",https:"",downspeed:"",vip_type:"",playertype:"",pvid:"",login_type:"",open_id:COMMON_DATA_KEY.hc_openid,live_delay:"",use_p2p:COMMON_DATA_KEY.p2p,p2p_play:"",p2pver:COMMON_DATA_KEY.p2pver},APP_KEY="0AND0F8T5N4N7QT0",OVERSEA_APP_KEY="0DOU0M38AT4C4UVD",LiveFlyReporterPlugin=function(e){function t(t,o,r){var i,n,a=e.call(this,t,o,r)||this;a.periodTickTimer=0,a.currentPeriodStartTime=0,a.isInPlayback=0,a.lastSid=0,a.loadCost=0,a.redirectCost=0,a.bufferCount=0,a.redirectStartTime=0,a.bufferDuration=0,a.reported=!1,a.delay=0,a.seq=0,a.errCode=exports.ErrorCode.SUC,a.keyMapping=__assign$1(__assign$1({},LiveFlyReportKeyMapping),null===(i=t.config.liveFlyReporterConfig)||void 0===i?void 0:i.paramsKey);var s=null===(n=t.config.liveFlyReporterConfig)||void 0===n?void 0:n.isOversea,l={appKey:s?APP_KEY:OVERSEA_APP_KEY,isOversea:s};return a.REPORT_KEY=l.appKey,a.bindEventHandlers(),BeaconRequest.register(l),a.reporter=BeaconRequest.report,a.cachedVideoInfo=createVideoInfo(),a}return __extends$1(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e=this,t=e.player,o=e.keyMapping,r=e.cachedVideoInfo,i=t.currentVideoInfo,n=(null==i?void 0:i.loadingUrl)||"",a=this.getAuthInfo(),s=a.pvid,l=a.loginType;return{progid:r.liveSid||0,playno:t.getCommonKv(o.playno)||"",guid:t.getCommonKv(o.guid)||"",sip:t.getCommonKv(o.sip)||"0.0.0.0",iqq:t.getCommonKv(o.iqq)||0,hh_ua:t.getCommonKv(o.hh_ua)||"",cdn:r.cdnName||"",sdtfrom:t.getCommonKv(o.sdtfrom)||0,loadingtime:this.loadCost,blocktime:this.bufferDuration,blockcount:this.bufferCount,prdlength:0,platform:t.getCommonKv(o.platform),errorcode:this.errCode,dsip:"0.0.0.0",durl:n,firstreport:+!this.reported,sUrl:t.getCommonKv(o.sUrl)||"",sRef:t.getCommonKv(o.sRef)||"",fplayerver:t.getCommonKv(o.fplayerver)||"0.0.0",livepid:t.getCommonKv(o.livepid)||0,viewid:r.liveChid||0,seq:this.seq,cmd:0,fullecode:this.errCode,live_type:r.liveType,geturltime:this.redirectCost,playtime:r.previewLength||-1,ispay:r.ispay||0,isuserpay:r.isuserpay||0,switch:"",lookback:this.isInPlayback,nettype:0,freetype:0,https:+(0===n.indexOf("https://")),downspeed:0,vip_type:t.getCommonKv(o.vip_type)||0,playertype:t.getCommonKv(o.playertype)||0,pvid:s||0,login_type:l,open_id:t.getCommonKv(o.open_id)||"",live_delay:this.delay,use_p2p:t.getCommonKv(o.use_p2p)||0,p2p_play:0,p2pver:t.getCommonKv(o.p2pver)||""}},enumerable:!1,configurable:!0}),t.prototype.report=function(t){this.player.getCommonKv(COMMON_DATA_KEY.vid)&&(uaTool.spider||(e.prototype.report.call(this,__assign$1(__assign$1({},t),{stepname:REPORT_EVENT_ID$1})),this.seq+=1,this.reported=!0))},t.prototype.getAuthInfo=function(){var e=this.player;return{pvid:cookieTool.get("pgv_pvid"),loginType:LoginType[e.getCommonKv(COMMON_DATA_KEY.hc_main_login)||"none"]}},t.prototype.getVideoInfo=function(e){var t=e.data.resData,o=0;1===t.stream&&(o|=16),2===t.vcode&&(o|=4),this.cachedVideoInfo={liveChid:t.livechid,liveSid:t.livesid,ispay:t.ispay,isuserpay:t.isuserpay,previewLength:t.playtime,cdnName:t.cdn_name,liveType:o},this.redirectCost=Date.now()-this.redirectStartTime},t.prototype.bindEventHandlers=function(){var e=this;this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_START,(function(){e.redirectStartTime=Date.now()})),this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.getVideoInfo.bind(this)),this.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,this.onDataSetStateUpdate.bind(this)),this.player.on(exports.H5_PLAY_EVENT.PLAY_SESSION_END,this.onSessionEnded.bind(this)),this.player.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_START,this.onSetLevelStart.bind(this))},t.prototype.onDataSetStateUpdate=function(e){var t,o=((t={})[exports.DATA_STATE.BUFFER_END]=this.onBufferEnd,t[exports.DATA_STATE.LOAD_END]=this.onLoaded,t[exports.DATA_STATE.SET_LEVEL_END]=this.onSetLevelEnd,t);o[e.data.key]&&o[e.data.key].call(this,e)},t.prototype.onLoaded=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=o.ftime,n=o.code,a=r.ftime;this.loadCost=i-a,this.errCode=n,this.report({cmd:n===exports.ErrorCode.SUC?CMD.load:CMD.error}),this.startTick()},t.prototype.onBufferEnd=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=o.ftime,n=r.ftime;this.bufferDuration+=i-n,this.bufferCount+=1},t.prototype.onSetLevelStart=function(){this.lastSid=this.cachedVideoInfo.liveSid,this.tickImmediate()},t.prototype.onSetLevelEnd=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=o.ftime,n=o.code,a=r.ftime;n===exports.ErrorCode.SUC&&(this.loadCost=i-a,this.report({cmd:CMD.load,switch:this.lastSid}),this.startTick())},t.prototype.onSessionEnded=function(e){var t=e.data.code;this.errCode=t,this.tickImmediate(),this.clearSessionData()},t.prototype.tick=function(){var e=this,t=e.errCode,o=e.player,r=e.currentPeriodStartTime;o.currentVideoInfo&&(this.delay=o.currentVideoInfo.currentDelay||0),this.report({cmd:t===exports.ErrorCode.SUC?CMD.period:CMD.error,fullecode:t,prdlength:Date.now()-r}),this.onTickEnd()},t.prototype.clearTick=function(){this.periodTickTimer&&(window.clearTimeout(this.periodTickTimer),this.periodTickTimer=null)},t.prototype.onTickEnd=function(){this.bufferCount=0,this.bufferDuration=0,this.currentPeriodStartTime=Date.now()},t.prototype.tickImmediate=function(){this.clearTick(),this.tick()},t.prototype.startTick=function(){this.periodTickTimer||(this.currentPeriodStartTime=Date.now(),this.periodTickTimer=window.setInterval(this.tick.bind(this),PeriodInterval))},t.prototype.clearSessionData=function(){this.redirectCost=0,this.redirectStartTime=0,this.currentPeriodStartTime=0,this.cachedVideoInfo=createVideoInfo(),this.loadCost=0,this.reported=!1,this.seq=0,this.delay=0,this.errCode=exports.ErrorCode.SUC},t.pluginName="live-fly-reporter",t}(BaseReporter),CMD;!function(e){e[e.load=205]="load",e[e.error=150]="error",e[e.period=263]="period"}(CMD||(CMD={}));var REPORT_EVENT_ID$1="boss_cmd_player_hit_tap_process",PeriodInterval=6e4,createVideoInfo=function(){return{liveChid:0,liveSid:0,liveType:0,ispay:0,isuserpay:0,previewLength:0,cdnName:""}},_a,msUnit=.001,step8Map=(_a={12e4:3e4,12e5:6e4},_a[1/0]=3e5,_a),DEFAULT_KEYS={uin:"",vid:COMMON_DATA_KEY.vid,coverid:COMMON_DATA_KEY.cid,pid:COMMON_DATA_KEY.flowid,guid:COMMON_DATA_KEY.guid,cmid:COMMON_DATA_KEY.guid,unid:"",vt:COMMON_DATA_KEY.cdnid,type:"",bi:COMMON_DATA_KEY.duration,bt:"",version:COMMON_DATA_KEY.playerver,platform:COMMON_DATA_KEY.platform,format:COMMON_DATA_KEY.fmt,defn:COMMON_DATA_KEY.currentDefn,ptag:"",isvip:COMMON_DATA_KEY.vip,tpid:"",pversion:"",hc_uin:"",hc_main_login:COMMON_DATA_KEY.hc_main_login,hc_vuserid:COMMON_DATA_KEY.hc_vuserid,hc_openid:COMMON_DATA_KEY.hc_openid,hc_appid:COMMON_DATA_KEY.hc_appid,hc_access_token:COMMON_DATA_KEY.hc_access_token,hc_pvid:"",hc_ssid:"",hc_qq:"",ua:COMMON_DATA_KEY.ua,hh_ua:COMMON_DATA_KEY.ua,ckey:"",ckeyVer:"",iformat:COMMON_DATA_KEY.fmt,hh_ref:COMMON_DATA_KEY.topUrl,vurl:"",v_idx:"",rcd_info:"",extrainfo:"",bucket_id:COMMON_DATA_KEY.testid,drm:COMMON_DATA_KEY.drm,pay_type:"",pcplatform:"",drmtype:COMMON_DATA_KEY.drmtype,insert_duration_ms:"",insert_flowid:"",vip_token:"",common_rcd_info:"",common_ext_info:"",common_json_info:"",qimei36:"",format_ua:"",triggerplay:"",tpay:"",cpay:"",dltype:COMMON_DATA_KEY.dltype,cginame:"",vtype:"",p2pVer:COMMON_DATA_KEY.p2pver,playertype:COMMON_DATA_KEY.playertype},VodFlowReporterPlugin=function(e){function t(t,o,r){var i=e.call(this,t,o,r)||this;i.FLOW_DATA_KEY="__thumbplayer_vod_flow_report__",i.UNSAFE_KEY=["hh_ref","vurl"],i.REPORT_URL="//h.trace.qq.com/bosskv?",i.startPlayTime=0,i.actualPlayTime=0,i.lastPlayTimeStamp=0,i.saveInterval=0,i.lastStep8PlayTime=0,i.step8Seq=0,i.setEvtHandler=function(){i.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,i.onDataStateChange),i.player.on(exports.H5_PLAY_EVENT.VIDEO_PLAYING,i.onFirstPlay),i.player.on(exports.H5_PLAY_EVENT.AD_PLAYING,i.onAdPlaying),i.player.on(exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,i.onVideoTimeUpdate),i.player.on(exports.PLAY_EVENT.STATE_CHANGE,i.onCoreStateChange),document.addEventListener("visibilitychange",i.onVisibilityChange)},i.onVisibilityChange=function(){"hidden"===document.visibilityState?i.saveData():i.player&&i.removeFromLS(i.player.getCommonKv(COMMON_DATA_KEY.flowid))},i.stopSaveData=function(){i.saveInterval&&(window.clearInterval(i.saveInterval),i.saveInterval=0)},i.onAdPlaying=function(){i.step7()},i.onFirstPlay=function(e){var t=Date.now();e.data.isFirst&&(i.startPlayTime=t)},i.onCoreStateChange=function(e){var t=e.data,o=t.new,r=t.old,n=Date.now();o===exports.VIDEO_STATE.PLAYING?i.lastPlayTimeStamp=n:r===exports.VIDEO_STATE.PLAYING&&i.lastPlayTimeStamp&&(i.actualPlayTime+=n-i.lastPlayTimeStamp)},i.onVideoTimeUpdate=function(){i.step8()},i.saveData=function(){var e=i.player.getCommonKv(COMMON_DATA_KEY.flowid);if(e&&!i.reportedEvt.step5){var t=Date.now(),o={step:"5",val:safelyConvertToNumber(i.startPlayTime?t-i.startPlayTime:0,!0),val1:2,bi:safelyConvertToNumber(i.actualPlayTime*msUnit,!0),bt:safelyConvertToNumber(i.player.getCommonKv(COMMON_DATA_KEY.duration),!0),heartbeat:t};i.saveToLS(e,__assign$1(__assign$1({},i.reportHeader),o))}},i.onDataStateChange=function(e){var t,o=e.data,r=o.key,n=((t={})[exports.DATA_STATE.GET_INFO_END]=i.step4,t[exports.DATA_STATE.LOAD_END]=i.step6,t[exports.DATA_STATE.SESSION_END]=i.step5,t[exports.DATA_STATE.SESSION_START]=i.onSessionStart,t);n[r]&&n[r](o)},i.onSessionStart=function(){i.actualPlayTime=0,i.lastPlayTimeStamp=0,i.startPlayTime=0,i.reportedEvt={},i.reportPrev(),i.step3(),i.stopSaveData(),i.saveInterval=window.setInterval(i.saveData,5e3)},i.step3=function(){var e={step:"3",val:0===i.player.currentVideoInfoIdx?1:2};i.report(e)},i.step7=function(){if(!i.reportedEvt.step7){i.reportedEvt.step7=!0;i.report({step:"7",val:0,val1:0})}},i.step4=function(){if(!i.reportedEvt.step4){i.reportedEvt.step4=!0;var e={step:"4",val:1,val1:1,bi:H5Player.pluginExists(AdPluginName)?2:1};i.report(e)}},i.step5=function(e){if(!i.reportedEvt.step5){i.reportedEvt.step5=!0;var t=e.newVal.code,o=i.startPlayTime?Date.now()-i.startPlayTime:0,r={step:"5",val:Math.round(o),val1:t!==exports.ErrorCode.SUC?2:1,val2:1,bi:safelyConvertToNumber(i.actualPlayTime*msUnit,!0),bt:safelyConvertToNumber(i.player.getCommonKv(COMMON_DATA_KEY.duration),!0)};i.report(r),i.step8(!0),i.removeFromLS(i.player.getCommonKv(COMMON_DATA_KEY.flowid)),i.stopSaveData()}},i.step6=function(e){if(!i.reportedEvt.step6){i.reportedEvt.step6=!0,i.startPlayTime=Date.now();var t=e.startEvent,o={step:"6",val:safelyConvertToNumber(e.newVal.ftime-(null==t?void 0:t.ftime)),val1:i.reportedEvt.step7?0:1,val2:1,bi:0,bt:safelyConvertToNumber(i.player.getCommonKv(COMMON_DATA_KEY.duration),!0)};i.report(o)}},i.step8=function(e){if(void 0===e&&(e=!1),i.lastPlayTimeStamp){var t=Date.now(),o=t-i.lastPlayTimeStamp,r=e?i.actualPlayTime:i.actualPlayTime+o,n=+Object.keys(step8Map).find((function(e){return r<+e})),a=r-i.lastStep8PlayTime;if(e||a>=step8Map[n]){var s={step:"8",val:safelyConvertToNumber(t-i.startPlayTime),val1:e?1:4,bi:safelyConvertToNumber(r*msUnit,!0),bt:safelyConvertToNumber(i.player.getCommonKv(COMMON_DATA_KEY.duration),!0),insert_duration_ms:a};i.lastStep8PlayTime=r,i.step8Seq+=1,i.report(s)}}};var n=t.config.vodFlowReporterConfig;return(null==n?void 0:n.releaseDelay)&&(i.RELEASE_DELAY=n.releaseDelay),i.config=__assign$1({paramsKey:__assign$1(__assign$1({},DEFAULT_KEYS),(null==n?void 0:n.paramsKey)||{}),onBeforeReport:n.onBeforeReport,forceImage:n.forceImage},whichBoss()),i.setEvtHandler(),i.reportPrev(),i}return __extends$1(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e,t=this.player,o=t.getCommonKv,r=t.dataset,i=t.currentVideoInfoIdx,n=t.videoSize,a=void 0===n?{width:0,height:0}:n,s=a.width,l=a.height,c=this.config.paramsKey,p=r.visualStats,d=p.isPlayerInViewport,u=p.isTabFocused,A={uin:o(c.uin)||getQQFromCookie(),vid:o(c.vid)||"",coverid:o(c.coverid)||"",pid:o(c.pid)||"",guid:o(c.guid)||"",cmid:o(c.guid)||"",unid:o(c.unid)||"",vt:o(c.vt)||"",type:o(c.type)||"",bi:o(c.bi)||0,bt:o(c.bt)||0,val:0,val1:0,val2:0,version:o(c.version)||"",platform:o(c.platform)||"",format:o(c.format)||"",defn:o(c.defn)||"",ptag:o(c.ptag)||getPtag(),isvip:o(c.isvip)||-1,tpid:o(c.tpid)||"",pversion:"thumbplayer",hc_uin:o(c.hc_uin)||getQQFromCookie(),hc_main_login:o(c.hc_main_login)||"",hc_vuserid:o(c.hc_vuserid)||"",hc_openid:o(c.hc_openid)||"",hc_appid:o(c.hc_appid)||"",hc_pvid:o(c.hc_pvid)||cookieTool.get("pgv_pvid"),hc_ssid:o(c.hc_ssid)||"",hc_qq:o(c.hc_qq)||"",hc_access_token:o(c.hc_access_token)||"",ua:o(c.ua)||"",hh_ua:o(c.hh_ua)||"",ckey:o(c.ckey)||"",iformat:o(c.iformat)||"",hh_ref:o(c.hh_ref)||"",rcd_info:o(c.rcd_info)||"",extrainfo:o(c.extrainfo)||"",bucket_id:o(c.bucket_id)||"",pay_type:o(c.pay_type)||0,idx:i||0,diagonal:Math.round(Math.sqrt(Math.pow(s,2)+Math.pow(l,2))),vurl:(null===(e=this.player.currentVideoInfo)||void 0===e?void 0:e.loadingUrl)||o(c.vurl),v_idx:this.player.currentVideoInfoIdx||0,ctime:comTool.dateFormat(void 0,void 0),url:document.URL,attaid:this.config.id,token:this.config.token,isfocustab:u,isvisible:d,format_ua:o(c.format_ua)||getFormatUA(),pcplatform:o(c.pcplatform)||"web",drm:o(c.drm)?1:0,insert_flowid:this.step8Seq,vip_token:o(c.vip_token)||0,kernel:this.player.kernelName||"",drmtype:o(c.drmtype)||0};return this.config.id===MOBILE_ATTAID&&(A.common_rcd_info=o(c.common_rcd_info)||"",A.common_ext_info=o(c.common_ext_info)||"",A.common_json_info=o(c.common_json_info)||"",A.qimei36=o(c.qimei36)||""),this.config.id===DESKTOP_ATTAID&&(A.triggerplay=o(c.triggerplay)||1,A.tpay=o(c.tpay)||0,A.cpay=o(c.cpay)||0,A.dltype=o(c.dltype)||0,A.cginame=o(c.cginame)||"",A.vtype=o(c.vtype)||"",A.ckeyVer=o(c.ckeyVer)||"",A.p2pVer=o(c.p2pVer)||"",A.playertype=o(c.playertype)||""),A},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.stopSaveData(),document.removeEventListener("visibilitychange",this.onVisibilityChange),e.prototype.destroy.call(this)},t.prototype.report=function(t){if(this.player.getCommonKv(COMMON_DATA_KEY.vid))return"function"==typeof this.config.onBeforeReport?e.prototype.report.call(this,this.config.onBeforeReport(t)):e.prototype.report.call(this,t)},t.pluginName="vod-flow-reporter",t}(BaseReporter);function whichBoss(){return uaTool.mobile?{id:MOBILE_ATTAID,token:MOBILE_ATTA_TOKEN}:{id:DESKTOP_ATTAID,token:DESKTOP_ATTA_TOKEN}}function getFormatUA(){var e="other",t=uaTool.browser,o=uaTool.os;return t.qqlive&&(o.iphone?e="iphone_qqlive":o.android&&(e="aphone_qqlive")),e}var DESKTOP_ATTAID="z4900004298",DESKTOP_ATTA_TOKEN="4973349567",MOBILE_ATTAID="z3000002865",MOBILE_ATTA_TOKEN="4135796792",VodFlyReporterPlugin=function(e){function t(t,o,r){var i,n,a=e.call(this,t,o,r)||this;a.seq=0,a.bufferReportCached=[],a.seekReportCached=[],a.onDataSetStateUpdate=function(e){var t,o=e.data.key,r=((t={})[exports.DATA_STATE.INIT]=a.runOnce(a.step5,a),t[exports.DATA_STATE.LOAD_END]=a.runOnce(a.step30,a),t[exports.DATA_STATE.SET_LEVEL_END]=function(){a.step45(e),a.step31(e)},t[exports.DATA_STATE.SET_LEVEL_START]=function(){a.reportStep35and40()},t[exports.DATA_STATE.RETRY_PLAY]=a.step47,t[exports.DATA_STATE.BUFFER_END]=a.recordStep35,t[exports.DATA_STATE.SEEK_END]=a.recordStep40,t[exports.DATA_STATE.FIRST_PLAY]=a.runOnce(a.step32,a),t[exports.DATA_STATE.SESSION_END]=a.runOnce(a.step50,a),t);r[o]&&r[o].call(a,e)},a.keyMapping=__assign$1(__assign$1({},defaultKeys),null===(i=t.config.vodFlyReporterConfig)||void 0===i?void 0:i.paramsKey);var s=null===(n=t.config.vodFlyReporterConfig)||void 0===n?void 0:n.isOversea,l={appKey:s?OVERSEA_APP_KEY:APP_KEY,isOversea:s};return a.REPORT_KEY=l.appKey,a.bindEventHandlers(),BeaconRequest.register(l),a.reporter=BeaconRequest.report,a}return __extends$1(t,e),Object.defineProperty(t.prototype,"reportHeader",{get:function(){var e=this,t=Object.keys(this.keyMapping).reduce((function(t,o){return e.keyMapping[o]&&(t[o]=e.player.getCommonKv(e.keyMapping[o])||""),t}),{});return __assign$1(__assign$1(__assign$1(__assign$1(__assign$1({},t),this.videoInfoParams),this.firstLoadVideoInfoParam),this.getAuthInfo()),{downloadkit:+!!this.player.config.enableP2P,seq:this.seq,stepname:REPORT_EVENT_ID})},enumerable:!1,configurable:!0}),t.prototype.report=function(t){this.player.getCommonKv(COMMON_DATA_KEY.vid)&&(uaTool.spider||(e.prototype.report.call(this,t),this.seq+=1))},Object.defineProperty(t.prototype,"currentUrlInfo",{get:function(){var e,t,o;if(!this.player.currentVideoInfo||!this.rawGetinfoData)return[-1,null];var r=(null===(o=null===(t=null===(e=this.rawGetinfoData.vl)||void 0===e?void 0:e.vi[0])||void 0===t?void 0:t.ul)||void 0===o?void 0:o.ui)||[],i=urlTool.getDomainOfURL(this.player.currentVideoInfo.loadingUrl),n=null==r?void 0:r.findIndex((function(e){return urlTool.getDomainOfURL(e.url)===i}));return[n,r[n]]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFmtId",{get:function(){var e,t,o,r;return this.rawGetinfoData&&null!==(r=null===(o=null===(t=null===(e=this.rawGetinfoData.fl)||void 0===e?void 0:e.fi)||void 0===t?void 0:t.find((function(e){return e.sl})))||void 0===o?void 0:o.id)&&void 0!==r?r:0},enumerable:!1,configurable:!0}),t.prototype.bindEventHandlers=function(){var e=this;this.msg.on(exports.PLAY_EVENT_EXT.DATASET_STATE_UPDATE,this.onDataSetStateUpdate),this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,this.step15.bind(this)),this.msg.on(exports.PLAY_EVENT_EXT.GETINFO_START,(function(){e.getinfoStartTime=Date.now()}))},t.prototype.step5=function(e){var t=e.data.newVal,o=t.ftime,r=t.ext.stime;this.report({step:"5",data:stringifyAndReplaceCommaInParams({stime:r,etime:o,code:exports.ErrorCode.SUC})})},t.prototype.step10=function(){},t.prototype.step15=function(e){var t,o,r=e.data,i=r.parseData,n=r.resData,a=i||{},s=a.definitionList,l=void 0===s?[]:s,c=a.vitem,p=void 0===c?{}:c,d=p.fc,u=void 0===d?0:d,A=p.br,_=void 0===A?0:A,E=p.vst,g=void 0===E?0:E,f=p.type,h=void 0===f?0:f,v=null!==(o=null===(t=null==l?void 0:l.find((function(e){return e.sl})))||void 0===t?void 0:t.id)&&void 0!==o?o:-1;this.videoInfoParams={dltype:null==n?void 0:n.dltype,duration:null==i?void 0:i.duration,type:h,clip:u,status:g},this.firstLoadVideoInfoParam||(this.firstLoadVideoInfoParam={fmt:v,rate:_}),this.rawGetinfoData=n,this.report({step:"15",data:stringifyAndReplaceCommaInParams({stime:this.getinfoStartTime,etime:Date.now(),code:"0."+n.em,ip:n.ip})})},t.prototype.step25=function(){},t.prototype.step30=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=r.ftime,n=r.currentUrl,a=o.ftime,s=this.currentUrlInfo,l=s[0],c=s[1],p=null==c?void 0:c.vt;this.report({step:"30",data:stringifyAndReplaceCommaInParams({stime:i,etime:a,vt:p,urlindex:l,reason:"",code:"0."+o.code,url:n})})},t.prototype.step31=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=r.ftime,n=r.ext,a=o.ftime,s=n.mode,l=this.currentUrlInfo,c=l[0],p=l[1],d=null==p?void 0:p.vt;this.report({step:"31",data:stringifyAndReplaceCommaInParams({stime:s===SET_LEVEL_MODE.SMOOTH?a:i,etime:a,vt:d,urlindex:c,code:"0."+o.code})})},t.prototype.step32=function(e){var t=e.data.newVal.ftime;this.report({step:"32",data:stringifyAndReplaceCommaInParams({stime:t,etime:t,code:exports.ErrorCode.SUC})})},t.prototype.step33=function(){},t.prototype.recordStep35=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=r.ftime,n=r.playbackRate,a=r.playtime,s=o.ftime,l=o.currentUrl,c=1!==n?2:1;this.bufferReportCached.push({stime:i,etime:s,ptime:a,format:this.currentFmtId,url:l,scene:c,reason:0,code:"0."+o.code})},t.prototype.recordStep40=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=r.ftime,n=r.playtime,a=o.ftime,s=o.playtime;this.seekReportCached.push({lstime:i,letime:a,pstime:n,petime:s,format:this.currentFmtId,code:"0."+o.code})},t.prototype.step45=function(e){var t=e.data,o=t.newVal,r=t.startEvent,i=r.ftime,n=r.ext,a=r.playtime,s=o.ftime,l=o.playtime,c=o.currentUrl,p=n.mode,d=this.currentUrlInfo,u=d[0],A=d[1],_=null==A?void 0:A.vt;this.report({step:"45",data:stringifyAndReplaceCommaInParams({stime:p===SET_LEVEL_MODE.SMOOTH?s:i,etime:s,pstime:a,petime:l,auto:1,format:this.currentFmtId,url:c,vt:_,urlindex:u,code:"0."+o.code})})},t.prototype.step46=function(){},t.prototype.step47=function(e){var t=e.data.newVal,o=t.currentUrl,r=t.ftime,i=this.currentUrlInfo,n=i[0],a=i[1],s=null==a?void 0:a.vt;this.report({step:"47",data:stringifyAndReplaceCommaInParams({url:o,vt:s,urlindex:n,cdnip:"",stime:r,etime:r,code:"0."+t.code})})},t.prototype.step50=function(e){var t=e.data.newVal,o=t.ftime,r=t.code,i=this.player.dataset.getStats().playDuration;this.report({step:"50",data:stringifyAndReplaceCommaInParams({etime:o,playduration:i,code:"0."+filterErrorCode(r)})}),this.reportStep35and40(),this.cleanUp()},t.prototype.reportStep35and40=function(){var e=this.bufferReportCached,t=this.seekReportCached;if(e.length){var o=e.reduce((function(e,t){return t.etime-t.stime<=STALLED_THRESHOLD?e:[e[0]+1,e[1]+(t.etime-t.stime)]}),[0,0]),r=o[0],i=o[1];this.report({step:"35",data:stringifyAndReplaceCommaInParams({tcount:r,tduration:i,val:this.bufferReportCached.slice(0,BUFFER_REPORT_LIMIT)})})}if(t.length){var n=t.reduce((function(e,t){return t.letime-t.lstime<=STALLED_THRESHOLD?[e[0]+1,e[1],e[2]]:[e[0]+1,e[1]+1,e[2]+(t.letime-t.lstime)]}),[0,0,0]),a=(r=n[0],n[1]),s=n[2];this.report({step:"40",data:stringifyAndReplaceCommaInParams({tcount:r,tbcount:a,tbduration:s,val:this.seekReportCached.slice(0,SEEK_REPORT_LIMIT)})})}this.bufferReportCached=[],this.seekReportCached=[]},t.prototype.cleanUp=function(){this.bufferReportCached=[],this.seekReportCached=[],this.rawGetinfoData=null,this.firstLoadVideoInfoParam=null,this.videoInfoParams=null,this.seq=0,this.getinfoStartTime=0},t.prototype.runOnce=function(e,t){var o=this,r="";return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var a=o.player.getCommonKv(COMMON_DATA_KEY.flowid);r!==a&&(r=a,e.apply(t,i))}},t.prototype.getAuthInfo=function(){var e=this.player;return{loginid:e.getCommonKv(COMMON_DATA_KEY.hc_openid)||"",loginex:e.getCommonKv(COMMON_DATA_KEY.hc_vuserid)||"",logintype:LoginType[e.getCommonKv(COMMON_DATA_KEY.hc_main_login)||"none"],vip:+!!e.getCommonKv(COMMON_DATA_KEY.vip)}},t.pluginName="vod-fly-reporter",t}(BaseReporter),defaultKeys={stepname:"",seq:"",hc_main_login:COMMON_DATA_KEY.hc_main_login,hc_vuserid:COMMON_DATA_KEY.hc_vuserid,hc_openid:COMMON_DATA_KEY.hc_openid,hc_appid:COMMON_DATA_KEY.hc_appid,loginid:"",loginex:"",logintype:"",guid:COMMON_DATA_KEY.guid,longitude:"",latitude:"",vip:"",online:"",p2p:COMMON_DATA_KEY.p2p,downloadkit:"",resolution:COMMON_DATA_KEY.resolution,testid:COMMON_DATA_KEY.testid,osver:COMMON_DATA_KEY.osver,playerver:COMMON_DATA_KEY.playerver,playertype:COMMON_DATA_KEY.playertype,uip:COMMON_DATA_KEY.uip,confid:COMMON_DATA_KEY.confid,cdnip:COMMON_DATA_KEY.cdnip,cdnid:COMMON_DATA_KEY.cdnid,cdnuip:COMMON_DATA_KEY.uip,freetype:"",sstrength:"",network:"",speed:"",device:COMMON_DATA_KEY.device,appver:COMMON_DATA_KEY.appVer,p2pver:COMMON_DATA_KEY.p2pver,flowid:COMMON_DATA_KEY.flowid,platform:COMMON_DATA_KEY.platform,vid:COMMON_DATA_KEY.vid,url:COMMON_DATA_KEY.url,refer:COMMON_DATA_KEY.referrer,cid:COMMON_DATA_KEY.cid,ua:COMMON_DATA_KEY.ua,ptag:COMMON_DATA_KEY.ptag,dltype:"",fmt:"",rate:"",clip:"",status:"",type:"",duration:"",ext:"",drm:"",purevid:""},BUFFER_REPORT_LIMIT=20,SEEK_REPORT_LIMIT=20,STALLED_THRESHOLD=1200,REPORT_EVENT_ID="boss_cmd_player_quality_feitian",ErrorCodeWhiteList=[exports.ErrorCode.GETINFO_SERVER_CODE_PREFIX+"083"];function filterErrorCode(e){return ErrorCodeWhiteList.find((function(t){return e.startsWith(t)}))?exports.ErrorCode.SUC:e}function getDefaultVodPlatform(){if(uaTool.mobile)return"11001";var e=isOfficialSite();return uaTool.os.windows&&e?"10201":uaTool.os.windows&&!e?"70201":uaTool.os.mac&&e?"10901":uaTool.os.mac&&!e?"70901":e?"10901":"70901"}function isOfficialSite(){var e=urlTool.getTopFrameUrl(),t=urlTool.getDomainOfURL(e);return["v.qq.com","film.qq.com"].includes(t)}function getDefautVodSdtfrom(e){if("11001"===e){if(uaTool.os.iphone||uaTool.os.ipod)return"v3010";if(uaTool.os.ipad)return"v4010";if(uaTool.os.tablet)return"v6010";if(uaTool.os.android)return"v5010";if(uaTool.browser.IEMobile)return"v7010"}return{70201:"v1104",70901:"v1103"}[e]||"v1010"}H5Player.registerPlugin(VodFlowReporterPlugin.pluginName,VodFlowReporterPlugin),H5Player.registerPlugin(LiveFlowReporterPlugin.pluginName,LiveFlowReporterPlugin),H5Player.registerPlugin(VodFlyReporterPlugin.pluginName,VodFlyReporterPlugin),H5Player.registerPlugin(LiveFlyReporterPlugin.pluginName,LiveFlyReporterPlugin);var VERSION$1=getEnvVals().VERSION,isQQDomain=/.*\.?qq\.com/g.test(urlTool.getDomainOfURL(location.href)),defaultVodPlatform=getDefaultVodPlatform(),defautVodSdtfrom=getDefautVodSdtfrom(defaultVodPlatform),defaultVodBusinessConfig={platform:defaultVodPlatform,sdtfrom:defautVodSdtfrom},defaultSuperConfig={enableDegradeOnLowPerformance:!0,maxDegradeCodecExpireTime:2592e5,minRenderFrameRate:.8,maxLowRenderFrameRate:.3,maxFrameDropRate:.3,maxRetryGetinfoTimes:3,maxRetryGetinfoTimesInVodSession:10,maxRetryGetinfoTimesInLiveSession:30,enableTVK:!0},defaultLiveBusinessConfig={platform:"10201",sdtfrom:"10201"};function getBuiltInPlugins(e,t){var o,r;void 0===e&&(e=exports.PLAY_MODE.VOD);var i=t.removeComponents,n=void 0===i?[]:i,a=n.includes(PosterPluginName)||!!t.disablePoster,s=n.includes(CtrlbarPluginName)||!!t.disableCtrlbar,l=n.includes(ErrorPagePluginName)||!!t.disableErrorPage,c=n.includes(TipsPluginName)||!!t.disableTips,p=n.includes(UILoadingPlugin.pluginName)||!!t.disableLoading,d=n.includes(UIContextMenuPluginName)||!!t.disableCtxMenu,u=n.includes(WatermarkPluginName)||!!t.disableWatermark,A=n.includes(InfoPanelPluginName),_=n.includes(PollDurationPlugin.pluginName),E=((o={})[PosterPluginName]={isEnabled:!a,config:t.poster},o[CtrlbarPluginName]={isEnabled:!s},o[ErrorPagePluginName]={isEnabled:!l,config:{showOnError:!0}},o[TipsPluginName]={isEnabled:!c},o[UILoadingPlugin.pluginName]={isEnabled:!p},o[UIContextMenuPluginName]={isEnabled:!isMobile&&!d,config:{menus:[{role:"version",label:VERSION$1||"1.3.0"}]}},o[InfoPanelPluginName]={isEnabled:!A,config:{defaultInfo:!0}},o[LivepollPlugin.pluginName]={isEnabled:e===exports.PLAY_MODE.LIVE,config:{livepid:null===(r=t.livepollConfig)||void 0===r?void 0:r.livepid}},o[VodFlowReporterPlugin.pluginName]={isEnabled:e===exports.PLAY_MODE.VOD},o[VodFlyReporterPlugin.pluginName]={isEnabled:e===exports.PLAY_MODE.VOD},o[LiveFlowReporterPlugin.pluginName]={isEnabled:e===exports.PLAY_MODE.LIVE},o[LiveFlyReporterPlugin.pluginName]={isEnabled:e===exports.PLAY_MODE.LIVE},o[WatermarkPluginName]={isEnabled:!u},o[PollDurationPlugin.pluginName]={isEnabled:e===exports.PLAY_MODE.VOD&&!_},o),g=[];return Object.keys(E).forEach((function(e){var t=E[e],o=t.isEnabled,r=t.config;o&&g.push(r?[e,r]:e)})),g}function getDownloadKitConfig(e){var t=e.type,o=e.enableP2P,r=e.platform,i=getShouldUseDownloadKitFromUrl();return"0"!==i&&("1"===i||(o?!!o:"live"!==t&&["10901","10201"].includes(r)))}function getSuperConfig(e){var t,o,r,i,n,a,s,l,c,p=e.plugins,d=void 0===p?[]:p,u=e.mode,A=void 0===u?exports.PLAY_MODE.VOD:u,_=e.businessConfig,E=void 0===_?{}:_,g=e.coreConfig,f=void 0===g?{}:g,h=e.pluginConfig,v=void 0===h?{}:h,m=e.dynamicConfig,y=void 0===m?{}:m;e.type=null!==(t=e.type)&&void 0!==t?t:A;var T=e.type,C=e.lazyInitPlugins,I=T===exports.PLAY_MODE.VOD?defaultVodBusinessConfig:defaultLiveBusinessConfig,P=__assign$1(__assign$1({},I),E),N=__spreadArray$1(__spreadArray$1([],getBuiltInPlugins(T,e),!0),d,!0),S=P.platform,x=__assign$1(__assign$1(__assign$1(__assign$1(__assign$1(__assign$1({},defaultSuperConfig),{preferCodec:T===exports.PLAY_MODE.LIVE?[]:void 0,supportedPaidFormat:isOfficialSite()?[exports.PAID_FORMAT.FHD,exports.PAID_FORMAT.DOLBY,exports.PAID_FORMAT.SFR_HDR,exports.PAID_FORMAT.UHD]:[],logLevel:getLogLevelFromUrl(),videoElementConfig:{playsinline:!0},maxVideoNodeCount:isMobile||T===exports.PLAY_MODE.LIVE?1:2,enableP2P:getDownloadKitConfig({type:T,enableP2P:e.enableP2P,platform:S})}),v),f),e),{businessConfig:P,plugins:N,offlineConfig:__assign$1({platform:S},e.offlineConfig),errorPageConfig:__assign$1({useBrowserTip:isOfficialSite(),useClientBtn:isOfficialSite()},e.errorPageConfig),ctrlConfig:__assign$1(__assign$1({disableNextBtn:!0,hidePopupOnClick:!0},v.ctrlConfig),e.ctrlConfig),infoPanelConfig:__assign$1({defaultInfo:!0},e.infoPanelConfig),vodQaReporterConfig:__assign$1(__assign$1({},null==e?void 0:e.vodQaReporterConfig),{paramsKey:__assign$1(__assign$1({},null===(o=v.vodQaReporterConfig)||void 0===o?void 0:o.paramsKey),null===(r=null==e?void 0:e.vodQaReporterConfig)||void 0===r?void 0:r.paramsKey)}),vodFlowReporterConfig:__assign$1(__assign$1({forceImage:!isQQDomain},null==e?void 0:e.vodFlowReporterConfig),{paramsKey:__assign$1(__assign$1({tpay:VOD_GET_INFO_DATA_KEYS.videoCharged,vtype:VOD_GET_INFO_DATA_KEYS.videoType,ckeyVer:VOD_GET_INFO_DATA_KEYS.ckeyVersion,pay_type:VOD_GET_INFO_DATA_KEYS.userPayType,cginame:exports.SUPER_DATA_KEY.vodCGIUsed,vurl:VOD_GET_INFO_DATA_KEYS.vurl},null===(i=v.vodFlowReporterConfig)||void 0===i?void 0:i.paramsKey),null===(n=null==e?void 0:e.vodFlowReporterConfig)||void 0===n?void 0:n.paramsKey)}),liveQaReporterConfig:__assign$1(__assign$1({},null==e?void 0:e.liveQaReporterConfig),{paramsKey:__assign$1(__assign$1({sid:LIVE_GET_INFO_DATA_KEYS$1.livesid,isuserpay:LIVE_GET_INFO_DATA_KEYS$1.isuserpay,playtime:LIVE_GET_INFO_DATA_KEYS$1.playtime},null===(a=v.liveQaReporterConfig)||void 0===a?void 0:a.paramsKey),null===(s=null==e?void 0:e.liveQaReporterConfig)||void 0===s?void 0:s.paramsKey)}),liveFlowReporterConfig:__assign$1(__assign$1({forceImage:!isQQDomain},null==e?void 0:e.liveFlowReporterConfig),{paramsKey:__assign$1(__assign$1({sid:LIVE_GET_INFO_DATA_KEYS$1.livesid,cpay:LIVE_GET_INFO_DATA_KEYS$1.cpay,tpay:LIVE_GET_INFO_DATA_KEYS$1.isuserpay,playtime:LIVE_GET_INFO_DATA_KEYS$1.playtime,rest_preview_cnt:LIVE_GET_INFO_DATA_KEYS$1.restpreviewcnt},null===(l=v.liveFlowReporterConfig)||void 0===l?void 0:l.paramsKey),null===(c=null==e?void 0:e.liveFlowReporterConfig)||void 0===c?void 0:c.paramsKey)})}),D=[],O={superPlayerConfig:mergeDynamicConfig(x,y),lazyPlugins:D};return C?(O.superPlayerConfig.plugins=O.superPlayerConfig.plugins.filter((function(e){var t="string"==typeof e?e:e[0];return!LAZY_PLUGINS.includes(t)||(D.push(e),!1)})),O):O}function getAdInitConfig(e){var t,o=e.adKernelName,r=void 0===o?exports.KERNEL_NAME.DEMUX_2_FMP4:o,i=e.adInitConfig,n=e.useSingleVideoElement,a=!!KernelFactory$1.getKernelByName(exports.KERNEL_NAME.DEMUX_2_FMP4);return __assign$1(__assign$1({},i),{playerData:__assign$1(__assign$1({},null==i?void 0:i.playerData),{playerVideoDom:(null!=n?n:uaTool.mobile)?null===(t=e.videoElements)||void 0===t?void 0:t[0]:void 0}),isUseDemuxKernel:a&&r===exports.KERNEL_NAME.DEMUX_2_FMP4,opencache:a})}function mergeDynamicConfig(e,t){var o=e;return Object.keys(t).forEach((function(e){var r=o[e];"[object Object]"===Object.prototype.toString.call(r)?o[e]=__assign$1(__assign$1({},r),t[e]):o[e]=t[e]})),o}var extInfoCgi="//h5vv6.video.qq.com/getextinfo";function requestVideoExtInfo(e){return __awaiter$1(this,void 0,void 0,(function(){var t,o,r,i,n,a,s,l,c;return __generator$1(this,(function(p){switch(p.label){case 0:return t=e.vid,o=e.platform,r={vid:t,platform:void 0===o?"11001":o,h5flag:1,otype:"json"},i="".concat(extInfoCgi,"?").concat(urlTool.object2string(r,"&")),[4,netTool.jsonp(i)];case 1:return"o"!==(n=p.sent()).s||n.em&&0!=+n.em?[2,null]:(a=n.limit,s=n.td,l=n.preview,c=n.fs,[2,{duration:0==+a?+s:+l,payLimit:+a,fileSize:c}])}}))}))}var EnvCache=function(){function e(){}return e.get=function(e){var t;return null===(t=getEnvData())||void 0===t?void 0:t[e]},e.set=function(e,t){var o,r=null!==(o=getEnvData())&&void 0!==o?o:{};r[e]=t,lsTool.setData(LOCAL_STORAGE_KEY.ENV_CACHE,JSON.stringify(r))},e.clear=function(){lsTool.setData(LOCAL_STORAGE_KEY.ENV_CACHE,"")},e}(),EnvCacheKeys;function getEnvData(){var e=lsTool.getData(LOCAL_STORAGE_KEY.ENV_CACHE);if(""!==e)try{var t=JSON.parse(e);if("[object Object]"===Object.prototype.toString.call(t))return t;EnvCache.clear()}catch(e){}}function sptAV1OnTx(){return videoTool.supportAV1()?{spav1:15}:null}function getHevcLevelRequestValue(e,t){var o,r=e.enableTxHevc,i=e.supportedPaidFormat,n=t.defn;return videoTool.supportHevc()&&!uaTool.mobile?-1!==i.indexOf(exports.PAID_FORMAT.UHD)&&(uaTool.browser.chrome||uaTool.browser.safari)?{hevclv:exports.HEVC_LV_VALUE.UHD}:{hevclv:exports.HEVC_LV_VALUE.FHD}:r&&(null===(o=KernelFactory$1.kernelMap[exports.KERNEL_NAME.WASM])||void 0===o?void 0:o.isEnvSupport)&&sptWasmHevcOnTx()&&(void 0===n||-1!==[FORMAT.SD,FORMAT.HD].indexOf(n))?{hevclv:exports.HEVC_LV_VALUE.HD}:null}function sptWasmHevcOnTx(){var e=uaTool.browser.chrome&&comTool.compareVersion(uaTool.browser.chrome.version,"92.0")>=0,t=EnvCache.get(EnvCacheKeys.enableHevc);void 0===t&&(t=1);var o=navigator.hardwareConcurrency>8;return e&&1===t&&o}function getCodecParams(e,t,o,r){var i,n=e.preferCodec,a=t.playCodec,s={};if(a===PLAY_CODEC.H264)return{};if(a===PLAY_CODEC.H265)return{hevclv:exports.HEVC_LV_VALUE.FHD};if(r)return{};if(0===(null==n?void 0:n.length))return{};for(var l=!!n,c=n||[exports.VIDEO_CODEC.AV1,exports.VIDEO_CODEC.H265],p=((i={})[exports.VIDEO_CODEC.AV1]=sptAV1OnTx,i[exports.VIDEO_CODEC.H265]=function(){return getHevcLevelRequestValue(e,o)},i),d=0;d<c.length;d++){var u=p[c[d]],A=null==u?void 0:u();if(A&&(Object.assign(s,A),l))break}return s}function getSptAdSegParam(e){return void 0===e&&(e=!1),e?3:2}function getBuiltInVideoReqInfoParam(e,t,o,r){return __awaiter$1(this,void 0,void 0,(function(){var i,n,a,s,l,c,p,d,u,A;return __generator$1(this,(function(_){return i=e.businessConfig,n=e.type,a={guid:o(COMMON_DATA_KEY.guid),platform:i.platform,sdtfrom:i.sdtfrom,appVer:o(COMMON_DATA_KEY.appVer)},(s=o(exports.PersistedUserSettings.definition))&&(a.defn=s),l=t||{},n===exports.PLAY_MODE.LIVE?(a.livepid=l.livepid||"",a.roomid=l.roomid||"",a.defauto=1):(uaTool.mobile||(a.sphls=2),a.spvvpay=1,a.spadseg=getSptAdSegParam(!0),(c=o(exports.SUPER_DATA_KEY.getinfoAdInfo))&&(a.adsid=c.adsid||"",a.adpinfo=c.adpinfo||"")),p=getCodecParams(e,l,a,r),Object.assign(a,p),(d=e.supportedPaidFormat)&&n===exports.PLAY_MODE.VOD&&(u=getRequestParamForPaidFormat(d),Object.assign(a,u)),A=getUserCookies(),a.logintoken=Object.keys(A).length>0?jsonTool.safelyStringify(A):"",[2,a]}))}))}!function(e){e.drm="drm",e.hdr="hdr",e.enableHevc="enableHevc_20220822"}(EnvCacheKeys||(EnvCacheKeys={}));var ProxyHttpRequestor=function(e){function t(t,o){var r=e.call(this)||this;return r.playerConfig=t,r.pluginMsg=o,r.destroyed=!1,r.logger=new Logger(r.playerConfig.instanceId,"ProxyHttp"),r}return __extends$1(t,e),t.prototype.request=function(e,t,o){return __awaiter$1(this,void 0,void 0,(function(){var r,i,n,a,s,l;return __generator$1(this,(function(c){switch(c.label){case 0:r=__assign$1(__assign$1({},o||{}),DEFAULT_CONFIG).retryCount,i={},e&&Object.assign(e,getUserCookies(((l={})[COOKIE_NAME$1.MAIN_LOGIN]="lt",l[COOKIE_NAME$1.OPENID]="opid",l[COOKIE_NAME$1.APPID]="appid",l[COOKIE_NAME$1.ACCESS_TOKEN]="atkn",l[COOKIE_NAME$1.VUSERID]="uid",l[COOKIE_NAME$1.VUSESSION]="tkn",l))),i.reqParams=this.getRequestParams(e,t),this.logger.log("proxyhttp reqParams(ad)",jsonTool.safelyStringify(e)),this.logger.log("proxyhttp reqParams(vinfo)",jsonTool.safelyStringify(t));try{this.pluginMsg.emit(exports.PLAY_EVENT_EXT.PROXY_HTTP_START,i.reqParams)}catch(e){this.logger.warn("H5_EXT_EVENT.PROXY_HTTP_START err, ".concat(e))}n=0,c.label=1;case 1:if(!(n<r+1))return[3,7];c.label=2;case 2:return c.trys.push([2,4,,5]),i.reqPath=this.getRequestUrl(n),this.logger.log("proxyhttp request start, num=".concat(n,", url=").concat(i.reqPath)),[4,netTool.xhr({responseType:"text",timeout:8e3,withCredentials:!0,method:"post",url:i.reqPath,retryCount:0,body:JSON.stringify(i.reqParams)})];case 3:return a=c.sent(),i.resData=JSON.parse(a.data),[3,5];case 4:return s=c.sent(),this.logger.log("proxyhttp(num=".concat(n,") request err:"),s),i.error=null,[3,5];case 5:if(this.destroyed)return[2,new Promise((function(){}))];if(i.alreadyRetryCount=n,i.resData)return[3,7];c.label=6;case 6:return n++,[3,1];case 7:this.parseResponseData(i);try{this.pluginMsg.emit(exports.PLAY_EVENT_EXT.PROXY_HTTP_END,i)}catch(e){this.logger.warn("H5_EXT_EVENT.PROXY_HTTP_END err, ".concat(e))}return[2,i]}}))}))},t.prototype.destroy=function(){this.destroyed=!0,this.logger=null},t.prototype.getRequestUrl=function(e){if(this.playerConfig.proxyHttpPath)return this.playerConfig.proxyHttpPath;var t=PROXY_HTTP_PATH.COMMON;return t[e%t.length]},t.prototype.getRequestParams=function(e,t){var o=t?urlTool.convertUrlParam(t):null,r=null,i=null;(null==e?void 0:e.adparam)?(r=urlTool.convertUrlParam(e.adparam),i=JSON.stringify(e.sspAdParam)):r=e?urlTool.convertUrlParam(e):null;var n=i?{sspAdParam:i,adparam:r}:{adparam:r};return r&&o?__assign$1({buid:PROXY_HTTP_REQ_BUID.vinfoad,vinfoparam:o},n):r?__assign$1({buid:PROXY_HTTP_REQ_BUID.onlyad},n):o?{buid:PROXY_HTTP_REQ_BUID.onlyvinfo,vinfoparam:o}:void 0},t.prototype.parseResponseData=function(e){var t,o;if(e.resData)if(0===e.resData.errCode){if(e.parseData={},e.resData.ad){this.logger.log("proxyhttp result(ad): ",null===(t=e.resData)||void 0===t?void 0:t.ad);try{e.parseData.ad=JSON.parse(e.resData.ad)}catch(t){this.logger.warn("can not parse ad data, res=".concat(e.resData.ad))}}if(e.resData.vinfo){this.logger.log("proxyhttp result(vinfo): ",null===(o=e.resData)||void 0===o?void 0:o.vinfo);try{e.parseData.vinfo=JSON.parse(e.resData.vinfo)}catch(t){this.logger.warn("can not parse vinfo data, res=".concat(e.resData.vinfo))}}}else e.error={code:PROXY_HTTP_CODE.RES_CODE,message:"播放后台返回错误码（".concat(e.resData.errCode,")")};else e.error={code:PROXY_HTTP_CODE.NET}},t}(s$1),ProxyHttpFlowNode=function(e){function t(t,o,r){var i=e.call(this,t)||this;return i.doRequestCallback=o,i.adType=r,i}return __extends$1(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.doRequestCallback=null},t.prototype.getName=function(){return"ProxyHttpFlowNode"},t.prototype.start=function(){return __awaiter$1(this,void 0,void 0,(function(){var e=this;return __generator$1(this,(function(t){switch(t.label){case 0:return this.emit(exports.FLOW_NODE_EVENT.START,{name:this.getName()}),this.isPreload=!1,this.loadDefer?[4,this.loadDefer]:[3,2];case 1:return t.sent(),this.emit(exports.FLOW_NODE_EVENT.END,{name:this.getName()}),[3,3];case 2:this.request().then((function(){e.emit(exports.FLOW_NODE_EVENT.END,{name:e.getName()})})),t.label=3;case 3:return[2]}}))}))},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.preload=function(){var e=this;return this.emit(exports.FLOW_NODE_EVENT.PRELOAD,{name:this.getName()}),this.isPreload=!0,this.loadDefer=this.request().then((function(){e.emit(exports.FLOW_NODE_EVENT.PRELOAD_NEXT,{forcePreload:e.adType===exports.AD_TYPE.PRE,name:e.getName()})})),this.loadDefer},t.prototype.request=function(){var e=this;return this.doRequestCallback().catch((function(t){e.emit(exports.FLOW_NODE_EVENT.ABORT,__assign$1(__assign$1({},t),{name:e.getName()}))}))},t}(BaseFlowNode),envVals=getEnvVals(),adInitDefer,logMethodCall=logMethodCallDecoratorCreator("SuperPlayer"),hlsADShift=1,SuperPlayer=function(e){function t(o){var r=this,i=getSuperConfig(o),n=i.superPlayerConfig,a=i.lazyPlugins;(r=e.call(this,n)||this).type=exports.PLAY_MODE.VOD,r.lazyPlugins=[],r.videoLoadParamModifier=function(e){var t,o;if(r.config.keepOriginalStartTime)return e;var i=null!==(t=r.getCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges))&&void 0!==t?t:[],n=comTool.findDiscontinuityTimeRangeAtPlaytime(e.startTime,i);if(n&&e.startTime){var a=n.start-hlsADShift;return r.log("start time modified due to hls ad, origin: ".concat(e.startTime,", new: ").concat(a)),__assign$1(__assign$1({},e),{startTime:a})}return(null===(o=r.removedAdRange)||void 0===o?void 0:o.length)?__assign$1(__assign$1({},e),{startTime:r.getVVIPOffsetTime(e.startTime)}):e},r.logger=new Logger(r.config.instanceId,"SuperPlayer"),r.log("new SuperPlayer(), input config=",jsonTool.safelyStringify(o));var s=o.mode,l=void 0===s?exports.PLAY_MODE.VOD:s,c=o.type;return r.lazyPlugins=a,r.type=c||l,r.adLogic=new AdLogic(r,r.corePlayer),r.previewLogic=new PreviewLogic(r),r.posterLogic=new PosterLogic(r),r.retryLogic=new RetryLogic(r,r.flowManager),r.createVideoReqInfoPlugin(o),r.writeGlobalCommonKvs(),r.initPlugins(),r.initInnerEvts(),r.reqExtInfoOnMobile(),r.setupRemovedAdRange(),getDebugModeFromUrl()&&(t._instances[r.config.instanceId]=r),(o.videoId||o.adInitConfig)&&r.loadAdPlugin(),n.enableTVK&&enableTVK(r,n.tvkConfig),r}return __extends$1(t,e),Object.defineProperty(t.prototype,"vinfo",{get:function(){return this.currentVideoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ctrlbarPlugin",{get:function(){return this.plugins[CtrlbarPluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tipsPlugin",{get:function(){return this.plugins[TipsPluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loadingPlugin",{get:function(){return this.plugins[UILoadingPlugin.pluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorPagePlugin",{get:function(){return this.plugins[ErrorPagePluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"posterPlugin",{get:function(){return this.plugins[PosterPluginName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.corePlayer.config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previewDuration",{get:function(){return this.previewLogic.previewDuration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"core",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coreConfig",{get:function(){return this.config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"getinfoPlugin",{get:function(){return this.videoReqInfoPlugin},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.logger).log.apply(e,t)},t.prototype.warn=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];(e=this.logger).warn.apply(e,t)},Object.defineProperty(t.prototype,"videoSize",{get:function(){var e;return this.videoSizeFromGetInfo||(null===(e=this._kernel)||void 0===e?void 0:e.videoSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cnlid",{get:function(){return this.config.type===exports.PLAY_MODE.LIVE?this.vid:""},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){var o,r,i,n,a,s;return null===(o=this.adLogic)||void 0===o||o.destroy(),this.adLogic=null,null===(r=this.retryLogic)||void 0===r||r.destroy(),this.retryLogic=null,null===(i=this.previewLogic)||void 0===i||i.destroy(),this.previewLogic=null,null===(n=this.posterLogic)||void 0===n||n.destroy(),this.posterLogic=null,null===(a=this.proxyHttpRequestor)||void 0===a||a.destroy(),this.proxyHttpRequestor=null,(null===(s=this.config)||void 0===s?void 0:s.instanceId)&&t._instances[this.config.instanceId]&&delete t._instances[this.config.instanceId],clearTimeout(this.mouseMoveTimerSuperPlayer),e.prototype.destroy.call(this)},t.prototype.play=function(t,o){var r,i,n,a;return __awaiter$1(this,void 0,void 0,(function(){var s,l,c,p,d,u,A,_,E,g;return __generator$1(this,(function(f){switch(f.label){case 0:return t?(this.clearBeforeReplay(),s=t,this.replayConfig=t,checkParams(this.type,"play",s),"string"==typeof t&&(this.type===exports.PLAY_MODE.LIVE?(l=(null===(r=this.currentPlayItem)||void 0===r?void 0:r.cnlid)?this.currentPlayItem:{},s=__assign$1(__assign$1({},l),{cnlid:t})):(l=(null===(i=this.currentPlayItem)||void 0===i?void 0:i.vid)?this.currentPlayItem:{},s=__assign$1(__assign$1({},l),{vid:t}))),null===(n=this.loadingPlugin)||void 0===n||n.show(),(c=null===(a=this.ctrlbarPlugin)||void 0===a?void 0:a.instances.CenterBtn)&&c.hideEl(c.playBtn),d=(p=s).vid,u=p.cnlid,A=p.livepid,_=this.isH5PlayParam(o)?o:{videoLoadParam:o},this.currentPlayItem=d||u||s,this.playtimeLimiter.clearAllConfig(),this.getinfoPlugin&&(d||u)?(E=this,[4,getBuiltInVideoReqInfoParam(this.config,s,this.getCommonKv.bind(this),this.checkDegradeCodecFromLocal())]):[3,3]):[2,this.playByInitConfig()];case 1:return E.buildinVideoReqInfoParam=f.sent(),this._destroyed?[2]:(_.videoReqInfoParam=__assign$1(__assign$1({},this.buildinVideoReqInfoParam),_.videoReqInfoParam),[4,this.loadAdPlugin()]);case 2:return f.sent(),this._destroyed?[2]:(u?(_.videoReqInfoParam.cnlid=u,this.getPlugin(LivepollPlugin.pluginName).livepid=A,this.setCommonKv(COMMON_DATA_KEY.livepid,A)):d&&(_.videoReqInfoParam.vid=d),[2,e.prototype.play.call(this,d||u,_)]);case 3:return(g=s.levels)&&this.setLevelOptions(g,s.url),[2,e.prototype.play.call(this,s,_)]}}))}))},t.prototype.replay=function(){var e,t,o;null===(t=null===(e=this.loadParam)||void 0===e?void 0:e.videoLoadParam)||void 0===t||delete t.startTime;var r=this.getCommonKv(COMMON_DATA_KEY.currentDefn);return this.vid&&r?this.play(this.replayConfig,__assign$1(__assign$1({},this.loadParam),{videoReqInfoParam:__assign$1(__assign$1({},null===(o=this.loadParam)||void 0===o?void 0:o.videoReqInfoParam),{defn:r})})):this.play(this.replayConfig,this.loadParam)},t.prototype.load=function(t,o){return __awaiter$1(this,void 0,void 0,(function(){var r,i,n,a;return __generator$1(this,(function(s){switch(s.label){case 0:return t?(this.clearBeforeReplay(),this.replayConfig=t,checkParams(this.type,"load",t),r="string"==typeof t?t:null==t?void 0:t.vid,i=this.isH5PlayParam(o)?o:{videoLoadParam:o},this.currentPlayItem=r,this.playtimeLimiter.clearAllConfig(),this.getinfoPlugin&&r?(n=this,[4,getBuiltInVideoReqInfoParam(this.config,t,this.getCommonKv.bind(this),this.checkDegradeCodecFromLocal())]):[3,3]):[2,e.prototype.load.call(this)];case 1:return n.buildinVideoReqInfoParam=s.sent(),this._destroyed?[2]:(i.videoReqInfoParam=__assign$1(__assign$1({},this.buildinVideoReqInfoParam),null==i?void 0:i.videoReqInfoParam),[4,this.loadAdPlugin()]);case 2:return s.sent(),this._destroyed?[2]:[2,e.prototype.load.call(this,r,i)];case 3:return(a=null==t?void 0:t.levels)&&this.setLevelOptions(a,null==t?void 0:t.url),[2,e.prototype.load.call(this,t,i)]}}))}))},t.prototype.seek=function(t){var o=t;uaTool.mobile||this.previewDuration===NO_PREVIEW_FLAG||(o=Math.min(t,this.previewDuration-1));var r=this.getCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges);if(r){var i=comTool.findDiscontinuityTimeRangeAtPlaytime(o,r);i&&(o=i.start-hlsADShift)}return e.prototype.seek.call(this,o)},t.prototype.setLevel=function(t,o){return void 0===o&&(o={}),__awaiter$1(this,void 0,void 0,(function(){var r,i,n,a,s,l,c,p,d,u,A,_=this;return __generator$1(this,(function(E){return"string"!=typeof t?[2,Promise.reject("setLevel received illegal parameter")]:this.getinfoPlugin&&this.vid?(this.state===exports.VIDEO_STATE.PAUSE&&this.type===exports.PLAY_MODE.VOD&&this.play(),r=this.getCommonKv(COMMON_DATA_KEY.currentDefn),o.userTrigger&&this.setCommonKv(exports.PersistedUserSettings.definition,t),this.buildinVideoReqInfoParam.flowid=this.getCommonKv(COMMON_DATA_KEY.flowid),i=__assign$1(__assign$1({},this.buildinVideoReqInfoParam),{defn:t,logintoken:jsonTool.safelyStringify(getUserCookies())}),n=void 0,this.type===exports.PLAY_MODE.LIVE?(a=__assign$1(__assign$1({},i),{defauto:o.userTrigger?0:1}),n=a):(s=__assign$1({fhdswitch:o.userTrigger?1:0},i),(l=this.getCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo))&&(s.adsid=l.adsid||"",s.adpinfo=l.adpinfo||""),n=s),c=[FORMAT.DOLBY,FORMAT.HDR10,FORMAT.SFR_HDR],p=o.setLevelMode,-1===c.indexOf(r)&&-1===c.indexOf(t)||(p=SET_LEVEL_MODE.HARD),[2,e.prototype.setLevel.call(this,n,{setLevelMode:p}).catch((function(e){_.log(e),_.ctrlbarPlugin.level=r,_.setCommonKv(COMMON_DATA_KEY.currentDefn,r)}))]):(d=this.getCommonKv(COMMON_DATA_KEY.currentDefnList),(u=null==d?void 0:d.find((function(e){return e.value===t})))?(!(A=u.url)&&this.defnIdToUrl&&(A=this.defnIdToUrl(t),u.url=A),A?(this.setCommonKv(COMMON_DATA_KEY.currentDefn,t),this.levelList=d,this.level=u.value,this.replayConfig.url=A,[2,e.prototype.setLevel.call(this,{url:A})]):[2,Promise.reject(new Error("definition must contains url"))]):[2,Promise.reject(new Error("no definition info"))])}))}))},t.prototype.getPlugin=function(e){return this.plugins[e]},t.prototype.closePayTipsCallback=function(e){var t=getAdPlugin(this.config.instanceId);"ad"===e&&"function"==typeof(null==t?void 0:t.resumeAd)&&t.resumeAd()},t.prototype.createPlugin=function(t,o){void 0===o&&(o={});var r=o.pluginName;(void 0===r?t:r)===AdPluginName?e.prototype.createPlugin.call(this,t,__assign$1(__assign$1({},o),{requestProxyHttp:this.requestAdProxyHttp.bind(this)})):e.prototype.createPlugin.call(this,t,o)},t.prototype.setAdConfig=function(e){return this.waitAdPlugin().then((function(t){return t.setConf(e)}))},t.prototype.resizeAd=function(){return this.waitAdPlugin().then((function(e){var t;return null===(t=e.resizeAd)||void 0===t?void 0:t.call(e)}))},t.prototype.hideAdBeforeResize=function(){return this.waitAdPlugin().then((function(e){var t;return null===(t=e.hideAdBeforeResize)||void 0===t?void 0:t.call(e)}))},t.prototype.getVVIPOffsetTime=function(e,t){void 0===t&&(t=!1);var o=this.removedAdRange;if(!(null==o?void 0:o.length))return e;if(t)return this.getPlusAdOffsetTime(e);for(var r=0,i=0;i<o.length;i++){var n=o[i],a=n.start,s=n.end;if(a>e)break;if(s>e){r+=e-a;break}r+=s-a}return e-r},t.prototype.getPlusAdOffsetTime=function(e){return this.removedAdRange.reduce((function(e,t){var o=t.start,r=t.end;return o<=e&&(e+=r-o),e}),e)},t.prototype.waitAdPlugin=function(){var e,t=this,o=getAdPlugin(null===(e=this.config)||void 0===e?void 0:e.instanceId);return o?Promise.resolve(o):new Promise((function(e){t.pluginMsg.on("pluginsetup:".concat(AdPluginName),(function(){e(getAdPlugin(t.config.instanceId))}))}))},t.prototype.playByInitConfig=function(){var t=this.config,o=t.videoId,r=t.videoInitConfig,i=void 0===r?o:r;return!i||this.currentPlayItem?e.prototype.play.call(this):this.play(i)},Object.defineProperty(t.prototype,"nodeBeforePreAd",{get:function(){return this.vid?this.getProxyHttpFlowNode(__assign$1(__assign$1({},this.loadParam),{adType:exports.AD_TYPE.PRE})):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodeBeforePostAd",{get:function(){return this.vid?this.getProxyHttpFlowNode(__assign$1(__assign$1({},this.loadParam),{adType:exports.AD_TYPE.POST})):null},enumerable:!1,configurable:!0}),t.prototype.prepareUsageData=function(){var t=e.prototype.prepareUsageData.call(this);return __assign$1(__assign$1({},t),{from:"2",channel:envVals.CHANNEL,platform:this.config.businessConfig.platform})},Object.defineProperty(t.prototype,"isCollected",{get:function(){return t._isCollected},set:function(e){t._isCollected=e},enumerable:!1,configurable:!0}),t.prototype.setupRemovedAdRange=function(){var e=this;this.on(exports.H5_PLAY_EVENT.VIDEO_REQ_INFO_END,(function(t){var o=t.data;if(o.code===exports.ErrorCode.SUC&&e.config.type!==exports.PLAY_MODE.LIVE)try{var r=o.data,i=r.parseData,n=r.reqParams,a=i.vitem,s=a.purevid,l=a.dotinfo,c=void 0===l?"":l;s&&n.vid!==s&&c?e.removedAdRange=JSON.parse(c).dot_time.map((function(e){return{start:+e.start_time/1e3,end:+e.end_time/1e3}})):e.removedAdRange=null}catch(t){e.log("set ad range err,",t),e.removedAdRange=null}}))},t.prototype.createVideoReqInfoPlugin=function(e){var t,o=H5Player.getPlugin(VideoReqInfoPluginName);if(t=this.type===exports.PLAY_MODE.VOD?GetInfoVod:e.enableUnifiedGetinfoLive?GetInfo:GetInfoLive,o&&!this.isUsingDefaultGetinfoPlugin())return this.createPlugin(VideoReqInfoPluginName,this.config);o!==t&&(H5Player.deregisterPlugin(VideoReqInfoPluginName),H5Player.registerPlugin(VideoReqInfoPluginName,t)),this.createPlugin(VideoReqInfoPluginName,this.config)},t.prototype.initPlugins=function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(e){switch(e.label){case 0:return this.config.lazyInitPlugins?(this.setCacheStatus(!0),this.setReplayType(0),[4,this.waitLoadStart()]):[3,3];case 1:return e.sent(),[4,this.loadPlayerPlugins()];case 2:e.sent(),e.label=3;case 3:return this.initAdPlugin(),this.initErrorPage(),this.initTipsPlugin(),this.initCtrlbarPlugin(),this.initLivepoll(),this.initLoadingPlugin(),this.clearCache(),[2]}}))}))},t.prototype.waitLoadStart=function(){var e=this;return new Promise((function(t){e.once(exports.H5_PLAY_EVENT.VIDEO_LOAD_START,(function(){return t()})),setTimeout((function(){t()}),200)}))},t.prototype.initAdPlugin=function(){var e=this,t=this.ctrlbarPlugin;t&&(t.on(CTRL_EVENTS.FAKE_FULLSCREEN_CHANGE,(function(){return e.resizeAd()})),t.on(CTRL_EVENTS.FULLSCREEN_CHANGE,(function(){e.hideAdBeforeResize();setTimeout((function(){e.resizeAd()}),300)})))},t.prototype.reqExtInfoOnMobile=function(){return __awaiter$1(this,void 0,void 0,(function(){var e,t,o,r,i;return __generator$1(this,(function(n){switch(n.label){case 0:return e=this.config,t=e.videoId,o=e.enableGetExtInfo,(void 0===o||o)&&uaTool.mobile&&"string"==typeof t?(r=this.getCommonKv(COMMON_DATA_KEY.platform),[4,requestVideoExtInfo({vid:t,platform:r})]):[2];case 1:return i=n.sent().duration,this.state===exports.VIDEO_STATE.IDLE&&!this.played&&this.ctrlbarPlugin&&(this.ctrlbarPlugin.duration=i),[2]}}))}))},t.prototype.initLoadingPlugin=function(){var e=this;this.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_START,(function(){var t;return null===(t=e.loadingPlugin)||void 0===t?void 0:t.show()})),this.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(){var t;return null===(t=e.loadingPlugin)||void 0===t?void 0:t.hide()})),this.pluginMsg.on(exports.PLAY_EVENT_EXT.RETRY_PLAY,(function(t){var o,r,i=t.data;null===(o=e.loadingPlugin)||void 0===o||o.show(),null===(r=e.tipsPlugin)||void 0===r||r.show((null==i?void 0:i.degradeReason)?"正在缓冲中...":"重新请求视频信息...")}))},t.prototype.initLivepoll=function(){var e=this,t=this.plugins[LivepollPlugin.pluginName];t&&t.on(LIVE_EVENTS.statusChange,(function(t){var o;t.data.new===LIVE_STATUS.OVER&&(null===(o=e.errorPagePlugin)||void 0===o||o.show({text:"直播已结束",hideRefresh:!0}))}))},t.prototype.isUsingCustomGetInfo=function(){var e;return!this.isUsingDefaultGetinfoPlugin()||!!(null===(e=this.config.getinfoConfig)||void 0===e?void 0:e.path)},t.prototype.isUsingDefaultGetinfoPlugin=function(){var e=H5Player.getPlugin(VideoReqInfoPluginName);return e===GetInfoLive||e===GetInfoVod},t.prototype.shouldUseProxyHttpForGetInfo=function(){var e,t=this.type===exports.PLAY_MODE.VOD&&!this.isUsingCustomGetInfo();return this.type===exports.PLAY_MODE.VOD&&this.setCommonKv(exports.SUPER_DATA_KEY.vodCGIUsed,t?"proxyhttp":null===(e=this.config.getinfoConfig)||void 0===e?void 0:e.path),t},t.prototype.initErrorPage=function(){var e=this;this.errorPagePlugin&&this.errorPagePlugin.on(ErrorPagePluginEvents.REPORT_LOG,(function(){e.offlineLog.report(!0,"error-page:click").then((function(t){var o,r=t||{},i=r.status,n=r.msg;null===(o=e.tipsPlugin)||void 0===o||o.show(i?"日志上报成功":"日志上报失败 ".concat(n))})).catch((function(t){var o;null===(o=e.tipsPlugin)||void 0===o||o.show("日志上报失败 ".concat(null==t?void 0:t.message))}))}))},t.prototype.initTipsPlugin=function(){var e=this;this.tipsPlugin&&this.on(exports.H5_PLAY_EVENT.VIDEO_SETLEVEL_END,(function(t){var o,r,i,n,a=t.data,s=e.getCommonKv(COMMON_DATA_KEY.currentDefn),l=null===(n=null===(i=null===(r=null===(o=e.levelList)||void 0===o?void 0:o.find((function(e){return e.value===s})))||void 0===r?void 0:r.payload)||void 0===i?void 0:i.trim)||void 0===n?void 0:n.call(i);e.tipsPlugin.show(a.code!==exports.ErrorCode.SUC?"".concat(a.message||"抱歉，切换清晰度失败~"):"已为您切换到清晰度[".concat(l,"]"))}))},t.prototype.initCtrlbarPlugin=function(){var e=this;if(this.ctrlbarPlugin){this.ctrlbarPlugin.level=this.getCommonKv(COMMON_DATA_KEY.currentDefn),this.ctrlbarPlugin.audio=this.getCommonKv(COMMON_DATA_KEY.currentAudioTrack),this.ctrlbarPlugin.lang=this.getCommonKv(COMMON_DATA_KEY.currentSubtitle),this.pluginMsg.on(exports.PLAY_EVENT_EXT.DATASET_UPDATE,(function(t){var o,r=t.data,i=r.key,n=r.newVal;if(n!==r.oldVal)switch(i){case COMMON_DATA_KEY.currentAudioTrackList:e.ctrlbarPlugin.audioOpts=n;break;case COMMON_DATA_KEY.currentAudioTrack:e.ctrlbarPlugin.audio=n;break;case COMMON_DATA_KEY.currentDefn:e.ctrlbarPlugin.level=n,e.level=n;break;case COMMON_DATA_KEY.currentDefnList:if(!n||n.length<=1){e.ctrlbarPlugin.levelOpts=[];break}o=[].concat(n),e.ctrlbarPlugin.levelOpts=o,e.levelList=o}})),this.ctrlbarPlugin.on(CTRL_EVENTS.SET_LEVEL,(function(t){var o,r;if(e.checkCanSetLevel()){var i=t.data,n=i.value,a=i.payload;null===(o=e.tipsPlugin)||void 0===o||o.show({text:"正在为您切换清晰度[".concat(null===(r=null==a?void 0:a.trim)||void 0===r?void 0:r.call(a),"]"),time:-1}),e.setLevel(n,{userTrigger:!0})}}));var t=function(){e.tipsPlugin.show("抱歉，切换清晰度失败~"),e.ctrlbarPlugin.audio=e.currentVideoInfo.currentAudioTrack};this.ctrlbarPlugin.on(CTRL_EVENTS.SET_AUDIO,(function(o){var r,i=o.data,n=i.label,a=i.value;null===(r=e.tipsPlugin)||void 0===r||r.show({text:"正在为您切换音轨[".concat(n,"]"),time:-1}),e.setAudioTrack(a).then((function(o){o.fail?t():function(t){e.tipsPlugin.show("已为您切换到音轨[".concat(t,"]"))}(n)})).catch((function(){t()}))})),this.on(exports.PLAY_EVENT.SET_AUDIO_TRACK_OVER,(function(t){e.setCommonKv(COMMON_DATA_KEY.currentAudioTrack,t.data.id)})),this.ctrlbarPlugin.on(CTRL_EVENTS.TEST_EVENT,(function(){var t;null===(t=e.getPlugin(InfoPanelPluginName))||void 0===t||t.show()}));this.container.addEventListener("mousemove",(function(){clearTimeout(e.mouseMoveTimerSuperPlayer),e.mouseMoveTimerSuperPlayer=setTimeout(e.hideMouseOnSuperPlayer.bind(e),5e3)}))}},t.prototype.hideMouseOnSuperPlayer=function(){var e,t;if(this.ctrlbarPlugin){var o=this.ctrlbarPlugin.instances.CtrlShow.isMouseHoverControl;this.config.autoHideMouse||(null===(e=this.ctrlbarPlugin.instances.Fullscreen)||void 0===e?void 0:e.isFullScreen)&&this.state===exports.VIDEO_STATE.PLAYING?o&&(this.container.style.cursor="auto"):(null===(t=this.ctrlbarPlugin.instances.FakeFullscreen)||void 0===t?void 0:t.isFullScreen)&&this.state===exports.VIDEO_STATE.PLAYING&&!o&&(this.container.style.cursor="none")}},t.prototype.setLevelOptions=function(e,t){var o,r=e.list,i=(null===(o=r.find((function(e){return e.default||e.url===t})))||void 0===o?void 0:o.value)||r[0].value;this.setCommonKv(COMMON_DATA_KEY.currentDefn,i),this.setCommonKv(COMMON_DATA_KEY.currentDefnList,r),this.levelList=r,this.level=i,this.defnIdToUrl=e.callback},t.prototype.isH5PlayParam=function(e){void 0===e&&(e={});var t=e;return!!(t.videoReqInfoParam||t.videoLoadParam||t.adParam||t.playTimeLimit)},t.prototype.initInnerEvts=function(){var e=this;this.pluginMsg.on(exports.PLAY_EVENT_EXT.GETINFO_OVER,(function(t){var o,r=(t.data||{}).resData,i=((null===(o=null==r?void 0:r.vl)||void 0===o?void 0:o.vi)||[])[0];if(i){var n=i.vw,a=i.vh;e.videoSizeFromGetInfo={width:n,height:a}}})),uaTool.mobile&&this.on(exports.H5_PLAY_EVENT.VIDEO_TIMEUPDATE,(function(t){var o=t.data;if(e.previewDuration!==NO_PREVIEW_FLAG){o.playtime>=e.previewDuration-10&&e.loadPostAd()}}))},t.prototype.writeGlobalCommonKvs=function(){this.setCommonKv(COMMON_DATA_KEY.appVer,"3.5.57"),this.setCommonKv(this.config.businessConfig),this.writeLoginCommonKV()},t.prototype.getDefnNameById=function(e){var t,o,r=null===(o=null===(t=this.getinfoCtx)||void 0===t?void 0:t.parseData)||void 0===o?void 0:o.definitionList.find((function(t){return t.name===e}));if(r){var i=formatDefnName(r.cname,this.type===exports.PLAY_MODE.LIVE),n=i[0],a=void 0===n?"":n,s=i[1];return"".concat(void 0===s?"":s," ").concat(a).trim()}return""},t.prototype.requestAdProxyHttp=function(e,t){var o;return __awaiter$1(this,void 0,void 0,(function(){var r,i,n,a,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(r=new ProxyHttpRequestor(this.config,this.pluginMsg),!(i=getAdPlugin(this.config.instanceId)))return[2];n=i.getAdParams(__assign$1(__assign$1({},t),{vid:this.vid,adType:e})),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,r.request(n,null)];case 2:return a=l.sent(),[3,4];case 3:return s=l.sent(),this.warn("proxyhttp request err in catch, ".concat(s)),[3,4];case 4:return(null===(o=null==a?void 0:a.parseData)||void 0===o?void 0:o.ad)&&i.setAdInfo(a.parseData.ad),[2,a]}}))}))},t.prototype.requestProxyHttp=function(e,t,o){var r,i,n,a,s,l;return __awaiter$1(this,void 0,void 0,(function(){var c,p,d,u,A,_,E=this;return __generator$1(this,(function(g){switch(g.label){case 0:return null===(r=this.proxyHttpRequestor)||void 0===r||r.destroy(),this.proxyHttpRequestor=new ProxyHttpRequestor(this.config,this.pluginMsg),"function"==typeof(null==(d=getAdPlugin(this.config.instanceId))?void 0:d.getAdParams)&&(c=d.getAdParams(__assign$1(__assign$1({},t),{vid:this.vid,adType:e}))),"function"!=typeof(null===(i=this.videoReqInfoPlugin)||void 0===i?void 0:i.getReqParams)?[3,2]:[4,this.getinfoPlugin.getReqParams(this.vid,__assign$1(__assign$1({},o),{flowid:this.getCommonKv(COMMON_DATA_KEY.flowid)}))];case 1:u=g.sent(),(p=u.reqParams).otype="ojson",g.label=2;case 2:return g.trys.push([2,4,,5]),[4,this.proxyHttpRequestor.request(c,p)];case 3:return A=g.sent(),[3,5];case 4:return _=g.sent(),this.warn("proxyhttp request err in catch, ".concat(_)),[3,5];case 5:return(null==A?void 0:A.error)?(this.warn("proxyhttp request error data: ",JSON.stringify(A.error)),[2]):((null===(n=null==A?void 0:A.parseData)||void 0===n?void 0:n.vinfo)&&(null===(s=(a=this.getinfoPlugin).setVideoInfo)||void 0===s||s.call(a,this.vid,A.parseData.vinfo),this.once(exports.H5_PLAY_EVENT.PLAY_SESSION_END,(function(e){var t,o;"AdFlowNode.preAd"===e.data.curFlowNodeName&&(E.log("stop in preAd, clear getinfo cache from proxyhttp rsp, vid=".concat(E.vid)),null===(o=(t=E.getinfoPlugin).setVideoInfo)||void 0===o||o.call(t,E.vid,void 0))}))),(null===(l=null==A?void 0:A.parseData)||void 0===l?void 0:l.ad)&&getAdPlugin(this.config.instanceId).setAdInfo(A.parseData.ad),[2])}}))}))},t.prototype.stop=function(t){var o;return null===(o=this.proxyHttpRequestor)||void 0===o||o.destroy(),this.videoSizeFromGetInfo=null,e.prototype.stop.call(this,t)},t.prototype.emit=function(t,o){return e.prototype.emit.call(this,t,o)},t.prototype.on=function(t,o,r){return e.prototype.on.call(this,t,o,r)},t.prototype.once=function(t,o){return e.prototype.once.call(this,t,o)},t.prototype.off=function(t,o){return e.prototype.off.call(this,t,o)},t.prototype.listeners=function(t){return e.prototype.listeners.call(this,t)},t.prototype.listenerCount=function(t){return e.prototype.listenerCount.call(this,t)},t.prototype.writeLoginCommonKV=function(){var e,t,o,r=function(e){return cookieTool.get(e)},i=getUserCookies();this.setCommonKv(((e={})[COMMON_DATA_KEY.hc_main_login]=i[COOKIE_NAME$1.MAIN_LOGIN],e[COMMON_DATA_KEY.hc_vuserid]=i[COOKIE_NAME$1.VUSERID],e[COMMON_DATA_KEY.hc_openid]=i[COOKIE_NAME$1.OPENID],e[COMMON_DATA_KEY.hc_appid]=i[COOKIE_NAME$1.APPID],e[COMMON_DATA_KEY.hc_access_token]=i[COOKIE_NAME$1.ACCESS_TOKEN],e)),i[COOKIE_NAME$1.GUID]&&this.setCommonKv(COMMON_DATA_KEY.guid,i[COOKIE_NAME$1.GUID]);var n="qq"===i[COOKIE_NAME$1.MAIN_LOGIN],a=null===(o=r("luin")||r("uin"))||void 0===o?void 0:o.replace(/\D/g,"").replace(/^0+/,"");this.setCommonKv(((t={})[COMMON_DATA_KEY.loginid]=n?a:r("openid"),t[COMMON_DATA_KEY.loginex]=n?r("openid"):a,t));this.setCommonKv(COMMON_DATA_KEY.logintype,{qq:1,wx:2}[i[COOKIE_NAME$1.MAIN_LOGIN]]||0),this.setCommonKv(COMMON_DATA_KEY.hc_vuession,i[COOKIE_NAME$1.VUSESSION])},t.prototype.getProxyHttpFlowNode=function(e){var t=this,o=e.adParam,r=e.videoReqInfoParam,i=e.adType,n=i===exports.AD_TYPE.PRE?function(){return t.shouldUseProxyHttpForGetInfo()?t.requestProxyHttp(exports.AD_TYPE.PRE,o,r):t.requestAdProxyHttp(exports.AD_TYPE.PRE,o)}:function(){return uaTool.mobile||t.previewLogic.previewDuration===NO_PREVIEW_FLAG?t.requestAdProxyHttp(exports.AD_TYPE.POST,o):Promise.resolve()};return new ProxyHttpFlowNode({flowid:this.getCommonKv(COMMON_DATA_KEY.flowid)},n,i)},t.prototype.loadAdPlugin=function(){var e=this,t=this.config.enableCreativePlugin;if(!(void 0===t||t)||envVals.LOCAL_DEV||isInDomainWhiteList)return Promise.resolve();var o=getAdInitConfig(this.config);if(adInitDefer)return adInitDefer.then((function(){!getAdPlugin(e.config.instanceId)&&H5Player.getPlugin(AdPluginName)&&e.createPlugin(AdPluginName,o)}));var r=isOfficialDomain()&&this.config.adVersion?this.config.adVersion:adVersion,i="https://vm.gtimg.cn/thumbplayer/creative/".concat(r,"/creative-player-").concat(uaTool.mobile?"m":"v",".js");return adInitDefer=this.loadPlugin({url:i,globalName:adGlobalName,pluginName:AdPluginName,timeout:adScriptMaxLoadTime,config:o,crossOrigin:"anonymous"}).catch((function(t){e.log("adPlugin load fail. ".concat(null==t?void 0:t.message))}))},t.prototype.loadPlayerPlugins=function(e){return void 0===e&&(e=2),__awaiter$1(this,void 0,void 0,(function(){var t,o,r;return __generator$1(this,(function(i){switch(i.label){case 0:if(e<=0||!this.lazyPlugins.length)return[2];t=this.lazyPlugins.map((function(e){return"string"==typeof e?e:e[0]})),o=H5Player.getPlugins(t)||{},i.label=1;case 1:return i.trys.push([1,4,,5]),Object.keys(o).length===t.length?[3,3]:[4,domTool.loadScript(PLUGINS_URL,void 0,1e4)];case 2:i.sent(),i.label=3;case 3:return[2,this.createPlugins(this.lazyPlugins)];case 4:return r=i.sent(),this.log("super-player-plugins load fail. ".concat(null==r?void 0:r.message)),[3,5];case 5:return[4,this.loadPlayerPlugins(e-1)];case 6:return i.sent(),[2]}}))}))},t.prototype.clearBeforeReplay=function(){this.setCommonKv(exports.SUPER_DATA_KEY.hlsAdRanges,null),this.setCommonKv(exports.SUPER_DATA_KEY.getinfoAdInfo,null)},t.prototype.checkDegradeCodecFromLocal=function(){var e=readDegradeCodecFromLocal(),t=e.needDegrade,o=e.degradeReason;return t&&this.pluginMsg.emit(exports.PLAY_EVENT_EXT.DEGRADE_CODEC_PLAY,{degradeReason:o}),t},t._instances={},__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"destroy",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],t.prototype,"play",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"replay",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],t.prototype,"load",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Number]),__metadata("design:returntype",void 0)],t.prototype,"seek",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",Promise)],t.prototype,"setLevel",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],t.prototype,"closePayTipsCallback",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",void 0)],t.prototype,"createPlugin",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],t.prototype,"setAdConfig",null),__decorate([logMethodCall,__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],t.prototype,"stop",null),t}(H5Player),BUILD_TIME=envVals.BUILD_TIME,VERSION=envVals.VERSION;window.SuperPlayer=SuperPlayer,bindExports(SuperPlayer),exports.AdPluginName=AdPluginName,exports.BUILD_TIME=BUILD_TIME,exports.BaseFlowNode=BaseFlowNode,exports.BaseReporter=BaseReporter,exports.BeaconRequest=BeaconRequest,exports.COMMON_DATA_KEY=COMMON_DATA_KEY,exports.CTRL_EVENTS=CTRL_EVENTS,exports.CtrlbarPluginName=CtrlbarPluginName,exports.DEFAULT_KEY=DEFAULT_KEY,exports.DEFAULT_SHOW_QUERY=DEFAULT_SHOW_QUERY,exports.DRM_TYPE=DRM_TYPE,exports.DRM_VALUE=DRM_VALUE,exports.ErrorPagePluginEvents=ErrorPagePluginEvents,exports.ErrorPagePluginName=ErrorPagePluginName,exports.EvtEmitter=s$1,exports.H5Player=H5Player,exports.H5_EXT_EVENT=exports.PLAY_EVENT_EXT,exports.INFO_SVG_DOM_STR=INFO_SVG_DOM_STR,exports.ImageRequest=report,exports.InfoPanelEvents=InfoPanelEvents,exports.InfoPanelPluginName=InfoPanelPluginName,exports.LAZY_PLUGINS=LAZY_PLUGINS,exports.LOCAL_STORAGE_KEY=LOCAL_STORAGE_KEY,exports.MaxRequestRetry=MaxRequestRetry,exports.OFFICIAL_PLUGIN=OFFICIAL_PLUGIN,exports.PLAY_CODEC=PLAY_CODEC,exports.PLUGINS_URL=PLUGINS_URL,exports.PLUGIN_MAP=PLUGIN_MAP,exports.Plugin=Plugin,exports.PosterPluginName=PosterPluginName,exports.REPORTING_SVG_ICON=REPORTING_SVG_ICON,exports.RequestTimeout=RequestTimeout,exports.TipsPluginName=TipsPluginName,exports.UIContextMenuPluginName=UIContextMenuPluginName,exports.VERSION=VERSION,exports.VideoReqInfoPluginName=VideoReqInfoPluginName,exports.WaterMarkCoverClassName=WaterMarkCoverClassName,exports.WatermarkPluginName=WatermarkPluginName,exports.adEvents=adEvents,exports.adGlobalName=adGlobalName,exports.adScriptMaxLoadTime=adScriptMaxLoadTime,exports.adVersion=adVersion,exports.autobind=autobind,exports.bodyOverflowClassName=bodyOverflowClassName,exports.classNameOnCtrlHide=classNameOnCtrlHide,exports.classNameOnCtrlResize=classNameOnCtrlResize,exports.containerClassName=containerClassName,exports.contextMenuPluginName=contextMenuPluginName,exports.createH5Player=createH5Player,exports.createPluginFactory=createPluginFactory,exports.ctrlbarPluginName=ctrlbarPluginName,exports.dataRoleMap=dataRoleMap,exports.default=SuperPlayer,exports.defaultErrorText=defaultErrorText,exports.defaultLiveBusinessConfig=defaultLiveBusinessConfig,exports.defaultShowTime=defaultShowTime,exports.defaultSuperConfig=defaultSuperConfig,exports.defaultVodBusinessConfig=defaultVodBusinessConfig,exports.defaultVodPlatform=defaultVodPlatform,exports.defautVodSdtfrom=defautVodSdtfrom,exports.definePlugins=definePlugins,exports.deregisterPlugin=deregisterPlugin,exports.formatDefnName=formatDefnName,exports.getAdInitConfig=getAdInitConfig,exports.getAdPlugin=getAdPlugin,exports.getBuiltInPlugins=getBuiltInPlugins,exports.getDownloadKitConfig=getDownloadKitConfig,exports.getHookMethodName=getHookMethodName,exports.getPlugin=getPlugin,exports.getPlugins=getPlugins,exports.getRootClassName=getRootClassName,exports.getSuperConfig=getSuperConfig,exports.gradientClassName=gradientClassName,exports.hideClass=hideClass,exports.isFunctionPlugin=isFunctionPlugin,exports.isInDomainWhiteList=isInDomainWhiteList,exports.isPreOrPostAd=isPreOrPostAd,exports.isVideoId=isVideoId,exports.kernelEvtBus=kernelEvtBus,exports.largeSizeClassName=largeSizeClassName,exports.logApiInvoke=logApiInvoke,exports.mergeDynamicConfig=mergeDynamicConfig,exports.mobileRootClassName=mobileRootClassName,exports.once=once,exports.pcRootClassName=pcRootClassName,exports.pluginExists=pluginExists,exports.registerPlugin=registerPlugin,exports.shadowClassName=shadowClassName,exports.skipAdDomainWhiteList=skipAdDomainWhiteList,Object.defineProperty(exports,"__esModule",{value:!0})}));
