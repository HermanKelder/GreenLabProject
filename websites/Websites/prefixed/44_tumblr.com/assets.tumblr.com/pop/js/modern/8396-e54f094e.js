"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[8396],{76636:(e,t,a)=>{a.d(t,{Z:()=>u});var n=a(95004),r=a(6790),s=a(65214),o=a(43523),i=a(78667),l=a(92816),c=a(8156),d=a(2629);const u=e=>{let{routeQueryProps:t,onClick:a,...u}=e;const{isLoggedIn:h,logEvent:m}=(0,i.bp)(),p=(0,n.useRef)(null),b=(0,c.Z)(t),g=()=>(0,s.TL)({},b);return(0,d.jsx)(r.ZP,{hotkey:{key:r.SV.C,command:()=>{var e;null===(e=p.current)||void 0===e||e.click()},modifiers:{[r.TE.Alt]:!0}},children:(0,d.jsx)(l.Z,{...u,getPath:g,onClick:e=>{m({eventName:o.J.PFComposePost}),null==a||a(e)},forwardedRef:p,isAlreadyOnPostFormPath:s.Lv,disableNavigation:!h,...!h&&{"data-login-wall-type":"newTaggedPost","data-login-wall-page":"floating","data-login-wall-tag-label":b.tags,"data-login-wall-redirect":"/dashboard","data-login-wall-destination":(0,s.fO)(b.tags||""),"data-login-wall-new-post-path":g()}})})}},28396:(e,t,a)=>{a.d(t,{Z:()=>ce});var n=a(5754),r=a.n(n),s=a(76636),o=a(2487),i=a(52870),l=a(69654),c=a(10689),d=a(85768),u=a(63764),h=a(93390),m=a(31872),p=a(85895),b=a(26503),g=a(65214),f=a(32468),v=a(51826),w=a(18046),x=a(32089),y=a(43523),T=a(78667),C=a(93099),k=a(73971),S=a(82449),j=a(80293);const P=(0,j.Z)((()=>Promise.all([a.e(1219),a.e(970)]).then(a.bind(a,32775))),"AsyncAccountPopover"),M=(0,j.Z)((()=>Promise.all([a.e(5541),a.e(7023),a.e(3981)]).then(a.bind(a,48571))),"AsyncActivityPopover");var Z=a(79615),N=a(23670),L=a(64186);const F="KTRcB",B="PK7qG",E="B1L2M",I="cckUS";var H=a(2629);const _=e=>{let{children:t,label:a,isActive:n,link:s,useRouter:o,notificationCount:i=0,notificationStatus:l}=e;const c=(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Z.Z,{wrapperClassName:E,className:r()(B,{[I]:n}),label:a,children:t}),i>0&&(0,H.jsx)(L.Z,{count:i,showNumber:!0}),l&&(0,H.jsx)(L.Z,{count:1,showNumber:!1,isCircle:!0,style:{top:-9,right:-9}})]});return(0,H.jsx)("div",{className:F,children:o?(0,H.jsx)(N.Z,{to:s,tabIndex:-1,children:c}):(0,H.jsx)("a",{href:s,tabIndex:-1,children:c})})};var O=a(50209),A=a.n(O),R=a(95004),W=a(8535);class q extends R.Component{constructor(){super(...arguments),A()(this,"state",{error:null})}static getDerivedStateFromError(e){return{error:e}}render(){const{error:e}=this.state;return e?this.props.FallbackComponent?(0,H.jsx)(this.props.FallbackComponent,{error:e}):null:this.props.children}}var D=a(9557),$=a(62412),z=a(43684);const U=e=>{const{children:t,label:a,isActive:n,notificationCount:s}=e;return(0,H.jsxs)(Z.Z,{wrapperClassName:E,label:a,children:[(0,H.jsx)("span",{className:r()(B,{[I]:n}),children:t}),(0,H.jsx)(L.Z,{count:s})]})},G=e=>{const{logEvent:t}=(0,T.bp)(),{label:a,componentWidth:n,componentMaxHeight:r,component:s,showOverflowY:o,controlledPopoverProps:i}=e,l={showOverflowY:o,component:(0,H.jsx)(q,{children:s},a),height:"auto",position:z.I2.Bottom,width:n,isFlipEnabled:!1,maxHeight:r,closeForAllExternalClicks:!0,onOpen:()=>t({eventName:e.krakenEvent})};return(0,H.jsx)("div",{className:F,children:i?(0,H.jsx)($.ZP,{...l,...i,children:U(e)}):(0,H.jsx)(D.Z,{...l,children:U(e)})})},J="GcA7R";class K extends R.Component{constructor(){super(...arguments),A()(this,"state",{isOpen:!1}),A()(this,"toggle",(()=>this.setState((e=>({isOpen:!e.isOpen})))))}render(){const{popoverMenuItemProps:e}=this.props,{isOpen:t}=this.state;return(0,H.jsx)(G,{...e,controlledPopoverProps:{isOpen:t,toggle:this.toggle},component:(0,H.jsx)("div",{className:J,children:(0,H.jsx)(W.Z,{})})})}}const Q="hlDot",Y="C38Rc",V="hvZ5A",X="_3kR_",ee="rllUD",te="nzmrE",ae="BY8m2",ne="yTPpj",re="uuWZ2",se="QOMh2",oe="xxqHJ",ie={width:22,height:22},le=e=>{let{activePage:t,headerTheme:a,showLimitedHeader:n,transparentBackground:j,hardLinkNavigation:Z,blogName:N,inboxStatus:L,unseenPostCount:F,notificationCount:B,unreadMessagesCount:E,privateGroupBlogUnreadPostCount:I,hideLoggedOutButtons:O,hideLoginButton:A,hideSignUpButton:R,logoUrl:W,registrationSource:q}=e;const{_t:D,isLoggedIn:$}=(0,T.bp)();let z="";(0,f.eh)(t)&&t.extraAttributes&&(z=t.extraAttributes.searchTerm);const U=!n&&(0,H.jsxs)("div",{className:re,children:[(0,H.jsx)(b.Z,{}),(0,H.jsx)(_,{link:g.o_.dashboard,useRouter:!0,label:D("Home"),isActive:(0,f.fR)(t),notificationCount:F,children:(0,H.jsx)(l.Z,{size:{width:20,height:21}})}),(0,H.jsx)(_,{useRouter:!0,link:(0,C.Z)(g.o_.exploreByMode,{exploreMode:w.Ru.Recommended}),label:D("Explore"),isActive:(0,f.J8)(t),children:(0,H.jsx)(i.Z,{size:ie})}),(0,H.jsx)(_,{link:g.o_.inbox,useRouter:!0,label:D("Inbox"),isActive:(0,f.GT)(t),notificationStatus:L,children:(0,H.jsx)(d.Z,{size:{width:23,height:21}})}),(0,H.jsx)(K,{popoverMenuItemProps:{children:(0,H.jsx)(u.Z,{size:ie}),componentWidth:280,componentMaxHeight:490,label:D("Messaging"),isActive:(0,f.ww)(t),showOverflowY:!0,notificationCount:E,krakenEvent:y.J.MessagesPopover}}),(0,H.jsx)(G,{component:(0,H.jsx)(M,{}),componentWidth:380,componentMaxHeight:"90vh",label:D("Activity"),isActive:(0,f.fu)(t),notificationCount:B,showOverflowY:!0,krakenEvent:y.J.ActivityPopover,children:(0,H.jsx)(c.Z,{size:{width:14,height:21}})}),(0,H.jsx)(G,{component:(0,H.jsx)(P,{activePage:t}),componentWidth:240,componentMaxHeight:"90vh",label:D("Account"),isActive:(0,f.G8)(t),notificationCount:I,krakenEvent:y.J.AccountPopover,children:(0,H.jsx)(m.Z,{size:{width:15,height:21}})}),(0,H.jsx)(s.Z,{label:D("New post"),className:oe,routeQueryProps:{blogName:N,isPageBlogPage:(0,f.Sr)(t),composeSettings:(0,v.W)(t)},children:(0,H.jsx)(h.Z,{size:{height:22,width:22}})})]}),J=!O&&(0,H.jsx)("div",{className:r()(re,ne),children:(0,H.jsx)(S.Z,{theme:x.yS[a],hideLoginButton:A,hideSignUpButton:R,registrationSource:q,loginButtonStyle:{marginRight:10}})}),le=$?U:J;let ce;ce=W?(0,H.jsx)(o.Z,{hardLinkHome:Z,logoUrl:W}):(0,H.jsx)(k.Z,{theme:a,hardLinkHome:Z,animatedGradientOnHover:!j});const de=j||a===x.Ov.Transparent||a===x.Ov.TransparentDark;return(0,H.jsx)("div",{className:r()({[Y]:j,[Q]:!j,[V]:de}),children:(0,H.jsxs)("header",{className:X,children:[(0,H.jsxs)("div",{className:r()(ee,{[ae]:!le}),children:[(0,H.jsx)("div",{className:se,children:ce}),(0,H.jsx)(p.Z,{className:te,initialSearchTerm:z,hardLinkToSearchPage:Z,...n&&{enableTypeahead:!0}})]}),le]})})};le.defaultProps={headerTheme:x.Ov.Light,unseenPostCount:0,notificationCount:0,privateGroupBlogUnreadPostCount:0,unreadMessagesCount:0,inboxCount:0};const ce=le},2487:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(95004),r=a(23670),s=a(43523),o=a(78667),i=a(2629);const l=function(e){let{hardLinkHome:t,logoUrl:a}=e;const{isLoggedIn:l,_t:c,logEvent:d}=(0,o.bp)(),u=(0,i.jsx)("div",{children:(0,i.jsx)("img",{src:a,alt:"Logo"})}),h=c("Home"),m=t||!l?"/":"/dashboard",p=(0,n.useCallback)((()=>{d({eventName:s.J.LogoClick,eventDetails:{destination:m}})}),[m]);return t||!l?(0,i.jsx)("a",{href:m,"aria-label":h,onClick:p,children:u}):(0,i.jsx)(r.Z,{to:m,"aria-label":h,onClick:p,children:u})}},73971:(e,t,a)=>{a.d(t,{Z:()=>y});var n=a(5754),r=a.n(n),s=a(95004),o=a(46773),i=a(23670),l=a(32089),c=a(43523),d=a(78667),u=a(63583),h=a.n(u);const m="Ovlgo",p="FQkf4",b="FP6oS",g="GjGsN",f="tSe6h";var v,w=a(2629);const x=(null===(v=o.Z.defaultProps)||void 0===v?void 0:v.size)||{width:0,height:0},y=function(e){let{size:t,theme:a,hardLinkHome:n,animatedGradientOnHover:u=!1}=e;const{isLoggedIn:v,_t:y,features:T,logEvent:C}=(0,d.bp)(),k=(0,w.jsxs)("div",{className:r()(p,{[f]:u,[m]:T.prideMonthLogoAnimation}),style:{width:`${(null==t?void 0:t.width)||x.width}px`,height:`${(null==t?void 0:t.height)||x.height}px`},children:[(0,w.jsx)("div",{className:b}),(0,w.jsx)(o.Z,{className:g,colors:{primary:void 0!==a&&[l.Ov.Light,l.Ov.Transparent].includes(a)?h().paletteWhiteOnDark:h().paletteBlack},...t&&{size:t}})]}),S=y("Home"),j=n||!v?"/":"/dashboard",P=(0,s.useCallback)((()=>{C({eventName:c.J.LogoClick,eventDetails:{destination:j}})}),[j]);return n||!v?(0,w.jsx)("a",{href:j,"aria-label":S,onClick:P,children:k}):(0,w.jsx)(i.Z,{to:j,"aria-label":S,onClick:P,children:k})}},82449:(e,t,a)=>{a.d(t,{Z:()=>w});var n=a(95004),r=a(86179),s=a(90891),o=a(65214),i=a(32089),l=a(42580),c=a(43523),d=a(64633),u=a(78667),h=a(58849),m=a(89465),p=a(63583),b=a(92023),g=a(71581);const f=(e,t)=>!!e[g.T.LoginWall]&&((0,o.lc)(t)||(0,o.tc)(t)||(0,b.vr)(t));var v=a(2629);const w=function(e){let{theme:t,hardLinkNavigation:a,hideLoginButton:b,hideSignUpButton:g,registrationSource:w,loginButtonStyle:x,signUpButtonStyle:y,disableLoginWall:T}=e;const{_t:C,logEvent:k,features:S,wwwBaseUrl:j}=(0,u.bp)(),{openLoginWall:P}=(0,h.h)(),{pathname:M,search:Z}=(0,r.TH)(),N=(0,n.useCallback)((()=>k({eventName:c.J.ClickSignup})),[]),L=(0,n.useCallback)((()=>k({eventName:c.J.ClickLogin})),[]),F=(0,n.useCallback)((e=>{null==e||e.preventDefault(),P({form:l.c.Login,redirect:M})}),[]),B=(0,n.useCallback)((e=>{null==e||e.preventDefault(),P({form:l.c.Register})}),[]),E=!T&&f(S,M)?F:L,I=!T&&f(S,M)?B:N,H=a&&"_blank",_=a?j:"",O=new URLSearchParams(Z).get("redirect_to")||void 0;let A,R,W;switch(w||(w=(0,m.k)(M,d.Vu.HeaderSignUpButton)),t){case i.p3.TransparentDark:R={backgroundColor:p.transparentBlack15,textColor:p.paletteBlack},W={backgroundColor:p.black,textColor:p.transparentWhite50},A={mixBlendMode:"hard-light"};break;case i.p3.Greyscale:R={backgroundColor:p.paletteBlack,textColor:p.gray40},W={backgroundColor:p.gray40,textColor:p.paletteBlack};break;default:R={backgroundColor:p.glassGreen,textColor:"#000000"},W={backgroundColor:p.dreamcastBlue,textColor:"#000000"}}return(0,v.jsxs)(v.Fragment,{children:[!b&&(0,v.jsx)(s.Z,{href:`${_}${(0,o.gZ)({formToShow:l.c.Login},{redirect_to:O})}`,feature:!1,size:"small",onClick:E,style:x,...H&&{target:H},...R,children:C("Log in")}),!g&&(0,v.jsx)(s.Z,{href:`${_}${(0,o.gZ)({formToShow:l.c.Register},{source:w,redirect_to:O})}`,feature:!1,size:"small",onClick:I,style:y,...H&&{target:H},...W,...A&&{style:A},children:C("Sign up")})]})}},52870:(e,t,a)=>{a.d(t,{Z:()=>r});const n=(0,a(36343).q)("explore");n.defaultProps={size:{width:22,height:24}};const r=n},69654:(e,t,a)=>{a.d(t,{Z:()=>r});const n=(0,a(36343).q)("home");n.defaultProps={size:{width:20,height:21}};const r=n},10689:(e,t,a)=>{a.d(t,{Z:()=>r});const n=(0,a(36343).q)("lightning");n.defaultProps={size:{width:24,height:24}};const r=n},85768:(e,t,a)=>{a.d(t,{Z:()=>r});const n=(0,a(36343).q)("mail");n.defaultProps={size:{width:23,height:24}};const r=n},63764:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(36343),r=a(66498),s=a(14544),o=a(2629);const i={default:(0,n.q)("messaging"),ghost:(0,n.q)("messaging-ghost"),pumpkin:(0,n.q)("messaging-pumpkin"),vampire:(0,n.q)("messaging-vampire")},l=e=>{let{forceVariant:t,...a}=e;const n=(0,s.M)();let l=t;l||(l=(null==n?void 0:n.name)===r.Z.ghost?"ghost":(null==n?void 0:n.name)===r.Z.vampire?"vampire":(null==n?void 0:n.name)===r.Z.pumpkin?"pumpkin":"default");const c=i[l];return(0,o.jsx)(c,{...a})};l.defaultProps={size:{width:21,height:21}};const c=l},93390:(e,t,a)=>{a.d(t,{Z:()=>r});const n=(0,a(36343).q)("post");n.defaultProps={size:{width:24,height:24}};const r=n},8535:(e,t,a)=>{a.d(t,{Z:()=>n});const n=(0,a(80293).Z)((()=>Promise.all([a.e(2470),a.e(8236),a.e(4051),a.e(4465)]).then(a.bind(a,74675))),"AsyncMessaging")},85895:(e,t,a)=>{a.d(t,{Z:()=>H});var n=a(50209),r=a.n(n),s=a(5754),o=a.n(s),i=a(95004),l=a(79153),c=a(6790),d=a(19486),u=a(13434),h=a(62412),m=a(65214),p=a(43684),b=a(81584),g=a(44655),f=a(59215),v=a(42914),w=a(58546),x=a(96488),y=a(63583),T=a.n(y),C=a(39277);const k=(0,a(80293).Z)((()=>a.e(4998).then(a.bind(a,47487))),"AsyncTypeaheadDropdown"),S="Mw2UR",j="oPa7v",P="Z3WPg",M="NaqPB",Z="aogHd",N="GT10N";var L=a(2629);class F extends i.Component{constructor(){super(...arguments),r()(this,"state",{searchKeyword:this.props.initialSearchTerm,followedTags:[],searchTags:[],searchBlogs:[],isOpen:!1,hasFocus:!1,hasRequestedFollowedTags:!1,isLoading:!1}),r()(this,"debounceDelay",250),r()(this,"debouncedTypeaheadSearch",(0,v.Z)(this.typeaheadSearch,this.debounceDelay)),r()(this,"inputRef",(0,i.createRef)()),r()(this,"apiHelper",(0,b.ZP)(this.props.appContext.apiFetch)),r()(this,"renderSearchForm",(()=>{const{appContext:{_t:e,wwwBaseUrl:t},autoCapitalize:a="on"}=this.props,{searchKeyword:n,hasFocus:r,isLoading:s}=this.state;return(0,L.jsx)("form",{method:"GET",action:`${t}/search`,role:"search",className:Z,onSubmit:this.submitForm,children:(0,L.jsxs)("div",{className:j,children:[(0,L.jsx)("div",{className:P,children:(0,L.jsx)(d.Z,{size:{width:18,height:18}})}),(0,L.jsx)(c.ZP,{hotkey:{key:c.SV.Slash,command:this.focus,modifiers:{[c.TE.Shift]:!0},allowInputs:!0},disable:r?c.z9:[],children:(0,L.jsx)("input",{name:"q",type:"text",autoComplete:"off",ref:this.inputRef,value:n,"aria-label":e("Search"),className:M,placeholder:e("Search Tumblr"),onBlur:this.onInputBlur,onFocus:this.onInputFocus,onChange:this.onInputChange,autoCapitalize:a})}),s&&(0,L.jsx)("div",{className:N,children:(0,L.jsx)(u.Z,{small:!0,centerOrientation:u.Q.HorizontalAndVertical,color:T().paletteTransparentWhite65})})]})})})),r()(this,"handleKeydownEvent",(e=>t=>{var a,n;const{key:r}=t;if(!["ArrowUp","ArrowDown"].includes(r))return;null===(a=t.preventDefault)||void 0===a||a.call(t);const s=Array.from(null==e?void 0:e.getElementsByTagName("a"));let o=null==s?void 0:s.indexOf(document.activeElement);var i;("ArrowDown"===r?o++:o--,o<0)?null===(i=this.inputRef.current)||void 0===i||i.focus():(o>=s.length&&(o=0),null===(n=s[o])||void 0===n||n.focus())})),r()(this,"onInputChange",(e=>{let{target:{value:t}}=e;return this.setState({searchKeyword:t},(()=>this.props.enableTypeahead&&this.debouncedTypeaheadSearch()))})),r()(this,"onInputFocus",(()=>{const{enableTypeahead:e,appContext:{isLoggedIn:t}}=this.props,{hasRequestedFollowedTags:a}=this.state;this.setState({hasFocus:!0}),e&&!a&&t&&this.requestFollowedTags()})),r()(this,"onInputBlur",(()=>this.setState({hasFocus:!1}))),r()(this,"onSearchBarBlur",(async e=>{this.props.isTypeaheadFullscreen||await(0,x.Z)(e)||this.onControlledPopoverClose()})),r()(this,"renderSearchFormWithTypeahead",(()=>{const{isOpen:e}=this.state,{isTypeaheadFullscreen:t,glassContext:{glassContainerRef:a}}=this.props;return t?(0,L.jsxs)(L.Fragment,{children:[this.renderSearchForm(),e&&this.hasResults()&&a&&(0,l.createPortal)(this.renderTypeahead(),a)]}):(0,L.jsx)(h.ZP,{isOpen:e,skipClickToOpen:!0,toggle:this.onControlledPopoverClose,tabIndex:-1,width:"100%",height:"auto",maxHeight:"70vh",type:p.Oj.Click,component:this.renderTypeahead(),handleKeydownEvent:this.handleKeydownEvent,children:this.renderSearchForm()})})),r()(this,"renderTypeahead",(()=>{const{isTypeaheadFullscreen:e}=this.props,{followedTags:t,searchTags:a,searchBlogs:n,searchKeyword:r}=this.state;return(0,L.jsx)(k,{followedTags:t,tags:a,blogs:n,query:r,isFullscreen:e,closeContainingPopover:this.onControlledPopoverClose})})),r()(this,"onControlledPopoverClose",(()=>{this.inputRef.current&&this.inputRef.current.blur(),this.setState({isOpen:!1})})),r()(this,"focus",(()=>this.inputRef.current&&this.inputRef.current.focus())),r()(this,"submitForm",(e=>{var t;const{hardLinkToSearchPage:a,appContext:{wwwBaseUrl:n}}=this.props;e.preventDefault();const r=e.target.querySelector('input[name="q"]'),s=null==r||null===(t=r.value)||void 0===t?void 0:t.trim(),o=s?(0,m.W8)(s):"/explore/";if(a){const e=`${n}${o}`;location.assign(e)}else this.props.navigate(o),this.onControlledPopoverClose()})),r()(this,"hasResults",(()=>{const{followedTags:e,searchTags:t,searchBlogs:a}=this.state;return!(0,w.Q)(e)||!(0,w.Q)(t)||!(0,w.Q)(a)}))}componentDidUpdate(e){this.updateOpenState(),this.props.initialSearchTerm!==e.initialSearchTerm&&this.setState({searchKeyword:this.props.initialSearchTerm})}componentDidMount(){this.props.autoFocus&&this.focus(),""!==this.state.searchKeyword&&this.debouncedTypeaheadSearch()}render(){const{className:e,enableTypeahead:t}=this.props;return(0,L.jsx)("div",{className:o()(S,e),onBlur:this.onSearchBarBlur,children:t?this.renderSearchFormWithTypeahead():this.renderSearchForm()})}async typeaheadSearch(){const{searchKeyword:e}=this.state;if(e){this.setState({isLoading:!0});const{response:{tags:t,blogs:a}}=await(0,g.on)(this.props.appContext.apiFetch,e).fetch();this.setState({searchTags:null!=t&&t.length?t:[{tag:e}],searchBlogs:a||[],isLoading:!1})}else this.setState({searchTags:[],searchBlogs:[],isLoading:!1})}async requestFollowedTags(){this.setState({hasRequestedFollowedTags:!0,isLoading:!0});const{response:{tags:e}}=await this.apiHelper.getTags().fetch();this.setState({followedTags:e||[],isLoading:!1})}updateOpenState(){const{isOpen:e,hasFocus:t}=this.state;!e&&t&&this.hasResults()&&this.setState({isOpen:!0})}}r()(F,"defaultProps",{enableTypeahead:!0,isTypeaheadFullscreen:!1,autoFocus:!1,initialSearchTerm:""});const B=(0,f.X9)(F,{appContext:!0,glassContext:!0}),E=(0,C.Z)(B);class I extends i.Component{render(){return(0,L.jsx)(E,{...this.props})}}r()(I,"defaultProps",F.defaultProps);const H=I},26503:(e,t,a)=>{a.d(t,{Z:()=>fe});var n=a(5754),r=a.n(n),s=a(95004),o=a(86179),i=a(87674),l=a(90891),c=a(54382),d=a(79153),u=a(43523),h=a(78667);const m=(e,t)=>Math.floor(Math.random()*(t-e+1))+e;const p=function(e){return e[m(0,e.length-1)]};var b=a(40433),g=a(42914);const f=()=>{const[e,t]=(0,s.useState)({clientX:0,clientY:0}),a=(0,g.Z)((e=>{const{clientX:a,clientY:n}=e;t({clientX:a,clientY:n})}),100);return(0,s.useEffect)((()=>(document.addEventListener("mousemove",a,!1),document.addEventListener("mouseenter",a,!1),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseenter",a),a.cancel()})),[]),e};var v=a(6790);const w={scoreboard:"PMWro",scoreCategory:"M6jBU",hidden:"t7fs2"};var x=a(2629);const y=function(e){let{numSummoned:t,numFriends:a,numBeloved:n,numCaptured:o}=e;const{_c:i}=(0,h.bp)(),[l,c]=(0,s.useState)(!0);return t?(0,x.jsxs)("div",{className:r()(w.scoreboard,{[w.hidden]:!l}),onClick:()=>c(!l),onKeyDown:e=>{e.key===v.SV.Enter&&c(!l)},role:"button",tabIndex:0,children:[t>0&&(0,x.jsxs)("div",{className:w.scoreCategory,children:[(0,x.jsx)("p",{children:i("[TumblrMart crab widget]: Label for displaying total number of summoned crabs","summoned:")}),(0,x.jsx)("span",{className:w.score,children:t})]}),null!==o&&(0,x.jsxs)("div",{className:w.scoreCategory,children:[(0,x.jsx)("p",{children:i("[TumblrMart crab widget]: Label for displaying total number of captured crabs","captured:")}),(0,x.jsx)("span",{className:w.score,children:o})]}),null!==a&&(0,x.jsxs)("div",{className:w.scoreCategory,children:[(0,x.jsx)("p",{children:i("[TumblrMart crab widget]: Label for displaying total number of friend crabs","befriended:")}),(0,x.jsx)("span",{className:w.score,children:a})]}),null!==n&&(0,x.jsxs)("div",{className:w.scoreCategory,children:[(0,x.jsx)("p",{children:i("[TumblrMart crab widget]: Label for displaying total number of crabs that have fallen in love with the user","beloved:")}),(0,x.jsx)("span",{className:w.score,children:n})]})]}):null};var T=a(79615),C=a(22790),k=a(65214),S=a(5700);const j="ZFczK";function P(e){let{_c:t,_cn:a,numSummoned:n,numFriends:r,numBeloved:s,numCaptured:o}=e;const i=n&&o&&!r&&!s,l=n&&o&&o>=n,c=n&&r&&!o&&!s&&r>=n,d=n&&s&&!o&&!r&&s>=n;if(n){if(n&&!o&&!r&&!s)return[{type:S.kH.Text,text:a("[TumblrMart crab widget]: Share post copy when only summoned crabs.","today i summoned a crab! it is a good day","today i summoned %1$s crabs! look at them!",n)},...N({_c:t,showTitle:!1,numSummoned:n})];if(i)return l?[{type:S.kH.Text,text:a("[TumblrMart crab widget]: Share post copy when user caught all summoned crabs.","today i summoned one crab and then caught it ðŸ’°","today i summoned %1$s crabs and then caught all of them! what a harvest",n)},...n>1?N({_c:t,showTitle:!1,numCaptured:o}):[]]:[{type:S.kH.Text,text:t("[TumblrMart crab widget]: Share post copy when user caught some of summoned crabs.","today i summoned %1$s crabs and caught %2$s ðŸ’° of them. look at them all!",[String(n),String(o)])},...N({_c:t,showTitle:!1,numSummoned:n,numCaptured:o})];if(c)return[{type:S.kH.Text,text:a("[TumblrMart crab widget]: Share post copy when user is friends with all summoned crabs.","today i summoned one crab and became best friends with it. it's just me and my crab friend against the world! ðŸ¦€ðŸŒ¼","today i summoned %1$s crabs and became friends with all of them ðŸ¥° look at my new friends!!",n)},...n>1?N({_c:t,showTitle:!1,numFriends:r}):[]];if(d)return[{type:S.kH.Text,text:a("[TumblrMart crab widget]: Share post copy when user summoned crabs and all of them fell in love with user.","today i summoned one crab and then we fell in love ðŸ¦€ðŸ’™ crab my beloved","today i summoned %1$s crabs and they all fell in love with me. i love them too.",n)},...n>1?N({_c:t,showTitle:!1,numBeloved:s}):[]];{const e=[a("[Tumblrmart crab widget]: Share post copy.","today i summoned one crab!","today i summoned %1$s crabs!",n)];return o&&e.push(a("[TumblrMart crab widget]: Share post copy.","i caught one ðŸ’° of them.","i caught %1$s ðŸ’° of them.",o)),r&&e.push(a("[TumblrMart crab widget]: Share post copy.","i became friends with one ðŸŒ¼ of them.","i became friends with %1$s ðŸŒ¼ of them.",r)),s&&e.push(a("[TumblrMart crab widget]: Share post copy.","one fell in love with me ðŸ’™","%1$s fell in love with me ðŸ’™",s)),[{type:S.kH.Text,text:e.join(" ")},...N({_c:t,numSummoned:n,numFriends:r,numBeloved:s,numCaptured:o})]}}return[{type:S.kH.Text,text:t("[TumblrMart crab widget]: Share post copy when no crabs summoned.","it is time for crab on tumblr, but not time for crab in my life. yet.")}]}function M(e){return[{type:S.kH.Text,text:p(e)}]}function Z(e,t){return Array(t>=0?t:0).fill(e).join(" ")}function N(e){let{_c:t,showTitle:a=!0,numSummoned:n=0,numFriends:r=0,numBeloved:s=0,numCaptured:o=0}=e;const i=n-o-s-r,l=Z("ðŸ¦€ðŸ’™",s),c=Z("ðŸ¦€ðŸŒ¼",r),d=Z("ðŸ¦€",i),u=Z("ðŸ’°",o),h=[];a&&h.push({type:S.kH.Text,subtype:S.lr.Quirky,text:t("[TumblrMart crab widget]: Share post group picture title. Must be a litle silly and excitable.","group picture!!!")});const m=[];return l&&m.push(l),c&&m.push(c),d&&m.push(d),u&&m.push(u),m.length&&h.push({type:S.kH.Text,subtype:S.lr.Quirky,text:m.join(" ")}),h}function L(e){let{className:t,...a}=e;return(0,x.jsx)(T.Z,{...a,wrapperClassName:r()(j,t),children:(0,x.jsx)(C.Z,{})})}const F=function(e){let{numSummoned:t,numFriends:a,numBeloved:n,numCaptured:r}=e;const{_c:s,_cn:i,logEvent:l}=(0,h.bp)(),c=(0,o.s0)(),d=s("[TumblrMart crab widget]: Button that shares your crab scores as a new post","Share your crab counts!");return(0,x.jsx)(L,{title:d,onClick:()=>{const e={content:[{type:S.kH.Text,subtype:S.lr.Heading1,text:s("[TumblrMart crab widget]: Share post title","ðŸ¦€ time for crab ðŸ¦€")},...M([s("[TumblrMart crab widget]: Share post copy. Intro content text.","Due to unforeseen circumstances, this post will be brought to you solely by crabs."),s("[TumblrMart crab widget]: Share post copy. Intro content text.","Whatâ€™s that coming over the dash? Is it a monster? No. Itâ€™s just a crab ðŸ¦€"),s("[TumblrMart crab widget]: Share post copy. Intro content text.","*clack clack clack* Itâ€™s crab time *clack clack clack*")]),...P({_c:s,_cn:i,numSummoned:t,numFriends:a,numBeloved:n,numCaptured:r}),...M([s("[TumblrMart crab widget]: Share post copy. Closing content text.","just me and my crab army *clack clack clack* ðŸ¦€"),s("[TumblrMart crab widget]: Share post copy. Closing content text.","i summoned some new orange friends ðŸ¦€")])],isPrefilledPost:!0,disableBlogSelection:!1,tags:["time for crab","crab time","crustacean nation","crab","clack"]};l({eventName:u.J.CrabsScoreboardShare}),c((0,k.TL)({postType:S.hQ.Text}),{state:{newPost:e}})},className:j})},B="n4ng3",E="o7Esz",I="rxrOL",H="y5_hQ",_="JljDF",O="vqBle",A="ovjCT",R="GmAPq",W="WxeRb",q="Acwsj";let D=0;const $=100,z=[[-1,-1],[-1,0],[0,-1],[0,1],[1,0],[1,1],[-1,1],[1,-1]],U="crab_counts";function G(e){return e>=10}function J(e,t,a){let n=m(-1,1);if(0!==n){const r=e+n*t;r<$?n=m(0,1):r>=a&&(n=m(-1,0))}return n}function K(e,t,a,n){const r=e+t*a;return r<$||r>=n}function Q(e){return(e??0)-1}function Y(e){return(e??0)+1}function V(e){let{id:t,onClick:a,onFriend:n,onLove:o}=e;const{_t:i,_c:l}=(0,h.bp)(),[c]=(0,s.useState)(m(400,1e3)),[d]=(0,s.useState)(m(20,79)),u=window.innerWidth-$,b=window.innerHeight-$,[g,v]=(0,s.useState)([m(0,Q(u)),m(0,Q(b))]),w=f(),y=p(z),[T,C]=(0,s.useState)(y[0]),[k,S]=(0,s.useState)(y[1]),[j,P]=(0,s.useState)(0),[M,Z]=(0,s.useState)(0),[N,L]=(0,s.useState)(!1),[F,B]=(0,s.useState)(!1),[E,I]=(0,s.useState)(!1),[H,D]=(0,s.useState)(""),[U,V]=(0,s.useState)(!1),X=(0,s.useRef)(),ee=(0,s.useRef)();(0,s.useEffect)((()=>{if(!E&&!F)return X.current=setInterval((()=>{const[e,t]=g;let a=T,n=k;const r=j>5&&Math.random()>.5;(r||K(e,a,d,u))&&(a=J(e,d,u),C(a)),(r||K(t,n,d,b))&&(n=J(t,d,b),S(n));v([e+T*d,t+k*d]),P(r?0:Y(j))}),c),()=>clearInterval(X.current)}),[g,T,k,M,d,j]),(0,s.useEffect)((()=>{var e;const t=new RegExp(i("Avatar"),"i"),a=null===(e=document)||void 0===e?void 0:e.elementFromPoint(...g),n=null==a?void 0:a.tagName.toLowerCase(),r=((null==a?void 0:a.getAttribute("data-crab-label"))||"").toLowerCase();if(r)D(r);else if("img"===n){const e=((null==a?void 0:a.getAttribute("alt"))||"").toLowerCase();e&&e.match(t)?D(l("[TumblrMart crab widget]: What a crab says when it walks on top of a blog name or avatar.","friend?")):e&&D(e)}else if("a"===n){const e=(null==a?void 0:a.getAttribute("href"))||"";if(e.match(/\/tagged\//)){const e=(null==a?void 0:a.textContent)||"";e.match(/\bc+r+a+b+\b/i)?D(l('[TumblrMart crab widget]: What a crab says when it walks on top of a tag link that contains "crab".',"about me?")):e.match(/ðŸ¦€/i)?D(l("[TumblrMart crab widget]: What a crab says when it walks on top of a tag link that contains a crab emoji.","me??")):D(l("[TumblrMart crab widget]: What a crab says when it walks on top of a tag link.","tag"))}else e.match(/^https:\/\/.+\.tumblr.com\//)?D(l("[TumblrMart crab widget]: What a crab says when it walks on top of a blog name or avatar.","friend?")):D(l("[TumblrMart crab widget]: What a crab says when it walks on top of a link.","link"))}else D("video"===n?l("[TumblrMart crab widget]: What a crab says when it walks on top of a video.","video"):"")}),[g]),(0,s.useEffect)((()=>{if(!E&&F)return X.current=setInterval((()=>{const{clientX:e,clientY:t}=w,[a,n]=g,r=20;let s,o,i,c;if(a+42<e-r?(s=1,i=e-r-a-42):a>e+r?(s=-1,i=a-e-r):(s=0,i=0),n+42<t-r?(o=1,c=t-r-n-42):n>t+r?(o=-1,c=n-t-r):(o=0,c=0),C(s),S(o),0===s&&0===o)D(l("[TumblrMart crab widget]: What a beloved crab says when it meets you","love <3"));else{const e=a+s*Math.min(i,d),t=n+o*Math.min(c,d);v([e,t])}}),.75*c),()=>clearInterval(X.current)}),[g,T,k,M,d,w]);const te=()=>{if(!U){const e=M,t=Y(e);!F&&function(e){return e>=25}(t)?(L(!1),B(!0),o()):!G(e)&&G(t)&&(L(!0),n()),Z(t)}},ae=()=>{U||E||(I(!0),setTimeout((()=>a(t)),3e3)),X.current&&clearInterval(X.current)};return(0,x.jsx)("div",{className:r()(_,{[R]:N&&!F,[W]:F,[A]:E,[O]:!!H}),"data-css-text-hand":l("[TumblrMart crab widget]: What a crab says when you hover over it","hand"),"data-css-text-friend":l("[TumblrMart crab widget]: What a friend crab says when you hover over it","friend <3"),"data-css-text-love":l("[TumblrMart crab widget]: What a beloved crab says when it meets you","love <3"),"data-speech":H,"data-testid":"crab-wrapper",style:{transform:`translate(${g[0]}px, ${g[1]}px)`},children:(0,x.jsx)("button",{"aria-label":l("[TumblrMart crab widget]: Label for interactive crab","Interactive crab"),className:q,onClick:ae,onMouseEnter:te,onTouchStart:()=>{if(U)return clearTimeout(ee.current),V(!1),ae();ee.current=setTimeout((()=>{V(!1),te()}),300),V(!0)},children:E?(0,x.jsx)("span",{role:"img","aria-label":l("[TumblrMart crab widget]: Label for a crab that has been caught","Crab in a bag"),children:"ðŸ’°"}):(0,x.jsx)("span",{role:"img","aria-label":l("[TumblrMart crab widget]: Label for a crab","Crab"),children:"ðŸ¦€"})})})}function X(e){var t;let{crabs:a,onFriendCrab:n,onLoveCrab:r,onDismissCrab:s}=e;return"undefined"!=typeof window?(0,d.createPortal)((0,x.jsx)("div",{"data-testid":"crab-wall",className:H,children:a.map((e=>(0,x.jsx)(V,{id:e.id,onClick:s,onFriend:n,onLove:r},e.id)))}),null===(t=document)||void 0===t?void 0:t.body):null}const ee=function(){const{_c:e,logEvent:t}=(0,h.bp)(),[a,n]=(0,s.useState)([]),[r,o]=(0,s.useState)(null),[i,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[m,p]=(0,s.useState)(null),g=(0,s.useRef)();(0,s.useEffect)((()=>(window.addEventListener("beforeunload",f),()=>{f(),window.removeEventListener("beforeunload",f)})),[]),(0,s.useEffect)((()=>{g.current={numBefriended:r??0,numBeloved:i??0,numCaptured:c??0,numSummoned:m??0}}),[r,i,c,m]);const f=()=>{var e;if(null!==(e=g.current)&&void 0!==e&&e.numSummoned&&(0,b.f)()){const e=localStorage.getItem(U),{befriended:t,beloved:a,captured:n,summoned:r}=e?JSON.parse(e):{befriended:0,beloved:0,captured:0,summoned:0},{numBefriended:s,numBeloved:o,numCaptured:i,numSummoned:l}=g.current;localStorage.setItem(U,JSON.stringify({befriended:t+s,beloved:a+o,captured:n+i,summoned:r+l}))}},v=e("[TumblrMart crab widget]: What the crab says when it steps on the Summon Crab button.","click please");return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:B,children:[(0,x.jsxs)("div",{className:E,children:[(0,x.jsx)("button",{className:I,onClick:()=>{n([...a,{id:D++}]),p((e=>Y(e))),t({eventName:u.J.CrabSummoned})},"data-crab-label":v,children:e("[TumblrMart crab widget]: Button that produces a crab on click","Summon Crab!")}),m&&(0,x.jsx)(F,{numBeloved:i??0,numCaptured:c??0,numFriends:r??0,numSummoned:m})]}),(0,x.jsx)(y,{numBeloved:i,numCaptured:c,numFriends:r,numSummoned:m})]}),(0,x.jsx)(X,{crabs:a,onDismissCrab:e=>{a.findIndex((t=>t.id===e))>-1&&(d((e=>Y(e))),n((t=>{const a=t.findIndex((t=>t.id===e));return a>-1?[...t.slice(0,a),...t.slice(Y(a))]:t})))},onFriendCrab:()=>o((e=>Y(e))),onLoveCrab:()=>{o((e=>Q(e))),l((e=>Y(e)))}})]})};var te=a(78219),ae=a(59464),ne=a(399),re=a(63583);const se="f5gD9",oe=()=>(0,b.f)()&&localStorage.removeItem(U),ie=e=>{let{status:t,uuid:a,onExpired:n}=e;const{_c:r}=(0,h.bp)(),d=(0,o.s0)(),{updateOrderStatus:u}=(0,ae.H)(),[m,p]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null);if((0,s.useEffect)((()=>{t===te.Pt.Completed&&(u(a,te.Pt.Expired),p(!0))}),[]),(0,s.useEffect)((()=>{if(m&&(0,b.f)()){const e=localStorage.getItem(U);e&&f(JSON.parse(e))}}),[m]),(0,s.useEffect)((()=>{if(m&&(0,b.f)())return window.addEventListener("beforeunload",oe),()=>{oe(),window.removeEventListener("beforeunload",oe)}}),[m]),!m)return null;const v=g?(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(c.ZP,{comment:"[TumblrMart] Message that appears when a crab gift expires and crab counts are stored in local storage.",params:{befriended:g.befriended,beloved:g.beloved,captured:g.captured,summoned:g.summoned},children:"Your 24 hours of crabs is over. You summoned [summoned] ðŸ¦€, captured [captured] ðŸ’°, befriended [befriended] ðŸŒ¼, and [beloved] fell in love with you ðŸ’œ on the Tumblr web app. Share your time with crabs and we'll get this place cleaned up."})}):(0,x.jsx)(c.ZP,{comment:"[TumblrMart] Message that appears when a crab gift expires and crab counts are not stored in local storage.",children:"Your 24 hours of crabs is over. Write a Tumblr post to say farewell to the glorious crustaceans, and we'll get to work cleaning this place up."}),w=(()=>{const e=(0,ne.ed)(r);return g?{content:[{type:S.kH.Text,subtype:S.lr.Heading1,text:r("[TumblrMart] Pre-filled title of a Tumblr post when a user's crab gift has expired","Farewell Sweet Crabs ðŸ‘‹ ðŸ¦€")},{type:S.kH.Text,text:r("[TumblrMart] Pre-filled text of a Tumblr post when a user's crab gift has expired and crab counts can be read from local storage.","I summoned %1$s ðŸ¦€, captured %2$s ðŸ’°, befriended %3$s ðŸŒ¼, and %4$s fell in love with me ðŸ’œ. I will miss you my sweet crabs.",[g.summoned,g.captured,g.befriended,g.beloved])}],isPrefilledPost:!0,tags:["time for crab"]}:{content:[{type:S.kH.Text,subtype:S.lr.Heading1,text:r("[TumblrMart] Pre-filled title of a Tumblr post when a user's crab gift has expired","Farewell Sweet Crabs ðŸ‘‹ ðŸ¦€")},{type:S.kH.Text,text:r("[TumblrMart] Pre-filled text of a Tumblr post when a user's crab gift has expired and crab counts cannot be read from local storage.","When I remember my crab friends I'll think of:")},{type:S.kH.Text,text:e,formatting:[{type:S.TV.Italic,start:0,end:e.length-1}]}],isPrefilledPost:!0,disableBlogSelection:!1,tags:["time for crab"]}})();return(0,x.jsxs)(i.Z,{compact:!0,onClose:()=>{p(!1),window.location.reload()},title:r("[TumblrMart] Title shown when the ability to use the crab widget has expired","Oh no! Crab time is up"),children:[(0,x.jsx)("p",{className:se,children:v}),(0,x.jsx)(l.Z,{textColor:re.paletteWhite,size:"entireWidth",onClick:()=>{n(),d((0,k.TL)({postType:S.hQ.Text},{redirect_to:"/dashboard"}),{state:{newPost:w}})},children:(0,x.jsx)(c.ZP,{comment:"[TumblrMart] Text on a button that will create a Tumblr post sharing expired message.",children:"Share"})})]})};var le=a(62412),ce=a(43684);const de="H9EdA",ue="qZEjf",he=e=>{let{children:t,content:a,isOpen:n}=e;const[r,o]=(0,s.useState)(!1);return(0,s.useEffect)((()=>o(n)),[n,o]),(0,x.jsx)(le.ZP,{arrowWrapperClassName:ue,component:(0,x.jsx)("div",{className:de,onClick:()=>o(!1),onKeyDown:()=>o(!1),role:"button",tabIndex:0,children:a}),hasArrow:!0,isChromeless:!0,isOpen:r,position:ce.I2.Bottom,toggle:()=>o(!1),children:t})};var me=a(93613),pe=a(74529);const be=e=>{let{isActive:t,component:a,onActivate:n,onClick:r,uuid:s}=e;const{_c:o,apiFetch:i}=(0,h.bp)(),{setOrder:l}=(0,ae.H)(),{toggleToast:c}=(0,me.V)();return(0,x.jsx)("div",{"data-testid":"tumblrmart-item",onClick:e=>(e=>{t?null==r||r(e):(0,pe.QP)(i,s).fetch().then((t=>{let{response:a}=t;n(),l(a),null==r||r(e)})).catch((()=>{c(o("error message when summoning a crab fails","Oops. There was an error. Try again."),"error")}))})(e),role:"link",tabIndex:-1,children:a})},ge="aVu3s",fe=e=>{let{className:t}=e;const{_c:a,logEvent:n}=(0,h.bp)(),{toggleToast:o}=(0,me.V)(),{getHeaderItem:i}=(0,ae.H)(),[l,c]=(0,s.useState)(!0),[d,m]=(0,s.useState)(null),[p,b]=(0,s.useState)("");(0,s.useEffect)((()=>{const e=i();if(e){const{status:t,uuid:a}=e;c(t===te.Pt.Active),m(t),b(a)}}),[i,c,m,b]);return p&&d?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(ie,{status:d,uuid:p,onExpired:()=>{m(null),n({eventName:u.J.CrabShareFarewell})}}),te.hi.includes(d)&&(0,x.jsx)("div",{className:r()(ge,t),children:(0,x.jsx)(he,{isOpen:!l,content:a("[TumblrMart] Tooltip text for when a user first sees the dashboard crab widget","Summon your crabs ðŸ¦€ Clack!"),children:(0,x.jsx)(be,{component:(0,x.jsx)(ee,{}),isActive:l,onActivate:()=>{c(!0),o(a("[TumblrMart] Message that appears when crabs gift has been used for the first time","ðŸ¦€ Your 24 hours of crabs has begun! ðŸ¦€"),"success")},uuid:p})})})]}):null}},32089:(e,t,a)=>{let n,r;a.d(t,{Ov:()=>n,p3:()=>r,yS:()=>s}),function(e){e[e.Light=0]="Light",e[e.Transparent=1]="Transparent",e[e.TransparentDark=2]="TransparentDark"}(n||(n={})),function(e){e[e.Color=0]="Color",e[e.Greyscale=1]="Greyscale",e[e.TransparentDark=2]="TransparentDark"}(r||(r={}));const s={[n.Light]:r.Color,[n.Transparent]:r.Color,[n.TransparentDark]:r.TransparentDark}},44655:(e,t,a)=>{a.d(t,{Rk:()=>d,_A:()=>i,o:()=>l,on:()=>o,op:()=>c});var n=a(5700),r=a(1308),s=a(60023);function o(e,t){return new s.x(e,`/v2/search/${encodeURIComponent(t)}`,{method:"GET",queryParams:(0,r.n9)(["avatar","name","url","blogViewUrl","title","followed","theme"])})}function i(e,t){return new s.x(e,`/v2/search/${encodeURIComponent(t)}/tags/typeahead`,{method:"GET",queryParams:{limit:"20",include_query:!0}})}function l(e,t){let{searchKeyword:a,timelineType:o,postType:i,requestMode:l,skipComponent:c,limit:d,days:u,reblogInfo:h=!0}=t;return new s.x(e,"/v2/timeline/search",{queryParams:{limit:d,days:u,query:a,mode:l,timeline_type:o,skip_component:c,reblog_info:h,post_type_filter:(0,n.Je)(i),...(0,r.xr)(["followed","shareFollowing","shareLikes","ask","theme"])}})}function c(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new s.x(e,`/v2/search/${encodeURIComponent(t)}/tags/all`,{queryParams:a})}function d(e,t){const a={queryParams:{query:t}};return new s.x(e,"/v2/audio",a)}},40433:(e,t,a)=>{function n(){try{return"undefined"!=typeof localStorage}catch{return!1}}a.d(t,{f:()=>n})}}]);